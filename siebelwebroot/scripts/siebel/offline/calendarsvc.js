/*<ORACLECOPYRIGHT>
* Copyright (C) 2008-2024
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 24.2.0.0SIA[2024_02] */
typeof SiebelApp.calendarsvc=="undefined"&&(SiebelJS.Namespace("SiebelApp.calendarsvc"),define("siebel/offline/calendarsvc",["siebel/offline/model","siebel/offline/servicemodel"],function(){var e=SiebelApp.Offlineconstants,t=SiebelApp.OfflineUtils,n={},r="",i="",s="",o="",u="",a,f=CCFMiscUtil_CreatePropSet(),l=CCFMiscUtil_CreatePropSet(),c=CCFMiscUtil_CreatePropSet();return SiebelApp.calendarsvc=function(){function r(e){}function i(e){return f.GetChildCount()===0&&(f.SetProperty("Appointment","ind_appointment.gif"),f.SetProperty("Meeting","ind_appointment.gif"),f.SetProperty("Presentation","ind_presentation.gif"),f.SetProperty("Demo","ind_presentation.gif"),f.SetProperty("Call - Inbound","ind_calls.gif"),f.SetProperty("Call - Outbound","ind_calls.gif"),f.SetProperty("Travel","ind_calls.gif"),f.SetProperty("Diagnosis","ind_diagnosis.gif"),f.SetProperty("Service","ind_diagnosis.gif"),f.SetProperty("Depot Repair","ind_repair.gif"),f.SetProperty("Field Repair","ind_repair.gif"),f.SetProperty("Maintenance","ind_repair.gif"),f.SetProperty("Event","ind_events.gif"),f.SetProperty("eEvent","ind_events.gif"),f.SetProperty("Project","ind_milestones.gif"),f.SetProperty("Milestone","ind_milestones.gif"),f.SetProperty("Sales Call","ind_salescall.gif"),f.SetProperty("Analyst Event","ind_analyst_events.gif"),f.SetProperty("Roadshow Event","ind_analyst_events.gif"),f.SetProperty("Account Call","ind_acc_call.gif")),f.GetProperty(e)}function s(e){return l.GetChildCount()===0&&(l.SetProperty("REM_FIELD_PLANNED","Planned"),l.SetProperty("REM_FIELD_PLANNED_COMPLETION","Planned Completion"),l.SetProperty("REM_FIELD_DURATION_MINUTES","Duration Minutes"),l.SetProperty("REM_FIELD_REPEATING_TYPE","Repeating Type"),l.SetProperty("REM_FIELD_STATUS","Status"),l.SetProperty("REM_FIELD_TYPE","Type"),l.SetProperty("REM_FIELD_DESCRIPTION","Description"),l.SetProperty("REM_FIELD_OWNED_BY_ID","Owned By Id"),l.SetProperty("REM_FIELD_PRIMARY_OWNER_ID","Primary Owner Id")),l.GetProperty(e)}function o(e){return c.GetChildCount()===0&&(c.SetProperty("REI_FIELD_PLANNED","Planned"),c.SetProperty("REI_FIELD_PLANNED_COMPLETION","Planned Completion"),c.SetProperty("REI_FIELD_DURATION_MINUTES","Duration Minutes"),c.SetProperty("REI_FIELD_EVENT_DATE","REI Event Date"),c.SetProperty("REI_FIELD_EVENT_END_DATE","REI Event End Date"),c.SetProperty("REI_FIELD_MASTER_ID","REI Master Id"),c.SetProperty("REI_FIELD_CALENDAR_ID","REI Calendar Id"),c.SetProperty("REI_FIELD_SEQUENCE_NUMBER","REI Sequence Number"),c.SetProperty("REI_FIELD_DESCRIPTION","Description"),c.SetProperty("REI_FIELD_REPEATING_TYPE","Repeating Type"),c.SetProperty("REI_FIELD_EMPLOYEE_ID","Employee Id")),c.GetProperty(e)}function u(r,i){var s=r.GetProperty("StartDate"),o=r.GetProperty("EndDate");if(s===null||s===""||o===null||o==="")return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"getREISearchSpec Start/End Date is Empty","SiebelApp.calendarsvc","getREISearchSpec"]),"";s=s.replace("+"," "),o=o.replace("+"," ");var u=new Date(s),a=u.getTime()+u.getTimezoneOffset()*6e4;u=new Date(a);var f=new Date(o);a=f.getTime()+f.getTimezoneOffset()*6e4,f=new Date(a);var l=""+u.getFullYear(),c=u.getMonth()+1,h=c<10?"0"+c:""+c,p=u.getDate(),d=p<10?"0"+p:""+p,v=u.getHours(),m=u.getMinutes(),g=u.getSeconds(),y=v<10?"0"+v:""+v,b=m<10?"0"+m:""+m,w=g<10?"0"+g:""+g,E=l+h+d+y+b+w;l=""+f.getFullYear(),c=f.getMonth()+1,h=c<10?"0"+c:""+c,p=f.getDate(),d=p<10?"0"+p:""+p,v=""+f.getHours(),m=""+f.getMinutes(),g=""+f.getSeconds(),y=v<10?"0"+v:""+v,b=m<10?"0"+m:""+m,w=g<10?"0"+g:""+g;var S=l+h+d+y+b+w,x;return n.IsEmpty(i)?x="[REI Event Date] >= '"+E+"' AND [REI Event Date] < '"+S+"'":x="["+i+"] >= '"+E+"' AND ["+i+"] < '"+S+"'",x}function a(e,t){var n=new Date(e),r=new Date(t),i=(r.getTime()-n.getTime())/1e3/60,s=i.toString();return s}function h(n,r){var i={err:!1},s;return n.SetExecuted(!0),i=n.NewRecord(!0),s=i,i={err:!1},s.err?(t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"New record Failed.","SiebelApp.calendarsvc","CalNewEvent"]),i=s,i):(i=n.SetMultipleFieldValues(r),s=i,function(r){i={err:!1};if(r.err)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"SetMultipleFieldValues Failed","SiebelApp.calendarsvc","CalNewEvent"]),i=r,i;n.SetCommitPending(!0),i=n.WriteRecord(),r=i,function(r){i={err:!1};if(r.err)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"BC write Failed.","SiebelApp.calendarsvc","CalNewEvent"]),i=r,i;i=n.FieldValue("Id"),r=i,i={err:!1};if(r.err)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Read ID failed after new record.","SiebelApp.calendarsvc","CalNewEvent"]),i=r,i;i=r}.call(this,r)}.call(this,s),i)}function p(e,t,n){var r={err:!1},i;return r=e.SetFldSearchSpec("Id",t),r=e.Execute(),i=r,r=e.Home(),i=r,r=e.SetMultipleFieldValues(n),i=r,e.SetCommitPending(!0),r=e.WriteRecord(),i=r,r=e.SetFldSearchSpec("Id",""),r}function d(n,r,i){var s={err:!1},o;return n.ActivateField(i),s=n.SetFldSearchSpec("Id",r),s=n.Execute(),o=s,s=n.Home(),o=s,s=n.FieldValue(i),o=s,s={err:!1},o.err?(t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"getFieldValFromID Failed for fieldName "+i,"SiebelApp.calendarsvc","getFieldValFromID"]),s=o,s):(s=o,s)}function v(e,t,n){var r;for(var i=!0;(r=t.EnumProperties(i))!==null;i=!1)n.SetProperty(t.GetProperty(r),e.GetProperty(r))}var n=SiebelJS.Dependency("SiebelApp.Utils");return SiebelJS.Extend(r,SiebelApp.ServiceModel),r.prototype.Populate=function(){},r.prototype.DoCanInvokeMethod=function(e){var t={err:!1},n,r="",i=CCFMiscUtil_CreatePropSet(),s;return r=e.GetProperty("MethodName").toString(),r==="GetCalendarDataDM"?(i.SetProperty("Invoked",!0),i.SetProperty("RetVal",!0),t={err:!1,retVal:i}):r==="CalDrillDownDM"?(i.SetProperty("Invoked",!0),i.SetProperty("RetVal",!0),t={err:!1,retVal:i}):r==="CalDragdropDM"?(i.SetProperty("Invoked",!0),i.SetProperty("RetVal",!0),t={err:!1,retVal:i}):r==="CalUpdateEventDM"?(i.SetProperty("Invoked",!0),i.SetProperty("RetVal",!0),t={err:!1,retVal:i}):r==="CalNewLSCallDM"?(i.SetProperty("Invoked",!0),i.SetProperty("RetVal",!0),t={err:!1,retVal
:i}):r==="CalNewEventDM"?(i.SetProperty("Invoked",!0),i.SetProperty("RetVal",!0),t={err:!1,retVal:i}):(i.SetProperty("Invoked",!1),i.SetProperty("RetVal",!1),t={err:!1,retVal:i}),t},r.prototype.DoInvokeMethod=function(e){var t={err:!1},n,r="",i=CCFMiscUtil_CreatePropSet();r=e.GetProperty("MethodName").toString();var s="";if(r==="SetDDContext"){var o=e.GetProperty("rowid").toString(),u=this.GetContext().BusComp();t=u.SetFldSearchSpec("Id",o),t=u.Execute(),n=t,t=u.Home();var a=t;t={err:!1},i.SetProperty("Invoked",!0),t={err:!1,retVal:i}}else r==="GetCalendarDataDM"?(s=this.GetInputPS(e),t=this.CalGetAllCalls(s),n=t,t={err:!1},i.SetProperty("Invoked",!0),t={err:!1,retVal:i}):r==="CalDrillDownDM"?(s=this.GetInputPS(e),this.CalDrillDown(s),n=t,t={err:!1},i.SetProperty("Invoked",!0),t={err:!1,retVal:i}):r==="CalUpdateEventDM"?(s=this.GetInputPS(e),t=this.CalUpdateEvent(s),n=t,t={err:!1},i.SetProperty("Invoked",!0),t={err:!1,retVal:i}):r==="CalDragdropDM"?(s=this.GetInputPS(e),t=this.CalDragdrop(s),n=t,t={err:!1},i.SetProperty("Invoked",!0),t={err:!1,retVal:i}):r==="CalNewLSCallDM"?(s=this.GetInputPS(e),this.CalNewLSCall(s),n=t,t={err:!1},i.SetProperty("Invoked",!0),t={err:!1,retVal:i}):r==="CalNewEventDM"?(s=this.GetInputPS(e),t=this.CalNewEvent(s),n=t,t={err:!1},i.SetProperty("Invoked",!0),t={err:!1,retVal:i}):(i.SetProperty("Invoked",!1),t={err:!1,retVal:i});return t},r.prototype.GetInputPS=function(e){var t=CCFMiscUtil_CreatePropSet(),n=e.GetProperty("Request");n=n.replace(/%2f/g,"/"),n=n.replace(/%23/g,"#"),n=n.replace(/%3a/g,":"),n=n.replace(/%7c/g,"|");var r=SiebelApp.S_App.GetAppExtension()+"?",i=n.search(r),s=n.slice(i+r.length),o=s.split("&"),u,a,f;for(var l=0;l<o.length;++l)u=o[l],i=u.search("="),a="",f="",a=u.slice(0,i),f=u.slice(i+1),t.SetProperty(a,f);return t},r.prototype.CalGetAllCalls=function(r){var i={err:!1},s;t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invoked calendarsvc CalGetAllCalls Method","SiebelApp.calendarsvc","CalGetAllCalls"]);var o,a,f,l,c,h,p,d,v,m,g,y=CCFMiscUtil_CreatePropSet(),b=CCFMiscUtil_CreatePropSet(),w=this.GetContext().BusObj().GetName(),E=this.GetContext().BusComp().GetName();if(n.IsEmpty(w)||n.IsEmpty(E))return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalGetAllCalls Unable to get Start BO/BC names","SiebelApp.calendarsvc","CalGetAllCalls"]),i;if(E==="Action"||E==="Action CE")return i=this.CalGetAllCallsNew(r),i;var S=this.GetContext().GetBusComp(),x=SiebelApp.S_App.Model.GetBusObj(w),T=x.GetBusComp(E),N=!1,C=this.GetContext().GetUserProperty("Icon Field"),k=this.GetContext().GetUserProperty("Drilldown Object Name"),L=this.GetContext().GetDrillDown(k),A=L.srcFieldName,O=r.GetProperty("StartDate"),M=r.GetProperty("EndDate"),_=[],D="",P="Id",H="",B="",j="",F="",I=this.GetContext().GetUserProperty("Can Update Check Field");if(n.IsEmpty(I)||typeof I!="undefined")I="Start Date";I.trim(),b.SetProperty("Id",""),D=this.GetContext().GetUserProperty("Start Date Field");if(n.IsEmpty(D)||typeof D=="undefined")D="Planned";D.trim(),j=D,P+=","+D,b.SetProperty(D,""),D=this.GetContext().GetUserProperty("End Date Field");if(n.IsEmpty(D)||typeof D=="undefined")D="Planned Completion";D.trim(),F=D,P+=","+D,b.SetProperty(D,""),D=this.GetContext().GetUserProperty("Display Fields");var q,R;if(n.IsEmpty(D)||typeof D=="undefined")b.SetProperty("Call Status",""),b.SetProperty("Type",""),b.SetProperty("Category",""),b.SetProperty("Contact Full Name",""),b.SetProperty("Account Name",""),P+=",Call Status,Type,Category,Contact Full Name,Account Name";else{var U=D.split(",");q=0;var z=U.length;while(q<z){var W=U[q].trim();D=this.GetContext().GetUserProperty(W+".Tooltip Fields"),b.SetProperty(W,""),q===0&&(H=D,B=W);if(n.IsEmpty(D)||typeof D!="undefined"){var X=D.split(","),V=0,$=X.length;while(V<$)D=X[V].trim(),D==="Status"&&typeof T.GetFieldMap()[D]=="undefined"&&(D="Call Status",N=!0),P+=","+D,b.SetProperty(D,""),V++}q++}}n.IsEmpty(C)||b.SetProperty(C,""),n.IsEmpty(A)||b.SetProperty(A,""),T.ActivateMultipleFields(b);var J=SiebelApp.S_App.GetActiveView(),K=J.GetApplet(n.UrlDecode(r.GetProperty("SWEActiveApplet"))),Q=K.GetDefn().searchSpec,G=K.GetBusComp().GetName();if(typeof Q=="undefined"){var Y=J.GetActiveApplet();Q=Y.GetDefn().searchSpec,G=Y.GetBusComp().GetName()}Q&&T.GetName()===G&&T.SetAppletSearchSpec(Q);var Z=u(r,j);n.IsEmpty(Z)||T.SetSearchExpr(Z),i=T.Execute(),s=i,i=T.Home(),s=i,i={err:!1};var et=function(){var e=CCFMiscUtil_CreatePropSet();i=T.GetMultipleFieldValues(b,e),s=i,e.SetProperty("Buscomp",E),i=T.CanUpdateX(!1,I),s=i,i={err:!1},s.retVal?e.SetProperty("ReadOnly","N"):e.SetProperty("ReadOnly","Y"),n.IsEmpty(C)||e.SetProperty("ICON_FIELD_DM",e.GetProperty(C)),n.IsEmpty(A)||e.SetProperty("DD_FIELD_VAL_DM",e.GetProperty(A)),n.IsEmpty(H)||(e.SetProperty("TOOL_TIP_FIELDS_DM",H),e.SetProperty("TOOL_DESC_DM",B)),N&&e.SetProperty("Status",e.GetProperty("Call Status")),j!=="Planned"&&e.SetProperty("Planned",e.GetProperty(j)),F!=="PlannedCompletion"&&e.SetProperty("PlannedCompletion",e.GetProperty(F)),e.SetProperty("FIELD_LIST_DM",P),y.AddChild(e),i=T.NextRecord(),s=i,i={err:!1};var t=s.err;if(!t)et.call(this);else{y.SetType("OUICalendarData");var r=y.EncodeAsString(),o=[];o.push(r),S.IsNotifyEnabled()?S.NotifyGeneric("HICalendarData",o):(S.EnableNotify(),S.NotifyGeneric("HICalendarData",o),S.DisableNotify()),SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted")}};return T.CheckActiveRow()===!0&&et.call(this),i},r.prototype.CalGetAllCallsNew=function(e){var t={err:!1},n;t=this.GetREIEvents(e),n=t,t={err:!1};if(n.err)return t=n,t;var r=n.retVal;if(typeof r=="undefined")return SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted"),t;var i=r.EncodeAsString(),s=[];s.push(i);var o=this.GetContext().GetBusComp();return o.IsNotifyEnabled()?o.NotifyGeneric("HICalendarData",s):(o.EnableNotify(),o.NotifyGeneric("HICalendarData",s),o.DisableNotify()),SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted"),t},r.prototype.GetREIEvents=function(r){var s={err:!1},o;t.CcfLogEvent
([e.get("LOG_EVT_CLIENT_SYS"),"Invoked calendarsvc GetREIEvents Method","SiebelApp.calendarsvc","GetREIEvents"]);var u,a,f,l,c,h,p,d,v,m,g,y=this.GetContext().GetUserProperty("Repeat Icon");if(typeof y=="undefined"||n.IsEmpty(y))y="repeat.gif";var b=CCFMiscUtil_CreatePropSet(),w=CCFMiscUtil_CreatePropSet(),E="Calendar REM",S="Calendar REM";if(n.IsEmpty(E)||n.IsEmpty(S))return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalGetAllCalls Unable to get Start BO/BC names","SiebelApp.calendarsvc","CalGetAllCalls"]),s;var x=SiebelApp.S_App.Model.GetBusObj(E),T=x.GetBusComp(S),N=T.GetFieldMap(),C=!1,k=this.GetContext().GetUserProperty("Icon Field"),L=this.GetContext().GetUserProperty("Drilldown Object Name"),A=this.GetContext().GetDrillDown(L),O=A.srcFieldName,M=r.GetProperty("StartDate"),_=r.GetProperty("EndDate"),D=[],P="",H="Id",B="",j="",F="",I="",q=this.GetContext().GetUserProperty("Can Update Check Field");if(n.IsEmpty(q)||typeof q!="undefined")q="Start Date";q.trim(),w.SetProperty("Id",""),P=this.GetContext().GetUserProperty("Start Date Field");if(n.IsEmpty(P)||typeof P=="undefined")P="Planned";P.trim(),F=P,H+=","+P,w.SetProperty(P,""),P=this.GetContext().GetUserProperty("End Date Field");if(n.IsEmpty(P)||typeof P=="undefined")P="Planned Completion";P.trim(),I=P,H+=","+P,w.SetProperty(P,""),P=this.GetContext().GetUserProperty("Display Fields");var R,U;if(n.IsEmpty(P)||typeof P=="undefined")w.SetProperty("Call Status",""),w.SetProperty("Type",""),w.SetProperty("Category",""),w.SetProperty("Contact Full Name",""),w.SetProperty("Account Name",""),H+=",Call Status,Type,Category,Contact Full Name,Account Name";else{var z=P.split(",");R=0;var W=z.length;while(R<W){var X=z[R].trim();P=this.GetContext().GetUserProperty(X+".Tooltip Fields"),typeof N[P]!="undefined"&&w.SetProperty(X,""),R===0&&(B=P,j=X);if(n.IsEmpty(P)||typeof P!="undefined"){B=P;var V=P.split(","),$=0,J=V.length;while($<J)P=V[$].trim(),P==="Status"&&typeof N[P]=="undefined"&&(P="Call Status",C=!0),P==="MeetingLocation"&&typeof N[P]=="undefined"&&typeof (N["Meeting Location"]!=="undefined")&&(P="Meeting Location",B=B.replace("MeetingLocation","Meeting Location")),H+=","+P,typeof N[P]!="undefined"&&w.SetProperty(P,""),$++}R++}}!n.IsEmpty(k)&&typeof N[k]!="undefined"&&w.SetProperty(k,""),!n.IsEmpty(O)&&typeof N[O]!="undefined"&&w.SetProperty(O,""),typeof N.Status!="undefined"&&w.SetProperty("Status",""),s=this.CalReadREI(r),o=s,s={err:!1};if(o.err)return s=o,s;var K=o.retVal;if(typeof K=="undefined")return s;var Q=K.GetChildCount(),G=0;if(Q<1)return s;var Y=function(e){s=this.CalReadREM(w,e),o=s,s={err:!1};if(o.err){s=o;return}var t=o.retVal;if(typeof t=="undefined")return;var r,u=K.GetChild(G);for(var a=!0;(r=w.EnumProperties(a))!==null;a=!1)r!=="Id"?u.SetProperty(r,t.GetProperty(r)):u.SetProperty(r,u.GetProperty(r)+"^"+e);n.IsEmpty(k)?u.SetProperty("ICON_FIELD_DM",i(u.GetProperty("Type"))):u.SetProperty("ICON_FIELD_DM",u.GetProperty(k)),n.IsEmpty(O)||u.SetProperty("DD_FIELD_VAL_DM",u.GetProperty(O)),n.IsEmpty(B)||(u.SetProperty("TOOL_TIP_FIELDS_DM",B),u.SetProperty("TOOL_DESC_DM",j)),u.SetProperty("Planned",u.GetProperty("REI Event Date")),u.SetProperty("PlannedCompletion",u.GetProperty("REI Event End Date")),u.SetProperty("REPEAT_ICON_DM",y),u.SetProperty("FIELD_LIST_DM",H);var f=this.GetContext().BusComp().GetName();u.SetProperty("Buscomp",f),G++;if(!(G<Q)){K.SetType("OUICalendarData"),s={err:!1,retVal:K};return}Y.call(this,K.GetChild(G).GetProperty("REI Master Id"))};return G=0,Y.call(this,K.GetChild(G).GetProperty("REI Master Id")),s},r.prototype.CalReadREI=function(n){var r={err:!1},i;t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invoked calendarsvc CalReadREI Method","SiebelApp.calendarsvc","CalReadREI"]);var s=SiebelApp.S_App.Model.GetBusObj("Calendar REM"),o=s.GetBusComp("Calendar REI"),a=n.GetProperty("StartDate"),f=n.GetProperty("EndDate"),l=u(n),c=CCFMiscUtil_CreatePropSet(),h=CCFMiscUtil_CreatePropSet();c.SetProperty("Description",""),c.SetProperty("REI Event Date",""),c.SetProperty("REI Event End Date",""),c.SetProperty("Duration Minutes",""),c.SetProperty("Repeating Type",""),c.SetProperty("REI Sequence Number",""),c.SetProperty("REI Master Id",""),c.SetProperty("REI Calendar Id",""),c.SetProperty("Id",""),o.ActivateMultipleFields(c),o.SetSearchExpr(l),r=o.Execute(),i=r,r=o.Home(),i=r,r={err:!1};var p=function(){var e=CCFMiscUtil_CreatePropSet();r=o.GetMultipleFieldValues(c,e),i=r,h.AddChild(e),r=o.NextRecord(),i=r,function(e){r={err:!1};var t=e.err;if(!!t){r={err:!1,retVal:h};return}p.call(this)}.call(this,i)};return o.CheckActiveRow()===!0&&p.call(this),r},r.prototype.CalReadREM=function(n,r){var i={err:!1},s,o=SiebelApp.S_App.Model.GetBusObj("Calendar REM"),u=o.GetBusComp("Calendar REM");return u.ActivateMultipleFields(n),i=u.Execute(),s=i,i=u.Home(),s=i,i=u.PositionById(r),s=i,function(s){i={err:!1};if(s.err)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Unable PositionById id"+r,"SiebelApp.calendarsvc","CalReadREM"]),i=s,i;if(u.CheckActiveRow()===!0){var o=CCFMiscUtil_CreatePropSet();i=u.GetMultipleFieldValues(n,o),s=i,function(n){return i={err:!1},n.err?(t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Unable to read REM, id"+r,"SiebelApp.calendarsvc","CalReadREM"]),i=n,i):(i={err:!1,retVal:o},i)}.call(this,s)}}.call(this,s),i},r.prototype.constructREMPS=function(r){t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invoked constructREMPS Method","SiebelApp.calendarsvc","constructREMPS"]);var i=CCFMiscUtil_CreatePropSet(),o=n.UrlDecode(r.GetProperty("StartDate")),u=n.UrlDecode(r.GetProperty("EndDate"));i.SetProperty(s("REM_FIELD_PLANNED"),o),i.SetProperty(s("REM_FIELD_PLANNED_COMPLETION"),u),i.SetProperty(s("REM_FIELD_REPEATING_TYPE"),"Non-Repeating");var f=s("REM_FIELD_DESCRIPTION");return i.SetProperty(f,n.UrlDecode(r.GetProperty(f))),i.SetProperty(s("REM_FIELD_TYPE"),"Appointment"),i.SetProperty(s("REM_FIELD_OWNED_BY_ID"),SiebelApp.S_App.Model.GetLoginId()),i.SetProperty(s("REM_FIELD_PRIMARY_OWNER_ID"),SiebelApp.S_App.Model
.GetLoginId()),i.SetProperty(s("REM_FIELD_DURATION_MINUTES"),a(o,u)),i.SetProperty(s("REM_FIELD_STATUS"),"Unscheduled"),i},r.prototype.constructREIPS=function(e,t){var r=n.UrlDecode(e.GetProperty("StartDate")),i=n.UrlDecode(e.GetProperty("EndDate")),s=CCFMiscUtil_CreatePropSet();s.SetProperty(o("REI_FIELD_MASTER_ID"),t),s.SetProperty(o("REI_FIELD_CALENDAR_ID"),t),s.SetProperty(o("REI_FIELD_EVENT_DATE"),r),s.SetProperty(o("REI_FIELD_EVENT_END_DATE"),i),s.SetProperty(o("REI_FIELD_PLANNED_COMPLETION"),i),s.SetProperty(o("REI_FIELD_SEQUENCE_NUMBER"),"1");var u=o("REI_FIELD_DESCRIPTION");return s.SetProperty(u,n.UrlDecode(e.GetProperty(u))),s.SetProperty(o("REI_FIELD_PLANNED"),r),s.SetProperty(o("REI_FIELD_DURATION_MINUTES"),a(r,i)),s.SetProperty(o("REI_FIELD_REPEATING_TYPE"),"Non-Repeating"),s.SetProperty(o("REI_FIELD_EMPLOYEE_ID"),SiebelApp.S_App.Model.GetLoginId()),s},r.prototype.CalNewEvent=function(n){var r={err:!1},i;t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invoked CalNewEvent Method","SiebelApp.calendarsvc","CalNewEvent"]);var s=n.GetProperty("MethodName"),o=n.GetProperty("StartDate"),u=n.GetProperty("CurrentDateTime"),a="calendarsvc.prototype.CalNewLSCall\n";a+="MethodName: "+s+"\n",a+="StartDate: "+o+"\n",a+="CurrentDateTime: "+u+"\n",t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),a,"SiebelApp.calendarsvc","CalNewLSCall"]);var f=SiebelApp.S_App.Model.GetBusObj("Calendar REM"),l=f.GetBusComp("Calendar REM"),c=f.GetBusComp("Calendar REI"),d=this.constructREMPS(n),v;r=h(l,d),i=r,r={err:!1};if(i.err)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"REM ID not found","SiebelApp.calendarsvc","CalNewEvent"]),r=i,r;var m=i.retVal,g=CCFMiscUtil_CreatePropSet();return g.SetProperty("REM Master Id",m),r=p(l,m,g),i=r,function(i){r={err:!1};if(i.err)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"REM record update failed","SiebelApp.calendarsvc","CalNewEvent"]),r=i,r;var s=this.constructREIPS(n,m);r=h(c,s),i=r,r={err:!1};if(i.err)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"REI record creation failed","SiebelApp.calendarsvc","CalNewEvent"]),r=i,r;r=i,SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted")}.call(this,i),r},r.prototype.CalUpdateEventREIREM=function(n){var r={err:!1},i;t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invoked CalUpdateEventREIREM Method","SiebelApp.calendarsvc","CalUpdateEventREI"]);var u=n.GetProperty("RowId"),f=u.split("%5e");if(f.length!==2)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEventREIREM  Invalid rowid :"+u,"SiebelApp.calendarsvc","CalUpdateEventREI"]),r;var l=f[0],c=f[1],h=n.GetProperty("NewStartDate"),d=n.GetProperty("NewEndDate"),v=n.GetProperty("Optional");if(h===null||h==="")return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEventREIREM Start Date is Empty","SiebelApp.calendarsvc","CalUpdateEventREI"]),r;h=h.replace("+"," ");if(d===null||d==="")return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEventREIREM End Date is Empty","SiebelApp.calendarsvc","CalUpdateEventREI"]),r;d=d.replace("+"," ");var m=SiebelApp.S_App.Model.GetBusObj("Calendar REM"),g=m.GetBusComp("Calendar REM"),y=m.GetBusComp("Calendar REI"),b=CCFMiscUtil_CreatePropSet();b.SetProperty(o("REI_FIELD_EVENT_DATE"),h),b.SetProperty(o("REI_FIELD_EVENT_END_DATE"),d),b.SetProperty(o("REI_FIELD_PLANNED_COMPLETION"),d),b.SetProperty(o("REI_FIELD_PLANNED"),h),b.SetProperty(o("REI_FIELD_DURATION_MINUTES"),a(h,d));var w=CCFMiscUtil_CreatePropSet();return w.SetProperty(s("REM_FIELD_PLANNED_COMPLETION"),d),w.SetProperty(s("REM_FIELD_PLANNED"),h),w.SetProperty(s("REM_FIELD_DURATION_MINUTES"),a(h,d)),r=p(g,c,w),i=r,r={err:!1},i.err?(t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"REM record update failed","SiebelApp.calendarsvc","CalNewEvent"]),SiebelApp.S_App.Model.ReleaseBO(m),r=i,r):(y.CheckActiveRow()?(r=y.SetMultipleFieldValues(b),i=r,function(n){r={err:!1};if(n.err)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"REI record update failed ,SetMultipleFieldValues()","SiebelApp.calendarsvc","CalNewEvent"]),r=n,SiebelApp.S_App.Model.ReleaseBO(m),r;y.SetCommitPending(!0),r=y.WriteRecord(),n=r,function(n){r={err:!1};if(n.err)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"REI record update failed, WriteRecord()","SiebelApp.calendarsvc","CalNewEvent"]),r=n,SiebelApp.S_App.Model.ReleaseBO(m),r;SiebelApp.S_App.Model.ReleaseBO(m)}.call(this,n)}.call(this,i)):(t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"REI record update failed, no active row","SiebelApp.calendarsvc","CalNewEvent"]),SiebelApp.S_App.Model.ReleaseBO(m)),r)},r.prototype.CalDrillDown=function(r){t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invoked CalDrillDown Method","SiebelApp.calendarsvc","CalDrillDown"]);var i=r.GetProperty("Data"),s=r.GetProperty("CurrentDate"),o=r.GetProperty("SelectedDate"),u=i.split("#"),a=u[1],f=u[2];f=f.slice(0,Number(a));var l=this.GetContext().GetUserProperty("Drilldown Object Name"),c=this.GetContext().GetDrillDown(l);if(n.IsEmpty(c)){t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalDrillDown Drilldown definition is empty","SiebelApp.calendarsvc","CalDrillDown"]);return}var h=c.viewname;if(n.IsEmpty(h)){t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalDrillDown Drilldown view is empty","SiebelApp.calendarsvc","CalDrillDown"]);return}var p=SiebelApp.S_App.Model.GetViewDef(h);if(p){var d=p.BOName,v=SiebelApp.S_App.Model.GetBusObj(d),m=v.GetBusComp(c.busCompName);m.SetFldSearchSpec(c.destFieldName,f),SiebelApp.OfflineAppMgr.BuildViewAsync(h,"BS_DRILLDOWN",c,v)}},r.prototype.CalUpdateEvent=function(r){var i={err:!1},s;t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invoked CalUpdateEvent Method","SiebelApp.calendarsvc","CalUpdateEvent"]);var o=this.GetContext().BusObj().GetName(),u=this.GetContext().BusComp().GetName();if(n.IsEmpty(o)||n.IsEmpty(u))return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEvent Unable to get Start BO/BC names","SiebelApp.calendarsvc","CalUpdateEvent"]),i;if(u==="Action"||u==="Action CE")return i=this.CalUpdateEventREIREM(r),i;var a=r.GetProperty("RowId")
,f=r.GetProperty("NewStartDate"),l=r.GetProperty("NewEndDate"),c=r.GetProperty("Optional");if(f===null||f==="")return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEvent Start Date is Empty","SiebelApp.calendarsvc","CalUpdateEvent"]),i;f=f.replace("+"," ");if(l===null||l==="")return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEvent End Date is Empty","SiebelApp.calendarsvc","CalUpdateEvent"]),i;l=l.replace("+"," ");var h=new Date(f),p=new Date(l);if(h===null||p===null)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEvent Incorrect format Start Date / End Date","SiebelApp.calendarsvc","CalUpdateEvent"]),i;var d=(p.getTime()-h.getTime())/1e3/60,v=d.toString(),m=this.GetContext().GetUserProperty("Start Date Field"),g=this.GetContext().GetUserProperty("End Date Field");if(n.IsEmpty(m)||n.IsEmpty(g))return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEvent Unable to get Start Date Field/End Date Field","SiebelApp.calendarsvc","CalUpdateEvent"]),i;var y=this.GetContext().GetUserProperty("LS Start Date Field");n.IsEmpty(y)&&(y="Start Date");var b=this.GetContext().GetUserProperty("LS Duration Minutes Field");n.IsEmpty(b)&&(b="Duration Minutes");var w=SiebelApp.S_App.Model.GetBusObj(o),E=w.GetBusComp(u),S=CCFMiscUtil_CreatePropSet(),x=CCFMiscUtil_CreatePropSet(),T,N=1;do{var C="Activate Field "+N;T=E.GetUserProperty(C),(T!=undefined||!n.IsEmpty(T))&&S.SetProperty(T,""),N++}while(T!=undefined||!n.IsEmpty(T));return S.SetProperty(m,""),S.SetProperty(g,""),E.ActivateMultipleFields(S),i=E.SetFldSearchSpec("Id",a),i=E.Execute(),s=i,i=E.Home(),s=i,x.SetProperty(m,f),x.SetProperty(g,l),i=E.SetMultipleFieldValues(x),s=i,E.SetCommitPending(!0),i=E.WriteRecord(),s=i,i=E.SetFldSearchSpec("Id",""),SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted"),i},r.prototype.CalDragdrop=function(r){var i={err:!1},s;t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invoked CalDragdrop Method","SiebelApp.calendarsvc","CalDragdrop"]);var o=r.GetProperty("MethodName"),u=n.UrlDecode(r.GetProperty("StartDate")),a=r.GetProperty("Data"),f=r.GetProperty("Optional"),l="",c="",h="";if(a===""||a.indexOf("|")===-1)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invalid strData: "+a,"SiebelApp.calendarsvc","CalDragdrop"]),i;h=a.split("|");if(h.length!==2)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invalid strData: "+a,"SiebelApp.calendarsvc","CalDragdrop"]),i;l=n.UrlDecode(h[0]),c=n.UrlDecode(h[1]);var p=this.GetContext().GetBusComp(),d=SiebelApp.S_App.GetActiveView().GetActiveApplet().BusObj(),m=SiebelApp.S_App.GetActiveView().GetAppletMap()[l],g=d.GetBusCompByName(m.GetBusComp().GetName()),y=[],b=!0,w=0,E=CCFMiscUtil_CreatePropSet(),S=CCFMiscUtil_CreatePropSet(),x=CCFMiscUtil_CreatePropSet(),T=CCFMiscUtil_CreatePropSet();while(b){var N="Calendar Drag Field"+(w+1),C=m.GetUserProperty(N);typeof C=="undefined"||C===""?b=!1:(h=C.split(","),h.length===2&&(E.SetProperty(h[0].trim(),""),x.SetProperty(h[0].trim(),h[1].trim())),w++)}var k=this.GetContext().GetUserProperty("Start Date Field"),L=this.GetContext().GetUserProperty("End Date Field");S.SetProperty(k,u);var A=c.split(","),O=A.length;return g.ActivateMultipleFields(E),i=g.Execute(),s=i,i=g.Home(),s=i,function(n){i={err:!1};if(n.err)return t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Home for srcBuscomp failed.","SiebelApp.calendarsvc","CalDragdrop"]),i=n,i;var r=function(s){i=g.PositionById(s),n=i,i={err:!1};if(n.err){t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"PositionById for: "+s+" failed.","SiebelApp.calendarsvc","CalDragdrop"]),i=n;return}T.Reset(),i=g.GetMultipleFieldValues(E,T),n=i,function(n){i={err:!1};if(n.err){t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"GetMultipleFieldValues for rowID: "+s+" failed.","SiebelApp.calendarsvc","CalDragdrop"]),i=n;return}v(T,x,S),p.SetExecuted(!0),i=p.NewRecord(!0),n=i,function(n){i={err:!1};if(n.err){t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"New record Failed.","SiebelApp.calendarsvc","CalDragdrop"]),i=n;return}i=p.SetMultipleFieldValues(S),n=i,function(n){i={err:!1};if(n.err){t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"SetMultipleFieldValues Failed","SiebelApp.calendarsvc","CalDragdrop"]),i=n;return}p.SetCommitPending(!0),i=p.WriteRecord(),n=i,function(n){i={err:!1};if(n.err){t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"BC write Failed.","SiebelApp.calendarsvc","CalDragdrop"]),i=n;return}w++,w<O?r.call(this,A[w].trim()):SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted")}.call(this,n)}.call(this,n)}.call(this,n)}.call(this,n)};w=0,r.call(this,A[w].trim())}.call(this,s),i},r.prototype.CalNewLSCall=function(n){t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),"Invoked CalNewLSCall Method (NI)","SiebelApp.calendarsvc","CalNewLSCall"]);var r=n.GetProperty("MethodName"),i=n.GetProperty("StartDate"),s=n.GetProperty("CurrentDateTime"),o="calendarsvc.prototype.CalNewLSCall\n";o+="MethodName: "+r+"\n",o+="StartDate: "+i+"\n",o+="CurrentDateTime: "+s+"\n",t.CcfLogEvent([e.get("LOG_EVT_CLIENT_SYS"),o,"SiebelApp.calendarsvc","CalNewLSCall"])},r}(),"SiebelAppFacade.calendarsvc"}));
