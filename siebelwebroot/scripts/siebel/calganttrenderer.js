/*<ORACLECOPYRIGHT>
* Copyright (C) 2008-2024
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 24.2.0.0SIA[2024_02] */
typeof SiebelAppFacade.CalGanttRenderer=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.CalGanttRenderer"),define("siebel/calganttrenderer",["siebel/ganttrenderer"],function(){return SiebelAppFacade.CalGanttRenderer=function(){function l(){SiebelAppFacade.CalGanttRenderer.superclass.constructor.apply(this,arguments)}function c(t){var n=t?t.data.ctx:this,r=n.GetPM(),i=r.Get("Resource Id"),s=r.Get("ResIDtoIndex"),o=s[i]||0;return o===r.Get("SelectedRow")?!0:(SiebelApp.S_App.uiStatus.Busy({}),r.SetProperty("SelectedRow",o),r.OnControlEvent(e.get("PHYEVENT_SELECT_ROW"),o,!1,!1)?(SiebelApp.S_App.uiStatus.Free(),!0):(SiebelApp.S_App.uiStatus.Free(),!1))}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=e.get("SWE_GANTT_DRILLDOWN_CLS"),n=e.get("SWE_GANTT_ACTIVITY_LABEL"),r=e.get("SWE_GANTT_TIME_SCALE"),i="MM/dd/yyyy",s=e.get("SWE_GANTT_STARTMILLIS"),o=e.get("SWE_GANTT_ENDMILLIS"),u=e.get("SWE_GANTT_START_DATE"),a=e.get("SWE_GANTT_ACTIVITY_START_TIME"),f="GCD";return SiebelJS.Extend(l,SiebelAppFacade.GanttRenderer),l.prototype.Init=function(){var e=this.GetPM();this.AttachPMBinding("RefreshData",function(){e.Get("IsRefreshNeeded")===!0&&e.SetProperty("InEvent",!0)}),this.AttachPMBinding("NotifyTSButtonClk",function(){e.SetProperty("IsRefreshNeeded",!1)}),SiebelAppFacade.CalGanttRenderer.superclass.Init.call(this)},l.prototype.ShowUI=function(){this.setGanttCtrlHeight(this.getGanttCtrlHeight()/2),SiebelAppFacade.CalGanttRenderer.superclass.ShowUI.call(this)},l.prototype.BindData=function(){var e=this.GetPM();e.Get(f)==="Working Hours"&&e.SetProperty("isDispatchBoard","TRUE");var t=140*this.GetPM().Get("RESOURCEHEADER").length;e.SetProperty("Splitter Position",t),SiebelAppFacade.CalGanttRenderer.superclass.BindData.call(this);var n=e.Get("RecordSet"),r=e.Get("Resource Id"),i=e.Get("ResIDtoIndex"),s=i?i[r]:0,o=n?n[s]:0;o&&c.call(this),$("#s_"+this.GetAppletId()+"_div").find(".siebui-ganttHead2").find(".siebui-ganttInnerTbl").find("div").addClass("siebui-gantt-align-left")},l.prototype.BindEvents=function(){SiebelAppFacade.CalGanttRenderer.superclass.BindEvents.call(this);var e=$("#s_"+this.GetAppletId()+"_div");e.on("click",".siebui-taskEditUtility",{ctx:this},c).on("click",".siebui-taskEditRow",{ctx:this},c).off("dblclick",".siebui-taskEditUtility")},l.prototype.calcNonContiguousTime=function(e){var t=this.GetPM(),n=t.Get(r);if(n==="1"||n==="64"||n==="4"||n==="512"||n==="1024"||n==="2048"||n==="4096"){var i=t.Get("PixelsPerUnit"),o=t.Get("TDays"),u=t.Get("StartTime"),a=t.Get("EndTime"),f=0,l=0,c,h,p,d,v=new Date(t.Get(s)),m=t.Get("FinalWeekDays");c=i*$("#s_"+this.GetAppletId()+"_div").find("#UGrid").width(),c&&(l=parseInt(e/c,10));for(var g=0;g<l;)m.indexOf(v.getDay())!==-1&&g++,f++,v.setDate(v.getDate()+1);while(m.indexOf(v.getDay())===-1)f++,v.setDate(v.getDate()+1);return h=e%c,p=t.Get(s)+f*o,c&&(d=parseInt(t.Get("StartTime")+h/c*t.Get("AxisDuration"),10)),p+=d,parseInt(p,10)}return SiebelAppFacade.CalGanttRenderer.superclass.calcNonContiguousTime.call(this,e)},l.prototype.SetHScrollPos=function(){var e=this.GetPM(),t=new Date(e.Get(u)),n=e.Get("SelectedEvent"),r,i=0,f=36e5,l,c,h;if(n){r=new Date(n.ST);if(r.toDateString()===t.toDateString())return c=3*f/e.Get("Scale_factor"),e.ExecuteMethod("setHoursFrom",t,String(e.Get(a))),l=(r.getTime()-t.getTime())%(24*f),l-=c,t=new Date(e.Get(u)),t.setHours(0,0,0),h=l*e.Get("PixelsPerUnit")/e.Get("AxisDuration"),i+=h,i+=(t.getTime()-e.Get(s))/(e.Get(o)-e.Get(s)),i+=i*e.Get("MinGanttsize"),$(".siebui-splitBox3").scrollLeft(i),!0}SiebelAppFacade.CalGanttRenderer.superclass.SetHScrollPos.call(this)},l.prototype.preparerowtasks=function(e,r,i){var s="",o=i.EventColor,u=i.Statabb,a=i.configSpacePatternFlag,f,l,c,h,p,d,v,m,g="",y,b="siebui-layout",w=!0,E,S,x;i.TST==="64"&&(b+=" siebui-taskBoxMonthDay");if(e){S=this.GetPM();for(h in e)if(e.hasOwnProperty(h)){y=e[h],f=y[u],x=S.Get("LIC Field"),E=x[f];if(E==="NEEDS-ACTION")for(var T in x)if(x.hasOwnProperty(T)&&x[T]==="TENTATIVE"){f=T;break}l=u+"_"+f,g="",y.BT&&(y.BT==="Out of Order"||y.BT==="Unavailable Instance"||y.BT==="Ineffective UNCHANGED")&&(l="GS_LIC_"+y.BT);if(o){for(var N in o)if(o.hasOwnProperty(N)&&o[N]===f){l=N.replace(" LOV","");break}c=o[l]}c||(c=i.EventDefaultColor);if(y.CR)g+=" siebui-cal-gantt-current-task",this.GetPM().SetProperty("SelectedEvent",y);else if(E==="DECLINED")continue;p=e[h][n],y.OLPCNT&&y.OLPCNT>2&&(p="",y.Icon&&(y.Icon="")),p||(p=""),d=y.DDID,d?v=t:(d="",v=""),f.trim()!==""&&(g+=" siebui-calgantt-"+f.replace(/\s+/g,"").trim()),m=100-(y.SW?parseInt(y.SW,10):0)-(y.TW?parseInt(y.TW,10):0)-5,s=s+'<div class="siebui-taskBox '+y.CLS+'" taskId='+y.ID+"  id= "+r.toString()+" style=width:"+y.width+"%;left:"+y.left+"%;margin-top:"+y.top+'px; ot = "div" rn = "event-'+y.ID+'" un = "event-'+y.ID+'">'+'<div class="'+b+g+'" style=background-color:'+c+";>",y.SW&&(s=s+'<div class = "siebui-turnTime siebui-setupTime" style = width:'+y.SW+"%;></div>"),y.TW&&(s=s+'<div class = "siebui-turnTime siebui-teardownTime" style = width:'+y.TW+"%;></div>"),a==="Y"&&y.CFST&&y.CFST==="Y"&&(s+='<div class = "siebui-configSpacePattern">'),s=s+'<span class="siebui-taskStatus" style = width:'+m+"%; status="+y.GS+">"+this.createIconInfo(y)+'<a class="siebui-activityLabel '+v+'" data-drilldown-type= "UGrid" data-drilldown-id="'+d+'" ot = "a" rn = "'+p+'" un = "'+p+'">'+p+"</a></span>",s+="</div></div>",a==="Y"&&y.CFST&&y.CFST==="Y"&&(s+="</div>")}}return s},l}(),"SiebelAppFacade.CalGanttRenderer"}));
