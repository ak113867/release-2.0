/*<ORACLECOPYRIGHT>
* Copyright (C) 2008-2024
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 24.2.0.0SIA[2024_02] */
typeof SiebelAppFacade.MapPhyRenderer=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.MapPhyRenderer"),define("siebel/maprenderer",[window.location.protocol+"//elocation.oracle.com/elocation/jslib/oracleelocation.js",window.location.protocol+"//elocation.oracle.com/mapviewer/fsmc/jslib/oraclemaps.js","siebel/phyrenderer"],function(){return SiebelAppFacade.MapPhyRenderer=function(){function g(e){SiebelAppFacade.MapPhyRenderer.superclass.constructor.call(this,e);var t;this.SetMapView=function(e){t=e},this.GetMapView=function(){return t}}function y(){var e=window.location.protocol+"//elocation.oracle.com/mapviewer",t=this.GetPM();this.SetMapView(new MVMapView(document.getElementById(t.Get("GetPlaceholder")),e)),this.GetMapView().addBaseMapLayer(new MVBaseMap("elocation_mercator.world_map"),b(this))}function b(){var e=20,t=0,n=1,r=arguments[0];r||(r=this);var i=MVSdoGeometry.createPoint(t,e,8307);r.GetMapView().setCenter(i),r.GetMapView().setZoomLevel(n),r.GetMapView().addNavigationPanel("EAST"),r.GetMapView().setLoadingIconVisible()}function w(e){var t=/^\s*lon lat:\s*-?((\d\d*\.\d*)|(\d\d*)|(\.\d\d*))\s*-?((\d\d*\.\d*)|(\d\d*)|(\.\d\d*))\s*$/;if(e&&t.test(e)){var n=e.indexOf("lon lat:");return e=e.substr(n+"lon/lat:".length).replace(/^\s+|\s+$/,""),n=e.indexOf(" "),{lon:e.substr(0,n),lat:e.substr(n)}}return e}function E(){v=new OracleELocation(window.location.protocol+"//elocation.oracle.com/elocation");var e=this;d={};var t=this.GetPM(),n=k.call(this),r=L.call(this),i=t.Get("GetRowsSelectedArray"),s=$("#"+t.Get("GetPlaceholder")),o="<span class='"+t.Get("SelectedRowImage")+"' ></span>",u="<span class='"+t.Get("UnselectedrowImage")+"' ></span>",e=this;$.each(n,function(t,n){v.geocode(w(n),function(n,r){if(n.length==0)SiebelJS.Log("No address is found! "+r);else if(n.length==1){var s=n[0];s.accuracy<1?SiebelJS.Log("No address is found! "+r):(icon=i[t]===!0?o:u,selected=i[t]===!0?!0:!1,d[t]=s,C.call(e,s,t,icon,selected))}else SiebelJS.Log("Multiple addresses are found! "+r)})}),this.GetMapView().display()}function S(){this.GetMapView().removeAllFOIs(),d={}}function x(e,t){var n=d[e];n.accuracy<3?this.GetMapView().setCenterAndZoomLevel(t,10):n.accuracy==3?this.GetMapView().setCenterAndZoomLevel(t,7):n.accuracy==4?this.GetMapView().setCenterAndZoomLevel(t,6):n.accuracy==5?this.GetMapView().setCenterAndZoomLevel(t,5):this.GetMapView().setCenterAndZoomLevel(t,4)}function T(e,t){$(this).hide();var n=e.data.ctx;if(t&&t.item)if(t.item.children().attr("tag")=="SelectRecord")D.call(n,m.id);else if(t.item.children().attr("tag")=="ViewDetails"){var r=O.call(n,m.id),i=A.call(n,m.id);$(n.GetPM().Get("ListDetail")).dialog("option","title",i).dialog("open")}return!0}function N(){var e=arguments[1].id;m=arguments[1],$("#"+p).show().position({my:"center top+15",at:"center bottom",of:$(m.node),collision:"flip flip"}),setTimeout(function(){$("#"+p).hide()},5e3)}function C(e,t,n,r){var i=this,s=i.GetPM(),o=MVSdoGeometry.createPoint(e.x,e.y,8307),u=MVFOI.createHTMLFOI(t.toString(),o,n);u.enableInfoWindow(!1),u.enableInfoTip(!0),u.enableEventPropagation(!0),this.GetMapView().enableInfoWindowEventPropagation(!0);var a=A.call(this,t);u.setInfoTip(a);var f=t;u.attachEventListener(MVEvent.MOUSE_CLICK,N),this.GetMapView().removeFOI(t.toString()),this.GetMapView().addFOI(u),r&&(x.call(i,t,u.geom),u.setZIndex(999),u.reDraw())}function k(){var t=this.GetPM(),n=t.Get("markerLocation"),r=t.Get("GetRawRecordSet"),i=[];if(!e.IsEmpty(n))for(var s=0,o=r.length;s<o;s++){var u=r[s][n];i.push(u)}return i}function L(){var t=this.GetPM(),n=t.Get("markerTitle"),r=t.Get("GetRawRecordSet"),i=[];if(!e.IsEmpty(n))for(var s=0,o=r.length;s<o;s++){var u=r[s][n];e.IsEmpty(u)||i.push(u)}return i}function A(e){var t=this.GetPM(),n=t.Get("markerTitle"),r=t.Get("GetRawRecordSet"),i=r[e][n];return i}function O(e){var t=this,n=$(t.GetPM().Get("ListDetail"));_.call(t,e),$("input",n).attr("readonly",!0)}function M(t,r){var i=r?r:0,s=this.GetPM(),o=t.GetName(),u=t.GetFieldName(),a=s.Get("IsInQueryMode"),f=s.Get("IsPure"),l=s.ExecuteMethod("IsPrivateField",o);if(!e.IsEmpty(u)||l||!f){var c="";if(a||l||!f)if(!a||!f)r===undefined||r===null?c=s.ExecuteMethod("GetFormattedFieldValue",t,!1):c=s.ExecuteMethod("GetFormattedFieldValue",t,!0,i);else{var h=s.Get("GetRecordSet");c=e.IsEmpty(h[i][u])?"":h[i][u]}else r===undefined||r===null?c=s.ExecuteMethod("GetFormattedFieldValue",t,!0):c=s.ExecuteMethod("GetFormattedFieldValue",t,!0,i);(f||!f&&t.GetUIType()!==n)&&this.SetControlValue(t,c,0)}}function _(e){var t=this.GetPM(),n=t.Get("ListOfColumns"),r=n.length;for(var i=0;i<r;i++)M.call(this,n[i].control,e)}function D(e){var n=this.GetPM(),r=self;return Number(e)===Number(n.Get("GetSelection"))?!0:(SiebelApp.S_App.uiStatus.Busy({}),n.OnControlEvent(t.get("PHYEVENT_SELECT_ROW"),e,"","")?(SiebelApp.S_App.uiStatus.Free(),!0):(SiebelApp.S_App.uiStatus.Free(),!1))}function P(){$(this.GetPM().Get("ListDetail")).dialog({modal:!0,appendTo:"#s_"+this.GetPM().Get("GetFullId")+"_div",autoOpen:!1,title:"",close:function(){$(this).hide()}})}function H(e){return typeof e.GetInputName=="function"}var e=SiebelJS.Dependency("SiebelApp.Utils"),t=SiebelJS.Dependency("SiebelApp.Constants"),n=t.get("SWE_PST_BUTTON_CTRL"),r=t.get("SWE_CTRL_MVG"),i=t.get("SWE_CTRL_RADIO"),s=t.get("SWE_CTRL_CHECKBOX"),o=t.get("SWE_CTRL_CHART"),u=t.get("SWE_CTRL_PLAINTEXT"),a=t.get("SWE_CTRL_TEXT"),f=t.get("SWE_CTRL_RTCEMBEDDED"),l=t.get("SWE_CTRL_URL"),c=t.get("SWE_CTRL_MAILTO"),h=t.get("SWE_CTRL_IMAGECONTROL"),p="SiebelMap_Menu",d={},v,m={};return SiebelJS.Extend(g,SiebelAppFacade.PhysicalRenderer),g.prototype.Init=function(){var e=this;P.call(this),SiebelAppFacade.MapPhyRenderer.superclass.Init.call(e)},g.prototype.ShowSelection=function(e){var t=this.GetPM(),n=$("#"+t.Get("GetPlaceholder")),r=t.Get("GetRowsSelectedArray"),i="<span class='"+t.Get("SelectedRowImage")+"' ></span>",s="<span class='"+t.Get("UnselectedrowImage")+"' ></span>";if(!this.GetMapView())return;var o=this.GetMapView().getAllFOIs
(),u=!1;if(o.length<1)return;SiebelApp.S_App.uiStatus.Busy({});for(var a=0,f=r.length;a<f;a++){var l=this.GetMapView().getFOI(a.toString());r[a]===!0?l&&(l.setHTMLElement(i,0,0),x.call(this,a,l.geom),l.setZIndex(999),l.reDraw(),u=!0):l&&(l.setHTMLElement(s,0,0),l.setZIndex(500),l.reDraw())}u||b.call(this),SiebelApp.S_App.uiStatus.Free({})},g.prototype.ShowUI=function(){SiebelAppFacade.MapPhyRenderer.superclass.ShowUI.call(this),P.call(this);var e=this.GetPM(),t=e.Get("GetPlaceholder"),n=$("#"+t);htmlmarkupstr="<div class = 'siebui-map' ><div style='width: 100%; height: 100%' id = '"+t+"'></div></div>",n.replaceWith(htmlmarkupstr),y.call(this);var r=SiebelApp.S_App.LocaleObject.GetLocalString("IDS_SWE_MAP_MENU_SELECT_RECORD"),i=SiebelApp.S_App.LocaleObject.GetLocalString("IDS_SWE_MAP_MENU_DISPLAY_INFO"),s=" <ul id='"+p+"' style='z-index:99'  ><li><a href='#' class='siebui-menu-details' tag='ViewDetails' >"+i+"</a></li><li><a href='#' class='siebui-menu-select' tag='SelectRecord' >"+r+"</a></li></ul>";$("#"+e.Get("GetPlaceholder")).append(s),$("#"+p).menu({}).css({position:"absolute",zIndex:99}).hide().bind("menuselect",{ctx:this},T)},g.prototype.BindData=function(e){var t=this.GetPM(),n=$("#"+t.Get("GetPlaceholder")),r=t.Get("IsInQueryMode");e&&(S.call(this),b.call(this));if(r){this.GetMapView().display();return}E.call(this)},g.prototype.EndLife=function(){var e=this.GetPM(),t=$("#"+e.Get("GetPlaceholder"));S.call(this),delete this.GetMapView(),delete v,delete d,SiebelAppFacade.MapPhyRenderer.superclass.EndLife.call(this)},g}(),SiebelAppFacade.MapPhyRenderer}));
