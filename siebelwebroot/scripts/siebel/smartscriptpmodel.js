/*<ORACLECOPYRIGHT>
* Copyright (C) 2008-2024
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 24.2.0.0SIA[2024_02] */
typeof SiebelAppFacade.SmartScriptPresentationModel=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.SmartScriptPresentationModel"),define("siebel/smartscriptpmodel",[],function(){return SiebelAppFacade.SmartScriptPresentationModel=function(){function n(e){this.m_name="",this.m_label="",this.m_afterFluff="",this.m_beforeFluff="",this.m_requiredIndicatorStyle="*",this.m_currPage=null,this.m_pageArray=[],this.m_exposedSectionArray=[],this.m_bAtFinish=0,this.m_currQuest=null;var n=null;SiebelAppFacade.SmartScriptPresentationModel.superclass.constructor.call(this,e),this.CcInitialize=function(e){var r,i=e.GetChild(0),s=e.GetProperty(t.get("SWE_PROP_NAME"));n=this.ExecuteMethod("GetControl",s);if(i===null)return SiebelJS.Debug("SmartScript missing property set for custom control."),!1;r=i.EnumChildren(!0);while(r){var a=0,f=r.GetType(),l=r.GetChildCount(),c,h,p;SiebelJS.Debug("SmartScript property set ["+f+"] with ["+l+"] children.");if(f==="PageInfo")for(a=0;a<l;a++)c=r.GetChild(a),h=new o,h.m_name=c.GetProperty("p_n"),h.m_displayName=""+c.GetProperty("p_dn"),h.m_name!==null&&(h.m_index=this.m_pageArray.length,this.m_pageArray[h.m_index]=h);else if(f==="QuestInfo")for(a=0;a<l;a++)c=r.GetChild(a),p=new u,p.m_name=c.GetProperty("q_n"),p.m_controlName=c.GetProperty("q_cn"),p.m_displayName=""+c.GetProperty("q_dn"),p.m_fieldName=c.GetProperty("q_fn"),p.m_pageName=c.GetProperty("q_pn"),p.m_uiInputName=c.GetProperty("q_uin"),p.m_enabledHTML=c.GetProperty("q_html"),p.m_bEnable=c.GetProperty("q_en")==="1",p.m_bInfoOnly=c.GetProperty("q_io")==="1",p.m_mustAnswer=parseInt(c.GetProperty("q_ma"),10),h=this.GetPage(p.m_pageName),h!==null&&p.m_name!==null&&(h.m_questionArray[h.m_questionArray.length]=p);else if(f==="ExposedQuest")for(a=0;a<l;a++){c=r.GetChild(a);var d=c.GetProperty("q_n");this.m_currPage!==null&&(p=this.m_currPage.GetQuestion(d),p.m_bIsExposed=1,this.m_exposedSectionArray[this.m_exposedSectionArray.length]=p)}else if(f==="ScriptInfo"){this.m_name=r.GetProperty("s_n"),this.m_label=r.GetProperty("s_l"),this.m_requiredIndicatorStyle=r.GetProperty("s_ri"),this.m_beforeFluff=r.GetProperty("s_bf"),this.m_afterFluff=r.GetProperty("s_af");var v=r.GetProperty("s_cp");if(this.m_requiredIndicatorStyle===null||this.m_requiredIndicatorStyle==="")this.m_requiredIndicatorStyle="*";this.SetCurrentPage(v)}r=i.EnumChildren(!1)}return!0},this.CcPopulate=function(){this.GenExposedSectionSpans(),this.DisplayExposedSection()},this.SetCurrentPage=function(e){this.HideCurrentPage();var t=this.GetPage(e);t!==null&&(this.m_currPage=t,this.m_currPage.m_bIsExposed=1)},this.HideCurrentPage=function(){var e=0;if(this.m_currPage===null)return;this.m_currPage.m_bIsExposed=0;for(e=0;e<this.m_currPage.m_questionArray.length;e++){var t=this.m_currPage.m_questionArray[e];t!==null&&t.m_bIsExposed&&(t.m_bIsExposed=0)}},this.HidePreviousSection=function(){var e,t;if(this.m_exposedSectionArray.length>0)for(e=0;e<this.m_exposedSectionArray.length;e++)t=this.m_exposedSectionArray[e],t!==null&&(t.m_bIsExposed=0);this.m_exposedSectionArray.splice(0)},this.SetExposedQuestion=function(e){var t,n;e!==null&&e!==""&&this.m_currPage!==null&&(n=this.m_currPage.GetQuestion(e),n!==null&&(n.m_bIsExposed=1,this.m_exposedSectionArray===null&&(this.m_exposedSectionArray=[]),t=this.m_exposedSectionArray.length,this.m_exposedSectionArray[t]=n))},this.GetPage=function(e){var t,n;if(this.m_pageArray===null)return null;for(t=0;t<this.m_pageArray.length;t++){n=this.m_pageArray[t];if(n.m_name===e)return n}return null},this.GenExposedSectionSpans=function(){var e=0;if(this.m_currPage===null)return!1;var t="";for(e=0;e<this.m_exposedSectionArray.length;e++){var n=this.m_exposedSectionArray[e];n!==null&&n.m_bIsExposed&&n.m_pageName===this.m_currPage.m_name&&(n.m_enabledHTML!==null&&n.m_enabledHTML!==undefined?t+=n.m_enabledHTML:SiebelJS.Debug("SmartScript error, GenExposedSectionSpans missing enabledHTML for question ["+n.m_uiInputName+"] - "+n.m_displayName))}return this.GetRenderer().PopulateQuestionList(this.m_beforeFluff+t+this.m_afterFluff),!0},this.DisplayExposedSection=function(){var e=0,t=this.GetRenderer();t.DisplayPageLabel(this.m_currPage,this.m_requiredIndicatorStyle);for(e=0;e<this.m_exposedSectionArray.length;e++){var n=this.m_exposedSectionArray[e];t.DisplayQuestion(n,this.m_requiredIndicatorStyle)}return $("body").scrollTop(),!0},this.GetHtmlForQuestions=function(){var e={},t=this.GetRenderer(),n,r,i,s;for(n=0;n<this.m_pageArray.length;n++){i=this.m_pageArray[n];for(r=0;r<i.m_questionArray.length;r++)s=i.m_questionArray[r],e[s.m_uiInputName]=s}t.ExtractHtmlForQuestions(e)},this.ShowExposedQuestions=function(){var e=this.GetRenderer(),t=this.Get("GetControls");for(var n=0;n<this.m_exposedSectionArray.length;n++){var r=this.m_exposedSectionArray[n],i=r.m_uiInputName,s=null;for(var o in t)if(t.hasOwnProperty(o)&&t[o].GetInputName()===i){s=t[o];break}s!==null?(e.ShowUIControl(s),e.BindControlEvents(s)):SiebelJS.Debug("SmartScript Error: control not found for question: "+i)}return e.ShowSelection(),$("body").scrollTop(),!0},this.FocusOnFirstQuestion=function(){var e=this.Get("GetControls"),t=null;for(var n=0;n<this.m_exposedSectionArray.length;n++){var r=this.m_exposedSectionArray[n],i=r.m_uiInputName,s=null;for(var o in e)if(e.hasOwnProperty(o)&&e[o].GetInputName()===i){s=e[o];break}if(t===null&&s!==null){t=s;break}}return this.SetProperty("firstQuestionFocus",t),!0},this.GetSmartScriptControl=function(){return n},this.ExpandNotifyArgs=function(e,t){var n,r,i=e,s,o,u,a;if(t===null)return;t.splice(0),o=0;while(i.length>0){u=i.indexOf("*",o);if(u<0)return null;i=i.substr(u+1,i.length),s=parseInt(i,10);if(isNaN(s))return;u=i.indexOf("*",o),i=i.substr(u+1,i.length),a="",a=i.substr(0,s),i=i.substr(s,i.length),t[t.length]=a}},this.OnNewPage=function(e){if(e!==null&&e.length>0){var t=e[0];this.SetCurrentPage(t)}},this.OnNewQuestion=function(e){var t,n,r,i=[],s=e[0];s&&this.ExpandNotifyArgs(s,i),e!==null&&e.length>0&&this.m_currPage!==null&&(i!==null&&
i.length>0&&(n=i[0],r=i[1]),n!==""&&(t=this.m_currPage.GetQuestion(n),t!==null&&(this.m_currQuest=t)))},this.OnRefreshDashboard=function(e){if(e.length>0){var n=SiebelApp.S_App.getExtObject("Dashboard");if(n)n.ExecuteMethod("PopulateDashboardfromSS");else{var r=SiebelApp.S_App.GetService(t.get("NAME_DASHBOARDSVC"));if(r){var i=CCFMiscUtil_CreatePropSet();i.SetProperty("CallFromClient","TRUE"),r.InvokeMethod(t.get("DASHBOARD_METHOD_OPEN"),i)}}}},this.OnExposeSection=function(e){var t,n,r,i,s,o,u=[];this.m_exposedSectionArray.length>0&&this.HidePreviousSection();if(e!==null&&e.length>0)for(n=0;n<e.length;n++){var a=e[n];a!==""&&(this.ExpandNotifyArgs(a,u),u.length>0&&(i=u[0],s=u[1],t=u[2],o=u[3],i!==""&&(r=this.m_currPage.GetQuestion(i),r!==null&&(r.m_displayName=s,t==="Y"||t==="y"?r.m_bAnswered=!0:r.m_bAnswered=!1,o==="Y"||o==="y"?r.m_bEnable=!0:r.m_bEnable=!1),this.SetExposedQuestion(i))))}this.GenExposedSectionSpans(),this.DisplayExposedSection(),this.ShowExposedQuestions(),this.FocusOnFirstQuestion()},this.OnUpdateQuestions=function(e){var t,n,r,i,s,o,u,a,f=[];e!==null&&e.length>0&&(a=e[0],a!==""&&(this.ExpandNotifyArgs(a,f),f.length>0&&(s=f[0],o=f[1],u=f[2],t=f[3],n=f[4],o!==""&&s!==""&&(r=this.GetPage(s),r!==null&&(i=r.GetQuestion(o),i!==null&&(i.m_displayName=u,t==="Y"||t==="y"?i.m_bAnswered=!0:i.m_bAnswered=!1,n==="Y"||n==="y"?i.m_bEnable=!0:i.m_bEnable=!1))))))}}function r(e){var t=this.m_currPage,n=!0;for(j=0;j<t.m_questionArray.length;j++)question=t.m_questionArray[j],question.m_uiInputName===e&&!question.m_bEnable&&(n=!1);return n}function i(e){var n=e.GetProperty(t.get("SWE_PROP_NOTI_TYPE")),r=e.GetProperty(t.get("SWE_PROP_ARGS_ARRAY")),i=[];r&&CCFMiscUtil_StringToArray(r,i);switch(n){case"SWEICanUpdate":break;case"EndOfScript":this.m_bAtFinish=1;break;case"ResetAll":break;case"NewPage":this.OnNewPage(i);break;case"NewQuestion":this.OnNewQuestion(i);break;case"ExposeSection":this.OnExposeSection(i);break;case"RefreshDashboard":this.OnRefreshDashboard(i);break;case"UpdateQuestions":this.OnUpdateQuestions(i);break;case"GetQuickPickInfo":var s=i[1],o=i[2],u=i[3],a=i[4]==="true",f=i[5],l=i.splice(6),c=this.Get("GetActiveControl"),h=c.GetFieldName();break;default:}}function s(e){var t=!1;return!0}function o(){this.m_name="",this.m_displayName="",this.m_bIsExposed=0,this.m_index=-1,this.m_questionArray=[]}function u(){this.m_bEnable=!0,this.m_bIsExposed=0,this.m_controlName="",this.m_displayName="",this.m_fieldName="",this.m_index=-1,this.m_mustAnswer=0,this.m_bAnswered=0,this.m_bInfoOnly=0,this.m_name="",this.m_pageName="",this.m_uiInputName="",this.m_height=0,this.m_width=0,this.m_maxLength=0,this.m_group="",this.m_enabledHTML=""}var e=SiebelJS.Dependency("SiebelApp.Utils"),t=SiebelJS.Dependency("SiebelApp.Constants");return SiebelJS.Extend(n,SiebelAppFacade.PresentationModel),n.prototype.Init=function(){SiebelAppFacade.SmartScriptPresentationModel.superclass.Init.call(this),this.AddProperty("firstQuestionFocus",null),this.AddMethod("IsQuestionEnabled",r),this.AttachEventHandler(t.get("PHYEVENT_INVOKE_CONTROL"),s),this.AttachNotificationHandler(t.get("SWE_PROP_BC_NOTI_GENERIC"),function(e){i.call(this,e)})},n.prototype.Setup=function(e){SiebelAppFacade.SmartScriptPresentationModel.superclass.Setup.call(this,e),SiebelApp.S_App.uiStatus.Busy({timeOut:!1,mask:!0});if(!SiebelApp.S_App.IsRwd()){var n=e.EnumChildren(!0);do{if(n.GetType()===t.get("SWE_PST_CNTRL_LIST")){var r=n.EnumChildren(!0),i=n.GetChildCount();SiebelJS.Debug("SmartScript control list of ["+i+"] controls.");do{if(r.GetType()===t.get("SWE_PST_CUSTOM_CTRL")){SiebelJS.Debug("SmartScript got custom control information."),this.CcInitialize(r);break}r=n.EnumChildren(!1)}while(r);break}n=e.EnumChildren(!1)}while(n)}else{var s=e.GetChildByType("apm");s&&this.CcInitialize(s)}},n.prototype.Show=function(){this.GetHtmlForQuestions(),this.CcPopulate(),SiebelAppFacade.SmartScriptPresentationModel.superclass.Show.call(this),this.FocusOnFirstQuestion(),SiebelApp.S_App.uiStatus.Free()},o.prototype={},o.prototype.GetQuestion=function(e){var t,n;if(this.m_questionArray===null)return null;for(n=0;n<this.m_questionArray.length;n++){t=this.m_questionArray[n];if(t.m_name===e)return t}return null},u.prototype={},n}(),"SiebelAppFacade.SmartScriptPresentationModel"}),SiebelApp.S_App.RegisterConstructorAgainstKey("SmartScriptPM","SiebelAppFacade.SmartScriptPresentationModel"));
