/*<ORACLECOPYRIGHT>
* Copyright (C) 2008-2024
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 24.2.0.0SIA[2024_02] */
typeof SiebelAppFacade.AppletListAppletPM=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.AppletListAppletPM"),define("siebel/appletlistappletpm",["siebel/listpmodel"],function(){return SiebelAppFacade.AppletListAppletPM=function(){function r(){SiebelAppFacade.AppletListAppletPM.superclass.constructor.apply(this,arguments)}function i(e,t,n,r){e==="Wizard"&&(this.ExecuteMethod("ShowWizard"),r.CancelOperation=!0,SiebelApp.S_App.uiStatus.Free())}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=SiebelJS.Dependency("SiebelApp.Utils");return SiebelJS.Extend(r,SiebelAppFacade.ListPresentationModel),r.prototype.Init=function(){SiebelAppFacade.AppletListAppletPM.superclass.Init.apply(this,arguments),this.AddProperty("EnableAppletWizard",this.ExecuteMethod("CanInvokeMethod","NewRecord")),this.AddMethod("ShowWizard",function(){}),this.AddMethod("InvokeMethod",i,{sequence:!0,scope:this})},r}(),SiebelAppFacade.AppletListAppletPM})),typeof SiebelAppFacade.AppletListAppletPR=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.AppletListAppletPR"),define("siebel/appletlistappletpr",["siebel/phyrenderer","siebel/jqgridrenderer"],function(){return SiebelAppFacade.AppletListAppletPR=function(){function s(){SiebelAppFacade.AppletListAppletPR.superclass.constructor.apply(this,arguments)}function o(){var e=$(r);$(".siebui-wt-applet-wizard-select-dialog").length<=0?(e.dialog({modal:!0,resizable:!1,classes:{"ui-dialog":"siebui-wt-applet-wizard-select-dialog","ui-dialog-content":"siebui-wt-applet-wizard-select-popup"},buttons:[{text:t.GetLocalString("IDS_SWE_CKEDITOR_START"),click:function(){var e,t=SiebelApp.S_App.GetActiveView().GetActiveApplet();if(t){var r=t.GetName(),s=t.GetRawRecordSet()[t.GetSelection()],o=s.Id;e="SWECmd=GotoView&SWEView="+i+"&SWEApplet0="+r+"&SWERowId0="+o}$(this).dialog("close"),n.IsEmpty(e)||SiebelApp.S_App.GotoView("","",e,"")}},{text:t.GetLocalString("IDS_CLIENT_CANCEL"),click:function(){$(this).dialog("close")}}]}),e.parent().find(":button").addClass("siebui-ctrl-btn"),e.find("tr.ui-draggable").draggable("disable"),SiebelApp.EventManager.fireEvent("forceResize")):e.dialog("open"),e.find(".siebui-awti-palette").first().click()}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=SiebelJS.Dependency("SiebelApp.Utils"),r="#siebui-view-palette-container",i="Applet Web Template Editor View";return SiebelJS.Extend(s,SiebelAppFacade.JQGridRenderer),s.prototype.Init=function(){SiebelAppFacade.AppletListAppletPR.superclass.Init.apply(this,arguments),this.AttachPMBinding("ShowWizard",o,{scope:this}),this.AttachPMBinding("UpdateConditionals",function(){var t=this.GetPM(),n=t.Get("GetControls").Visualization;n&&this.GetUIWrapper(n).SetState(e.get("SHOW"),!1,0)})},s.prototype.EndLife=function(){SiebelAppFacade.AppletListAppletPR.superclass.EndLife.apply(this,arguments),$(".siebui-wt-applet-wizard-select-dialog").length>0&&$(".siebui-wt-applet-wizard-select-dialog").remove()},s.prototype.ShowUI=function(){var e=this.GetPM(),t=$("#"+e.Get("GetFullId"));SiebelAppFacade.AppletListAppletPR.superclass.ShowUI.apply(this,arguments),$(r).children().length==0&&e.SetProperty("EnableAppletWizard",!1),t.find(".siebui-icon-wizard").prop("disabled",!e.Get("EnableAppletWizard"))},s}(),SiebelAppFacade.AppletListAppletPR})),typeof SiebelAppFacade.ScriptObjectSAPickPM=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ScriptObjectSAPickPM"),define("siebel/scriptobjsapickpm",["siebel/listpmodel"],function(){return SiebelAppFacade.ScriptObjectSAPickPM=function(){function r(){SiebelAppFacade.ScriptObjectSAPickPM.superclass.constructor.apply(this,arguments)}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=SiebelJS.Dependency("SiebelApp.Utils");return SiebelJS.Extend(r,SiebelAppFacade.ListPresentationModel),r.prototype.Init=function(){SiebelAppFacade.ScriptObjectSAPickPM.superclass.Init.call(this),this.AddProperty("ScriptObjType",""),this.AddProperty("ScriptObjTypeText",""),this.AddMethod("SetupScriptObjSelection",function(e,t){this.SetProperty("ScriptObjType",e),this.SetProperty("ScriptObjTypeText",t)}),this.AddMethod("ShowScriptObjSelection",function(){})},r.prototype.Setup=function(e){SiebelAppFacade.ScriptObjectSAPickPM.superclass.Setup.call(this,e)},r.prototype.Show=function(){SiebelAppFacade.ScriptObjectSAPickPM.superclass.Show.call(this)},r}(),SiebelAppFacade.ScriptObjectSAPickPM})),typeof SiebelAppFacade.ScriptObjectSAPickPR=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ScriptObjectSAPickPR"),define("siebel/scriptobjsapickpr",["siebel/jqgridrenderer"],function(){return SiebelAppFacade.ScriptObjectSAPickPR=function(){function r(){SiebelAppFacade.ScriptObjectSAPickPR.superclass.constructor.apply(this,arguments)}function l(e,r){var l=this.GetPM(),c=n.IsTrue(SiebelApp.S_App.IsAutoOn()),p=l.Get("GetAppletLabel")+": "+r,d=$("#s_"+l.Get("GetFullId")+"_div");d.find(".siebui-applet-title").text(l.Get("GetAppletLabel")+": "+r),d.dialog({autoOpen:!1,height:"auto",width:"630px",title:p,modal:!0,classes:{"ui-dialog":"siebui-sd-select-script-obj-dialog","ui-dialog-content":"siebui-sd-select-script-obj-content"},buttons:[{text:t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_BUTTON_OK"),click:function(){SiebelApp.S_App.SetExternalActiveApplet(null),$(this).dialog("close");var e=l.Get("GetRawRecordSet")[l.Get("GetSelection")].Name;setTimeout(function(){$("#_swescriptdebugger").find("#scriptDebuggerServerScriptObjName").val(e).change()},10)}},{text:t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_BUTTON_CANCEL"),click:function(){SiebelApp.S_App.SetExternalActiveApplet(null),$(this).dialog("close")}}]});var v=d.siblings(".ui-dialog-buttonpane");v.find(":button").addClass("siebui-ctrl-btn appletButton"),v.find(":button").first().addClass("siebui-icon-pickrecord"),c&&(d.parent().attr(i,u).attr(s,p).attr(o,p),v.find(":button").each(function(){$(this).attr(i,a).attr(s,p+f+$(this).text
()).attr(o,$(this).text())})),v=null,d=null,SiebelApp.EventManager.addListner("postload",h,this)}function c(){var e=this.GetPM(),t=$("#s_"+e.Get("GetFullId")+"_div");t.dialog("isOpen")||(t.dialog("open"),t.resize()),h.call(this)}function h(){var t=this.GetPM(),n=$("#s_"+t.Get("GetFullId")+"_div");n.dialog("isOpen")&&t.OnControlEvent(e.get("PHYEVENT_APPLET_FOCUS"))}function p(){var e=this.GetPM(),t=$("#s_"+e.Get("GetFullId")+"_div").parent().find(".ui-dialog-buttonpane");e.Get("InQueryMode")?t.find(".siebui-icon-pickrecord").addClass("appletButtonDis"):t.find(".siebui-icon-pickrecord").removeClass("appletButtonDis"),t=null}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=SiebelJS.Dependency("SiebelApp.Utils");SiebelJS.Extend(r,SiebelAppFacade.JQGridRenderer);var i=e.get("SWE_PROP_AUTOM_OT"),s=e.get("SWE_PROP_AUTOM_RN"),o=e.get("SWE_PROP_AUTOM_UN"),u="SiebApplet",a=e.get("SWE_PST_BUTTON_CTRL"),f=":";return r.prototype.Init=function(){SiebelAppFacade.ScriptObjectSAPickPR.superclass.Init.call(this),this.AttachPMBinding("SetupScriptObjSelection",l,{scope:this}),this.AttachPMBinding("ShowScriptObjSelection",c,{scope:this}),this.AttachPMBinding("BeginQueryState",p,{scope:this}),this.AttachPMBinding("EndQueryState",p,{scope:this})},r.prototype.ShowUI=function(){var e=this.GetPM();e.SetProperty("DisableElasticGrid",!0),SiebelAppFacade.ScriptObjectSAPickPR.superclass.ShowUI.call(this)},r.prototype.BindEvents=function(){SiebelAppFacade.ScriptObjectSAPickPR.superclass.BindEvents.call(this)},r.prototype.BindData=function(e){SiebelAppFacade.ScriptObjectSAPickPR.superclass.BindData.call(this,e)},r.prototype.EndLife=function(){SiebelApp.EventManager.removeListner("postload",h,this),SiebelAppFacade.ScriptObjectSAPickPR.superclass.EndLife.call(this)},r}(),SiebelAppFacade.ScriptObjectSAPickPR})),typeof SiebelAppFacade.ScriptEditorPM=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ScriptEditorPM"),define("siebel/scripteditorpm",["siebel/pmodel"],function(){return SiebelAppFacade.ScriptEditorPM=function(){function J(){SiebelAppFacade.ScriptEditorPM.superclass.constructor.apply(this,arguments)}function K(e,t,n,r){e==="WriteRecord"&&(this.ExecuteMethod("WriteScriptData"),r.CancelOperation=!0)}function Q(e){var t=!1;switch(e){case"DebugToggleScriptDebugger":t=!0;break;case"DebugRestart":this.Get("EnableRestart")&&(t=!0);break;case"DebugByteCode":case"DebugEnd":this.Get("IsInDebugging")&&(t=!0);break;case"DebugStart":case"DebugCallTree":this.Get("IsInDebugging")||(t=!0);break;case"DebugContinue":case"DebugBreak":case"DebugStepInto":case"DebugStepOver":case"DebugStepToCursor":this.Get("IsInDebugging")&&(this.Get(b)===x?e!=="DebugBreak"&&(t=!0):e==="DebugBreak"&&(t=!0));break;case"DebugCheckSyntax":case"DebugToggleBreakpoint":case"DebugClearAllBreakpoints":this.Get("IsScriptDebuggerShown")&&!n.IsEmpty(this.Get("ActiveEventName"))&&(t=!0)}return t}function G(){W=this.Get("ProfileState"),V=this.Get("ProfileNodes"),W===2&&(this.ExecuteMethod("ShowProfileWindow",!0),this.ExecuteMethod("RefreshProfileWindow"),pt.call(this)),this.ExecuteMethod("NotifyDebugStateChanged")}function Y(e){var t=!1;switch(e){case"DebugByteCode":_t.call(this);break;case"DebugBreak":t=!0,Dt.call(this);break;case"DebugCheckSyntax":Xt.call(this);break;case"DebugClearAllBreakpoints":Vt.call(this);break;case"DebugEnd":t=!0,Bt.call(this);break;case"DebugRestart":t=!0,Ft.call(this);break;case"DebugCallTree":W=this.Get("ProfileState"),W===1?(st.call(this),this.ExecuteMethod("ShowProfileWindow",!0)):W===2&&(ot.call(this),this.ExecuteMethod("ShowProfileWindow",!1));break;case"DebugStart":case"DebugContinue":t=!0,Rt.call(this);break;case"DebugStepInto":Ut.call(this);break;case"DebugStepOver":zt.call(this);break;case"DebugStepToCursor":Wt.call(this);break;case"DebugToggleBreakpoint":$t.call(this);break;case"DebugToggleScriptDebugger":Kt.call(this);break;case"DebugSettings":Jt.call(this)}t&&this.ExecuteMethod("NotifyDebugStateChanged")}function et(e){SiebelJS.Debug("[ScriptDebugger] "+e,!0)}function tt(t){var n=CCFMiscUtil_CreatePropSet();return n.SetType(e.get("SCRIPTDEBUG_SD_TYPE")),n.SetProperty(e.get("SCRIPTDEBUG_PROPERTY_CMD"),t),n.SetProperty(e.get("PROP_TYPE"),e.get("SCRIPTDEBUG_PROPERTY_TYPE")),n}function nt(t){var n="unknown error",r=t.GetChildByType(e.get("SWE_PROP_RESULTSET"));if(r!==null){var i=r.GetChildByType(e.get("SCRIPTDEBUG_SD_TYPE"));if(i!==null&&i.GetChildCount()>0){var s=i.GetChild(0);s!==null&&(n=s.GetProperty(e.get("SCRIPTDEBUG_CMD_RESPONSE_ERRORMSG")));if(n===null||n===undefined||n.length===0)n=s.EncodeAsString()}}return n}function rt(t){var n=t.GetChildByType(e.get("SWE_PROP_RESULTSET")),r=null,i="";return n!==null?(r=n.GetChildByType(e.get("SCRIPTDEBUG_SD_TYPE")),r!==null?i=r.GetProperty(e.get("SCRIPTDEBUG_PROPERTY_CMD")):et("GetDbgSrvRespCmd: SD Cmd is null")):et("GetDbgSrvRespCmd: ResultSet is null"),i}function it(t){if(t===null){et("HandleProfileInit: receive empty data");return}et("HandleProfileInit: working");if(D===!0)return;if(!P){et("Debugger Service is not available - DebugSvc is null");return}W=1,this.SetProperty("ProfileState",W),window.sessionStorage.setItem("CallTree",W.toString()),Et.call(this,e.get("SCRIPTDEBUG_CMD_CALLTREE"));var n=nn.call(this);for(var r=0;r<n.length;r++)gt(n[r])}function st(){et("OnDebugCallTree");if(this.Get("IsInDebugging")){if(W===1){var t={async:!0,scope:this,npr:!0,cb:St},n=tt(e.get("SCRIPTDEBUG_CMD_GETROOT"));et("OnDebugCallTree: "+e.get("SCRIPTDEBUG_CMD_GETROOT")+":"+n.EncodeAsString()),P.InvokeMethod("ProcessDebugMsg",n,t)}}else et("OnDebugCallTree: not in debug mode")}function ot(){et("OnResetUpdate");if(this.Get("IsInDebugging")){if(W===2){var t={async:!0,scope:this,npr:!0,cb:St},n=tt(e.get("SCRIPTDEBUG_CMD_RESETUPDATE"));et("OnResetUpdate: "+e.get("SCRIPTDEBUG_CMD_RESETUPDATE")+":"+n.EncodeAsString()),P.InvokeMethod("ProcessDebugMsg",n,t),X={},V={},this.SetProperty("ProfileNodes",V);var r=JSON.stringify(V);window.sessionStorage.
setItem("ProfileNodes",r),W=1,this.SetProperty("ProfileState",W),window.sessionStorage.setItem("CallTree",W.toString()),Et.call(this,e.get("SCRIPTDEBUG_CMD_CALLTREE"))}}else et("OnResetUpdate: not in debug mode")}function ut(){if(W!==0){et("StopProfile: is called"),X={},V={},this.SetProperty("ProfileNodes",V);var t=JSON.stringify(V);window.sessionStorage.setItem("ProfileNodes",t),W=0,this.SetProperty("ProfileState",W),Et.call(this,e.get("SCRIPTDEBUG_CMD_CALLTREE")),window.sessionStorage.setItem("CallTree",W.toString()),this.ExecuteMethod("ShowProfileWindow",!1)}}function at(e){var t;for(t in e){t!==e[t].m_pThisNode&&et("logJS_PS: error"),et(e[t].m_pParent+":"+t+":"+e[t].m_Level+":"+e[t].m_sMethodName),et("	 "+e[t].m_nCallCount+":"+e[t].m_nTotalSelfTime+":"+e[t].m_nTotalTime);var n="	 Lines: ",r;if(e[t].m_Lines!==null)for(r=0;r<e[t].m_Lines.length;r++){var i=e[t].m_Lines[r].m_nLineNum+":"+e[t].m_Lines[r].m_nCount+":"+e[t].m_Lines[r].m_nTimeTotal+", ";n+=i}et(n),n="	 Children: ";if(e[t].m_Children!==null)for(r=0;r<e[t].m_Children.length;r++)n+=e[t].m_Children[r],n+=", ";et(n)}}function ft(e){if(n.IsEmpty(X)||n.IsEmpty(X.m_pThisNode))return;n.IsEmpty(V[X.m_pThisNode])?(et("UpdateProfiles: add"),X.m_pParent==="0"?X.m_Level=0:n.IsEmpty(V[X.m_pParent])===!1&&(X.m_Level=V[X.m_pParent].m_Level+1)):(et("UpdateProfiles: update"),X.m_Level=V[X.m_pThisNode].m_Level),V[X.m_pThisNode]=structuredClone(X);var t=JSON.stringify(V);window.sessionStorage.setItem("ProfileNodes",t),this.ExecuteMethod("UpdateProfileWindow",X.m_pThisNode),X={},at(V)}function lt(t,r){var i=t.GetChildByType(e.get("SCRIPTDEBUG_DATA_LIST"));if(n.IsEmpty(i)){et("HandleDebugMsg: "+e.get("SCRIPTDEBUG_DATA_LIST")+" is empty");return}X.m_pThisNode=i.GetProperty("_this"),X.m_pParent=i.GetProperty("_parent"),X.m_sMethodName=i.GetProperty("_method"),X.m_nCallCount=i.GetProperty("_call_c"),X.m_nTotalSelfTime=i.GetProperty("_t_self_t"),X.m_nMinSelfTime=i.GetProperty("_min_self_t"),X.m_nMaxSelfTime=i.GetProperty("_max_self_t"),X.m_nTotalTime=i.GetProperty("_t_t"),X.m_nMinTime=i.GetProperty("_min_t"),X.m_nMaxTime=i.GetProperty("_max_t"),X.m_Children=[];var s,o,u,a=i.GetChildByType("_children");if(!n.IsEmpty(a)){u=Number(a.GetProperty("Count"));for(o=0;o<u;o++){s="Child"+String(o);var f=a.GetProperty(s);et("HandleRootNode: child: "+f),X.m_Children[o]=f}}X.m_Lines=[];var l=i.GetChildByType("_lines");if(!n.IsEmpty(l)){u=Number(l.GetProperty("Count"));for(o=0;o<u;o++){s="Line"+String(o);var c=l.GetChildByType(s);if(c!==null){var h={};h.m_nLineNum=c.GetProperty("_l_n"),h.m_nCount=c.GetProperty("_l_c"),h.m_nTimeTotal=c.GetProperty("_l_time"),X.m_Lines[o]=h,et("HandleRootNode: line: "+X.m_Lines[o])}}}ft.call(this,r)}function ct(t){if(n.IsEmpty(t)){et("HandleRootNode: receive empty data");return}et("HandleRootNode: working: "+t.EncodeAsString());if(D===!0)return;if(!P){et("Debugger Service is not available - DebugSvc is null");return}W=2,this.SetProperty("ProfileState",W),window.sessionStorage.setItem("CallTree",W.toString()),Et.call(this,e.get("SCRIPTDEBUG_CMD_CALLTREE")),lt.call(this,t,!0),pt()}function ht(e){if(n.IsEmpty(e)){et("HandleNode: receive empty data");return}et("HandleNode: working: "+e.EncodeAsString());if(D===!0)return;if(!P){et("Debugger Service is not available - DebugSvc is null");return}lt.call(this,e,!1)}function pt(){if(W!==2)return;et("StartProfilePolling: ");var e=0,t="",n;for(n in V)e>0&&(t+=";"),t+=n,e++;vt(t,e),setTimeout(pt,5e3)}function dt(t){if(W!==2)return;var n={async:!0,scope:this,npr:!0,cb:St},r=tt(e.get("SCRIPTDEBUG_CMD_PIPEDATA"));r.SetProperty(e.get("SCRIPTDEBUG_DATA_NODE"),t),r.SetProperty(e.get("SCRIPTDEBUG_DATA_TYPE"),L),et("GetChildren: "+e.get("SCRIPTDEBUG_CMD_PIPEDATA")+":"+r.EncodeAsString()),P.InvokeMethod("ProcessDebugMsg",r,n)}function vt(t,n){if(W!==2)return;if(n<1)return;var r={async:!0,scope:this,npr:!0,cb:St},i=tt(e.get("SCRIPTDEBUG_CMD_PIPEDATA"));i.SetProperty(e.get("SCRIPTDEBUG_DATA_NODE_COUNT"),n),i.SetProperty(e.get("SCRIPTDEBUG_DATA_NODE"),t),i.SetProperty(e.get("SCRIPTDEBUG_DATA_TYPE"),A),et("GetThreeLevels: "+e.get("SCRIPTDEBUG_CMD_PIPEDATA")+":"+i.EncodeAsString()),P.InvokeMethod("ProcessDebugMsg",i,r)}function mt(t){if(W!==2)return;var n={async:!0,scope:this,npr:!0,cb:St},r=tt(e.get("SCRIPTDEBUG_CMD_GETSUBTREE"));r.SetProperty(e.get("SCRIPTDEBUG_DATA_NODE"),t),r.SetProperty(e.get("SCRIPTDEBUG_DATA_TYPE"),O),et("GetSubTree: "+e.get("SCRIPTDEBUG_CMD_GETSUBTREE")+":"+r.EncodeAsString()),P.InvokeMethod("ProcessDebugMsg",r,n)}function gt(t){if(W===0)return;var n={async:!0,scope:this,npr:!0,cb:St},r=tt(e.get("SCRIPTDEBUG_CMD_ADDRULE"));r.SetProperty(e.get("SCRIPTDEBUG_DATA_RULE"),t),et("HandleProfileInit: "+e.get("SCRIPTDEBUG_CMD_ADDRULE")+":"+r.EncodeAsString()),P.InvokeMethod("ProcessDebugMsg",r,n)}function yt(t){if(W===0)return;var n={async:!0,scope:this,npr:!0,cb:St},r=tt(e.get("SCRIPTDEBUG_CMD_DELRULE"));r.SetProperty(e.get("SCRIPTDEBUG_DATA_RULE"),t),et("HandleProfileInit: "+e.get("SCRIPTDEBUG_CMD_DELRULE")+":"+r.EncodeAsString()),P.InvokeMethod("ProcessDebugMsg",r,n)}function bt(t){et("HandleDebugMsg:"),Tt.call(this);if(t===null){et("HandleDebugMsg: receive empty data");return}var n=t.GetChildByType(e.get("SCRIPTDEBUG_DATA_LIST"));if(n===null){et("HandleDebugMsg: "+e.get("SCRIPTDEBUG_DATA_LIST")+" is empty");return}this.ExecuteMethod("RemoveScriptCallData"),this.ExecuteMethod("RemoveWatchData");var r=n.GetChildByType(e.get("SCRIPTDEBUG_DATA_CALLSTACK"));if(r===null)et("HandleDebugMsg: "+e.get("SCRIPTDEBUG_DATA_CALLSTACK")+" is empty");else{et("HandleDebugMsg: callStack: "+r.EncodeAsString());var i=CCFMiscUtil_CreatePropSet();this.ExecuteMethod("InvokeServiceMethod","RebuildCallStackData",r,i),this.ExecuteMethod("SetScriptCallData",i),this.ExecuteMethod("NotifyBreakpointHit")}var s=n.GetChildByType(e.get("SCRIPTDEBUG_DATA_ERR"));s===null||s.GetPropertyCount()===0?et("HandleDebugMsg: "+e.get("SCRIPTDEBUG_DATA_ERR")+" is empty"):this.ExecuteMethod("AddErrorData",s);var o=n.GetChildByType(e.get("SCRIPTDEBUG_DATA_APPDATA"
));o===null?et("HandleDebugMsg: "+e.get("SCRIPTDEBUG_DATA_APPDATA")+" is empty"):this.ExecuteMethod("SetWatchData",o),Qt.call(this)}function wt(e){et("SetDebugState: '"+e+"'"),this.Get(b)!==e&&this.SetProperty(b,e),et("Property 'DebugState' = '"+e+"'"),window.sessionStorage.getItem(b)!==e&&window.sessionStorage.setItem(b,e),et("Session 'DebugState' = '"+window.sessionStorage.getItem(b)+"'")}function Et(t,n){var r=!0;switch(t){case e.get("SCRIPTDEBUG_CMD_BREAK"):case e.get("SCRIPTDEBUG_CMD_STEPIN"):case e.get("SCRIPTDEBUG_CMD_STEPOVER"):case e.get("SCRIPTDEBUG_CMD_CONTINUE"):case e.get("SCRIPTDEBUG_CMD_RUNTOLINE"):break;case e.get("SCRIPTDEBUG_CMD_CALLTREE"):break;case e.get("SCRIPTDEBUG_CMD_RESERVE_SESSION"):n=E;break;case e.get("SCRIPTDEBUG_CMD_ATTACH_TARGET"):n=S,this.SetProperty("IsInDebugging",!0),this.ExecuteMethod("SetDebugStart"),this.ExecuteMethod("RemoveScriptCallData"),this.ExecuteMethod("RemoveWatchData"),this.ExecuteMethod("RemoveErrorData");break;case e.get("SCRIPTDEBUG_CMD_DETACH_TARGET"):n=w,this.SetProperty("IsInDebugging",!1),this.ExecuteMethod("SetDebugEnd"),this.ExecuteMethod("RemoveScriptCallData"),this.ExecuteMethod("RemoveWatchData"),this.ExecuteMethod("RemoveErrorData");break;case e.get("SCRIPTDEBUG_CMD_DEBUG"):n=x;break;default:r=!1}this.ExecuteMethod("RemoveWatchData"),this.ExecuteMethod("RemoveScriptCallData"),r&&(n!==null&&wt.call(this,n),this.ExecuteMethod("NotifyDebugStateChanged"))}function St(){et("HandleDbgSrvResp");var t=arguments[0],n=arguments[1].GetProperty(e.get("SCRIPTDEBUG_PROPERTY_CMD")),r=rt(arguments[2]);et("HandleDbgSrvResp: "+t+", request:"+n+", response:"+r);var i=arguments[2].GetChildByType(e.get("SWE_PROP_RESULTSET")),s=null;i!==null?(s=i.GetChildByType(e.get("SCRIPTDEBUG_SD_TYPE")),s===null&&et("HandleDbgSrvResp: sdPropSet is null")):et("HandleDbgSrvResp: resultSetPropSet is null"),n===e.get("SCRIPTDEBUG_CMD_SETBPS")&&(B=!1);if(r!==e.get("SCRIPTDEBUG_CMD_RESPONSE_SUCCESS"))if(r===e.get("SCRIPTDEBUG_CMD_RESPONSE_ERROR"))Et.call(this,n,x),et("HandleDbgSrvResp: Failed to execute: "+n+": "+nt(arguments[2]));else if(r===e.get("SCRIPTDEBUG_CMD_CURRENTBPS")){if(s!==null){var o=s.GetChildByType(e.get("SCRIPTDEBUG_DATA_LIST"));Ct.call(this,s)}}else r===e.get("SCRIPTDEBUG_CMD_DEBUG")?bt.call(this,s):et("HandleDbgSrvResp, unhandled cases: "+arguments[2].EncodeAsString())}function xt(){if(D===!0)return;if(!P){et("Debugger Service is not available - DebugSvc is null");return}if(H===!1){et("GetNextMsg: stopped");return}if(B===!0){et("GetNextMsg: wait for DbgSvc");var r=this;setTimeout(function(){xt.call(r)},1e3);return}var i={async:!0,scope:this,npr:!0,selfbusy:!0};i.cb=function(){B=!1;var r=rt(arguments[2]);et("GetNextMsg: receives "+r);var i=arguments[2],s=i.GetChildByType(e.get("SWE_PROP_RESULTSET")),o=null;s!==null?o=s.GetChildByType(e.get("SCRIPTDEBUG_SD_TYPE")):et("GetNextMsg: response does not have resultSet");if(r===e.get("SCRIPTDEBUG_CMD_RESPONSE_ERROR")){var u=nt(i);if(u==="GetNext broken by BREAK or DETACH"){H=!1,et("GetNextMsg: stopped: "+u);return}if(I===0)I=1,q=(new Date).getTime();else{I++;if(I%2===0){var a=(new Date).getTime();if(a-q>15e3){et("GetNextMsg: m_iGetNextError: "+I);if(!n.Confirm(t.GetLocalString("WT_SCRIPT_DEBUG_SERVER_NOT_REACHABLE"))){SiebelJS.Log("[ScriptDebugger] GetNextMsg: Fail to connect to Script Debug Server. End script debugging.",!0),H=!1,Et.call(this,e.get("SCRIPTDEBUG_CMD_DETACH_TARGET")),Ht.call(this),ut.call(this);return}q=(new Date).getTime(),et("GetNextMsg: continue try")}}}SiebelJS.Log("[ScriptDebugger] GetNextMsg: retry: "+I,!0)}else I=0;if(r===e.get("SCRIPTDEBUG_CMD_LOADSCRIPT")){et("GetNextMsg: _ls: resultSet: "+s.EncodeAsString());if(o!==null){var f=o.GetChildByType(e.get("SCRIPTDEBUG_DATA_LIST")),l;f!==null&&(l=f.GetProperty(e.get("SCRIPTDEBUG_DATA_OBJECT"))),kt.call(this,l)}}else r===e.get("SCRIPTDEBUG_CMD_DEBUG")?(Et.call(this,e.get("SCRIPTDEBUG_CMD_DEBUG")),bt.call(this,o)):r!==e.get("SCRIPTDEBUG_CMD_RESPONSE_SUCCESS")&&(r===e.get("SCRIPTDEBUG_CMD_PROFILE_INIT")?it.call(this,o):r===e.get("SCRIPTDEBUG_CMD_PROFILE_ROOTNODE")?ct.call(this,o):r===e.get("SCRIPTDEBUG_CMD_PROFILE_NODE")?ht.call(this,o):r===e.get("SCRIPTDEBUG_CMD_RESPONSE_WAIT")?B=!0:r===e.get("SCRIPTDEBUG_CMD_CALL_GET_DETACHED")?(H=!1,Bt.call(this)):et("GetNextMsg, unhandled cases: "+arguments[2].EncodeAsString()));xt.call(this)};var s=tt(e.get("SCRIPTDEBUG_CMD_GETNEXT"));et("GetNextMsg... "+e.get("SCRIPTDEBUG_CMD_GETNEXT")),P.InvokeMethod("ProcessDebugMsg",s,i),et("GetNextMsg... After calling ProcessDebugMsg.")}function Tt(){var t=this.Get("ClearRunToLineBP");if(t!==null){if(SiebelJS.LogLevel==="debug"){et("ClearRunToLineBreakpoint: request Script Engine to clear previous RunToLine breakpoint.");var r=t.GetChildByType(e.get("SCRIPTDEBUG_DATA_LIST"));!n.IsEmpty(r)&&r.GetChildCount()===1&&et("ClearRunToLineBreakpoint: "+r.GetChild(0).EncodeAsString())}var i={async:!0,scope:this,npr:!0,cb:St};P.InvokeMethod("ProcessDebugMsg",t,i),this.SetProperty("ClearRunToLineBP",null)}}function Nt(t){t===null&&(t=""),et("GetAllDebugBreakpoints: plan to load: "+t);var r=CCFMiscUtil_CreatePropSet();r.SetType(e.get("SCRIPTDEBUG_DATA_LIST"));var i=CCFMiscUtil_CreatePropSet(),s=CCFMiscUtil_CreatePropSet();if(this.ExecuteMethod("InvokeServiceMethod","GetAllDebugBreakpoints",i,s))for(var o=0;o<s.GetChildCount();o++){var u=s.GetChild(o),a=u.GetType(),f;for(var l=0;l<u.GetChildCount();l++){var c=u.GetChild(l),h;c!==null&&(h=c.GetType()),f=hn(a,h);if(t===f||t==="*"){et("GetAllDebugBreakpoints: found: "+f);var p=n.IsTrue(Cn.call(this,"AdjustToValidLine"))?"1":"0",d=f+"_"+c.GetProperty("ScriptLib"),v=c.GetProperty("BPLines"),m=[];n.IsEmpty(v)||CCFMiscUtil_StringToArray(v,m),et("BPLines: "+m.toString());for(var g=0,y=m.length;g<y;g++){var b=parseInt(m[g],10);if(!n.IsEmpty(b)&&!isNaN(b)){et("GetAllDebugBreakpoints: "+d+":"+b+":"+p);var w=CCFMiscUtil_CreatePropSet();w.SetType(d),w.SetProperty(e.get("SCRIPTDEBUG_DATA_LINENUMBER"),b),w.SetProperty(e.get("SCRIPTDEBUG_DATA_SET_BP"
),"1"),w.SetProperty(e.get("SCRIPTDEBUG_DATA_CA"),p),r.AddChild(w)}}}else et("GetAllDebugBreakpoints: skip: "+f)}}return r}function Ct(e){et("HandleCurrentBPs: "+e.EncodeAsString());var t=CCFMiscUtil_CreatePropSet();this.ExecuteMethod("InvokeServiceMethod","HandleCurrentBreakpoint",e,t)&&(et("ApplyDebugServerBP: "+t.EncodeAsString()),this.ExecuteMethod("ApplyDebugServerBP",t))}function kt(t){if(D===!0)return;if(!P){et("Debugger Service is not available - DebugSvc is null");return}var n={async:!0,scope:this,npr:!0,cb:St},r=tt(e.get("SCRIPTDEBUG_CMD_SETBPS")),i=Nt.call(this,t);r.AddChild(i),et("SendBreakpoints: "+e.get("SCRIPTDEBUG_CMD_SETBPS")+":"+r.EncodeAsString()),B=!0,P.InvokeMethod("ProcessDebugMsg",r,n)}function Lt(e,t){n.IsEmpty(e)||(et("Invoke UpdateSessionTimeout: "+e),UpdateSessionTimeout(e,t))}function At(){var t=sessionStorage.getItem(e.get("SCRIPTDEBUG_CURRENT_TARGET_VIEW"));return sessionStorage.removeItem(e.get("SCRIPTDEBUG_CURRENT_TARGET_VIEW")),t}function Ot(t,r,i){var s=SiebelApp.S_App.GetBaseURL(),o=s+"app/"+t+"/"+r+i,u=At.call(this);n.IsEmpty(u)?($('<a id="openDebugWindow" href="'+o+'" target="_blank" rel="noreferrer"'+"></a>").appendTo("body"),$("#openDebugWindow")[0].click(),$("#openDebugWindow").html("").remove()):(o=o+"&"+e.get("SCRIPTDEBUG_TARGET_CMD")+"="+e.get("SWE_GOTO_VIEW")+"&"+e.get("SWE_VIEW_ARG")+"="+u,OUI_TabMessageChannel({Cmd:"Replace",Val:o})),et("Open application: "+o),localStorage.setItem("IsDebugInitiated","true")}function Mt(){if(D===!0)return;if(!P){et("Debugger Service is not available - DebugSvc is null");return}var t={async:!0,scope:this,npr:!0};t.cb=function(){var t=arguments[0],n=arguments[1].GetProperty(e.get("SCRIPTDEBUG_PROPERTY_CMD")),r=rt(arguments[2]);et("AttachDebugTarget: "+t+", request:"+n+", response:"+r),r===e.get("SCRIPTDEBUG_CMD_ATTACH")||r===e.get("SCRIPTDEBUG_CMD_RESPONSE_SUCCESS")?(Lt.call(this,this.Get("SessionTimeout"),!0),window.sessionStorage.removeItem(v),H=!0,et("AttachDebugTarget: Starting GetNextMsg..."),xt.call(this),Et.call(this,e.get("SCRIPTDEBUG_CMD_ATTACH_TARGET")),this.ExecuteMethod("InvokeServiceMethod","AddDisconnectRequest",this.Get("DisconnectRequestPS"))):r===e.get("SCRIPTDEBUG_CMD_RESPONSE_ERROR")?et("AttachDebugTarget: Failed :"+nt(arguments[2])):et("AttachDebugTarget: unhandled cases: "+arguments[2].EncodeAsString())};var r=tt(e.get("SCRIPTDEBUG_CMD_ATTACH_TARGET")),i=CCFMiscUtil_CreatePropSet(),s=window.sessionStorage.getItem(v);n.IsEmpty(s)||(et("AttachDebugTarget: Encoded AttachTarget PropSet: "+s),i.DecodeFromString(s),r.AddChild(i)),et("AttachDebugTarget: "+e.get("SCRIPTDEBUG_CMD_ATTACH_TARGET")),P.InvokeMethod("ProcessDebugMsg",r,t)}function _t(){sessionStorage.setItem(e.get("SCRIPTDEBUG_CURRENT_STATE_SESSIONACTIVE"),"1"),this.SetProperty("EnableRestart",!0)}function Dt(){if(D===!0){Z(this,"DebugBreak");return}if(!P){et("Debugger Service is not available - DebugSvc is null");return}var t={async:!0,scope:this,npr:!0,cb:St},n=tt(e.get("SCRIPTDEBUG_CMD_BREAK"));et("OnDebugBreak: "+e.get("SCRIPTDEBUG_CMD_BREAK")+":"+n.EncodeAsString());var r=P.InvokeMethod("ProcessDebugMsg",n,t)}function Pt(){Qt.call(this);if(D===!0){Z(this,"DebugContinue");return}if(!P){et("Debugger Service is not available - DebugSvc is null");return}et("OnDebugContinue: "+e.get("SCRIPTDEBUG_CMD_CONTINUE")),Et.call(this,e.get("SCRIPTDEBUG_CMD_CONTINUE"),S);var t={async:!0,scope:this,npr:!0,cb:St},n=tt(e.get("SCRIPTDEBUG_CMD_CONTINUE"));P.InvokeMethod("ProcessDebugMsg",n,t)}function Ht(){if(D===!0)return;if(!P){P=SiebelApp.S_App.GetService("Template Parser Service");if(P===null){et("Failed to get Debugger Service");return}}et("OnDebugDisconnect: RouteToDebuggerService"),H=!1;var t={async:!0,scope:this,npr:!0};t.cb=function(){this.SetProperty("SessionTimeout","");var t=CCFMiscUtil_CreatePropSet(),r=CCFMiscUtil_CreatePropSet();t.SetProperty("SessionTimeout",this.Get("SessionTimeout")),this.ExecuteMethod("InvokeServiceMethod","SetSessionTimeout",t,r);var i=n.IsTrue(r.GetProperty("InDebugOrSim"));et("OnDebugDisconnect: got InDebugOrSim = "+i);if(i)et("OnDebugDisconnect: No need to reset SessionTimeout.  Still in Debugging/Simulating.");else{var s=arguments[2].GetProperty(e.get("SWE_PROP_SESSION_TIMEOUT"))||"";et("OnDebugDisconnect: got "+e.get("SWE_PROP_SESSION_TIMEOUT")+" = "+s),Lt.call(this,s,!1)}this.ExecuteMethod("InvokeServiceMethod","DeleteDisconnectRequest"),window.sessionStorage.getItem(e.get("SCRIPTDEBUG_CURRENT_STATE_SESSIONACTIVE"))==="1"&&this.ExecuteMethod("AutoStartScriptDebugging")};var r=CCFMiscUtil_CreatePropSet();r.SetType(e.get("SCRIPTDEBUG_CMD_DISCONNECT")),P.InvokeMethod("RouteToDebuggerService",r,t)}function Bt(){if(D===!0){Z(this,"DebugEnd");return}if(!P){et("Debugger Service is not available - DebugSvc is null");return}et("OnDebugEnd: "+e.get("SCRIPTDEBUG_CMD_DETACH_TARGET")),ut.call(this),Tt.call(this);var t={async:!0,scope:this,npr:!0};t.cb=function(){var t=arguments[0],n=arguments[1].GetProperty(e.get("SCRIPTDEBUG_PROPERTY_CMD")),r=rt(arguments[2]);et("OnDebugEnd: "+t+", request:"+n+", response:"+r),r===e.get("SCRIPTDEBUG_CMD_RESPONSE_SUCCESS")?(H=!1,Et.call(this,e.get("SCRIPTDEBUG_CMD_DETACH_TARGET"))):r===e.get("SCRIPTDEBUG_CMD_RESPONSE_ERROR")?et("OnDebugEnd: Failed :"+nt(arguments[2])):et("OnDebugEnd, unhandled cases: "+arguments[2].EncodeAsString()),Ht.call(this)};var n=tt(e.get("SCRIPTDEBUG_CMD_DETACH_TARGET")),r=P.InvokeMethod("ProcessDebugMsg",n,t)}function jt(t){if(D===!0)return;if(!P){P=SiebelApp.S_App.GetService("Template Parser Service");if(P===null){et("Failed to get Debugger Service");return}}et("OnDebugRefresh: "+e.get("SCRIPTDEBUG_CMD_REFRESH"));var r={async:!0,scope:this,npr:!0};r.cb=function(){var r=arguments[0],i=arguments[1].GetProperty(e.get("SCRIPTDEBUG_PROPERTY_CMD")),s=rt(arguments[2]);et("OnDebugRefresh: "+r+", request:"+i+", response:"+s),s===e.get("SCRIPTDEBUG_CMD_RESPONSE_SUCCESS")?n.IsTrue(t)?(et("OnDebugRefresh: AttachDebugTarget..."),Mt.call(this)):(et("OnDebugRefresh: GetNextMsg..."
),H=!0,xt.call(this)):s===e.get("SCRIPTDEBUG_CMD_RESPONSE_ERROR")?(et("OnDebugRefresh: Failed :"+nt(arguments[2])),et("Script debugging has ended."),Et.call(this,e.get("SCRIPTDEBUG_CMD_DETACH_TARGET"))):et("OnDebugRefresh, unhandled cases: "+arguments[2].EncodeAsString())};var i=tt(e.get("SCRIPTDEBUG_CMD_REFRESH"));P.InvokeMethod("ProcessDebugMsg",i,r)}function Ft(){sessionStorage.getItem(e.get("SCRIPTDEBUG_CURRENT_STATE_SESSIONACTIVE"))==="1"&&OUI_TabMessageChannel({Cmd:"LogOff"});var t=this,n=0,r=setInterval(function(){t.Get("IsInDebugging")||(clearInterval(r),It.call(t),t.SetProperty("EnableRestart",!1)),n++,n===25&&(et("Failed to start in Fix & Go"),clearInterval(r),t.SetProperty("EnableRestart",!1))},500)}function It(){Qt.call(this);if(D===!0){Z(this,"DebugRestart");return}if(!P){P=SiebelApp.S_App.GetService("Template Parser Service");if(P===null){et("Failed to get Debugger Service");return}}et("HandleDebugRestart: RouteToDebuggerService"),H=!1;var r={async:!0,scope:this,npr:!0};r.cb=function(){SiebelApp.S_App.uiStatus.Free();var r=arguments[2].GetChildByType(e.get("SWE_PROP_RESULTSET"));if(r===null){et("HandleDebugRestart: response does not have resultSet.");return}if(r.GetChild(0)===null){SiebelJS.Log("[ScriptDebugger] Please contact your Siebel Administrator for the settings of Named Subsystem DBGSVC.",!0),n.Alert(t.GetLocalString("WT_SCRIPT_DEBUGGER_CONNECT_FAIL"));return}var i=rt(arguments[2]);if(i===e.get("SCRIPTDEBUG_CMD_RESPONSE_ERROR")){et("HandleDebugRestart: Failed to execute: RouteToDebuggerService: "+nt(arguments[2]));return}this.SetProperty("SessionTimeout",arguments[2].GetProperty(e.get("SWE_PROP_SESSION_TIMEOUT"))||""),et("HandleDebugRestart: got "+e.get("SWE_PROP_SESSION_TIMEOUT")+" = "+this.Get("SessionTimeout"));var s=r.GetChild(0),o=!1,u=null,a;if(s===null){et("HandleDebugRestart, does not return expected response");return}for(o=!0;(u=s.EnumProperties(o))!==null;o=!1)a=s.GetProperty(u),et("HandleDebugRestart, Connect: Key = '"+u+"'; Value = '"+a+"'");R="?"+(n.IsTrue(SiebelApp.S_App.IsAutoOn())?e.get("SWE_CMD_ARG")+"=AutoOn&":"")+e.get("DEBUGGER_TYPE")+"="+e.get("SCRIPTDEBUG_SD_TYPE"),n.IsTrue(Cn.call(this,"EnableProfile"))&&(et("HandleDebugRestart, EnableProfile"),R+="&"+e.get("ENABLE_PROFILE")+"=true"),z="";var f=CCFMiscUtil_CreatePropSet();f.SetType(e.get("SCRIPTDEBUG_DATA_LIST"));var l=this.Get("DisconnectRequestPS");l.Reset();if(s!==null&&s.GetChildCount()>0){var c=s.GetChild(0);for(o=!0;(u=c.EnumProperties(o))!==null;o=!1)a=c.GetProperty(u),u==="_appname"?(U=a,et("HandleDebugRestart: got '_appname' = '"+U+"'")):u==="_lang"?(z=a.toLowerCase(),et("HandleDebugRestart: got '_lang' = '"+z+"'")):(R+="&"+u+"="+a,f.SetProperty(u,a),u==="_srvr"?l.SetProperty("DbgServerHost",a):u==="_port"?l.SetProperty("DbgServerPort",a):u==="_vdid"&&l.SetProperty("DebugID",a))}var h=!1,p=!1,d=0,m=0,g=this.Get("AppInfoArray"),y;if(n.IsEmpty(U)||n.IsEmpty(z))h=!0;for(d=0,m=g.length;d<m;d++){y=g[d];if(d===0&&h===!0){U=y.appName,z=y.langName,z=n.IsEmpty(z)?this.Get("LangName"):z,p=!0;break}if(!h&&U===y.appName&&z===y.langName){p=!0;break}}if(!p){SiebelJS.Log("[ScriptDebugger] HandleDebugRestart: Non-existing target application/language from UserPref: Application = '"+U+"'; Language = '"+z+"'",!0);if(!(g.length>0)){SiebelJS.Log("[ScriptDebugger] HandleDebugRestart: invalid target application for Script Debugger: Application = '"+U+"'; Language = '"+z+"'",!0);return}y=g[0],U=y.appName,z=y.langName,z=n.IsEmpty(z)?this.Get("LangName"):z,SiebelJS.Log("[ScriptDebugger] HandleDebugRestart: Use the first entry instead: '"+y.displayName+"' to start Script Debugging.",!0)}et("HandleDebugRestart: starting target application for Script Debugger: Application = '"+U+"'; Language = '"+z+"'"),window.sessionStorage.setItem(v,f.EncodeAsString()),qt.call(this)},F=0;var i=CCFMiscUtil_CreatePropSet();i.SetType(e.get("SCRIPTDEBUG_CMD_CONNECT")),P.InvokeMethod("RouteToDebuggerService",i,r)}function qt(){if(!P){et("Debugger Service is not available - DebugSvc is null");return}var r={async:!0,scope:this,npr:!0};r.cb=function(){var r=arguments[0],i=arguments[1].GetProperty(e.get("SCRIPTDEBUG_PROPERTY_CMD")),s=rt(arguments[2]),o=this;et("CallDbgServerReserveSession: "+r+", request:"+i+", response:"+s);if(s===e.get("SCRIPTDEBUG_CMD_RESPONSE_SUCCESS")){var u=CCFMiscUtil_CreatePropSet();u.SetProperty("SessionTimeout",this.Get("SessionTimeout")),this.ExecuteMethod("InvokeServiceMethod","SetSessionTimeout",u),Et.call(this,e.get("SCRIPTDEBUG_CMD_RESERVE_SESSION")),Ot(U,z,R),Mt.call(this)}else if(s===e.get("SCRIPTDEBUG_CMD_RESPONSE_ERROR")){et("CallDbgServerReserveSession: Failed: "+nt(arguments[2]));var a=nt(arguments[2]),f=!1;a==="HitMaxTask"&&(SiebelJS.Log("[ScriptDebugger] CallDbgServerReserveSession: Fail to reserve debugger session: "+a,!0),n.Alert(t.GetLocalString("WT_SCRIPT_DEBUGGER_RESERVE_SESSION_FAIL")),f=!0),!f&&F>=20&&(SiebelJS.Log("[ScriptDebugger] CallDbgServerReserveSession: Fail to reserve debugger session after "+F+" tries.",!0),n.Alert(t.GetLocalString("WT_SCRIPT_DEBUGGER_CONNECT_FAIL")),f=!0);if(f){Et.call(this,e.get("SCRIPTDEBUG_CMD_DETACH_TARGET")),Ht.call(this);return}F++,setTimeout(function(){SiebelJS.Log("[ScriptDebugger] CallDbgServerReserveSession: retry: "+F,!0),qt.call(o)},500+F*50)}else et("CallDbgServerReserveSession, unhandled cases: "+arguments[2].EncodeAsString())};var i=tt(e.get("SCRIPTDEBUG_CMD_RESERVE_SESSION"));et("CallDbgServerReserveSession: "+e.get("SCRIPTDEBUG_CMD_RESERVE_SESSION")),P.InvokeMethod("ProcessDebugMsg",i,r)}function Rt(){this.Get("IsInDebugging")?Pt.call(this):It.call(this)}function Ut(){if(D===!0)return;if(!P){et("Debugger Service is not available - DebugSvc is null");return}et("OnDebugStepInto: "+e.get("SCRIPTDEBUG_CMD_STEPIN")),Et.call(this,e.get("SCRIPTDEBUG_CMD_STEPIN"),S);var t={async:!0,scope:this,npr:!0,cb:St},n=tt(e.get("SCRIPTDEBUG_CMD_STEPIN"));P.InvokeMethod("ProcessDebugMsg",n,t)}function zt(){if(D===!0){Z(this,"DebugStepOver");return}if(!P){et("Debugger Service is not available - DebugSvc is null"
);return}et("OnDebugStepOver: "+e.get("SCRIPTDEBUG_CMD_STEPOVER")),Et.call(this,e.get("SCRIPTDEBUG_CMD_STEPOVER"),S);var t={async:!0,scope:this,npr:!0,cb:St},n=tt(e.get("SCRIPTDEBUG_CMD_STEPOVER"));P.InvokeMethod("ProcessDebugMsg",n,t)}function Wt(){et("OnDebugStepToCursor: "+e.get("SCRIPTDEBUG_CMD_RUNTOLINE")),Et.call(this,e.get("SCRIPTDEBUG_CMD_RUNTOLINE"),S),this.ExecuteMethod("DebugStepToCursor")}function Xt(){}function Vt(){et("OnDebugClearAllBreakpoints"),this.ExecuteMethod("DebugClearAllBreakpoints")}function $t(){et("OnDebugToggleBreakpoint"),this.ExecuteMethod("DebugToggleBreakpoint")}function Jt(){et("OnDebugSettings"),this.ExecuteMethod("DebugSettings")}function Kt(){this.SetProperty("IsScriptDebuggerShown",!this.Get("IsScriptDebuggerShown"))}function Qt(){this.Get("IsScriptDebuggerShown")||this.SetProperty("IsScriptDebuggerShown",!0)}function Gt(){Kt.call(this)}function Yt(e){var t=CCFMiscUtil_CreatePropSet(),r=CCFMiscUtil_CreatePropSet();this.Get("IsTreeInitialLoading")&&t.SetProperty("IsTreeInitialLoading",!0);if(e){t.SetProperty("ServerScriptObjType",this.Get("DebuggerTreeServerScriptObjType")),t.SetProperty("ServerScriptObjName",this.Get("DebuggerTreeServerScriptObjName")),et("ServerScriptObjType: "+t.GetProperty("ServerScriptObjType")),et("ServerScriptObjName: "+t.GetProperty("ServerScriptObjName"));if(!this.ExecuteMethod("InvokeServiceMethod","GetDebuggerTreeData",t,r))return}else{if(!this.ExecuteMethod("InvokeServiceMethod","GetTreeData",t,r))return;this.SetProperty("ScriptObjType",r.GetProperty("ScriptNodeTitle")),this.SetProperty("ScriptObjName",r.GetProperty("ScriptObjName")),this.SetProperty("InactiveLabelServer",r.GetProperty("InactiveLabel"))}var i=r.GetProperty("ScriptEditable"),s=r.GetProperty("ScriptLangType"),o=r.GetChildByType("ScriptTreeData"),u=r.GetProperty("EnableScriptValidation");return!n.IsEmpty(i)&&i==="Y"?this.SetProperty("ScriptEditable",!0):this.SetProperty("ScriptEditable",!1),n.IsEmpty(s)?this.SetProperty("ScriptLangType",""):this.SetProperty("ScriptLangType",s),!n.IsEmpty(u)&&u==="Y"?this.SetProperty("EnableScriptValidation",!0):this.SetProperty("EnableScriptValidation",!1),o}function Zt(e){var t=CCFMiscUtil_CreatePropSet(),r=CCFMiscUtil_CreatePropSet();n.IsEmpty(e)&&(e="JS"),t.SetProperty("ScriptLangType",e);if(this.ExecuteMethod("InvokeServiceMethod","SetScriptLang",t,r))return r}function en(e,t){SiebelJS.Debug("UpdateLineProfileRule:"+e+":"+t),e.trim();if(e==="")return;var n=nn.call(this),r="",i;for(i=0;i<n.length;i++)r+=n[i],r+=", ";SiebelJS.Debug("UpdateLineProfileRule: existing rule: "+r);var s=-1;for(i=0;i<n.length;i++)if(n[i]===e){s=i;break}if(t)s===-1&&(n[n.length]=e,s=n.length-1);else if(s!==-1){n[s]="";for(i=s;i<n.length-1;i++)n[i]=n[i+1];n.length-=1}r="";for(i=0;i<n.length;i++)r+=n[i],r+=", ";SiebelJS.Debug("UpdateLineProfileRule: updated rule: "+r),s!==-1&&tn.call(this,n)}function tn(e){if(W>0){var t=nn.call(this),n=[],r=[],i,s,o,u=0;for(s=0;s<e.length;s++){o=!0;for(i=0;i<t.length;i++)if(e[s]===t[i]){o=!1;break}o===!0&&(n[u++]=e[s])}u=0;for(i=0;i<t.length;i++){o=!0;for(s=0;s<e.length;s++)if(e[s]===t[i]){o=!1;break}o===!0&&(r[u++]=t[i])}for(u=0;u<n.length;u++)gt(n[u]);for(u=0;u<r.length;u++)yt(r[u])}var a=CCFMiscUtil_CreatePropSet(),f=CCFMiscUtil_CreatePropSet(),l=CCFMiscUtil_ArrayToString(e);a.SetProperty("ProfileRules",l);if(this.ExecuteMethod("InvokeServiceMethod","SetLineProfileRules",a,f))return f}function nn(){var e=CCFMiscUtil_CreatePropSet(),t=CCFMiscUtil_CreatePropSet();if(this.ExecuteMethod("InvokeServiceMethod","GetLineProfileRules",e,t)){var n=t.GetProperty("ProfileRules"),r=[];return CCFMiscUtil_StringToArray(n,r),r}}function rn(e,t){var r=CCFMiscUtil_CreatePropSet(),i=CCFMiscUtil_CreatePropSet();n.IsEmpty(e)||r.SetProperty("EventName",e),!n.IsEmpty(t)&&t.eventType&&r.SetProperty("EventType",t.eventType);var s=this.Get("ScriptLangType");n.IsEmpty(s)&&(s="JS"),s!=="JS"&&(s="SBL");var o,u=!1;!n.IsEmpty(t)&&t.isScriptDebugger?(o="GetDebuggerEventData",u=!0,t.scriptObjType&&t.scriptObjName?(r.SetProperty("ServerScriptObjType",t.scriptObjType),r.SetProperty("ServerScriptObjName",t.scriptObjName),n.IsEmpty(t.scriptLang)?r.SetProperty("ScriptLangType",s):r.SetProperty("ScriptLangType",t.scriptLang)):(r.SetProperty("ServerScriptObjType",this.Get("DebuggerTreeServerScriptObjType")),r.SetProperty("ServerScriptObjName",this.Get("DebuggerTreeServerScriptObjName")),r.SetProperty("ScriptLangType",s))):(o="GetEventData",r.SetProperty("ScriptLangType",s));if(this.ExecuteMethod("InvokeServiceMethod",o,r,i)){i.GetProperty("EventExist")!=="Y"&&this.Get("ScriptEditable")===!1&&i.SetProperty("EventData",""),this.SetProperty("ActiveEventInactive",i.GetProperty("inactive")==="true"?!0:!1),this.SetProperty("ActiveEventEditable",!0),this.SetProperty("ActiveEventExistInDB",i.GetProperty("EventExist")==="Y"?!0:!1),this.SetProperty("ActiveEventName",i.GetProperty("EventName")),this.SetProperty("ActiveEventData",i.GetProperty("EventData")),u&&this.SetProperty("ActiveEventScriptLangType",i.GetProperty("ScriptLangType"));var a=i.GetProperty("BPLines"),f=[];n.IsEmpty(a)||(CCFMiscUtil_StringToArray(a,f),f.sort(function(e,t){return e-t})),this.SetProperty("EventBPLineArray",f)}else this.SetProperty("ActiveEventInactive",!1),this.SetProperty("ActiveEventEditable",!1),this.SetProperty("ActiveEventExistInDB",!1),this.SetProperty("ActiveEventName",e),this.SetProperty("ActiveEventData",""),this.SetProperty("EventBPLineArray",[]);SiebelJS.Debug("[ScriptEditorPM] GetEventData - '"+this.Get("ActiveEventName")+"'; BPLineArray = '"+this.Get("EventBPLineArray")+"'",!0)}function sn(e){SiebelJS.Debug("[ScriptEditorPM] SetEventState: Inactive = '"+e+"'",!0);var t=CCFMiscUtil_CreatePropSet(),r=CCFMiscUtil_CreatePropSet(),i=this.Get("ActiveEventName");t.SetProperty("EventName",i),t.SetProperty("EventStateInactive",e?"Y":"N"),t.SetProperty("EventType",this.Get("ActiveEventType"));var s=this.Get("ScriptLangType");s==="JS"||n.IsEmpty(s)?t.SetProperty("ScriptLangType","JS")
:t.SetProperty("ScriptLangType","SBL");if(this.ExecuteMethod("InvokeServiceMethod","SetEventState",t,r)){un.call(this),this.SetProperty("ActiveEventInactive",e);var o="UpdateScriptState",u=CCFMiscUtil_CreatePropSet();return u.SetProperty("Key",i),u.SetProperty("Operation",o),u.SetProperty("ActiveEventInactive",e),this.ExecuteMethod("UpdateTreeNode",u),this.Get("ScriptObjType").substr(0,j.length)!==j&&SiebelApp.EventManager.fireEvent("refreshScriptDebuggerScriptData",{scriptObjType:this.Get("ScriptObjType"),scriptObjName:this.Get("ScriptObjName"),eventName:i,eventStateInactive:e,operation:o}),!0}return!1}function on(e,t){SiebelJS.Debug("[ScriptEditorPM] PostScriptEditorChanges",!0);var r=CCFMiscUtil_CreatePropSet(),i=CCFMiscUtil_CreatePropSet(),s=this.Get("ActiveEventName");r.SetProperty("EventName",s),r.SetProperty("EventData",e),r.SetProperty("NewEventName",t),r.SetProperty("EventType",this.Get("ActiveEventType"));var o=this.Get("ScriptLangType");o==="JS"||n.IsEmpty(o)?r.SetProperty("ScriptLangType","JS"):r.SetProperty("ScriptLangType","SBL"),un.call(this);if(this.ExecuteMethod("InvokeServiceMethod","SetEventData",r,i)){var u=i.GetProperty("Operation"),a=i.GetProperty("EventData");u==="DeleteRecord"&&n.IsEmpty(e)?this.SetProperty("ActiveEventData",a):n.IsEmpty(a)?this.SetProperty("ActiveEventData",e):this.SetProperty("ActiveEventData",a),u==="NewRecord"||u==="DeleteRecord"?(this.SetProperty("ActiveEventExistInDB",u==="NewRecord"?!0:!1),this.SetProperty("ActiveEventInactive",!1),this.ExecuteMethod("SetScriptState",!1)):this.SetProperty("ActiveEventExistInDB",!0),s!==t&&!n.IsEmpty(t)&&this.SetProperty("ActiveEventName",t),this.Get("ScriptObjType").substr(0,j.length)!==j&&SiebelApp.EventManager.fireEvent("refreshScriptDebuggerScriptData",{scriptObjType:this.Get("ScriptObjType"),scriptObjName:this.Get("ScriptObjName"),eventName:this.Get("ActiveEventName"),eventData:this.Get("ActiveEventData"),eventNameOrig:s,operation:u});var f=CCFMiscUtil_CreatePropSet();return f.SetProperty("Key",this.Get("ActiveEventName")),f.SetProperty("KeyOrig",s),f.SetProperty("Operation",u),this.ExecuteMethod("UpdateTreeNode",f),fn.call(this,i,!0),u}}function un(){this.Get("FixAndGo")&&SiebelApp.S_App.GetScriptDebuggerMgr().CanInvokeMethod("DebugByteCode")&&SiebelApp.S_App.GetScriptDebuggerMgr().InvokeMethod("DebugByteCode")}function an(e){var t=CCFMiscUtil_CreatePropSet(),r=CCFMiscUtil_CreatePropSet();if(e===!1){if(!this.Get("ActiveEventExistInDB"))return;t.SetProperty("EventName",this.Get("ActiveEventName"))}var i=this.Get("ScriptLangType");i==="JS"||n.IsEmpty(i)?t.SetProperty("ScriptLangType","JS"):t.SetProperty("ScriptLangType","SBL"),this.ExecuteMethod("InvokeServiceMethod","ValidateScriptData",t,r)&&fn.call(this,r)}function fn(e,r){var i=e.GetProperty("Messages"),s=e.GetProperty("MessageLines");if(!n.IsEmpty(i)&&!n.IsEmpty(s)){var o=e.GetProperty("MessageType"),u=e.GetProperty("EventNames"),a=e.GetProperty("EventLineCounts"),f=[],l=[],c=[],h=[];CCFMiscUtil_StringToArray(i,f),CCFMiscUtil_StringToArray(s,l),CCFMiscUtil_StringToArray(u,c),CCFMiscUtil_StringToArray(a,h);var p={};p.type=o,p.messages=f,p.messageLines=l,p.eventNames=c,p.eventLineCounts=h,this.ExecuteMethod("ProcessScriptValidationInfo",p,r)}else n.IsTrue(r)||n.Alert(t.GetLocalString("WT_SCRIPT_EDITOR_CHECK_SYNTAX_FINISH_OK"))}function ln(e,t,r,i,s){var o=CCFMiscUtil_CreatePropSet(),u=CCFMiscUtil_CreatePropSet(),a=this.Get("ScriptLangType");return a==="JS"||n.IsEmpty(a)?o.SetProperty("ScriptLangType","JS"):o.SetProperty("ScriptLangType","SBL"),o.SetProperty("EventData",e),o.SetProperty("CurrentRow",t),o.SetProperty("CurrentColumn",r),o.SetProperty("AutoComplete",i),o.SetProperty("LeftParen",s),this.ExecuteMethod("InvokeServiceMethod","GetAssistant",o,u)?u:""}function cn(e,t){var n=CCFMiscUtil_CreatePropSet(),r=CCFMiscUtil_CreatePropSet();return n.SetProperty("OptionName",e),n.SetProperty("OptionType",t),this.ExecuteMethod("InvokeServiceMethod","AddFavorite",n,r)?r:""}function hn(e,t){return e+" ["+t+"]"}function pn(t,r,i,s){var o=s?"ToggleBreakpoint":"RunToLine",u=CCFMiscUtil_CreatePropSet(),a=CCFMiscUtil_CreatePropSet(),f=r.toString(),l=!1;u.SetProperty("EventName",t),u.SetProperty("BPLine",f),SiebelJS.Debug("[ScriptEditorPM] ToggleBreakpoint - EventName = '"+t+"'; BPLine = '"+f+"'; Action = '"+o+"'",!0),!n.IsEmpty(i)&&i.isScriptDebugger?(u.SetProperty("IsScriptDebugger",!0),u.SetProperty("ServerScriptObjType",i.scriptObjType),u.SetProperty("ServerScriptObjName",i.scriptObjName),this.Get("ActiveEventName")===t&&this.Get("ActiveEventScriptObjType")===i.scriptObjType&&this.Get("ActiveEventScriptObjName")===i.scriptObjName&&(l=!0)):l=!0;if(s&&l){var c=this.Get("EventBPLineArray");SiebelJS.Debug("[ScriptEditorPM] EventBreakpoints - Before: '"+t+"'; BPLineArray = '"+c+"'",!0);var h=c.indexOf(f);h>-1?c.splice(h,1):(c.push(f),c.sort(function(e,t){return e-t})),this.SetProperty("EventBPLineArray",c),SiebelJS.Debug("[ScriptEditorPM] EventBreakpoints - After: '"+t+"'; BPLineArray = '"+c+"'",!0)}if(this.ExecuteMethod("InvokeServiceMethod",o,u,a)){var p=a.GetProperty("Enabled"),d=a.GetProperty("DebugLineNum"),v=a.GetProperty("ScriptLib"),m=a.GetProperty("DisplayName");et(o+": "+m+":"+p+":"+d+":"+v);if(D===!0)return;if(H===!1){et("Not in debugging mode. Just do the update at debug client.");return}if(!P){et("Debugger Service is not available - DebugSvc is null");return}var g={async:!0,scope:this,npr:!0,cb:St},y=n.IsTrue(Cn.call(this,"AdjustToValidLine"))?"1":"0",b;if(s){b=tt(e.get("SCRIPTDEBUG_CMD_SETONEBP"));var w=CCFMiscUtil_CreatePropSet();w.SetType(e.get("SCRIPTDEBUG_DATA_LIST"));var E=CCFMiscUtil_CreatePropSet();E.SetType(m+"_"+v),E.SetProperty(e.get("SCRIPTDEBUG_DATA_LINENUMBER"),d),E.SetProperty(e.get("SCRIPTDEBUG_DATA_SET_BP"),p),E.SetProperty(e.get("SCRIPTDEBUG_DATA_CA"),p==="1"?y:"0"),w.AddChild(E),b.AddChild(w),et(o+": "+e.get("SCRIPTDEBUG_CMD_SETONEBP")+":"+b.EncodeAsString())}else{b=tt(e.get("SCRIPTDEBUG_CMD_RUNTOLINE")),b.SetProperty(e.get("SCRIPTDEBUG_DATA_SCRIPTLIB"
),v),b.SetProperty(e.get("SCRIPTDEBUG_DATA_OBJECT"),m),b.SetProperty(e.get("SCRIPTDEBUG_DATA_LINENUMBER"),d),b.SetProperty(e.get("SCRIPTDEBUG_DATA_CA"),y),et(o+": "+e.get("SCRIPTDEBUG_CMD_RUNTOLINE")+":"+b.EncodeAsString()),Tt.call(this);var S=tt(e.get("SCRIPTDEBUG_CMD_SETONEBP")),x=CCFMiscUtil_CreatePropSet();x.SetType(e.get("SCRIPTDEBUG_DATA_LIST"));var T=CCFMiscUtil_CreatePropSet();T.SetType(m+"_"+v),T.SetProperty(e.get("SCRIPTDEBUG_DATA_LINENUMBER"),d),T.SetProperty(e.get("SCRIPTDEBUG_DATA_SET_BP"),"0"),T.SetProperty(e.get("SCRIPTDEBUG_DATA_CA"),"0"),x.AddChild(T),S.AddChild(x),this.SetProperty("ClearRunToLineBP",S)}return P.InvokeMethod("ProcessDebugMsg",b,g),a}return""}function dn(e,t,r){var i=!1,s=CCFMiscUtil_CreatePropSet(),o=CCFMiscUtil_CreatePropSet();return SiebelJS.Debug("[ScriptEditorPM] ResetBreakpoints - '"+e+"'; BPLineArray = '"+t+"'",!0),this.SetProperty("EventBPLineArray",t),s.SetProperty("EventName",e),s.SetProperty("BPLines",CCFMiscUtil_ArrayToString(t)),!n.IsEmpty(r)&&r.isScriptDebugger&&(i=!0,s.SetProperty("IsScriptDebugger",i),s.SetProperty("ServerScriptObjType",r.scriptObjType),s.SetProperty("ServerScriptObjName",r.scriptObjName)),this.ExecuteMethod("InvokeServiceMethod","ResetBreakpoints",s,o)?(!i&&this.Get("ScriptObjType").substr(0,j.length)!==j&&SiebelApp.EventManager.fireEvent("refreshScriptDebuggerBreakpoints",{scriptObjType:this.Get("ScriptObjType"),scriptObjName:this.Get("ScriptObjName"),eventName:this.Get("ActiveEventName"),bpLineArr:this.Get("EventBPLineArray")}),o):""}function vn(t){SiebelJS.Debug("[ScriptEditorPM] ClearAllBreakpoints",!0),this.SetProperty("EventBPLineArray",[]);if(this.ExecuteMethod("InvokeServiceMethod","ClearAllBreakpoints")){if(D===!0)return;if(H===!1){et("Not in debugging mode. Just do the update at debug client.");return}if(!P){et("Debugger Service is not available - DebugSvc is null");return}et("ClearAllBreakpoints: "+e.get("SCRIPTDEBUG_CMD_CLEARALLBREAKPOINT"));var n={async:!0,scope:this,npr:!0,cb:St},r=tt(e.get("SCRIPTDEBUG_CMD_CLEARALLBREAKPOINT"));P.InvokeMethod("ProcessDebugMsg",r,n)}}function mn(e){var t=CCFMiscUtil_CreatePropSet(),r=CCFMiscUtil_CreatePropSet();SiebelJS.Debug("[ScriptEditorPM] ClearAllScriptObjBreakpoints",!0),this.SetProperty("EventBPLineArray",[]),!n.IsEmpty(e)&&e.isScriptDebugger&&(t.SetProperty("IsScriptDebugger",!0),t.SetProperty("ServerScriptObjType",e.scriptObjType),t.SetProperty("ServerScriptObjName",e.scriptObjName)),this.ExecuteMethod("InvokeServiceMethod","ResetBreakpoints",t,r)}function gn(){var e=CCFMiscUtil_CreatePropSet(),t=CCFMiscUtil_CreatePropSet(),n=[];if(this.ExecuteMethod("InvokeServiceMethod","GetApplicationList",e,t)){var r=t.GetProperty("ApplicationList");CCFMiscUtil_StringToArray(r,n)}return n.length===0||n[0]===""?n[0]=i:n[0]!==i&&n.unshift(i),n}function yn(){var e=CCFMiscUtil_CreatePropSet(),t=CCFMiscUtil_CreatePropSet(),r=[];if(n.IsEmpty(this.Get("AppName"))){var i=SiebelApp.S_App.GetPageURL(),s,o;i.slice(-1)==="/"&&(i=i.slice(0,-1)),o=i.split("/"),i=o[o.length-2],s=o[o.length-1],this.SetProperty("AppName",i),this.SetProperty("LangName",s),et("AppName from PageURL: "+this.Get("AppName")),et("LangName from PageURL: "+this.Get("LangName"))}e.SetProperty("IsScriptDebugger",!0);if(this.ExecuteMethod("InvokeServiceMethod","GetTargetApplicationList",e,t)){for(var u=0,a=t.GetChildCount();u<a;u++){var f=t.GetChild(u),l=f.GetType();l==="ActiveApp"&&f.GetProperty("Name")!==this.Get("AppName")&&r.push({displayName:f.GetProperty("AppLang"),appName:f.GetProperty("Name"),langName:f.GetProperty("Lang")})}r.sort(function(e,t){return e.displayName.localeCompare(t.displayName)})}return r}function bn(){var e=CCFMiscUtil_CreatePropSet(),t=CCFMiscUtil_CreatePropSet();return this.ExecuteMethod("InvokeServiceMethod","SetAppOptions",e,t)?t:""}function wn(){var t=CCFMiscUtil_CreatePropSet(),n=CCFMiscUtil_CreatePropSet(),s=i;return t.SetProperty(r,""),this.ExecuteMethod("InvokeServiceMethod","GetPreferences",t,n,e.get("SWE_OUI_CLIENT_PREF_SERVICE"))&&(s=n.GetProperty(r)),s}function En(t){var n=CCFMiscUtil_CreatePropSet();n.SetProperty(r,t),this.ExecuteMethod("InvokeServiceMethod","SetPreferences",n,null,e.get("SWE_OUI_CLIENT_PREF_SERVICE"))}function Sn(e){return f[e]}function xn(){var t=CCFMiscUtil_CreatePropSet(),r=CCFMiscUtil_CreatePropSet(),i={},s,o,f=0,l=a.length;for(f=0;f<l;f++)t.SetProperty(u+"/"+a[f].name,"");if(this.ExecuteMethod("InvokeServiceMethod","GetPreferences",t,r,e.get("SWE_OUI_CLIENT_PREF_SERVICE")))for(f=0;f<l;f++)s=a[f].name,o=r.GetProperty(u+"/"+s),a[f].type==="boolean"?o=n.IsEmpty(o)?a[f].default_val:n.IsTrue(o):a[f].type==="integer"?o=isNaN(parseInt(o,10))?a[f].default_val:parseInt(o,10):o=n.IsEmpty(o)?a[f].default_val:o,i[s]=a[f],i[s].value=o,h[s]===!0&&this.SetProperty(s,i[s].value);else for(f=0;f<l;f++)s=a[f].name,i[s]=a[f],i[s].value=a[f].default_val,h[s]===!0&&this.SetProperty(s,i[s].value);return i}function Tn(t,n){var r=CCFMiscUtil_CreatePropSet();r.SetProperty(u+"/"+t,n),this.ExecuteMethod("InvokeServiceMethod","SetPreferences",r,null,e.get("SWE_OUI_CLIENT_PREF_SERVICE")),h[t]===!0&&this.SetProperty(t,n)}function Nn(t,n){var r=CCFMiscUtil_CreatePropSet();r.SetProperty(p+"/"+t,n),this.ExecuteMethod("InvokeServiceMethod","SetPreferences",r,null,e.get("SWE_OUI_CLIENT_PREF_SERVICE")),h[t]===!0&&this.SetProperty(t,n)}function Cn(e){var t=kn.call(this);for(var n=0,r=t.length;n<r;n++)if(t[n].name===e)return t[n].checked;return!1}function kn(){var t=CCFMiscUtil_CreatePropSet(),r=CCFMiscUtil_CreatePropSet(),i=0,s=d.length,o,u,a;for(i=0;i<s;i++)t.SetProperty(p+"/"+d[i].name,"");if(this.ExecuteMethod("InvokeServiceMethod","GetPreferences",t,r,e.get("SWE_OUI_CLIENT_PREF_SERVICE")))for(i=0;i<s;i++)o=d[i],u=o.name,a=r.GetProperty(p+"/"+u),u!=="Application"&&u!=="Language"?(n.IsEmpty(a)&&(a=!1),o.checked=a):o.value=a;return d}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=SiebelJS.Dependency("SiebelApp.Utils"),r="Webtools/Application Context"
,i="All Applications",s="All Languages",o="ENU",u="WebToolsScriptEditor",a=[{name:"AutoCloseBrackets",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_AUTO_CLOSE_BRACKETS")},{name:"DisplayHints",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_DISPLAY_HINTS")},{name:"DisplayLineNumbers",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_DISPLAY_LINE_NUMBERS")},{name:"WrapLongLines",type:"boolean",default_val:!1,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_WRAP_LONG_LINES")},{name:"HiliteActiveLine",type:"boolean",default_val:!1,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_HILITE_ACTIVE_LINE")},{name:"MatchBrackets",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_MATCH_BRACKETS")},{name:"IndentWithTabs",type:"boolean",default_val:!1,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_INDENT_WITH_TABS")},{name:"IndentSpaces",type:"integer",default_val:4,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_INDENT_SPACES")},{name:"EnableMethodListing",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_ENABLE_METHOD_LISTING"),separator:!0,section_title:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_SCRIPT_ASSIST_TITLE")},{name:"EnableAutoComplete",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_ENABLE_AUTO_COMPLETE")},{name:"EnableFavorites",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_ENABLE_FAVORITES")},{name:"FixAndGo",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_FIX_AND_GO"),separator:!0,section_title:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_ENGINE_SETTINGS_TITLE")},{name:"DefaultLogin",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_DEFAULT_LOGIN")},{name:"EnableCompilationWarning",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_ENABLE_WARNINGS")},{name:"EnableTypeDeduction",type:"boolean",default_val:!0,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_DEDUCE_TYPES")},{name:"UseDefLangForNewScript",type:"boolean",default_val:!1,label:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_DEFAULT_SCRIPT_LANG"),separator:!0,section_title:t.GetLocalString("WT_SCRIPT_EDITOR_CONFIG_LANGUAGES_TITLE")},{name:"ServerScriptDefLang",type:"combo",default_val:"JS",options:[{name:"JS",label:"eScript"},{name:"SBL",label:"Visual Basic"}]}],f={};for(var l=0,c=a.length;l<c;l++)f[a[l].name]=a[l].type;var h={FixAndGo:!0,UseDefLangForNewScript:!0,ServerScriptDefLang:!0,DefaultLogin:!0},p="WebToolsScriptDebugger",d=[{name:"AdjustToValidLine",id:"siebui-sd-settings-adjust-valid-line",label:t.GetLocalString("WT_SCRIPT_DEBUGGER_CONFIG_ADJUST_TO_VALID_LINE")},{name:"EnterDebugger",id:"siebui-sd-settings-enter-debugger",label:t.GetLocalString("WT_SCRIPT_DEBUGGER_CONFIG_ENTER_DEBUGGER")},{name:"ActiveDebuggerWindow",id:"siebui-sd-settings-active-debugger-windows",label:t.GetLocalString("WT_SCRIPT_DEBUGGER_CONFIG_ACTIVE_DEUBGER_WINDOW")},{name:"EnableProfile",id:"siebui-sd-settings-enable-profile",label:t.GetLocalString("WT_SCRIPT_DEBUGGER_CONFIG_ENABLE_PROFILE")},{name:"Application",id:"siebui-sd-settings-application",label:t.GetLocalString("WT_SCRIPT_DEBUGGER_APPLICATION_TITLE")},{name:"Language",id:"siebui-sd-settings-language",label:t.GetLocalString("IDS_SEARCH_OUI_SRCH_PREF_QUERY_LANG")}],v=e.get("SCRIPTDEBUG_PROP_ATTACH_TARGET_PROPSET_STR"),m=e.get("SCRIPTDEBUG_PROP_CALL_STACK"),g=e.get("SCRIPTDEBUG_PROP_ERRORS"),y=e.get("SCRIPTDEBUG_PROP_WATCH"),b=e.get("SCRIPTDEBUG_PROP_DEBUG_STATE"),w=e.get("SCRIPTDEBUG_STATE_INIT"),E=e.get("SCRIPTDEBUG_STATE_STARTING"),S=e.get("SCRIPTDEBUG_STATE_RUNNING"),x=e.get("SCRIPTDEBUG_STATE_BREAK"),T=0,N=1,C=2,k=3,L=4,A=5,O=6,M=7,_=8,D=!1,P=null,H=!1,B=!1,j="Browser",F=0,I=0,q=0,R,U,z="enu",W=0,X={},V={};SiebelJS.Extend(J,SiebelAppFacade.PresentationModel),J.prototype.Init=function(){SiebelAppFacade.ScriptEditorPM.superclass.Init.apply(this,arguments),this.AddProperty("EnableAttachingScriptEditorPW",!0),this.AddProperty("FixAndGo",!0),this.AddProperty("DefaultLogin",!0),this.AddProperty("UseDefLangForNewScript",!1),this.AddProperty("ServerScriptDefLang","JS"),this.AddProperty("ScriptObjType",""),this.AddProperty("ScriptObjName",""),this.AddProperty("ScriptLangType",""),this.AddProperty("ScriptEditable",!1),this.AddProperty("InactiveLabelServer",""),this.AddProperty("ActiveEventInactive",!1),this.AddProperty("ActiveEventEditable",!1),this.AddProperty("ActiveEventExistInDB",!1),this.AddProperty("ActiveEventName",""),this.AddProperty("ActiveEventType",""),this.AddProperty("ActiveEventData",""),this.AddProperty("BreakpointGutterEnabled",!0),this.AddProperty("EnableScriptValidation",!0),this.AddProperty("EnableRestart",!1),this.AddProperty("EventBPLineArray",[]),this.AddProperty("IsTreeInitialLoading",!1),this.AddMethod("SetEventState",sn),this.AddMethod("SetScriptState",function(e){}),this.AddMethod("GetApplicationArray",gn),this.AddMethod("SetAppOptions",bn),this.AddMethod("GetApplicationContextPrefrence",wn),this.AddMethod("SetApplicationContextPrefrence",En),this.AddMethod("GetUserPrefrenceType",Sn),this.AddMethod("GetEditorPrefrences",xn),this.AddMethod("SetEditorPrefrence",Tn),this.AddMethod("GetDebuggerPrefrence",kn),this.AddMethod("SetDebuggerPrefrence",Nn),this.AddMethod("SetScriptLang",Zt),this.AddMethod("SetLineProfileRules",tn),this.AddMethod("UpdateLineProfileRule",en),this.AddMethod("GetLineProfileRules",nn),this.AddMethod("GetTreeData",Yt),this.AddMethod("GetEventData",rn),this.AddMethod("PostScriptEditorChanges",on),this.AddMethod("UpdateTreeNode",function(e){}),this.AddMethod("ValidateScriptData",an),this.AddMethod("ProcessScriptValidationInfo",function(e,t){}),this.AddMethod("GetAssistant",ln),this.AddMethod("AddFavorite",cn),this.AddMethod("ToggleBreakpoint",pn),this.AddMethod("ResetBreakpoints",dn),this.AddMethod("ClearAllBreakpoints",vn),this.AddProperty("ScriptObjectTreeId","ScriptEditorTree")
,this.AddProperty("IsScriptDebugger",!1),this.AddProperty("IsScriptDebuggerShown",!1),this.AddProperty("IsScriptDebuggerDocked",!0),this.AddProperty("IsDebuggerPanelHideInShow",!1),this.AddProperty("IsInDebugging",!1),this.AddProperty("ProfileState",W),this.AddProperty("ProfileNodes",V),this.AddProperty("SessionTimeout",""),this.AddProperty(b,w),this.AddProperty("IsInRefresh",!1),this.AddProperty("AppInfoArray",[]),this.AddProperty("AppName",null),this.AddProperty("LangName",null),this.AddProperty("DisconnectRequestPS",SiebelApp.S_App.NewPropertySet()),this.AddProperty("ActiveEventScriptObjType",""),this.AddProperty("ActiveEventScriptObjName",""),this.AddProperty("ActiveEventScriptLangType",""),this.AddProperty("DebuggerTreeServerScriptObjType",null),this.AddProperty("DebuggerTreeServerScriptObjName",null),this.AddProperty("DebuggerTreeServerScriptObjTypeToNames",{}),this.AddProperty("ClearRunToLineBP",null),this.AddMethod("GetTargetApplicationArray",yn),this.AddMethod("CanInvokeDebugMethod",Q),this.AddMethod("InvokeDebugMethod",Y),this.AddMethod("NotifyDebugStateChanged",function(){}),this.AddMethod("DebugToggleBreakpoint",function(e){}),this.AddMethod("DebugSettings",function(e){}),this.AddMethod("DebugStepToCursor",function(e){}),this.AddMethod("DebugClearAllBreakpoints",function(){}),this.AddMethod("DebugClearAllScriptObjBreakpoints",function(e,t){}),this.AddMethod("SetDebugDataWindowState",function(e,t){if(this.Get("IsInRefresh"))return;window.sessionStorage.setItem("ScriptDebug_"+e+"_Expanded",!n.IsTrue(t)),et("SetDebugDataWindowState: Session ScriptDebug_"+e+"_Expanded = '"+!n.IsTrue(t)+"'")}),this.AddMethod("RemoveWatchData",function(){window.sessionStorage.removeItem(y)}),this.AddMethod("RemoveScriptCallData",function(){window.sessionStorage.removeItem(m)}),this.AddMethod("RemoveErrorData",function(){window.sessionStorage.removeItem(g)}),this.AddMethod("SetWatchData",function(e){if(this.Get("IsInRefresh"))return;var t=e.EncodeAsString();et("SetWatchData: Session Watch Data = '"+t+"'"),window.sessionStorage.setItem(y,t)}),this.AddMethod("SetScriptCallData",function(e){if(this.Get("IsInRefresh"))return;var t=e.EncodeAsString();et("SetScriptCallData: Session CallStack Data = '"+t+"'"),window.sessionStorage.setItem(m,t)}),this.AddMethod("AddErrorData",function(t){if(this.Get("IsInRefresh"))return;if(n.IsEmpty(t)||t.GetPropertyCount()===0)return;var r=window.sessionStorage.getItem(g);et("AddErrorData: Session Old Error Data = '"+r+"'");var i=CCFMiscUtil_CreatePropSet();n.IsEmpty(r)?i.SetType(e.get("SCRIPTDEBUG_DATA_ERR")):i.DecodeFromString(r);var s=i.GetPropertyCount();for(var o=0,u=t.GetPropertyCount();o<u;o++)i.SetProperty(""+(o+s),t.GetProperty(""+o));r=i.EncodeAsString(),window.sessionStorage.setItem(g,r),et("AddErrorData: Session Error Data = '"+r+"'")}),this.AddMethod("ApplyDebugServerBP",function(e){}),this.AddMethod("NotifyBreakpointHit",function(){}),this.AddMethod("AutoStartScriptDebugging",function(){}),this.AttachEventHandler("ScriptDebuggerClose",Gt),this.AddMethod("OpenDebuggerPanel",function(){if(this.Get("IsInRefresh"))return;this.ExecuteMethod("InvokeServiceMethod","OpenDebuggerPanel")}),this.AddMethod("CloseDebuggerPanel",function(){if(this.Get("IsInRefresh"))return;this.ExecuteMethod("InvokeServiceMethod","CloseDebuggerPanel")}),this.AddMethod("DockDebuggerPanel",function(){if(this.Get("IsInRefresh"))return;this.ExecuteMethod("InvokeServiceMethod","DockDebuggerPanel")}),this.AddMethod("UndockDebuggerPanel",function(){if(this.Get("IsInRefresh"))return;this.ExecuteMethod("InvokeServiceMethod","UndockDebuggerPanel")}),this.AddMethod("NotifyDebugTreeRefresh",function(e){}),this.AddMethod("SetDebugRefresh",function(e){jt.call(this,e)}),this.AddMethod("SetDebugStart",function(){this.ExecuteMethod("InvokeServiceMethod","SetDebugStart")}),this.AddMethod("SetDebugEnd",function(){this.ExecuteMethod("InvokeServiceMethod","SetDebugEnd")}),this.AddMethod("SetDebugState",wt),this.AddMethod("NotifyExpandDataWindow",function(e){}),this.AddMethod("SetActiveTab",function(e){}),this.AddMethod("ShowProfileWindow",function(e){}),this.AddMethod("UpdateProfileWindow",function(e){}),this.AddMethod("RefreshProfileWindow",function(){}),this.AddMethod("RefreshProfile",G),this.AddMethod("InvokeServiceMethod",function(t,r,i,s){s||(s="Script Editor UI Service");var o=SiebelApp.S_App.GetService(s);if(o){r||(r=CCFMiscUtil_CreatePropSet()),SiebelJS.Debug('[ScriptEditorPM] Invoking "'+s+'" - "'+t+'" ...',!0);var u=o.InvokeMethod(t,r);SiebelJS.Debug('[ScriptEditorPM] Done invoking "'+s+'" - "'+t+'".',!0);var a=u.GetProperty(e.get("SWE_RPC_PROP_RETURN_STATUS"));if(a!==e.get("SWE_RPC_PROP_STATUS_ERROR")&&!n.IsEmpty(a)){if(i){var f=u.GetChildByType(e.get("SWE_PROP_RESULTSET"));f&&i.DeepCopy(f)}return!0}}return!1}),this.AddMethod("InvokeMethod",K,{sequence:!0,scope:this}),this.AddMethod("WriteScriptData",function(){})},J.prototype.EndLife=function(){this.Get("IsScriptDebugger")&&(window.sessionStorage.removeItem("ScriptDebug_Type_WebApplet"),window.sessionStorage.removeItem("ScriptDebug_Type_Application"),window.sessionStorage.removeItem("ScriptDebug_Type_BusComp"),window.sessionStorage.removeItem("ScriptDebug_Type_Service"),window.sessionStorage.removeItem(v),window.sessionStorage.removeItem(b),window.sessionStorage.removeItem(y),window.sessionStorage.removeItem(m),window.sessionStorage.removeItem(g),window.sessionStorage.removeItem(y+"_Expanded"),window.sessionStorage.removeItem(m+"_Expanded"),window.sessionStorage.removeItem(g+"_Expanded"),window.sessionStorage.removeItem(e.get("SCRIPTDEBUG_CURRENT_TARGET_VIEW")),window.sessionStorage.removeItem(e.get("SCRIPTDEBUG_CURRENT_STATE_SESSIONACTIVE")),window.sessionStorage.removeItem("CallTree")),SiebelAppFacade.ScriptEditorPM.superclass.EndLife.apply(this,arguments)},J.prototype.Setup=function(t){SiebelAppFacade.ScriptEditorPM.superclass.Setup.call(this,t),this.Get("IsScriptDebugger")&&(this.SetProperty("ScriptObjectTreeId","ScriptDebuggerEditorTree"),this
.Get("IsInRefresh")||(et("Setup: Remove/Clear all Script Debugger sessionStorage items."),window.sessionStorage.removeItem("ScriptDebug_Type_WebApplet"),window.sessionStorage.removeItem("ScriptDebug_Type_Application"),window.sessionStorage.removeItem("ScriptDebug_Type_BusComp"),window.sessionStorage.removeItem("ScriptDebug_Type_Service"),window.sessionStorage.removeItem(v),window.sessionStorage.removeItem(b),window.sessionStorage.removeItem(y),window.sessionStorage.removeItem(m),window.sessionStorage.removeItem(g),window.sessionStorage.removeItem(y+"_Expanded"),window.sessionStorage.removeItem(m+"_Expanded"),window.sessionStorage.removeItem(g+"_Expanded"),window.sessionStorage.removeItem(e.get("SCRIPTDEBUG_CURRENT_TARGET_VIEW")),window.sessionStorage.removeItem(e.get("SCRIPTDEBUG_CURRENT_STATE_SESSIONACTIVE")),window.sessionStorage.removeItem("CallTree")))},J.prototype.Show=function(){SiebelAppFacade.ScriptEditorPM.superclass.Show.call(this),this.Get("IsScriptDebuggerShown")||this.SetProperty("IsScriptDebuggerShown",!this.Get("IsDebuggerPanelHideInShow"))};var Z=function(t,n){var r="WebApplet",i="Application",s="BusComp",o="Service",u=-1,a=o,f="Send AlertOnline eMail",l="Service_PreInvokeMethod",c=19;return function(t,n){var i,s,h,p=!0,d,v,m;switch(n){case"DebugRestart":t.SetProperty("IsInDebugging",!0),t.SetProperty(b,S),t.ExecuteMethod("DebugClearAllScriptObjBreakpoints",o,"Send AlertOnline eMail"),t.ExecuteMethod("DebugClearAllScriptObjBreakpoints",r,"Agreement Detail Applet"),t.ExecuteMethod("DebugClearAllScriptObjBreakpoints",r,"Quote Item List Applet"),t.ExecuteMethod("DebugToggleBreakpoint",{scriptObjType:o,scriptObjName:"Send AlertOnline eMail",eventName:"Service_PreInvokeMethod",lineNum:18}),t.ExecuteMethod("DebugToggleBreakpoint",{scriptObjType:r,scriptObjName:"Agreement Detail Applet",eventName:"WebApplet_InvokeMethod",lineNum:2}),t.ExecuteMethod("DebugToggleBreakpoint",{scriptObjType:r,scriptObjName:"Agreement Detail Applet",eventName:"syncAgreementLineswithOracle",lineNum:56}),t.ExecuteMethod("DebugToggleBreakpoint",{scriptObjType:r,scriptObjName:"Agreement Detail Applet",eventName:"syncAgreementLineswithOracle",lineNum:68}),t.ExecuteMethod("DebugToggleBreakpoint",{scriptObjType:r,scriptObjName:"Quote Item List Applet",eventName:"WebApplet_InvokeMethod",lineNum:24}),t.ExecuteMethod("RemoveWatchData"),t.ExecuteMethod("RemoveScriptCallData"),t.ExecuteMethod("RemoveErrorData");return;case"DebugEnd":t.SetProperty("IsInDebugging",!1),t.SetProperty(b,w),t.ExecuteMethod("RemoveWatchData"),t.ExecuteMethod("RemoveScriptCallData");return;case"DebugBreak":t.SetProperty(b,x),i=a,s=f,h=l,u=c,d=CCFMiscUtil_CreatePropSet(),v=CCFMiscUtil_CreatePropSet(),v.SetProperty("object",i+"("+s+")"),v.SetProperty("procName",h),v.SetProperty("lineNum",u),d.InsertChildAt(v,0),v=CCFMiscUtil_CreatePropSet(),v.SetProperty("object",r+"["+"MS Quote Products List Applet"+"]"),v.SetProperty("procName","WebApplet_InvokeMethod"),v.SetProperty("lineNum",45),d.InsertChildAt(v,1),v=CCFMiscUtil_CreatePropSet(),v.SetProperty("object",o+"("+"Shipment Tracking"+")"),v.SetProperty("procName","Service_PreInvokeMethod"),v.SetProperty("lineNum",5),d.InsertChildAt(v,2),t.ExecuteMethod("RemoveErrorData");break;case"DebugContinue":t.SetProperty("IsInDebugging",!0),t.SetProperty(b,S),i=r,s="Agreement Detail Applet",h="syncAgreementLineswithOracle";var g="WebApplet_InvokeMethod",y=5;if(u===c)h=g,u=y-2,d=CCFMiscUtil_CreatePropSet(),v=CCFMiscUtil_CreatePropSet(),v.SetProperty("object",i+"("+s+")"),v.SetProperty("procName",h),v.SetProperty("lineNum",u),d.InsertChildAt(v,0),m=CCFMiscUtil_CreatePropSet(),m.SetType(e.get("SCRIPTDEBUG_DATA_ERR")),m.SetProperty("0","error 1"),m.SetProperty("1","error 2"),t.ExecuteMethod("AddErrorData",m);else if(u===y-2)u=57,d=CCFMiscUtil_CreatePropSet(),v=CCFMiscUtil_CreatePropSet(),v.SetProperty("object",i+"("+s+")"),v.SetProperty("procName",h),v.SetProperty("lineNum",u),d.InsertChildAt(v,0),v=CCFMiscUtil_CreatePropSet(),v.SetProperty("object",i+"("+s+")"),v.SetProperty("procName",g),v.SetProperty("lineNum",y),d.InsertChildAt(v,1);else if(u===57)u=69,d=CCFMiscUtil_CreatePropSet(),v=CCFMiscUtil_CreatePropSet(),v.SetProperty("object",i+"("+s+")"),v.SetProperty("procName",h),v.SetProperty("lineNum",u),d.InsertChildAt(v,0),v=CCFMiscUtil_CreatePropSet(),v.SetProperty("object",i+"("+s+")"),v.SetProperty("procName",g),v.SetProperty("lineNum",y),d.InsertChildAt(v,1);else{if(u!==69){t.ExecuteMethod("RemoveWatchData"),t.ExecuteMethod("RemoveScriptCallData");return}i=r,s="Quote Item List Applet",h="WebApplet_InvokeMethod",u=25,d=CCFMiscUtil_CreatePropSet(),v=CCFMiscUtil_CreatePropSet(),v.SetProperty("object",i+"("+s+")"),v.SetProperty("procName",h),v.SetProperty("lineNum",u),d.InsertChildAt(v,0),m=CCFMiscUtil_CreatePropSet(),m.SetType(e.get("SCRIPTDEBUG_DATA_ERR")),m.SetProperty("0","error 3"),m.SetProperty("1","error 4"),t.ExecuteMethod("AddErrorData",m)}break;case"DebugStepToCursor":p=!1;case"DebugStepOver":i=r,s="Quote Item List Applet",h="WebApplet_InvokeMethod",u===c||u===57||u===69?u=25:u===25?u=30:u===30?u=34:u===41?(i=a,s=f,h=l,u=c):u++,d=CCFMiscUtil_CreatePropSet(),v=CCFMiscUtil_CreatePropSet(),v.SetProperty("object",i+"("+s+")"),v.SetProperty("procName",h),v.SetProperty("lineNum",u),d.InsertChildAt(v,0),u===41&&(m=CCFMiscUtil_CreatePropSet(),m.SetType(e.get("SCRIPTDEBUG_DATA_ERR")),m.SetProperty("0","last error msg"),t.ExecuteMethod("AddErrorData",m))}if(i===a){t.ExecuteMethod("RemoveWatchData");var E=CCFMiscUtil_CreatePropSet();E.DecodeFromString("@0*0*0*4*0*0*4*0*15*Local Variables0*1*a1*41*d1*41*c1*51*b1*12*0*16*Global Variables0*7*global11*67*global21*2154*0*18*Profile Attributes0*18*Is Delegated Admin1*N35*Prospect Partner Application Source0*22* Preferred Locale Code0*13*Approver Flag1*N19*Org.Main Fax Number0*18*Full Name No Space20*Siebel Administrator23*Preferred Language Code0*31*Org.Primary Division Address Id15*No Match Row Id13*EBPEnrollFlag0*29*Org.Siebel InterActive Layout0*24*Org.Parent Division Name20*Default Organization8*Org.Name21*Siebel Administration18*EnableTransferCart5*FALSE23*Primary Sub Employee Id8*04-LH3UA6*Income0*14*Last Logged In19*06/23/2018 14:38:0336*Org.Back Office Distribution Channel0*21*IsStandaloneWebClient4*TRUE19*Preferred Locale Id0*16*Org.Partner Flag1*N16*Years at Account0*21*User Responsibilities20*Siebel Administrator4*Call0*10*First Name6*Siebel8*Position20*Siebel Administrator18*EnableRecordingFor4*Both25*Org.Primary Sales Area Id0*11*Employee Id0*15*Created By Name0*39*Prospect Partner Preferred Partner Tier0*17*Org.Email Address0*13*Profile Image0*13*Active Status1*Y13*Personal City9*San Mateo19*Primary Division Id6*0-520011*Org.Country3*USA12*Is SUI Theme5*FALSE16*Responsibilities0*17*Org.Currency Code3*USD20*Dynamic Hierarchy Id9*1SIA-WQ3F10*Login Name6*SADMIN22*Educational Background0*22*Primary User Role Name20*Siebel Administrator9*User Type0*8*Industry0*7*Married0*15*Send Promotions0*24*Preferred Communications0*39*Prospect Partner Preferred Partner Type0*11*Is Employee1*Y17*Auction Privilege16*Listing Approved14*EBPPEnrollFlag0*12*Connectivity6*Online10*Birth Date0*23*Org.Assignment Excluded1*Y6*Spouse0*8*Birthday0*26*Org.Parent Organization Id0*19*Primary Position Id6*0-52209*Org.State2*CA14*Explicit Login4*TRUE16*Org.Phone Number0*9*Unit Mode5*False2*Id3*0-19*Last Name13*Administrator21*Org.Organization Flag0*20*Org.Street Address 20*6*Mobile5*false22*LOY_TXN_RULE_LOG_LEVEL0*6*BusObj7*Contact13*Platform Name7*Desktop33*Prospect Partner Application Type0*13*Previous Jobs0*5*Alias0*15*Navigation Type15*NAVIGATION_SIDE21*Primary Position Type0*14*ActiveViewName17*Contact List View12*Org.Province0*15*CreateTransItem1*Y13*Email Address17*sadmin@siebel.com3*M/M0*5*Hobby0*15*EnableRecording5*False13*Currency Code0*14*Viewport:width4*131127*Primary Personal Address Id15*No Match Row Id15*Org.Postal Code5*1998012*AutomationOn5*False14*Org.Party Name21*Siebel Administration27*Primary Account Id Internal0*13*BarcodeDriver0*18*DefaultPriceListId6*1-9J4T18*Org.Street Address11*12 Felt St.25*Is SUI_THEME Landing View5*FALSE20*Personal Postal Code5*9440319*Org.Group Type Code12*Organization12*Is Anonymous5*FALSE12*Org.Party Id6*0-520027*Primary Responsibility Name20*Siebel Administrator20*Income Exchange Date0*21*Full Name For Outlook22* Siebel  Administrator19*Org.Party Type Code12*Organization3*M/F0*15*Organization Id15*No Match Row Id11*Middle Name0*23*Org.Business Address Id15*No Match Row Id25*Send Quarterly Financials0*6*Org.Id6*0-520011*Spouse Name0*28*Org.Parent Organization Name0*8*Org.Type0*28*Primary Division Id Internal6*0-52008*IsOpenUI1*112*UMFMessageId10*0CM-1E5OAH14*UMFMessageName28*Product Offer Recommendation17*Alternate Phone #0*9*Full Name20*Siebel Administrator14*Personal State2*CA13*Input Capture5*False16*Cellular Phone #0*9*Job Title9*Sys Admin15*Employee Number0*9*Education0*10*Is Manager1*Y31*Org.Partner Manager Position Id6*0-522014*Org.Fax Number0*11*Fax Phone #0*28*Org.Partner Manager Position20*Siebel Administrator18*Primary Account Id15*No Match Row Id15*ApplicationName22*Siebel Universal Agent34*Org.Back Office Sales Organization0*8*Org.City10*Santa Rosa23*LOY_TXN_PROMO_LOG_LEVEL0*15*Send Newsletter0*21*Org.Main Phone Number0*12*Home Phone #0*9*Bulk Mode5*False22*Org.Parent Division Id6*0-R9NH25*Personal Street Address 20*18*GetJSAddBarDisable5*False47*Prospect Partner Partnership Application Status0*18*Approval Authority0*9*Alignment0*24*LOYALTY_TXN_ENHANCED_LOG1*N18*Primary Address Id8*05-LZBV323*Personal Street Address20*1855 South Grant St.10*Org.County0*24*Org.Organization BU Name0*15*Viewport:height3*7439*Time Zone0*25*Primary Responsibility Id4*0-3020*Income Currency Code0*19*Org.Organization Id6*0-R9NH16*Personal Country3*USA0*4*21*Application Variables0*0*1*6*BusObj3*8*Calendar12*0*7*BusComp3*18*Alarm Reminder VBC5*Alarm0*2*Id6*VRId-07*Comment0*19*Appt Alarm Time Min0*7*Updated19*06/23/2018 14:49:0415*MeetingLocation0*4*Type0*8*Due Date0*7*Created19*06/23/2018 14:49:0411*Description0*10*Updated By3*0-110*Created By3*0-10*2*6*BusObj3*14*ISS VOD Loader10*0*7*BusComp3*18*ISS VOD Cache Sync13*Cache Sync Id8*0V-SP72Q14*Object Type CD10*ISS_SIGNAL2*Id8*0V-SP72Q13*Last Reset DT19*05/05/2004 16:38:137*Updated19*02/06/2017 01:38:497*Created19*05/05/2004 16:38:1311*Broker Name12*ISSCTXTOBJBR16*Last Request Num3*20610*Updated By10*0CR-1G52N610*Created By8*0VC-ZUZ48*0*7*BusComp3*21*ISS VOD Cache Request14*Request Number2*7913*Cache Sync Id8*0V-SP72Q2*Id9*0V-13NEE57*Updated19*10/21/2005 03:47:357*Created19*10/21/2005 03:47:3510*Object Key17*9*0V-13NEA90*0*0*10*Updated By9*0V-10RW3D10*Created By9*0V-10RW3D0*1*6*BusObj3*38*CommSrv CM Active Agent Administration9*0*7*BusComp3*37*CommSrv CM Active Agents/Active Items2*Id9*88-1XU4264*Busy1*N5*Ready1*N10*Contact ID3*0-17*Updated19*06/23/2018 14:49:2910*Profile ID8*88-35Y537*Created19*06/23/2018 14:49:2910*Updated By3*0-110*Created By3*0-10*1*6*BusObj3*7*Contact132*0*7*BusComp3*7*Contact26*Primary Contact Address Id15*No Match Row Id11*Citizenship0*7*Is FINS1*N15*ED Enabled Flag1*Y7*Account10*test12321426*Primary Alternate Email Id15*No Match Row Id23*Primary Organization Id6*0-R9NH11*Member Flag1*N17*Primary Last Name0*9*Party UId9*88-1XU42735*Primary Personal Payment Profile Id15*No Match Row Id8*Is Agent1*N20*Primary Account Name10*test12321414*PIM Sync Owner0*20*Target Position Name20*Siebel Administrator13*Price List Id0*34*Account Primary Bill To Address Id0*10*First Name0*30*Primary Assignment Manual Flag1*N34*Account Primary Ship To Address Id0*18*Related Account Id9*88-1S8BXF13*Personal City0*50*Primary Employee Login Of Primary Contact Position6*SADMIN3*CSN9*88-1S8BXF24*Primary Personal Country3*USA10*Person UId9*88-1XU4277*Created19*06/23/2018 14:50:2021*Suppress All Mailings1*N13*Employee Flag1*N30*Protect Internal Employee Flag1*N18*Primary Student Id15*No Match Row Id17*Joined Account Id9*88-1S8BXF17*WB Personal State2*IL16*Last KeyGen Date0*13*Provider Flag1*N14*Account Number9*88-1S8BXF11*Fax Address0*21*PUB Contact Read-Only1*N26*Primary Group/Household Id15*No Match Row Id10*Contact Id10*0CR-1GQ1SJ23*Primary Product Line Id15*No Match Row Id20*Primary Specialty Id0*24*Preferred Communications0*12*Full Address49*3462 N. Lake Shore Drive, Chicago, IL, 60657, USA20*Primary Territory Id15*No Match Row Id20*First Name Last Name1* 15*Position Status6*Active19*Primary Identity Id15*No Match Row Id22*Primary Affiliation Id15*No Match Row Id50*Primary Employee Login Of Primary Company Position8*SAARUMUG19*Primary Position Id6*0-522010*Price List0*19*Primary Industry Id15*No Match Row Id2*Id9*88-1XU42721*Share Home Phone Flag0*10*Account Id9*88-1S8BXF9*Last Name0*10*Party Name4*A, A15*Primary Note Id15*No Match Row Id15*S-S Instance Id0*7*Updated19*06/23/2018 14:50:248*Brick Id15*No Match Row Id11*Owned By Id10*0CR-1GI0ZY19*Primary Security Id15*No Match Row Id13*Email Address0*3*M/M0*14*Account Row Id9*88-1S8BXF10*Row Status1*N23*Loyalty Member Type Cal0*13*Currency Code3*USD14*Street Address24*3462 N. Lake Shore Drive30*Primary Assignment System Flag1*N10*S-S Key Id0*24*Primary State License Id15*No Match Row Id20*Personal Postal Code0*24*M/M First Name Last Name2*  15*Primary Name ID15*No Match Row Id32*PUB Contact Remove All Read-Only1*N23*WB Personal Postal Code5*6065726*Primary Alternate Phone Id15*No Match Row Id19*Primary Category Id15*No Match Row Id22*Primary Opportunity Id15*No Match Row Id18*Primary First Name0*17*Loyalty Member Id0*17*Primary Specialty0*47*Primary Employee Id Of Primary Company Position8*04-LH3UA19*WB Personal Address24*3462 N. Lake Shore Drive3*M/F0*10*Since Date0*12*Work Phone #0*16*Is Life Sciences1*N11*Middle Name0*21*Primary SMS Number Id0*26*Pr Emp of Contact Pr Postn3*0-110*Updated By3*0-115*ED Deleted Flag1*N19*WB Personal Country3*USA34*CUT Address/Contact.ED_DELETED_FLG1*N47*Primary Employee Id Of Primary Contact Position3*0-114*Personal State0*4*City7*Chicago16*Cellular Phone #0*14*Master Case Id0*19*Loyalty Member Type0*9*Job Title0*5*State2*IL11*Fax Phone #0*30*Primary Assignment Denorm Flag1*N25*Primary PIM Sync Owner Id15*No Match Row Id33*Account Primary Bill To Person Id0*20*Account Partner Flag1*N12*Home Phone #0*16*WB Personal City7*Chicago16*Account Location0*15*HLS Citizenship0*9*Sales Rep6*SADMIN11*Dedup Token0*21*Primary Fax Number Id0*9*Watchlist0*16*Personal Contact1*N18*Primary Address Id6*25Z-6G22*Account Primary Market0*23*Personal Street Address0*22*Account Integration Id0*7*Country3*USA25*Primary Responsibility Id15*No Match Row Id10*Is eDealer1*N33*Account Primary Ship To Person Id0*16*Personal Country0*11*Postal Code5*6065728*Primary Service Agreement Id15*No Match Row Id10*Created By3*0-1"
),t.ExecuteMethod("SetWatchData",E)}t.ExecuteMethod("RemoveScriptCallData"),t.ExecuteMethod("SetScriptCallData",d)}}();return J.prototype.UpdateModel=function(){SiebelAppFacade.ScriptEditorPM.superclass.UpdateModel.apply(this,arguments);var t=e.get("SWE_TREE_APPLET_CTRL"),n=SiebelAppFacade.PresentationModel.GetCtrlTemplate("ScriptEditorTree","ScriptEditorTree",t,6);this.ExecuteMethod("AddClientControl",n)},J}(),SiebelAppFacade.ScriptEditorPM})),typeof SiebelAppFacade.FavsPM=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.FavsPM"),define("siebel/favspm",["siebel/pmodel"],function(){return SiebelAppFacade.FavsPM=function(){function n(e){SiebelAppFacade.FavsPM.superclass.constructor.apply(this,arguments)}function r(e,n,r,s){e==="Drilldown"&&(i.call(this),s[t.get("SWE_EXTN_CANCEL_ORIG_OP")]=!0,s[t.get("SWE_EXTN_STOP_PROP_OP")]=!0,s[t.get("SWE_EXTN_RETVAL")]=null)}function i(){var e=this,t=$(event.target),n=t.attr("name"),r=t.hasClass("siebui-ctrl-drilldown")?t.attr("rowId"):t.parents("tr").eq(0).attr("id"),i,s="SWEBU=1";i=e.Get("GetBusComp").GetRawRecords()[r-1];var o=i[1],u=i[2].split("?")[1].split("&");for(var a=0;a<u.length;a++)u[a].includes("SWERF")||u[a].includes("SWEHo")||u[a].includes("SWEView")||u[a].includes("SWECmd")||u[a].includes("SWEBU")||(s+="&"+u[a]);return SiebelApp.S_App.GotoView(o," ",s," "),!1}var e=SiebelJS.Dependency("SiebelApp.Utils"),t=SiebelJS.Dependency("SiebelApp.Constants");return SiebelJS.Extend(n,SiebelAppFacade.ListPresentationModel),n.prototype.Init=function(){SiebelAppFacade.FavsPM.superclass.Init.apply(this,arguments),this.AddMethod("InvokeMethod",r,{sequence:!0,scope:this})},n}(),"SiebelAppFacade.FavsPM"})),typeof SiebelAppFacade.ScriptEditorPR=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ScriptEditorPR"),define("siebel/scripteditorpr",["siebel/phyrenderer","siebel/scripteditorpw","3rdParty/fancytree/dist/jquery.fancytree.min.js"],function(){return SiebelAppFacade.ScriptEditorPR=function(){function hn(e,t){var n="",r=null,i="",s=e;for(n in t)t.hasOwnProperty(n)&&(i="{{\\s*"+n+"\\s*}}",r=new RegExp(i,"g"),s=s.replace(r,t[n]));return s}function pn(e,t,n,o){if(e.length!==0){e.attr(r,t).attr(i,n).attr(s,o);if(t===f||t===c){var u=e.attr("aria-describedby");if(u){var a=u.split(" "),l=a[a.length-1];e.siblings("[id ="+l+"]").attr("data-autom","siblings:[aria-describedby~='"+l+"']")}}}}function yn(){SiebelAppFacade.ScriptEditorPR.superclass.constructor.apply(this,arguments)}function bn(e){var t=this.GetPM();if(!t.Get("IsScriptDebugger")){var n=$("#"+t.Get("GetFullId")),r=!0;e!==t.Get("ActiveEventInactive")&&(r=t.ExecuteMethod("SetEventState",e));if(E){var i=n.find("#scriptEditorActivateScript"),s=n.find("#scriptEditorInactivateScript");t.Get("ScriptEditable")&&t.Get("ActiveEventEditable")&&t.Get("ActiveEventExistInDB")?r&&(e?(i.addClass("appletButton").removeClass("appletButtonDis").prop("disabled",!1),s.removeClass("appletButton").addClass("appletButtonDis").prop("disabled",!0)):(i.removeClass("appletButton").addClass("appletButtonDis").prop("disabled",!0),s.addClass("appletButton").removeClass("appletButtonDis").prop("disabled",!1))):(i.removeClass("appletButton").addClass("appletButtonDis").prop("disabled",!0),s.removeClass("appletButton").addClass("appletButtonDis").prop("disabled",!0)),i=null,s=null}else{var o=n.find(".siebui-se-script-state-check-icon");r&&(e?(o.addClass("siebui-icon-checkbox-checked"),o.removeClass("siebui-icon-checkbox-unchecked")):(o.addClass("siebui-icon-checkbox-unchecked"),o.removeClass("siebui-icon-checkbox-checked")),o.attr("checked",e).attr("aria-checked",e).attr("value",e?"Y":"N")),t.Get("ScriptEditable")&&t.Get("ActiveEventEditable")&&t.Get("ActiveEventExistInDB")?o.parent().removeClass("ui-state-disabled"):o.parent().addClass("ui-state-disabled"),o=null}t.Get("ActiveEventInactive")?n.find(".CodeMirror").addClass("siebui-se-inactive"):n.find(".CodeMirror").removeClass("siebui-se-inactive"),n=null}}function wn(){if(!document.hasFocus()){var e=-1,t=document.title,n=y+t,r=!0;e=setInterval(function(){document.hasFocus()?(document.title=t,clearInterval(e)):(document.title=r?n:t,r=!r)},500)}}function En(){var e=$(Yt);if(e.length>0){var t=this.GetPM(),n=e.hasClass("siebui-sd-float");t.Get("IsScriptDebuggerShown")?($("html").addClass("siebui-sd-mode"),e.removeClass("forcehide"),SiebelJS.Debug("[ScriptEditorPR] Open Debugger Panel.",!0),n?An.call(this):$("#_sweclient").addClass("siebui-sd-shown-docked"),t.ExecuteMethod("OpenDebuggerPanel")):($("html").removeClass("siebui-sd-mode"),e.addClass("forcehide"),SiebelJS.Debug("[ScriptEditorPR] Close Debugger Panel.",!0),e.data("uiDraggable")!==undefined&&e.draggable("destroy"),$("#_sweclient").removeClass("siebui-sd-shown-docked"),t.ExecuteMethod("CloseDebuggerPanel")),n?(SiebelJS.Debug('[ScriptEditorPR] HandleScriptDebuggerShowHide - trigger DebuggerContentResize".',!0),$(window).trigger(Tt)):(SiebelJS.Debug('[ScriptEditorPR] HandleScriptDebuggerShowHide - trigger resize".',!0),$(window).trigger("resize"))}}function Sn(){var e=$("#scriptDebuggerHeader");if(e.length===0)return;var t=this.GetPM(),n=e.find("#scriptDebuggerStart");if(t.Get("IsInDebugging")){e.find("#scriptDebuggerEnd").removeClass(Zt),n.parent().attr("title",z),n.attr("aria-label",z),t.Get(m)===g?(n.removeClass(Zt),e.find("#scriptDebuggerBreak").addClass(Zt),e.find("#scriptDebuggerStepInto").removeClass(Zt),e.find("#scriptDebuggerStepOver").removeClass(Zt),e.find("#scriptDebuggerStepToCursor").removeClass(Zt)):(vn.clearDebugStopAt(),n.addClass(Zt),e.find("#scriptDebuggerBreak").removeClass(Zt),e.find("#scriptDebuggerStepInto").addClass(Zt),e.find("#scriptDebuggerStepOver").addClass(Zt),e.find("#scriptDebuggerStepToCursor").addClass(Zt));var r=t.Get("ProfileState");r>=1?(t.Get(m)===g?e.find("#scriptDebuggerCallTree").addClass(Zt):e.find("#scriptDebuggerCallTree").removeClass(Zt),r===2?(e.find("#scriptDebuggerCallTree").attr("aria-label",O),e.find("#scriptDebuggerCallTree").attr("title",O),e.find("#scriptDebuggerCallTree").addClass
("siebui-sd-hide-tree"),e.find("#scriptDebuggerCallTree").removeClass("siebui-sd-show-tree")):(e.find("#scriptDebuggerCallTree").attr("aria-label",A),e.find("#scriptDebuggerCallTree").attr("title",A),e.find("#scriptDebuggerCallTree").removeClass("siebui-sd-hide-tree"),e.find("#scriptDebuggerCallTree").addClass("siebui-sd-show-tree"))):e.find("#scriptDebuggerCallTree").addClass(Zt)}else vn.clearDebugStopAt(),n.parent().attr("title",U),n.attr("aria-label",U),n.removeClass(Zt),e.find("#scriptDebuggerBreak").addClass(Zt),e.find("#scriptDebuggerEnd").addClass(Zt),e.find("#scriptDebuggerStepInto").addClass(Zt),e.find("#scriptDebuggerStepOver").addClass(Zt),e.find("#scriptDebuggerStepToCursor").addClass(Zt),e.find("#scriptDebuggerCallTree").addClass(Zt),e.find("#scriptDebuggerCallTree").attr("aria-label",A),e.find("#scriptDebuggerCallTree").attr("title",A),e.find("#scriptDebuggerCallTree").removeClass("siebui-sd-hide-tree"),e.find("#scriptDebuggerCallTree").addClass("siebui-sd-show-tree")}function xn(e,t){var n=$("#scriptDebuggerHeader");if(n.length===0)return;var r=this.GetPM();r.Get("IsInDebugging")&&t?n.find("#scriptDebuggerRestart").removeClass(Zt):t||n.find("#scriptDebuggerRestart").addClass(Zt)}function Tn(){OUI_TabMessageChannel({Cmd:"AutoLogin",Val:!!$("#wtseConfigDefaultLogin").prop("checked")})}function Nn(){var e=$("#scriptDebuggerHeader");if(e.length===0)return;var t=this.GetPM();n.IsEmpty(t.Get("ActiveEventName"))?(e.find("#scriptDebuggerToggleBreakpoint").addClass(Zt),e.find("#scriptDebuggerClearAllBreakpoints").addClass(Zt),e.find("#scriptDebuggerCheckSyntax").addClass(Zt)):(e.find("#scriptDebuggerToggleBreakpoint").removeClass(Zt),e.find("#scriptDebuggerClearAllBreakpoints").removeClass(Zt),e.find("#scriptDebuggerCheckSyntax").removeClass(Zt))}function Cn(e){var t=$(e.target),r=e.data.ctx.GetPM(),i=t.attr("data-clickMethod");i&&!n.IsEmpty(r)&&(e.preventDefault(),e.stopPropagation(),r.ExecuteMethod("InvokeDebugMethod",i))}function kn(e){(e.which===$.ui.keyCode.ENTER||e.which===$.ui.keyCode.SPACE)&&Cn(e)}function Ln(e){var t=$(e.target),r=t.attr("id"),i=$(Yt),s=e.data.ctx.GetPM();if(i.length>0&&!n.IsEmpty(s)){var o=i.find("#scriptDebuggerDockToShowPin"),u=i.find("#scriptDebuggerDockToShowUnpin");e.preventDefault(),e.stopPropagation();if(r==="scriptDebuggerDockToShowPin"){if(u.css("display")!=="none")return;o.hide().attr("aria-hidden",!0),u.show().attr("aria-hidden",!1),e&&t&&u.focus()}else{if(r!=="scriptDebuggerDockToShowUnpin")return;if(o.css("display")!=="none")return;o.show().attr("aria-hidden",!1),u.hide().attr("aria-hidden",!0),e&&t&&o.focus()}i.toggleClass("siebui-sd-float"),s.SetProperty("IsScriptDebuggerDocked",!s.Get("IsScriptDebuggerDocked")),s.Get("IsScriptDebuggerDocked")?s.ExecuteMethod("DockDebuggerPanel"):s.ExecuteMethod("UndockDebuggerPanel"),An.call(this),SiebelJS.Debug('[ScriptEditorPR] OnClickScriptDebuggerDock - trigger resize".',!0),$(window).trigger("resize")}}function An(){var e=$(Yt),t=e.find("#scriptDebuggerHeader");e.length>0&&t.length>0&&(e.data("uiDraggable")===undefined&&(e.draggable({handle:t,start:function(){e.css({right:"",bottom:"",width:"",height:""})},stop:On}),e.off("dragstop.scriptdebugger").on("dragstop.scriptdebugger",On)),e.hasClass("siebui-sd-float")?(e.draggable("option","disabled",!1),$("#_sweclient").removeClass("siebui-sd-shown-docked")):(e.draggable("option","disabled",!0),$("#_sweclient").addClass("siebui-sd-shown-docked")),e.css("cursor","default"),e.css("position",""))}function On(e,t){var n=$(Yt),r=n.find("#scriptDebuggerHeader");if(n.length>0&&r.length>0){var i=t?t.offset.top:n.offset().top,s=t?t.offset.left:n.offset().left,o=$(window).width(),u=n.outerWidth(!0),a=50-u+parseInt(n.css("marginRight"),10),f=$(window).height()-parseInt(n.css("marginTop"),10)-r.height()-5,l=$(document).scrollTop();i<l?n.css("top",0):i>f+l&&n.css("top",f),SiebelApp.S_App.GetDirection()?s<a?n.css("left",a):s>o-u&&n.css("left",o-u):s<5?n.css("left",5):s>o-50&&n.css("left",o-50),n.css({right:"",bottom:"",width:"",height:""})}}function Mn(e){(e.which===$.ui.keyCode.ENTER||e.which===$.ui.keyCode.SPACE)&&Ln(e)}function _n(e){e.preventDefault(),e.stopPropagation(),e.data.ctx.GetPM().OnControlEvent("ScriptDebuggerClose")}function Dn(e){(e.which===$.ui.keyCode.ENTER||e.which===$.ui.keyCode.SPACE)&&_n(e)}function Pn(){var e=$("#"+this.GetPM().Get("GetFullId"));DOMUtils.Read(function(){var t=e.find(".siebui-applet").outerHeight(),n=e.find(".siebui-applet-header").outerHeight();DOMUtils.Write(function(){e.find(".siebui-se-tree").height(t-n-5),e=null})})}function Hn(){this.GetPM().Get("IsScriptDebugger")||this.GetUIWrapper(this.GetPM().Get("GetControls")[b]).AttachScriptAssistant()}function Bn(e){this.GetPM().Get("IsScriptDebugger")||this.GetUIWrapper(this.GetPM().Get("GetControls")[b]).LoadBreakpoints(e)}function jn(e){var t=this.GetPM();t.Get("IsScriptDebugger")?vn.setEditorValue(t.Get("ScriptLangType"),e):(SiebelJS.Debug('[ScriptEditorPR] SetEditorValue - Script Event = "'+t.Get("ActiveEventName")+'"',!0),SiebelJS.Debug("[ScriptEditorPR] SetEditorValue - Start",!0),this.GetUIWrapper(t.Get("GetControls")[b]).SetValue(e,0,"ScriptEditor"),SiebelJS.Debug("[ScriptEditorPR] SetEditorValue - End",!0),bn.call(this,t.Get("ActiveEventInactive")))}function Fn(){this.GetPM().Get("IsScriptDebugger")||this.GetUIWrapper(this.GetPM().Get("GetControls")[b]).SetState(e.get("FOCUS"),!0,0,"ScriptEditor")}function In(e){var t=this.GetPM();t.SetProperty("ScriptLangType",e),t.Get("IsScriptDebugger")||this.GetUIWrapper(t.Get("GetControls")[b]).SetEditorMode(e)}function qn(e){var t=this.GetPM();t.ExecuteMethod("GetEventData",e);var r=$.ui.fancytree.getTree("#"+t.Get("ScriptObjectTreeId")),i=r.getNodeByKey(t.Get("ActiveEventName"));if(n.IsEmpty(i)){i=r.getNodeByKey("(general)");if(n.IsEmpty(i)){r=null;return}t.SetProperty("ActiveEventName",i.key),t.SetProperty("ActiveEventData","")}i.setActive(),i.isFolder()&&(i.setExpanded(),t.SetProperty("ActiveEventInactive",!1),t.SetProperty("ActiveEventEditable"
,!1)),jn.call(this,t.Get("ActiveEventData")),t.Get("ActiveEventExistInDB")&&Bn.call(this,t.Get("EventBPLineArray")),r=null,i=null,$("#"+t.Get("GetFullId")).find("#scriptEditorCheckSyntaxCurrent").prop("disabled",!t.Get("EnableScriptValidation")||!t.Get("ActiveEventExistInDB"))}function Rn(e,t){var n=this.GetPM();n.ExecuteMethod("SetScriptLang",t),n.Get("IsScriptDebugger")||this.GetUIWrapper(n.Get("GetControls")[b]).UpdateScriptLangPreferences(e,t),In.call(this,t),qn.call(this),Fn.call(this)}function Un(e){SiebelJS.Debug("[ScriptEditorPR] SetLineProfileRules: "+e,!0);var t=this.GetPM();t.ExecuteMethod("SetLineProfileRules",e)}function zn(){var e=this.GetPM(),t=e.ExecuteMethod("GetLineProfileRules");return SiebelJS.Debug("[ScriptEditorPR] GetLineProfileRules: "+t,!0),t}function Wn(e){n.IsEmpty(e)&&(e="JS"),$(ct).length>0&&$(ct).remove();var r=this,i=n.IsTrue(SiebelApp.S_App.IsAutoOn()),s=$(cn.chooseScriptingLanguage),a=t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_SCRIPT_LANG_TITLE"),f=0,l=0;if(i){var c,h;for(f=0,l=nn.length;f<l;f++)c=rn[nn[f]],n.IsEmpty(c)||(h=s.find("#"+c.id),pn.call(this,h,c.type,c.name,c.text))}s.dialog({title:a,modal:!0,resizable:!1,classes:{"ui-dialog":ft,"ui-dialog-content":lt},buttons:[{text:t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_BUTTON_OK"),click:function(){$(this).dialog("close");var e=$(ct+" #scriptEditorUseDefaultLang"),t=$(ct+' input[type="radio"]:checked');Rn.call(r,e[0].checked,t[0].value)}},{text:t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_BUTTON_CANCEL"),click:function(){$(this).dialog("close")}}]});var p=s.siblings(".ui-dialog-buttonpane");p.find(":button").addClass("siebui-ctrl-btn appletButton"),s.find("input").bind("change",function(e){nr.call(r,e)}),i&&(pn.call(r,s.parent(),o,a,a),p.find(":button").each(function(){pn.call(r,$(this),u,a+v+$(this).text(),$(this).text())})),s.find("#scriptEditorLangType"+e).prop("checked",!0),p=null,s=null}function Xn(){$(wt).length>0&&$(wt).remove();var e=this,r=n.IsTrue(SiebelApp.S_App.IsAutoOn()),i=$(cn.tmplSetLineProfileRulesDlg),s=t.GetLocalString("WT_SCRIPT_DEBUGGER_POPUP_LINE_PROFILE_RULE"),a=0,f=0,l=zn.call(this);if(!n.IsEmpty(l)){var c=i.find("#id_SetLineProfileRules_rule");for(var h=0;h<l.length;h++){var p='<option value="'+l[h]+'"'+">"+l[h]+"</option>";SiebelJS.Debug("[ScriptEditorPR] add: "+p,!0),c&&c.append(p)}}i.find("#setLineProfileRules_Add").click(function(){var e=$("#setLineProfileRules_Add");if(e!==null&&e.hasClass("appletButtonDis"))return;var r=$("#scriptDebuggerSettingSetLineProfileRuleObjectType"),i=$("#scriptDebuggerSettingSetLineProfileRuleObjectName"),s=$("#scriptDebuggerSettingSetLineProfileRuleObjectFunc");if(r!==null&&r.val()!==""&&i!==null&&i.val()!==""&&s!==null&&s.val()!==""){var o=r.val()+"["+i.val()+"]::"+s.val(),u=$("#id_SetLineProfileRules_rule");if(u!==null){var a='<option value="'+o+'"'+">"+o+"</option>";SiebelJS.Debug("[ScriptEditorPR] add: "+a,!0),u.append(a)}}else n.Alert(t.GetLocalString("WT_SCRIPT_DEBUGGER_PROFILE_RULE_ADD_FAIL"))}),i.find("#setLineProfileRules_Delete").click(function(){var e=$("#setLineProfileRules_Delete");if(e!==null&&e.hasClass("appletButtonDis"))return;var r=$("#id_SetLineProfileRules_rule").find("option:selected");r!==null&&r.length===1?(SiebelJS.Debug("[ScriptEditorPR] delete: "+r.val(),!0),r.remove()):n.Alert(t.GetLocalString("WT_SCRIPT_DEBUGGER_PROFILE_RULE_DELETE_FAIL")),e.addClass("appletButtonDis")}),i.dialog({title:s,modal:!0,resizable:!1,classes:{"ui-dialog":yt,"ui-dialog-content":bt},buttons:[{text:t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_BUTTON_OK"),click:function(){$(this).dialog("close");var t=[],n=0;$("#id_SetLineProfileRules_rule option").each(function(){var e=$(this).text();SiebelJS.Debug("[ScriptEditorPR] save profile rule: "+e,!0),t[n++]=e}),Un.call(e,t)}},{text:t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_BUTTON_CANCEL"),click:function(){$(this).dialog("close")}}]});var d=i.siblings(".ui-dialog-buttonpane");d.find(":button").addClass("siebui-ctrl-btn appletButton"),i.find("input").bind("change",function(t){nr.call(e,t);var n=$("#scriptDebuggerSettingSetLineProfileRuleObjectName"),r=$("#scriptDebuggerSettingSetLineProfileRuleObjectFunc"),i=$("#setLineProfileRules_Add");n!==null&&n.val()!==""&&r!==null&&r.val()!==""?i.removeClass("appletButtonDis"):i.addClass("appletButtonDis")}),i.find("#id_SetLineProfileRules_rule").bind("change",function(t){nr.call(e,t);var n=$("#id_SetLineProfileRules_rule"),r=$("#setLineProfileRules_Delete");r!==null&&r.removeClass("appletButtonDis")});if(r){pn.call(e,i.parent(),o,s,s),d.find(":button").each(function(){pn.call(e,$(this),u,s+v+$(this).text(),$(this).text())});var m,g,y;for(y in fn)m=fn[y],n.IsEmpty(m)||(g=i.find("#"+m.id),pn.call(e,g,m.type,m.id,m.text))}d=null,i=null}function Vn(){var e=this.GetPM(),t=e.ExecuteMethod("GetApplicationContextPrefrence");SiebelJS.Debug("[ScriptEditorPR] CurrentApplication = '"+t+"'",!0);var n=$("#scriptEditorApplicationList"),r=n.find("#scriptEditorApplicationListSelect"),i=0,s=0,o=!1,u=e.ExecuteMethod(Et),a;for(i=0,s=u.length;i<s;i++)a=u[i],r.append('<option value="'+a+'">'+a+"</option>"),o===!1&&t===a&&(o=!0);o?r.val(t).prop("selected",!0):r.find("option:first-child").prop("selected",!0),r=null,n=null}function $n(e){SiebelJS.Debug('[ScriptEditorPR] Invoking "CreateTree" ...',!0);var t=this.GetPM(),n=$("#"+t.Get("ScriptObjectTreeId")),r=t.ExecuteMethod("GetTreeData",e),i=[],s=[],o=Kn.call(this,r);i.push(o);var u=n.parent();n.empty();var a=n;n.remove(),e?u.append(a):u.prepend(a),Jn.call(this,e,a,i),SiebelJS.Debug('[ScriptEditorPR] Done invoking "CreateTree".',!0)}function Jn(t,r,i){var s=n.IsTrue(SiebelApp.S_App.IsAutoOn()),o,u=this,a=this.GetPM();r.length===1&&(o={autoCollapse:!1,imagePath:" ",_classNames:{nodeIcon:null},clickFolderMode:3,minExpandLevel:2,persist:!1,renderNode:function(e,t){var n=t.node;n.data.addClass&&$(n.span).addClass(n.data.addClass);if(s){var r=$(n.span).find(".fancytree-title"),i=n.title;pn.call(u,r,l,i,i),r=r.siblings(".fancytree-expander"),n.isFolder()?(i="ScriptFolder-"+
n.title,i+=n.hasChildren()?n.isExpanded()?"-Collapse":"-Expand":"-Empty"):i="ScriptData-"+n.title,pn.call(u,r,d,n.isExpanded()?"Collapse":"Expand",i),r.attr({id:i,"data-rowid":i})}},click:function(r,i){var s=i.originalEvent.target?$(i.originalEvent.target).attr("class"):"";if(n.IsEmpty(s))return!1;var o=s?s.indexOf("fancytree-title")>=0:!1,u=i.node.key,a=i.node.data.type,f=this.GetPM(),l=!1,c,h;return t?(c=f.Get("DebuggerTreeServerScriptObjType"),h=f.Get("DebuggerTreeServerScriptObjName"),i.tree.activeNode===null||i.tree.activeNode.key!==u?l=!0:l=!vn.isActiveTab(c,h,u)):(f.Get("IsActive")||f.OnControlEvent(e.get("PHYEVENT_APPLET_FOCUS")),l=u!==f.Get("ActiveEventName")),l&&(i.node.folder===!0||i.node.extraClasses.indexOf(at)!==-1&&f.Get("ScriptEditable")===!1?t?l=!1:(f.SetProperty("ActiveEventInactive",!1),f.SetProperty("ActiveEventEditable",!1),f.SetProperty("ActiveEventExistInDB",!1),f.SetProperty("ActiveEventName",u),f.SetProperty("ActiveEventData","")):(t&&vn.existTab(c,h,u)&&(vn.activateTab(c,h,u),f.SetProperty("ActiveEventName",u),l=!1),l&&f.ExecuteMethod("GetEventData",u,{isScriptDebugger:t,eventType:a})),i.node.setActive(),f.SetProperty("ActiveEventType",a),l&&(t?(f.SetProperty("ActiveEventScriptObjType",c),f.SetProperty("ActiveEventScriptObjName",h),vn.newTab(c,h,u,f.Get("ActiveEventScriptLangType"),f.Get("ActiveEventData"),f.Get("EventBPLineArray"),!0)):(jn.call(this,f.Get("ActiveEventData")),f.Get("ActiveEventExistInDB")&&Bn.call(this,f.Get("EventBPLineArray"))))),t||(Fn.call(this),$("#"+f.Get("GetFullId")).find("#scriptEditorCheckSyntaxCurrent").prop("disabled",!f.Get("EnableScriptValidation")||!f.Get("ActiveEventExistInDB"))),!o}.bind(u)},$.extend(o,{source:i,expanded:!0}),r.fancytree(o))}function Kn(e){var t={};if(!n.IsEmpty(e)){t.title=e.GetProperty("title");var r=e.GetProperty("key");t.key=n.IsEmpty(r)?t.title:r,t.data={},n.IsEmpty(e.GetProperty("folder"))||(t.folder=e.GetProperty("folder")==="true"),n.IsEmpty(e.GetProperty("expanded"))||(t.expanded=e.GetProperty("expanded")==="true"),n.IsEmpty(e.GetProperty("isRoot"))||(t.isRoot=e.GetProperty("isRoot")==="true"),t.folder!==!0&&(n.IsEmpty(e.GetProperty("type"))||(t.data.type=e.GetProperty("type")),e.GetProperty("hasScriptData")==="true"?(t.extraClasses=ut,e.GetProperty("inactive")==="true"&&(t.extraClasses+=" siebui-se-inactive")):t.extraClasses=at,n.IsEmpty(e.GetProperty("custom"))||(t.data.custom=e.GetProperty("custom")));var i=[];for(var s=0,o=e.GetChildCount();s<o;s++)i.push(Kn.call(this,e.GetChild(s)));t.children=i}return t}function Qn(e){var t=this.GetPM();if(!n.IsEmpty(e)){var r=e.GetProperty("Key"),i=e.GetProperty("Operation"),s=$.ui.fancytree.getTree("#"+t.Get("ScriptObjectTreeId")).getNodeByKey(r);if(!n.IsEmpty(s))"DeleteRecord"===i?s.data.custom?(s.key===t.Get("ActiveEventName")&&(t.SetProperty("ActiveEventInactive",!1),t.SetProperty("ActiveEventEditable",!1),t.SetProperty("ActiveEventExistInDB",!1),t.SetProperty("ActiveEventName",s.parent.key),t.SetProperty("ActiveEventData",""),jn.call(this,""),s.parent.setActive()),setTimeout(function(){s.remove(),s=null},10)):(s.extraClasses=at,s.renderStatus()):"UpdateRecord"!==i&&(s.extraClasses=ut,"UpdateScriptState"===i&&n.IsTrue(e.GetProperty("ActiveEventInactive"))&&(s.extraClasses+=" siebui-se-inactive"),s.renderStatus(),s.setActive());else if("NewRecord"===i||"UpdateRecord"===i){var o=this;SiebelApp.S_App.uiStatus.Busy({mask:!0}),setTimeout(function(){$n.call(o),qn.call(o,r),SiebelApp.S_App.uiStatus.Free()},w)}$("#"+t.Get("GetFullId")).find("#scriptEditorCheckSyntaxCurrent").prop("disabled",!t.Get("EnableScriptValidation")||!t.Get("ActiveEventExistInDB"))}}function Gn(){var t=this.GetPM();if(!t.Get("IsScriptDebugger")){var n=t.Get("ScriptEditable")&&t.Get("ActiveEventEditable"),r=$("#"+t.Get("GetFullId")).find(".CodeMirror");n?r.removeClass("siebui-se-readonly"):r.addClass("siebui-se-readonly"),r=null,this.GetUIWrapper(t.Get("GetControls")[b]).SetState(e.get("EDITABLE"),n,0,"ScriptEditor")}}function Yn(e,t){var n=this.GetPM();n.Get("IsScriptDebugger")||(e!==n.Get("ActiveEventName")&&qn.call(this,e),this.GetUIWrapper(n.Get("GetControls")[b]).SelectLine(t))}function Zn(e,t,r){var i=[];for(var s=0,o=e.length;s<o;s++){var u={},a="",f=parseInt(e[s],10);if(n.IsEmpty(f)||isNaN(f))f=0;for(var l=0,c=r.length;l<c;l++){if(f<=r[l]){a=t[l];break}f-=r[l]}u.eventName=a,u.lineNum=f,i.push(u)}return i}function er(e,a){if(n.IsEmpty(e)){n.IsTrue(a)||n.Alert(t.GetLocalString("WT_SCRIPT_EDITOR_CHECK_SYNTAX_FINISH_OK"));return}var f=this.GetPM().Get("ScriptLangType"),c=e.type,h=e.messages,p=e.messageLines,d=e.eventNames,m=e.eventLineCounts,g=this,y=n.IsTrue(SiebelApp.S_App.IsAutoOn()),b=$(cn.scriptValidationList),w=c==="Error"?t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_CHECK_SYNTAX_TITLE_ERROR"):t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_CHECK_SYNTAX_TITLE_WARNING"),E=t.GetLocalString("WT_SCRIPT_EDITOR_COMPILE_LINE_PROC_MSG");$(dt).length>0&&$(dt).remove(),b.dialog({title:w,modal:!0,resizable:!1,classes:{"ui-dialog":ht,"ui-dialog-content":pt},buttons:[{text:t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_BUTTON_GO_TO_LINE"),click:function(){var e=$(this).find("li.siebui-script-validation-list-item.selected");if(e.length>0){var r=e.data("eventname"),i=parseInt(e.data("linenum"),10);if(n.IsEmpty(i)||isNaN(i))i=0;n.IsEmpty(r)?n.Alert(t.GetLocalString("WT_SCRIPT_EDITOR_NO_PROC_GO_TO_LINE").replace("%1","\n\n"+e[0].textContent)):Yn.call(g,r,i)}e=null}},{text:t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_BUTTON_CLOSE"),click:function(){$(this).dialog("close"),Fn.call(g)}}]});var S=b.siblings(".ui-dialog-buttonpane");S.find(":button").addClass("siebui-ctrl-btn appletButton");var x=b.find("ol.siebui-script-validation-list"),T=Zn.call(this,p,d,m);for(var N=0,C=h.length;N<C;N++){var k=y?" "+r+'="'+l+'" '+i+'="'+w+(N+1)+'" '+s+'="'+w+v+(N+1)+'"':"",L=h[N].trim().split(/\r?\n/),A='<li id="wtsvli'+(N+1)+'" class="siebui-script-validation-list-item'+'" data-eventname="'+T[N].eventName+'" data-linenum="'+T[N].lineNum+'"'+
k+">";for(var O=0,M=L.length;O<M;O++)A+="<div>"+L[O]+"</div>";f==="JS"&&c==="Warning"&&(A+="<div>"+E.replace("%1",T[N].lineNum).replace("%2",T[N].eventName)+"</div>"),A+="</li>",x.append(A)}x=null,b.find("li.siebui-script-validation-list-item").click(function(){$(this).hasClass("selected")||($(this).siblings(".selected").removeClass("selected"),$(this).addClass("selected"))}),b.find("#wtsvli1").click();if(y){pn.call(g,b.parent(),o,w,w),S.find(":button").each(function(){pn.call(g,$(this),u,w+v+$(this).text(),$(this).text())});var _=(SiebelApp.S_App.GetDirection()?"right":"left")+" center";b.parent().position({my:_,at:_,of:"#_sweclient"})}S=null,b=null}function tr(){$(gt).length>0&&$(gt).remove();var e=this,r=this.GetPM(),i=n.IsTrue(SiebelApp.S_App.IsAutoOn()),s=$(cn.tmplDebuggerSettings),l=t.GetLocalString("WT_SCRIPT_DEBUGGER_POPUP_SETTINGS_TITLE"),c=r.ExecuteMethod("GetDebuggerPrefrence"),h,p,d,m,g,y,b=0,w=0;for(b=0,w=c.length;b<w;b++){h=c[b];if(h.name==="Application")p=h.label,d=h.value,g=h.name;else if(h.name==="Language")m=h.value,y=h.name;else{s.find("#scriptDebuggerSettingsSection").append(hn.call(this,cn.tmplDebuggerSettingsEntry,h));var E=s.find("#"+h.id),S=n.IsTrue(h.checked);E.attr("checked",S).attr("aria-checked",S).attr("value",S?"Y":"N"),i&&pn.call(this,E,a,h.name,h.name)}}s.find("#scriptDebuggerSettingsSection").append(hn.call(this,cn.tmplDebuggerSettingsApplicaiton,{userprefNameApp:g,userprefNameLang:y,appLabel:p}));var x=!1,T=!1,N=r.Get("AppInfoArray"),C;if(n.IsEmpty(d)||n.IsEmpty(m))x=!0;for(b=0,w=N.length;b<w;b++)C=N[b],s.find("#scriptDebuggerApplicationListSelect").append(hn.call(this,cn.tmplDebuggerSettingsApplicaitonOption,{displayName:C.displayName,appName:C.appName,langName:C.langName})),b===0&&x===!0?(T=!0,s.find("#scriptDebuggerApplicationListSelect option:last-child").prop("selected",!0)):T===!1&&d===C.appName&&m===C.langName&&(T=!0,s.find("#scriptDebuggerApplicationListSelect option:last-child").prop("selected",!0));T||(SiebelJS.Debug("[ScriptDebuggerSettings] Non-existing target application/language from UserPref: Application = '"+d+"'; Language = '"+m+"'",!0),N.length>0&&(s.find("#scriptDebuggerApplicationListSelect option:first-child").prop("selected",!0),SiebelJS.Debug("[ScriptDebuggerSettings] Select the first entry instead: '"+N[0].displayName+"'",!0))),s.dialog({title:l,modal:!0,resizable:!1,classes:{"ui-dialog":vt,"ui-dialog-content":mt},buttons:[{text:t.GetLocalString("WT_SCRIPT_EDITOR_TOOLTIP_EDIT_PROFILE_RULE"),click:function(){Xn.call(e)}},{text:t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_BUTTON_OK"),click:function(){var t=e.GetPM(),n=$("#scriptDebuggerSettingsSection").children();for(var r=0,i=n.length;r<i;r++){var s,o;$(n[r]).find(".siebui-application-list-title").length>0?(s=$(n[r]).find(".siebui-application-list-title").data("userprefnameapp"),o=$(n[r]).find("#scriptDebuggerApplicationListSelect option:selected").data("appname"),t.ExecuteMethod("SetDebuggerPrefrence",s,o),s=$(n[r]).find(".siebui-application-list-title").data("userprefnamelang"),o=$(n[r]).find("#scriptDebuggerApplicationListSelect option:selected").data("langname"),t.ExecuteMethod("SetDebuggerPrefrence",s,o)):(s=n[r].firstChild.name,o=n[r].firstChild.checked,t.ExecuteMethod("SetDebuggerPrefrence",s,o))}$(this).dialog("close")}},{text:t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_BUTTON_CANCEL"),click:function(){$(this).dialog("close")}}]});var k=s.siblings(".ui-dialog-buttonpane");k.find(":button").addClass("siebui-ctrl-btn appletButton"),s.find("input").bind("change",function(t){nr.call(e,t)}),s.find("select").bind("change",function(t){nr.call(e,t)}),i&&(pn.call(e,s.parent(),o,l,l),pn.call(e,s.find("#scriptDebuggerApplicationListSelect"),f,l+v+p,p),k.find(":button").each(function(){pn.call(e,$(this),u,l+v+$(this).text(),$(this).text())})),k=null,s=null}function nr(e){e.target.type==="checkbox"?$(e.target).attr("checked",e.target.checked).attr("aria-checked",e.target.checked).attr("value",e.target.checked?"Y":"N"):e.target.type==="radio"&&($(e.target).siblings("input:radio").prop("checked",!e.target.checked),$(e.target).prop("checked",e.target.checked))}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=SiebelJS.Dependency("SiebelApp.Utils"),r=e.get("SWE_PROP_AUTOM_OT"),i=e.get("SWE_PROP_AUTOM_RN"),s=e.get("SWE_PROP_AUTOM_UN"),o="SiebApplet",u=e.get("SWE_PST_BUTTON_CTRL"),a=e.get("SWE_CTRL_CHECKBOX"),f=e.get("SWE_CTRL_COMBOBOX"),l=e.get("SWE_CTRL_LINK"),c=e.get("SWE_CTRL_PICK"),h=e.get("SWE_CTRL_RADIO"),p=e.get("SWE_CTRL_TEXT"),d=e.get("SWE_TREE_APPLET_CTRL"),v=":",m=e.get("SCRIPTDEBUG_PROP_DEBUG_STATE"),g=e.get("SCRIPTDEBUG_STATE_BREAK"),y="\u275a\u275a ",b="Script",w=50,E=!0,S=t.GetLocalString("WT_SCRIPT_EDITOR_TOOLTIP_PREFIX"),x=t.GetLocalString("WT_SCRIPT_EDITOR_LABEL_ACTIVE"),T=t.GetLocalString("WT_SCRIPT_EDITOR_LABEL_INACTIVE"),N=S+t.GetLocalString("WT_SCRIPT_EDITOR_LABEL_ACTIVATE"),C=S+t.GetLocalString("WT_SCRIPT_EDITOR_LABEL_INACTIVATE"),k=S+t.GetLocalString("WT_SCRIPT_EDITOR_TOOLTIP_CHECK_SYNTAX_CURR"),L=S+t.GetLocalString("WT_SCRIPT_EDITOR_TOOLTIP_CHECK_SYNTAX"),A=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_CALL_TREE"),O=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_CLOSE_CALL_TREE"),M=t.GetLocalString("WT_SCRIPT_DEBUGGER_PROFILE_RULE_OBJECT_TYPE"),_=e.get("OBJECT_TYPE_APPLICATION"),D=e.get("OBJECT_TYPE_BUSCOMP"),P=e.get("OBJECT_TYPE_SERVICE"),H=e.get("OBJECT_TYPE_WEBAPPLET"),B=e.get("PROFILE_RULES"),j=t.GetLocalString("WT_SCRIPT_DEBUGGER_PROFILE_RULE_OBJECT_NAME"),F=t.GetLocalString("WT_SCRIPT_DEBUGGER_PROFILE_RULE_FUNCTION"),I=t.GetLocalString("WT_SCRIPT_DEBUGGER_PROFILE_RULE_ADD"),q=t.GetLocalString("WT_SCRIPT_DEBUGGER_PROFILE_RULE_DELETE"),R=t.GetLocalString("WT_SCRIPT_DEBUGGER_PROFILE_RULE_MSG"),U=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_START"),z=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_CONTINUE"),W=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_BREAK"),X=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_END"),V=t.GetLocalString
("WT_SCRIPT_DEBUGGER_TOOLTIP_RESTART"),J=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_STEP_INTO"),K=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_STEP_OVER"),Q=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_STEP_TO_CURSOR"),G=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_TOGGLE_BREAKPOINT"),Y=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_CLEAR_ALL_BREAKPOINTS"),Z=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_SETTINGS"),et=t.GetLocalString("WT_SCRIPT_EDITOR_TOOLTIP_CHECK_SYNTAX"),tt=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_UNDOCK"),nt=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_DOCK"),rt=t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_CLOSE"),it=t.GetLocalString("WT_SCRIPT_DEBUGGER_ERRORS_CLEAR"),st=t.GetLocalString("WT_SCRIPT_DEBUGGER_TAB_CLOSE"),ot="siebui-se-applet",ut="siebui-se-hasdata",at="siebui-se-nodata",ft="siebui-se-select-lang-dialog",lt="siebui-se-select-lang-content",ct="."+lt,ht="siebui-script-validation-dialog",pt="siebui-script-validation-content",dt="."+pt,vt="siebui-sd-settings-dialog",mt="siebui-sd-settings-content",gt="."+mt,yt="siebui-sd-profile-rule-dialog",bt="siebui-sd-profile-rule-content",wt="."+bt,Et="GetApplicationArray",St="GetTargetApplicationArray",xt="resize.ScriptEditorTree",Tt="resize.scriptDebuggerContent",Nt="scriptDebuggerServerScriptObjType",Ct="scriptDebuggerServerScriptObjName",kt=Nt+"_icon",Lt=Ct+"_icon",At="scriptDebuggerTabItem",Ot="scriptDebuggerTabClose",Mt="scriptDebuggerWatchTitle",_t="scriptDebuggerCallStackTitle",Dt="scriptDebuggerErrorsTitle",Pt="scriptDebuggerErrorsClear",Ht=t.GetLocalString("WT_SCRIPT_DEBUGGER_TITLE"),Bt=t.GetLocalString("WT_SCRIPT_DEBUGGER_WATCH_TITLE"),jt=t.GetLocalString("WT_SCRIPT_DEBUGGER_CALL_STACK_TITLE"),Ft=t.GetLocalString("WT_SCRIPT_DEBUGGER_ERRORS_TITLE"),It=t.GetLocalString("WT_SCRIPT_DEBUGGER_WATCH_DEFAULT_TEXT"),qt=t.GetLocalString("WT_SCRIPT_DEBUGGER_CALL_STACK_DEFAULT_TEXT"),Rt=t.GetLocalString("WT_SCRIPT_DEBUGGER_ERRORS_DEFAULT_TEXT"),Ut=!0,zt="Siebel Object",Wt="WebApplet",Xt="Application",Vt="BusComp",$t="Service",Jt=[{type:Wt,text:"Applet",comp_id:"Repository Applet List Applet - Standalone Pick"},{type:Xt,text:"Application",comp_id:"Repository Application List Applet - Standalone Pick"},{type:Vt,text:"Business Component",comp_id:"Repository Business Component List Applet - Standalone Pick"},{type:$t,text:"Business Service",comp_id:"Repository Business Service List Applet - Standalone Pick"}],Kt={};for(var Qt=0,Gt=Jt.length;Qt<Gt;Qt++)Kt[Jt[Qt].type]=Jt[Qt];var Yt="#_swescriptdebugger",Zt="siebui-sd-button-disabled",en=["appcontext","activatescript","inactivatescript","restorecontext","checksyntax","settings"],tn={appcontext:{id:"scriptEditorApplicationListSelect",type:f,text:"Application Context"},activatescript:{id:"scriptEditorActivateScript",type:u,text:N},inactivatescript:{id:"scriptEditorInactivateScript",type:u,text:C},restorecontext:{id:"scriptEditorRestoreContext",type:l,text:S+t.GetLocalString("WT_CMEDITOR_TOOLTIP_RESTORE_CONTEXT")},checksyntax:{id:"scriptEditorCheckSyntax",type:u,text:L},settings:{id:"scriptEditorSettings",type:u,text:S+t.GetLocalString("WT_CMEDITOR_TOOLTIP_SETTINGS")}},nn=["js","sbl","usedefault"],rn={js:{id:"scriptEditorLangTypeJS",type:h,name:"scriptEditorLangType",text:"eScript"},sbl:{id:"scriptEditorLangTypeSBL",type:h,name:"scriptEditorLangType",text:"Visual Basic"},usedefault:{id:"scriptEditorUseDefaultLang",type:a,name:"scriptEditorUseDefaultLang",text:"Use As Default Lang"}},sn=["debugheader","debugcontent","debugstart","debugbreak","debugend","debugrestart","stepinto","stepover","steptocursor","togglebreakpoint","clearallbreakpoints","debugcalltree","debugsettings","debugchecksyntax","debugundock","debugdock","debugclose"],on=["scriptobjtype","scriptobjname","scriptobjtypepick","scriptobjnamepick"],un=["watchsectionheader_watch","watchsectionheader_callstack","watchsectionheader_errors","watchsectionheader_errorsclear"],an={debugheader:{id:"scriptDebuggerHeader",type:o,text:"ScriptDebuggerHeader"},debugcontent:{id:"scriptDebuggerContent",type:o,text:"ScriptDebuggerContent"},debugstart:{id:"scriptDebuggerStart",type:u,text:U},debugcontinue:{id:"scriptDebuggerContinue",type:u,text:z},debugbreak:{id:"scriptDebuggerBreak",type:u,text:W},debugend:{id:"scriptDebuggerEnd",type:u,text:X},debugrestart:{id:"scriptDebuggerRestart",type:u,text:V},stepinto:{id:"scriptDebuggerStepInto",type:u,text:J},stepover:{id:"scriptDebuggerStepOver",type:u,text:K},steptocursor:{id:"scriptDebuggerStepToCursor",type:u,text:Q},togglebreakpoint:{id:"scriptDebuggerToggleBreakpoint",type:u,text:G},clearallbreakpoints:{id:"scriptDebuggerClearAllBreakpoints",type:u,text:Y},debugcalltree:{id:"scriptDebuggerCallTree",type:u,text:A},debugsettings:{id:"scriptDebuggerSettings",type:u,text:Z},debugchecksyntax:{id:"scriptDebuggerCheckSyntax",type:u,text:et},debugundock:{id:"scriptDebuggerDockToShowUnpin",type:u,text:tt},debugdock:{id:"scriptDebuggerDockToShowPin",type:u,text:nt},debugclose:{id:"scriptDebuggerClose",type:u,text:rt},scriptobjtype:{id:Nt,type:p,text:Nt},scriptobjname:{id:Ct,type:p,text:Ct},scriptobjtypepick:{id:kt,type:u,text:kt},scriptobjnamepick:{id:Lt,type:u,text:Lt},watchsectionheader_watch:{id:Mt,type:u,text:Bt},watchsectionheader_callstack:{id:_t,type:u,text:jt},watchsectionheader_errors:{id:Dt,type:u,text:Ft},watchsectionheader_errorsclear:{id:Pt,type:u,text:it},tabitem:{id:At,type:u,text:At},tabclose:{id:Ot,type:u,text:st}},fn={objtype:{id:"scriptDebuggerSettingSetLineProfileRuleObjectType",type:f,text:M},objname:{id:"scriptDebuggerSettingSetLineProfileRuleObjectName",type:p,text:j},objfunc:{id:"scriptDebuggerSettingSetLineProfileRuleObjectFunc",type:p,text:F},profilerules:{id:"id_SetLineProfileRules_rule",type:f,text:B},addbtn:{id:"setLineProfileRules_Add",type:u,text:I},deletebtn:{id:"setLineProfileRules_Delete",type:u,text:q}},ln=["",t.GetLocalString("WT_SCRIPT_DEBUGGER_CALLTREE_COLUMN_FUNCTION"),t.GetLocalString("WT_SCRIPT_DEBUGGER_CALLTREE_COLUMN_CALL_COUNT"),t.GetLocalString("WT_SCRIPT_DEBUGGER_CALLTREE_COLUMN_TOTAL_T"
),t.GetLocalString("WT_SCRIPT_DEBUGGER_CALLTREE_COLUMN_MAX_T"),t.GetLocalString("WT_SCRIPT_DEBUGGER_CALLTREE_COLUMN_MIN_T"),t.GetLocalString("WT_SCRIPT_DEBUGGER_CALLTREE_COLUMN_TOTAL_SELF_T"),t.GetLocalString("WT_SCRIPT_DEBUGGER_CALLTREE_COLUMN_MAX_SELF_T"),t.GetLocalString("WT_SCRIPT_DEBUGGER_CALLTREE_COLUMN_MIN_SELF_T")],cn={chooseScriptingLanguage:"<div><div>"+t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_SCRIPT_SELECT_LANG")+"</div>"+"<form>"+'<input type="radio" name="scriptEditorLangType" id="scriptEditorLangTypeJS" value="JS">'+"<span>eScript</span><br>"+'<input type="radio" name="scriptEditorLangType" id="scriptEditorLangTypeSBL" value="SBL">'+"<span>Visual Basic</span><br>"+"</form>"+"<div>"+'<input type="checkbox" id="scriptEditorUseDefaultLang" value="N" aria-checked="false">'+"<span>"+t.GetLocalString("WT_SCRIPT_EDITOR_POPUP_ASK_SCRIPT_LANG")+"</span>"+"</div>"+"</div>",scriptValidationList:'<div><ol class="siebui-script-validation-list"></ol></div>',checkSyntaxButtons:'<button id="scriptEditorCheckSyntaxCurrent" class="siebui-ctrl-btn appletButton siebui-ctrl-validate-script-current forcehide" title="'+k+'" aria-label="'+k+'"></button>'+'<button id="scriptEditorCheckSyntax" class="siebui-ctrl-btn appletButton siebui-ctrl-validate-script" title="'+L+'" aria-label="'+L+'"></button>',chooseApplicaiton:'<div id="scriptEditorApplicationList" class="siebui-application-list"><div class="siebui-application-list-title"></div><select id="scriptEditorApplicationListSelect" class="siebui-application-list-select"></select></div>',scriptStateButtons:'<button id="scriptEditorActivateScript" class="siebui-ctrl-btn appletButton siebui-se-hasdata" title="'+N+'" aria-label="'+N+'"></button>'+'<button id="scriptEditorInactivateScript" class="siebui-ctrl-btn appletButton siebui-se-hasdata siebui-se-inactive" title="'+C+'" aria-label="'+C+'"></button>',scriptStateCheck:'<div id="scriptEditorScriptStateCheck" class="siebui-se-script-state-check" tabindex="0" aria-label="'+T+'" title="'+T+'">'+'<div class="siebui-se-script-state-check-icon siebui-icon-checkbox-unchecked" tabindex="-1"></div>'+'<div class="siebui-se-script-state-check-label" tabindex="-1">'+T+"</div>"+"</div>",scriptDebuggerFrame:'<div name="_swescriptdebugger" id="_swescriptdebugger" ot="_swescriptdebugger Frame" class="siebui-sd-frame"><div id="scriptDebuggerHeader" class="siebui-sd-header"><div class="siebui-sd-title-wrap" title=""><div id="scriptDebuggerCaption" class="siebui-sd-caption" role="label" aria-label="" tabindex="0"></div></div><div class="siebui-sd-btns"><div class="siebui-sd-title-wrap" title="'+U+'">'+'<a id="scriptDebuggerStart" class="siebui-sd-debug-button siebui-sd-start" data-clickMethod="DebugStart" role="button" aria-label="'+U+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+W+'">'+'<a id="scriptDebuggerBreak" class="siebui-sd-debug-button siebui-sd-break" data-clickMethod="DebugBreak" role="button" aria-label="'+W+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+X+'">'+'<a id="scriptDebuggerEnd" class="siebui-sd-debug-button siebui-sd-end" data-clickMethod="DebugEnd" role="button" aria-label="'+X+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+V+'">'+'<a id="scriptDebuggerRestart" class="siebui-sd-debug-button siebui-sd-restart '+Zt+'" data-clickMethod="DebugRestart" role="button" aria-label="'+V+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+J+'">'+'<a id="scriptDebuggerStepInto" class="siebui-sd-debug-button siebui-sd-step-into" data-clickMethod="DebugStepInto" role="button" aria-label="'+J+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+K+'">'+'<a id="scriptDebuggerStepOver" class="siebui-sd-debug-button siebui-sd-step-over" data-clickMethod="DebugStepOver" role="button" aria-label="'+K+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+Q+'">'+'<a id="scriptDebuggerStepToCursor" class="siebui-sd-debug-button siebui-sd-step-to-cursor" data-clickMethod="DebugStepToCursor" role="button" aria-label="'+Q+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+G+'">'+'<a id="scriptDebuggerToggleBreakpoint" class="siebui-sd-debug-button siebui-sd-toggle-breakpoint" data-clickMethod="DebugToggleBreakpoint" role="button" aria-label="'+G+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+Y+'">'+'<a id="scriptDebuggerClearAllBreakpoints" class="siebui-sd-debug-button siebui-sd-clear-all-breakpoints" data-clickMethod="DebugClearAllBreakpoints" role="button" aria-label="'+Y+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+A+'">'+'<a id="scriptDebuggerCallTree" class="siebui-sd-debug-button siebui-sd-show-tree siebui-sd-button-disabled" data-clickMethod="DebugCallTree" role="button" aria-label="'+A+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+Z+'">'+'<a id="scriptDebuggerSettings" class="siebui-sd-debug-button siebui-sd-settings" data-clickMethod="DebugSettings" role="button" aria-label="'+Z+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+et+'">'+'<a id="scriptDebuggerCheckSyntax" class="siebui-sd-debug-button siebui-sd-check-syntax" data-clickMethod="DebugCheckSyntax" role="button" aria-label="'+et+'" tabindex="0">'+"</a>"+"</div>"+'<div id="scriptDebuggerDockToggle" class="siebui-sd-dock-toggle">'+'<div class="siebui-sd-title-wrap" title="'+tt+'">'+'<a id="scriptDebuggerDockToShowUnpin" class="siebui-sd-undock" role="button" aria-hidden="false" aria-label="'+tt+'" tabindex="0">'+"</a>"+"</div>"+'<div class="siebui-sd-title-wrap" title="'+nt+'">'+'<a id="scriptDebuggerDockToShowPin" class="siebui-sd-dock" role="button" aria-hidden="true" aria-label="'+nt+'" tabindex="0">'+"</a>"+"</div>"+"</div>"+'<div id="scriptDebuggerCloseToggle" class="siebui-sd-close-toggle">'+'<div class="siebui-sd-title-wrap" title="'+rt+'">'+'<a id="scriptDebuggerClose" class="siebui-sd-close" role="button" aria-label="'+
rt+'" tabindex="0">'+"</a>"+"</div>"+"</div>"+"</div>"+"</div>"+'<div id="scriptDebuggerContent" class="siebui-sd-content">'+'<div id="scriptDebuggerNavigationPanel" class="siebui-sd-navigation-panel">'+"</div>"+'<div id="scriptDebuggerEditorWindowsPanel" class="siebui-sd-editor-windows-panel">'+'<div id="scriptDebuggerEditorPanel" class="siebui-sd-editor-panel">'+'<div id="scriptDebuggerEditorTabPanel" class="siebui-sd-editor-tab-panel">'+'<ul id="scriptDebuggerEditorTabItems" class="siebui-sd-editor-tab-items" role="tablist">'+"</ul>"+"</div>"+'<textarea id="scriptDebuggerScript" class="siebui-sd-script"></textarea>'+"</div>"+'<div id="scriptDebuggerWindowsPanel" class="siebui-sd-windows-panel">'+'<div id="scriptDebuggerWindowsWatchPanel" class="siebui-sd-watch-panel">'+"</div>"+'<div id="scriptDebuggerWindowsScriptCallPanel" class="siebui-sd-script-call-panel">'+"</div>"+'<div id="scriptDebuggerWindowsErrorPanel" class="siebui-sd-error-panel">'+"</div>"+"</div>"+"</div>"+"</div>"+'<div id="scriptDebuggerProfiler">'+'<div id="scriptDebuggerProfilerHeader" class="siebui-sd-profile-header">'+"</div>"+'<div id="scriptDebuggerProfilerTree" class="siebui-sd-profile-tree">'+"</div>"+"</div>"+"</div>",profileHeader:'<span class="siebui-sd-profile-header-column">{{column}}</span>',profileHeader_w:'<span class="siebui-sd-profile-header-column_w">{{column}}</span>',profileHeader_m:'<span class="siebui-sd-profile-header-column_m">{{column}}</span>',profileEntry_li:'<li id={{thisNode}} class="siebui-sd-profile-tree-li"><div class="siebui-sd-profile-tree-entry"></div></li>',profileEntry_data:'<span class="siebui-sd-profile-entry-value_m">{{menu}}</span><span class="siebui-sd-profile-entry-value_w">{{method}}</span><span class="siebui-sd-profile-entry-value_h">{{hiddenV}}</span><span class="siebui-sd-profile-entry-value">{{callcount}}</span><span class="siebui-sd-profile-entry-value">{{totalt}}</span><span class="siebui-sd-profile-entry-value">{{maxt}}</span><span class="siebui-sd-profile-entry-value">{{mint}}</span><span class="siebui-sd-profile-entry-value">{{totalselft}}</span><span class="siebui-sd-profile-entry-value">{{maxselft}}</span><span class="siebui-sd-profile-entry-value">{{minselft}}</span>',profileEntry_li_lp_data:'<li class="siebui-sd-profile-tree-li-profile"><div class="siebui-sd-profile-tree-entry"><span class="siebui-sd-profile-entry-value_m"></span><span class="siebui-sd-profile-entry-value_w">{{method}}</span><span class="siebui-sd-profile-entry-value_h">{{hiddenV}}</span><span class="siebui-sd-profile-entry-value">{{callcount}}</span><span class="siebui-sd-profile-entry-value">{{totalt}}</span><span class="siebui-sd-profile-entry-value"> </span><span class="siebui-sd-profile-entry-value"> </span><span class="siebui-sd-profile-entry-value"> </span><span class="siebui-sd-profile-entry-value"> </span><span class="siebui-sd-profile-entry-value"> </span></div></li>',tmplSetLineProfileRulesDlg:'<ul><li class="siebui-sd-settings-entry"><div class="siebui-application-list-title"><label for="otype">'+M+":</label>"+"</div>"+'<select name="otype" id="scriptDebuggerSettingSetLineProfileRuleObjectType">'+'<option value="Application">'+_+"</option>"+'<option value="BusComp">'+D+"</option>"+'<option value="Service">'+P+"</option>"+'<option value="WebApplet">'+H+"</option>"+"</select>"+"</li>"+'<li class="siebui-sd-settings-entry">'+'<div class="siebui-application-list-title">'+'<label for="oname">'+j+":</label>"+"</div>"+'<input type="text" id="scriptDebuggerSettingSetLineProfileRuleObjectName" class="siebui-sd-settings-profile-rule-input-text" name="oname">'+"</li>"+'<li class="siebui-sd-settings-entry">'+'<div class="siebui-application-list-title">'+'<label for="ofunction">'+F+":</label>"+"</div>"+'<input type="text" id="scriptDebuggerSettingSetLineProfileRuleObjectFunc" class="siebui-sd-settings-profile-rule-input-text" name="ofunction">'+"</li>"+'<li class="siebui-sd-settings-entry">'+'<div class="ui-dialog-buttonpane">'+'<button id="setLineProfileRules_Delete" class="ui-button ui-corner-all ui-widget siebui-ctrl-btn appletButton appletButtonDis">'+q+"</button>"+'<button id="setLineProfileRules_Add" class="ui-button ui-corner-all ui-widget siebui-ctrl-btn appletButton appletButtonDis" type="button">'+I+"</button>"+"</div>"+"</li>"+'<li class="siebui-sd-settings-entry siebui-sd-settings-rules">'+'<select id="id_SetLineProfileRules_rule" class="siebui-sd-settings-rule" size="5">'+"</select>"+"</li>"+'<li class="siebui-sd-settings-entry">'+"<p>"+R+"</p>"+"</li>"+"</ul>",scriptDebuggerWindowItem:'<div class="siebui-sd-window-section" role="tab" aria-selected="false"><div id="{{windowItemId}}" class="siebui-sd-window-section-header" tabindex="0" aria-label="{{windowItemName}}" title="{{windowItemName}}"><div class="siebui-sd-title-wrap"><a class="siebui-sd-window-section-toggle" role="button" tabindex="-1"></a></div><div class="siebui-sd-title-wrap"><a href="javascript:;" class="siebui-sd-window-section-title" tabindex="-1">{{windowItemName}}</a></div></div><div class="siebui-sd-window-section-body forcehide" title=""><div class="siebui-sd-window-section-body-default" title="">{{windowItemNoEntry}}</div><div class="siebui-sd-window-section-body-data forcehide" title=""></div></div></div>',scriptDebuggerErrorButtons:'<div class="siebui-sd-btns forcehide"><div class="siebui-sd-title-wrap" title="'+it+'">'+'<div id="'+Pt+'" class="siebui-sd-error-clear" role="button" aria-label="'+it+'" tabindex="0"></div>'+"</div>"+"</div>",scriptDebuggerEditorTabItem:'<li class="siebui-sd-editor-tab-item" tabindex="0" role="tab" aria-selected="false" aria-label="{{scriptObjType}}\n{{scriptObjName}}\n{{eventName}}" title="{{scriptObjType}}\n{{scriptObjName}}\n{{eventName}}" data-scripttabkey="{{scriptTabKey}}" data-scriptobjtype="{{scriptObjType}}" data-scriptobjname="{{scriptObjName}}" data-eventname="{{eventName}}"><div class="siebui-sd-title-wrap"><a href="javascript:;" tabindex="-1">{{eventName}}</a></div><div class="siebui-sd-title-wrap" title="'+
st+'">'+'<a id="'+Ot+'"class="siebui-sd-editor-tab-close" role="button" aria-label="'+st+'" tabindex="0">'+"</a>"+"</div>"+"</li>",chooseServerScriptObjTypePick:'<div id="scriptDebuggerServerScriptObjTypeSection" class="siebui-sd-script-obj-type-pick"><div class="siebui-label siebui-sd-script-obj-type-label">'+zt+"</div>"+'<input type="text" id="'+Nt+'" name="'+Nt+'" aria-describedby=" '+kt+'" class="siebui-ctrl-select siebui-ctrl-input siebui-sd-script-obj-type" tabindex="0" role="combobox" readonly="readonly" aria-readonly="true">'+'<span class="siebui-icon-dropdown" id="'+kt+'"></span>'+'<ul class="siebui-sd-script-obj-type-list ui-menu forcehide" tabindex="0" role="combobox">'+'<li class="ui-menu-item" data-scriptobjtype="'+Wt+'">'+'<a href="javascript:;" tabindex="-1">'+Kt[Wt].text+"</a>"+"</li>"+'<li class="ui-menu-item" data-scriptobjtype="'+Xt+'">'+'<a href="javascript:;" tabindex="-1">'+Kt[Xt].text+"</a>"+"</li>"+'<li class="ui-menu-item" data-scriptobjtype="'+Vt+'">'+'<a href="javascript:;" tabindex="-1">'+Kt[Vt].text+"</a>"+"</li>"+'<li class="ui-menu-item" data-scriptobjtype="'+$t+'">'+'<a href="javascript:;" tabindex="-1">'+Kt[$t].text+"</a>"+"</li>"+"</ul>"+"</div>",chooseServerScriptObjNamePick:'<div id="scriptDebuggerServerScriptObjSection" class="siebui-sd-script-obj-pick"><input type="text" id="'+Ct+'" name="'+Ct+'" aria-describedby=" '+Lt+'" class="siebui-ctrl-select siebui-ctrl-input siebui-sd-script-obj-name" tabindex="0" readonly="readonly" aria-readonly="true">'+'<span class="siebui-icon-pick" id="'+Lt+'"></span>'+"</div>",chooseServerScriptObjTypeList:'<div id="scriptDebuggerServerScriptObjTypeList" class="siebui-sd-list"><div class="siebui-sd-list-title">'+zt+"</div>"+'<select id="scriptDebuggerServerScriptObjTypeListSelect" class="siebui-sd-list-select">'+'<option value="'+Wt+'">'+Kt[Wt].text+"</option>"+'<option value="'+Xt+'">'+Kt[Xt].text+"</option>"+'<option value="'+Vt+'">'+Kt[Vt].text+"</option>"+'<option value="'+$t+'">'+Kt[$t].text+"</option>"+"</select>"+"</div>",chooseServerScriptObjAppletList:'<div id="scriptDebuggerServerScriptObjAppletList" class="siebui-sd-list forcehide"><div class="siebui-sd-list-title">'+Wt+"</div>"+'<select id="scriptDebuggerServerScriptObjAppletListSelect" class="siebui-sd-list-select">'+"</select>"+"</div>",chooseServerScriptObjApplicationList:'<div id="scriptDebuggerServerScriptObjApplicationList" class="siebui-sd-list forcehide"><div class="siebui-sd-list-title">'+Xt+"</div>"+'<select id="scriptDebuggerServerScriptObjApplicationListSelect" class="siebui-sd-list-select">'+"</select>"+"</div>",chooseServerScriptObjBusCompList:'<div id="scriptDebuggerServerScriptObjBusCompList" class="siebui-sd-list forcehide"><div class="siebui-sd-list-title">'+Vt+"</div>"+'<select id="scriptDebuggerServerScriptObjBusCompListSelect" class="siebui-sd-list-select">'+"</select>"+"</div>",chooseServerScriptObjServiceList:'<div id="scriptDebuggerServerScriptObjServiceList" class="siebui-sd-list forcehide"><div class="siebui-sd-list-title">'+$t+"</div>"+'<select id="scriptDebuggerServerScriptObjServiceListSelect" class="siebui-sd-list-select">'+"</select>"+"</div>",chooseServerScriptObjOption:'<option value="{{scriptObjName}}">{{scriptObjName}}</option>',scriptDebuggerEditorTree:'<div class="siebui-se-tree" id="ScriptDebuggerEditorTree" type="Tree" name="ScriptDebuggerEditorTree"></div>',appendUL:"<ul></ul>",watchEntryLevel0:'<li class="siebui-sd-watch-level0" role=""><div class="siebui-sd-watch-entry"><span class="siebui-sd-entry-key-level0">{{key}}</span><span class="siebui-sd-entry-colon">:</span><span class="siebui-sd-entry-value">{{value}}</span></div></li>',watchEntry:'<li class="siebui-sd-watch-level1"><div class="siebui-sd-watch-entry"><span class="siebui-sd-entry-key">{{key}}</span><span class="siebui-sd-entry-colon">:</span><span class="siebui-sd-entry-value">{{value}}</span></div></li>',tmplScriptCall:'<li class="siebui-sd-script-call-entry" role="" data-object="{{object}}" data-procName="{{procName}}" data-lineNum="{{lineNum}}" data-scriptLang="{{scriptLang}}"><span class="siebui-sd-entry-select"></span><span class="siebui-sd-entry-object">{{object}}</span><span class="siebui-sd-entry-procedure">{{procName}}</span><span class="siebui-sd-entry-line">{{lineNum}}</span></li>',tmplDebugErrorMsg:'<li class="siebui-sd-error-entry" role="" title="{{errmsg}}" data-error-msg="{{errmsg}}"><span class="siebui-sd-error-msg">{{errmsg}}</span></li>',tmplDebuggerSettings:'<div id=""><ul id="scriptDebuggerSettingsSection" class="siebui-sd-settings-section" role="tablist"></ul></div>',tmplDebuggerSettingsEntry:'<li class="siebui-sd-settings-entry"><input type="checkbox" id="{{id}}" name="{{name}}"> {{label}}</li>',tmplDebuggerSettingsApplicaiton:'<li class="siebui-sd-settings-entry"><div class="siebui-application-list-title" data-userprefnameapp="{{userprefNameApp}}" data-userprefnamelang="{{userprefNameLang}}">{{appLabel}}</div><select id="scriptDebuggerApplicationListSelect" class="siebui-application-list-select"></select></li>',tmplDebuggerSettingsApplicaitonOption:'<option value="{{displayName}}" data-appname="{{appName}}" data-langname="{{langName}}">{{displayName}}</option>',tmplDebuggerSettingsLanguage:'<li class="siebui-sd-settings-entry"><div class="siebui-language-list-title"></div><select id="script-editor-language-list-select" class="siebui-language-list-select"></select></li>'},dn={init:function(e){this.renderer=null,this.jqScriptDebugger=$(),this.eventHelper=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper"),this.saPickCompMap={},e&&(this.renderer=e.renderer||null,this.jqScriptDebugger=e.jqScriptDebugger||$())},endLife:function(){this.renderer=null,this.jqScriptDebugger=null,this.eventHelper=null},showUI:function(){var e=this.jqScriptDebugger.find("#scriptDebuggerNavigationPanel"),t=0,r=0,i=n.IsTrue(SiebelApp.S_App.IsAutoOn()),s,o;if(e.length>0){if(Ut){e.append(cn.chooseServerScriptObjTypePick),e.append(cn.chooseServerScriptObjNamePick
);if(i){for(t=0,r=on.length;t<r;t++)s=an[on[t]],n.IsEmpty(s)||(o=e.find("#"+s.id),pn.call(this.renderer,o,s.type,s.id,s.text));var a=this;e.find("li.ui-menu-item").each(function(){var e=zt+"_"+$(this).attr("data-scriptobjtype");pn.call(a.renderer,$(this),u,e,e)})}for(t=0,r=Jt.length;t<r;t++){var f=SiebelAppFacade.ComponentMgr.FindComponent({id:Jt[t].comp_id});f&&(this.saPickCompMap[Jt[t].type]=f,f.GetPM().ExecuteMethod("SetupScriptObjSelection",Jt[t].type,Jt[t].text))}}else e.append(cn.chooseServerScriptObjTypeList),e.append(cn.chooseServerScriptObjAppletList),this.buildScriptObjOptions(e,Wt,[" Contact Quota Period List Applet"," User Profile Applet (CX_sService)","Agreement Detail Applet","Quote Item List Applet","Remote Client List Applet"]),e.append(cn.chooseServerScriptObjApplicationList),this.buildScriptObjOptions(e,Xt),e.append(cn.chooseServerScriptObjBusCompList),this.buildScriptObjOptions(e,Vt,["Account","CRA Master","Contact","Opportunity","Quote"]),e.append(cn.chooseServerScriptObjServiceList),this.buildScriptObjOptions(e,$t);e.append(cn.scriptDebuggerEditorTree)}},bindEvents:function(){if(this.eventHelper)if(Ut){var e=this.jqScriptDebugger.find("#"+kt);e.length>0&&this.eventHelper.Manage(e,"click",{ctx:this},this.onClickServerScriptObjTypePick);var t=this.jqScriptDebugger.find("ul.siebui-sd-script-obj-type-list");t.length>0&&(this.eventHelper.Manage(t.find("li.ui-menu-item"),"click",{ctx:this},this.onClickServerScriptObjType),t.find("a").hover(function(){$(this).toggleClass("ui-state-active")}),t.focusout(function(){var e=$(this);setTimeout(function(){var t=document.activeElement;e.find($(t)).length===0&&e[0]!==t&&e.addClass("forcehide"),e=null},10)}));var n=this.jqScriptDebugger.find("#"+Lt);n.length>0&&this.eventHelper.Manage(n,"click",{ctx:this},this.onClickServerScriptObjNamePick);var r=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjName");r.length>0&&this.eventHelper.Manage(r,"change",{ctx:this},this.onChangeServerScriptObjName)}else{var i=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjTypeListSelect");i.length>0&&this.eventHelper.Manage(i,"change",{ctx:this},this.onChangeServerScriptObjSelect);var s=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjAppletListSelect");s.length>0&&this.eventHelper.Manage(s,"change",{ctx:this},this.onChangeServerScriptObjSelect);var o=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjApplicationListSelect");o.length>0&&this.eventHelper.Manage(o,"change",{ctx:this},this.onChangeServerScriptObjSelect);var u=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjBusCompListSelect");u.length>0&&this.eventHelper.Manage(u,"change",{ctx:this},this.onChangeServerScriptObjSelect);var a=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjServiceListSelect");a.length>0&&this.eventHelper.Manage(a,"change",{ctx:this},this.onChangeServerScriptObjSelect)}},bindData:function(){if(n.IsEmpty(this.renderer))return;var e=this.renderer.GetPM(),t={};for(var r=0,i=Jt.length;r<i;r++)t[Jt[r].type]=window.sessionStorage.getItem("ScriptDebug_Type_"+Jt[r].type)||"";e.SetProperty("DebuggerTreeServerScriptObjTypeToNames",t);if(e.Get("IsInRefresh")){SiebelJS.Debug("[ScriptDebuggerNavigation] Debugger Tree refresh disabled.",!0);return}Ut?this.handleServerScriptObjTypeClick(Wt):this.handleServerScriptObjSelectChange()},buildScriptObjOptions:function(e,t,r){if(n.IsEmpty(this.renderer))return;Array.isArray(r)||(r=[]);if(r.length===0){var i=this.renderer.GetPM(),s=CCFMiscUtil_CreatePropSet(),o=CCFMiscUtil_CreatePropSet();s.SetProperty("ServerScriptObjType",t);if(i.ExecuteMethod("InvokeServiceMethod","GetDebuggerScriptObjList",s,o)){var u=o.GetProperty("DebuggerScriptObjList");CCFMiscUtil_StringToArray(u,r)}}var a=e.find("#scriptDebuggerServerScriptObj"+t+"ListSelect");for(var f=0,l=r.length;f<l;f++)a.append(hn.call(this,cn.chooseServerScriptObjOption,{scriptObjName:r[f]}));a.find("option").first().prop("selected",!0)},onClickServerScriptObjTypePick:function(e){e.preventDefault(),e.stopPropagation(),e.data.ctx.handleServerScriptObjTypePickClick()},handleServerScriptObjTypePickClick:function(){var e=SiebelApp.S_App.GetDirection(),t=this.jqScriptDebugger.find(".siebui-sd-script-obj-type-list");t.toggleClass("forcehide"),t.hasClass("forcehide")||(t.eq(0).position({my:e?"right top":"left top",at:e?"right bottom":"left bottom",of:this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjType"),collision:"flipfit flipfit"}),t.focus()),t=null},onClickServerScriptObjType:function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget).attr("data-scriptobjtype");e.data.ctx.handleServerScriptObjTypeClick(t)},handleServerScriptObjTypeClick:function(e,t){this.jqScriptDebugger.find(".siebui-sd-script-obj-type-list").addClass("forcehide");if(n.IsEmpty(this.renderer))return;if(!n.IsTrue(t)&&this.renderer.GetPM().Get("DebuggerTreeServerScriptObjType")===e)return;var r=this.renderer.GetPM(),i=r.Get("DebuggerTreeServerScriptObjTypeToNames")[e];r.SetProperty("DebuggerTreeServerScriptObjType",e),r.SetProperty("DebuggerTreeServerScriptObjName",i),this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjType").val(Kt[e].text),this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjName").val(i);var s=this;SiebelJS.Debug("[ScriptDebuggerNavigation] handleServerScriptObjTypeClick: uiStatus.Busy",!0),SiebelApp.S_App.uiStatus.Busy({mask:!0}),setTimeout(function(){$n.call(s.renderer,!0),SiebelApp.S_App.uiStatus.Free(),SiebelJS.Debug("[ScriptDebuggerNavigation] handleServerScriptObjTypeClick: uiStatus.Free",!0)},w)},onClickServerScriptObjNamePick:function(e){e.preventDefault(),e.stopPropagation(),e.data.ctx.handleServerScriptObjNamePickClick()},handleServerScriptObjNamePickClick:function(){if(n.IsEmpty(this.renderer))return;var e=this.renderer.GetPM(),t=e.Get("DebuggerTreeServerScriptObjType"),r=this.saPickCompMap[t];if(r){var i=CCFMiscUtil_CreatePropSet();i.SetProperty("StandaloneAppletName",Kt[t].comp_id),e.ExecuteMethod("InvokeServiceMethod"
,"ReexecuteScriptObj",i),r.GetPM().ExecuteMethod("ShowScriptObjSelection"),r=null}},onChangeServerScriptObjName:function(e){e.data.ctx.handleServerScriptObjNameChange()},handleServerScriptObjNameChange:function(){if(n.IsEmpty(this.renderer))return;var e=this.renderer.GetPM(),t=e.Get("DebuggerTreeServerScriptObjType"),r=e.Get("DebuggerTreeServerScriptObjTypeToNames");r[t]=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjName").val(),e.SetProperty("DebuggerTreeServerScriptObjName",r[t]),window.sessionStorage.setItem("ScriptDebug_Type_"+t,r[t]);var i=this;SiebelJS.Debug("[ScriptDebuggerNavigation] handleServerScriptObjNameChange: uiStatus.Busy",!0),SiebelApp.S_App.uiStatus.Busy({mask:!0}),setTimeout(function(){$n.call(i.renderer,!0),SiebelApp.S_App.uiStatus.Free(),SiebelJS.Debug("[ScriptDebuggerNavigation] handleServerScriptObjNameChange: uiStatus.Free",!0)},w)},onChangeServerScriptObjSelect:function(e){e.data.ctx.handleServerScriptObjSelectChange()},handleServerScriptObjSelectChange:function(){if(n.IsEmpty(this.renderer))return;var e=this.renderer.GetPM(),t=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjTypeListSelect").find("option:selected").val(),r="";e.SetProperty("DebuggerTreeServerScriptObjType",t);if(Ut){var i=e.Get("DebuggerTreeServerScriptObjTypeToNames");r=i[t],e.SetProperty("DebuggerTreeServerScriptObjName",r),this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjName").val(r)}else{var s=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjAppletList"),o=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjApplicationList"),u=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjBusCompList"),a=this.jqScriptDebugger.find("#scriptDebuggerServerScriptObjServiceList");switch(t){case Wt:s.removeClass("forcehide"),r=s.find("option:selected").text(),o.addClass("forcehide"),u.addClass("forcehide"),a.addClass("forcehide");break;case Xt:s.addClass("forcehide"),o.removeClass("forcehide"),r=o.find("option:selected").text(),u.addClass("forcehide"),a.addClass("forcehide");break;case Vt:s.addClass("forcehide"),o.addClass("forcehide"),u.removeClass("forcehide"),r=u.find("option:selected").text(),a.addClass("forcehide");break;case $t:s.addClass("forcehide"),o.addClass("forcehide"),u.addClass("forcehide"),a.removeClass("forcehide"),r=a.find("option:selected").text()}e.SetProperty("DebuggerTreeServerScriptObjName",r),s=null,o=null,u=null,a=null}$n.call(this.renderer,!0)}},vn={emptyFunc:function(){},gutterBreakpointClassName:"siebui-se-gutter-breakpoint",gutterCodeMirrorLineNumbersClassName:"CodeMirror-linenumbers",init:function(e){this.tabMap={},this.activeTabKey="",this.debugStopAtTabKey="",this.debugStopAtLineNum=-1,this.cmEditor=null,this.renderer=null,this.jqScriptDebugger=$(),this.eventHelper=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper"),e&&(this.renderer=e.renderer||null,this.jqScriptDebugger=e.jqScriptDebugger||$())},endLife:function(){this.cmEditor=null,this.renderer=null,this.jqScriptDebugger=null,this.eventHelper=null,SiebelApp.EventManager.removeListner("refreshScriptDebuggerScriptData",this.refreshScriptDebuggerScriptData,this),SiebelApp.EventManager.removeListner("refreshScriptDebuggerBreakpoints",this.refreshScriptDebuggerBreakpoints,this)},showUI:function(){var e=this.jqScriptDebugger.find("#scriptDebuggerScript");if(e.length===0)return;e.addClass("forcehide");var t=e[0];this.cmEditor=CodeMirror.fromTextArea(t,{value:""}),this.cmEditor.setOption("readOnly",!0),this.cmEditor.setOption("lineNumbers",!0),this.cmEditor.setOption("lineWrapping",!1),this.cmEditor.setOption("styleActiveLine",!0),this.cmEditor.setOption("matchBrackets",!0),this.cmEditor.setOption("tabSize",4),this.cmEditor.setOption("showCursorWhenSelecting",!0),this.cmEditor.setOption("lineWiseCopyCut",!1),this.cmEditor.setOption("mode","javascript"),this.cmEditor.setOption("viewportMargin",Infinity),e.data("cmInstance",this.cmEditor),this.setupGutterMarker(),n.IsTrue(SiebelApp.S_App.IsAutoOn())&&(this.cmEditor.setOption("matchBrackets",!1),pn.call(this.renderer,$(this.cmEditor.getWrapperElement()),o,"ScriptDebuggerCodeMirror","ScriptDebuggerCodeMirror"))},bindEvents:function(){if(this.eventHelper){var e=0;this.eventHelper.Manage($(window),Tt,{ctx:this},function(t){var n=t.data.ctx;e&&(clearTimeout(e),e=0),e=setTimeout(function(){n.setContentHeight(),n=null,e=0},10)})}SiebelApp.EventManager.addListner("refreshScriptDebuggerScriptData",this.refreshScriptDebuggerScriptData,this),SiebelApp.EventManager.addListner("refreshScriptDebuggerBreakpoints",this.refreshScriptDebuggerBreakpoints,this),n.IsTrue(SiebelApp.S_App.IsAutoOn())&&this.cmEditor.on("renderLine",function(e,t,n){var r="SD-Line"+v+(1+e.lineInfo(t).line);pn.call(this.renderer,$(n),l,r,r)})},refreshScriptDebuggerScriptData:function(e){if(n.IsEmpty(e))return;var t=this.renderer.GetPM(),r=e.scriptObjType,i=e.scriptObjName,s=e.eventName,o=e.eventData,u=e.eventNameOrig,a=e.operation,f=this.existTab(r,i,s);SiebelJS.Debug('[ScriptDebuggerEditor] Invoking "refreshScriptDebuggerScriptData" - eventName: "'+s+'"; eventNameOrig: "'+u+'"; Operation: "'+a,!0),f&&(SiebelJS.Debug('[ScriptDebuggerEditor] "'+s+'" Script has been opened in the debugger',!0),"DeleteRecord"===a||e.eventStateInactive&&"UpdateScriptState"===a?this.deleteTab(this.genTabKey(r,i,s)):a==="UpdateRecord"&&(f.eventData=o,this.isActiveTab(r,i,s)?(SiebelJS.Debug("[ScriptDebuggerEditor] Active Tab",!0),this.setEditorValue(f.scriptLang,f.eventData)):SiebelJS.Debug("[ScriptDebuggerEditor] Not Active Tab",!0))),(a==="NewRecord"||a==="UpdateRecord")&&s!==u&&!n.IsEmpty(u)&&this.existTab(r,i,u)&&this.deleteTab(this.genTabKey(r,i,u)),r===t.Get("DebuggerTreeServerScriptObjType")&&i===t.Get("DebuggerTreeServerScriptObjName")&&(a==="DeleteRecord"||a==="UpdateScriptState"||a==="NewRecord"||a==="UpdateRecord"&&s!==u&&!n.IsEmpty(u))&&(dn.handleServerScriptObjTypeClick(r,!0),SiebelJS.Debug("[ScriptDebuggerEditor] Script Tree refreshed",!0)),SiebelJS.Debug('[ScriptDebuggerEditor] Done Invoking "refreshScriptDebuggerScriptData".'
,!0)},refreshScriptDebuggerBreakpoints:function(e){if(n.IsEmpty(e))return;var t=this.renderer.GetPM(),r=e.scriptObjType,i=e.scriptObjName,s=e.eventName,o=e.bpLineArr,u=this.existTab(r,i,s);SiebelJS.Debug('[ScriptDebuggerEditor] Invoking "refreshScriptDebuggerBreakpoints"; ScriptEvent: '+s,!0),u?(SiebelJS.Debug("[ScriptDebuggerEditor] Script has been opened in the debugger",!0),u.bpLineArr=$.extend([],o),this.isActiveTab(r,i,s)?(SiebelJS.Debug("[ScriptDebuggerEditor] Active Tab",!0),this.loadBreakpoints(o)):SiebelJS.Debug("[ScriptDebuggerEditor] Not Active Tab",!0)):SiebelJS.Debug("[ScriptDebuggerEditor] Script is not opened in debugger",!0),SiebelJS.Debug('[ScriptDebuggerEditor] Done Invoking "refreshScriptDebuggerBreakpoints".',!0)},genTabKey:function(e,t,n){return e+v+t+v+n},isActiveTab:function(e,t,n){return this.activeTabKey===this.genTabKey(e,t,n)},existTab:function(e,t,n){return this.existTabByKey(this.genTabKey(e,t,n))},existTabByKey:function(e){return this.tabMap[e]},activateTab:function(e,t,n,r,i){this.activateTabByKey(this.genTabKey(e,t,n),r,i)},activateTabByKey:function(e,t,r){if(n.IsEmpty(e))return;var i=this.tabMap[e];if(i){var s=this.jqScriptDebugger.find("#scriptDebuggerEditorTabItems");if(s.length===0)return;if(this.activeTabKey!==e){var o=this.renderer.GetPM(),u=this.existTabByKey(this.activeTabKey);if(u){var a=this.cmEditor.getCursor();u.cursor.line=a.line,u.cursor.ch=a.ch}s.find(".active").removeClass("active").attr("aria-selected","false"),i.jqTab.addClass("active").attr("aria-selected","true"),this.setEditorValue(i.scriptLang,i.eventData),this.activeTabKey=e,r!==!0&&(o.SetProperty("ActiveEventScriptObjType",i.scriptObjType),o.SetProperty("ActiveEventScriptObjName",i.scriptObjName),o.SetProperty("ActiveEventScriptLangType",i.scriptLang),o.SetProperty("ActiveEventInactive",!1),o.SetProperty("ActiveEventEditable",!0),o.SetProperty("ActiveEventExistInDB",!0),o.SetProperty("ActiveEventName",i.eventName),o.SetProperty("ActiveEventData",i.eventData),o.SetProperty("EventBPLineArray",$.extend([],i.bpLineArr))),Nn.call(this.renderer),SiebelJS.Debug("[ScriptDebuggerEditor] loadBreakpoints: "+i.scriptObjType+" - "+i.scriptObjName+" - "+i.eventName+"; BPLineArray = '"+i.bpLineArr+"'",!0),this.loadBreakpoints(i.bpLineArr);if(!o.Get("IsInRefresh")){var f=CCFMiscUtil_CreatePropSet();f.SetProperty("DebugActiveTab",i.scriptObjType+v+i.scriptObjName+v+i.eventName+v+i.scriptLang),o.ExecuteMethod("InvokeServiceMethod","SetDebugActiveTab",f),SiebelJS.Debug("[ScriptDebugger] SetDebugActiveTab = '"+f.GetProperty("DebugActiveTab")+"'",!0)}}var l=this;setTimeout(function(){l.scrollToActiveTabLine(t),l=null},50)}},newTab:function(e,t,r,i,s,o,u,a){var f=this.jqScriptDebugger.find("#scriptDebuggerEditorTabItems");if(f.length===0)return;var l=this.genTabKey(e,t,r);if(this.existTabByKey(l))return;var c={scriptTabKey:l,scriptObjType:Kt[e].text,scriptObjName:t,eventName:r},h=hn.call(this,cn.scriptDebuggerEditorTabItem,c);f.append(h);var p=f.find(".siebui-sd-editor-tab-item").last();o.sort(function(e,t){return e-t}),this.tabMap[l]={scriptObjType:e,scriptObjName:t,scriptLang:i,eventName:r,eventData:s,bpLineArr:$.extend([],o),cursor:{line:0,ch:0},jqTab:p},this.setEditorHeight(),this.eventHelper&&(this.eventHelper.Manage(p.find("#"+Ot),"click",{ctx:this},this.onClickTabItemClose),this.eventHelper.Manage(p,"click",{ctx:this},this.onClickTabItem));if(n.IsTrue(SiebelApp.S_App.IsAutoOn())){var d,m;d=an.tabitem,n.IsEmpty(d)||(m=p,pn.call(this.renderer,m,d.type,l,l)),d=an.tabclose,n.IsEmpty(d)||(m=p.find("#"+d.id),pn.call(this.renderer,m,d.type,l+v+d.id,d.text))}u&&this.activateTabByKey(l,a,!0)},deleteTab:function(e){if(this.tabMap[e]){var t=this.tabMap[e].jqTab,n="";if(t){var r=t.next();r.length===0&&(r=t.prev()),r.length!==0&&(n=r.attr("data-scripttabkey")),t.find("#"+Ot).off("click"),t.off("click").remove(),this.setEditorHeight()}delete this.tabMap[e];if(Object.keys(this.tabMap).length===0){this.activeTabKey="",this.setEditorValue();var i=this.renderer.GetPM();i.SetProperty("ActiveEventScriptObjType",""),i.SetProperty("ActiveEventScriptObjName",""),i.SetProperty("ActiveEventScriptLangType",""),i.SetProperty("ActiveEventInactive",!1),i.SetProperty("ActiveEventEditable",!1),i.SetProperty("ActiveEventExistInDB",!1),i.SetProperty("ActiveEventName",""),i.SetProperty("ActiveEventData",""),i.SetProperty("EventBPLineArray",[]),Nn.call(this.renderer);var s=CCFMiscUtil_CreatePropSet();s.SetProperty("DebugActiveTab",""),i.ExecuteMethod("InvokeServiceMethod","SetDebugActiveTab",s),SiebelJS.Debug("[ScriptDebugger] SetDebugActiveTab = ''",!0)}else e===this.activeTabKey&&(this.activeTabKey="",this.setEditorValue(),this.activateTabByKey(n))}},setActiveTab:function(e){if(!n.IsEmpty(e)){var t=e.split(v),r=t.length;r===4?this.gotoDebuggerEditorLine(t[0],t[1],t[2],t[3]):SiebelJS.Log('[ScriptDebugger] setActiveTab: Ignore invalid ActiveTab Info = "'+e+'".',!0)}},gotoDebuggerEditorLine:function(e,t,n,r,i,s){var o=this.renderer.GetPM();e=e.trim(),s&&(o.Get(m)!==g&&o.ExecuteMethod("SetDebugState",g),this.clearDebugStopAt(),this.debugStopAtTabKey=this.genTabKey(e,t,n),this.debugStopAtLineNum=i),this.existTab(e,t,n)?this.activateTab(e,t,n,i):(o.ExecuteMethod("GetEventData",n,{isScriptDebugger:!0,scriptObjType:e,scriptObjName:t,scriptLang:r}),o.SetProperty("ActiveEventScriptObjType",e),o.SetProperty("ActiveEventScriptObjName",t),this.newTab(e,t,n,o.Get("ActiveEventScriptLangType"),o.Get("ActiveEventData"),o.Get("EventBPLineArray"),!0,i))},scrollToActiveTabLine:function(e){if(!this.existTabByKey(this.activeTabKey))return;var t=this.tabMap[this.activeTabKey].cursor,r=0,i=0;n.IsEmpty(e)?this.activeTabKey===this.debugStopAtTabKey&&this.debugStopAtLineNum!==-1?r=this.debugStopAtLineNum:(r=t.line,i=t.ch):r=e,this.activeTabKey===this.debugStopAtTabKey&&this.debugStopAtLineNum!==-1&&this.cmEditor.addLineClass(this.debugStopAtLineNum,"wrap","siebui-sd-current-debug-line");var s=this.cmEditor.lineAtHeight(this.cmEditor.display.scroller.getBoundingClientRect
().top),o=this.cmEditor.lineAtHeight(this.cmEditor.display.scroller.getBoundingClientRect().bottom),u=this.jqScriptDebugger.find(".CodeMirror-hscrollbar:visible").length?4:3;(r<=s+1||o-u<=r)&&this.cmEditor.scrollIntoView({line:r,ch:i},$(this.cmEditor.display.scroller).height()/2),this.cmEditor.setCursor({line:r,ch:i}),this.cmEditor.focus()},clearDebugStopAt:function(){if(n.IsEmpty(this.cmEditor))return;this.activeTabKey===this.debugStopAtTabKey&&this.cmEditor.removeLineClass(this.debugStopAtLineNum,"wrap","siebui-sd-current-debug-line"),this.debugStopAtTabKey="",this.debugStopAtLineNum=-1},onClickTabItemClose:function(e){e.preventDefault(),e.stopPropagation();var t=$(e.currentTarget).parent().parent().attr("data-scripttabkey");e.data.ctx.deleteTab(t)},onClickTabItem:function(e){var t=$(e.currentTarget).attr("data-scripttabkey");e.data.ctx.activateTabByKey(t)},setContentHeight:function(){var e=this;DOMUtils.Read(function(){var t=e.jqScriptDebugger.outerHeight(),n=e.jqScriptDebugger.find("#scriptDebuggerHeader").outerHeight(),r=e.jqScriptDebugger.find("#scriptDebuggerProfiler").outerHeight();DOMUtils.Write(function(){e.jqScriptDebugger.hasClass("siebui-sd-float")?e.jqScriptDebugger.find("#scriptDebuggerContent").height(t-n-r):e.jqScriptDebugger.find("#scriptDebuggerContent").height(""),e.setEditorHeight(),e=null})})},setEditorHeight:function(){if(this.cmEditor===null)return;var e=this.jqScriptDebugger.find("#scriptDebuggerEditorPanel"),t=this.cmEditor;DOMUtils.Read(function(){var r=e.outerHeight(),i=e.find("#scriptDebuggerEditorTabPanel").outerHeight(),s=e.find("#scriptDebuggerProfiler").outerHeight();n.IsEmpty(s)&&(s=0),DOMUtils.Write(function(){t.setSize(null,r-i-s),t=null,e=null,mn.resize()})})},setEditorValue:function(e,t){if(this.cmEditor===null)return;var r=e==="SBL"?"vbscript":"javascript";this.cmEditor.setOption("mode",r),n.IsEmpty(t)&&(t=""),SiebelJS.Debug("[ScriptDebuggerEditot] setEditorValue - Start",!0),this.cmEditor.setValue(t),SiebelJS.Debug("[ScriptDebuggerEditor] setEditorValue - End",!0)},setupGutterMarker:function(){if(n.IsEmpty(this.renderer))return;if(this.cmEditor===null)return;var e=this.renderer.GetPM(),t=[this.gutterCodeMirrorLineNumbersClassName],r=this;t.unshift(this.gutterBreakpointClassName),this.cmEditor.setOption("gutters",t),this.cmEditor.on("gutterClick",function(t,n,i,s){s.which===1&&(i===r.gutterBreakpointClassName&&e.Get("ActiveEventExistInDB")?r.toggleBreakpoint({lineNum:n}):r.scrollToActiveTabLine(n)),t.hasFocus()||t.focus()}),this.cmEditor.on("gutterContextMenu",function(t,n,i,s){s.preventDefault(),s.stopPropagation(),(i===r.gutterBreakpointClassName||i===r.gutterCodeMirrorLineNumbersClassName)&&e.Get("ActiveEventExistInDB")&&r.showBreakpointContextMenu(t,n,r.gutterBreakpointClassName,s)})},showBreakpointContextMenu:function(e,n,r,i){var s=this.renderer.GetPM(),o=this,u=[];u.push({label:t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_TOGGLE_BREAKPOINT"),action:function(e){s.Get("ActiveEventExistInDB")&&o.toggleBreakpoint({lineNum:n})}}),u.push({label:t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_CLEAR_ALL_BREAKPOINTS"),action:function(e){s.Get("ActiveEventExistInDB")&&o.clearAllBreakpoints()}});var a=$(".siebui-se-breakpoint-menu");a.length>0?a.empty():a=$('<ul class="siebui-se-breakpoint-menu ui-menu"></ul>').appendTo(document.body),u.forEach(function(e){var t=$('<li><a href="#">'+e.label+"</a></li>");t.addClass("siebui-se-breakpoint-menu-item ui-menu-item"),e.action&&t.find("a").click(function(t){e.action(t)}).mousedown(function(e){e.preventDefault()}).hover(function(){$(this).toggleClass("ui-state-active")}),t.appendTo(a)}),a.show().css({left:i.pageX+1,top:i.pageY+1});var f=$('<div class="siebui-se-breakpoint-menu-background"></div>').css("z-index",a.css("z-index")).css("position",a.css("position")).css({left:0,top:0,width:"100%",height:"100%"}).insertBefore(a).on("contextmenu mousedown",function(e){e.preventDefault()}).on("contextmenu click",function(e){return f.remove(),a.remove(),!1});a.find("a").click(function(e){f.remove(),a.remove()})},toggleBreakpointMarker:function(e){var t=null;return e?t:(t=$('<div class="siebui-se-breakpoint"></div>'),t[0])},loadBreakpoints:function(e){this.cmEditor.clearGutter(this.gutterBreakpointClassName);if(!n.IsEmpty(e))for(var t=0,r=e.length;t<r;t++){var i=parseInt(e[t],10);!n.IsEmpty(i)&&!isNaN(i)&&this.cmEditor.setGutterMarker(i-1,this.gutterBreakpointClassName,this.toggleBreakpointMarker(this.cmEditor.lineInfo(i-1).gutterMarkers))}},toggleBreakpointAtLine:function(e,t){var r,i,s,o;n.IsEmpty(e)||(r=e.scriptObjType,i=e.scriptObjName,s=e.eventName,o=e.lineNum);var u=this.existTabByKey(this.activeTabKey),a=!1;u&&(n.IsEmpty(r)||n.IsEmpty(i)||n.IsEmpty(s)?(a=!0,r=u.scriptObjType,i=u.scriptObjName,s=u.eventName):this.activeTabKey===this.genTabKey(r,i,s)&&(a=!0));if(n.IsEmpty(o)||isNaN(o)){if(!a)return;o=this.cmEditor.getCursor().line}if(t){var f=this.existTabByKey(this.genTabKey(r,i,s));if(f){var l=!1,c=o+1;for(var h=0,p=f.bpLineArr.length;h<p;h++){if(f.bpLineArr[h]===c){f.bpLineArr.splice(h,1),l=!0;break}if(f.bpLineArr[h]>c){f.bpLineArr.splice(h,0,c),l=!0;break}}l||f.bpLineArr.push(c)}a&&(this.cmEditor.setGutterMarker(o,this.gutterBreakpointClassName,this.toggleBreakpointMarker(this.cmEditor.lineInfo(o).gutterMarkers)),this.cmEditor.focus())}this.renderer.GetPM().ExecuteMethod("ToggleBreakpoint",s,o+1,{isScriptDebugger:!0,scriptObjType:r,scriptObjName:i},t),t&&SiebelApp.EventManager.fireEvent("refreshScriptEditorBreakpoints",{action:"toggle",scriptObjType:r,scriptObjName:i,eventName:s,bpLine:(o+1).toString()})},toggleBreakpoint:function(e){this.toggleBreakpointAtLine(e,!0)},stepToCursor:function(e){this.toggleBreakpointAtLine(e,!1)},clearAllBreakpoints:function(){n.Confirm(t.GetLocalString("WT_SCRIPT_EDITOR_CONFIRM_CLEAR_ALL_BREAKPOINTS"))&&(this.clearAllBreakpointsFromTabs(),this.existTabByKey(this.activeTabKey)&&(this.cmEditor.clearGutter(this.gutterBreakpointClassName),this.cmEditor.focus()),this.renderer.GetPM().ExecuteMethod
("ClearAllBreakpoints"),SiebelApp.EventManager.fireEvent("refreshScriptEditorBreakpoints",{action:"clearall"}))},clearAllScriptObjBreakpoints:function(e,t){var r=this.existTabByKey(this.activeTabKey),i=!1;r&&(n.IsEmpty(e)||n.IsEmpty(t)?(i=!0,e=r.scriptObjType,t=r.scriptObjName):r.scriptObjType===e&&r.scriptObjName===t&&(i=!0)),!n.IsEmpty(e)&&!n.IsEmpty(t)&&(this.clearAllBreakpointsFromTabs(e,t),i&&(this.cmEditor.clearGutter(this.gutterBreakpointClassName),this.cmEditor.focus()),this.renderer.GetPM().ExecuteMethod("ClearAllScriptObjBreakpoints",{isScriptDebugger:!0,scriptObjType:e,scriptObjName:t}),SiebelApp.EventManager.fireEvent("refreshScriptEditorBreakpoints",{action:"clearallscriptobj",scriptObjType:e,scriptObjName:t}))},clearAllBreakpointsFromTabs:function(e,t){var r=this,i=n.IsEmpty(e)&&n.IsEmpty(t);Object.keys(this.tabMap).forEach(function(n){var s=r.tabMap[n];if(i||e===s.scriptObjType&&t===s.scriptObjName)s.bpLineArr=[]})}},mn={init:function(e){},show:function(){SiebelJS.Log("scriptDebuggerProfileWindow: show");var e=$("#scriptDebuggerProfiler"),t=e.find("#scriptDebuggerProfilerHeader");t.find("ul").length===0&&t.append(cn.appendUL);if(t.find(".siebui-sd-profile-header-column_m").length===0)for(var r=0;r<ln.length;r++){SiebelJS.Log("scriptDebuggerProfileWindow: add header: "+ln[r]);var i=hn.call(this,cn.profileHeader,{column:ln[r]});r===1&&(i=hn.call(this,cn.profileHeader_w,{column:ln[r]})),r===0&&(i=hn.call(this,cn.profileHeader_m,{column:ln[r]})),t.find("ul").append(i)}else SiebelJS.Log("scriptDebuggerProfileWindow: show: already has header");e.addClass("siebui-sd-profile-frame"),$("#scriptDebuggerProfilerTree").css("height","200px");var s=n.IsTrue(SiebelApp.S_App.IsAutoOn());s&&pn.call(this,e,o,"scriptDebuggerProfiler","scriptDebuggerProfiler")},resize:function(){var e=$("#scriptDebuggerProfiler"),t=e.find(".siebui-sd-profile-header-column_w").width(),n=e.find(".siebui-sd-profile-header-column").width(),r=e.find(".siebui-sd-profile-header-column_m").width(),i=e.find("#scriptDebuggerProfilerTree");i.find(".siebui-sd-profile-entry-value").css("width",n),i.find(".siebui-sd-profile-entry-value_m").css("width",r),i.find(".siebui-sd-profile-entry-value_w").each(function(){var e=$(this).next().text(),n=e.split(","),r=n[0]*20;n.length>1&&n[1]>0&&(r+=13),$(this).css("width",t-r)})},refresh:function(){SiebelJS.Log("scriptDebuggerProfileWindow: refresh");var e=this.GetPM(),t=e.Get("ProfileNodes"),n={},r=1;while(Object.keys(n).length<Object.keys(t).length&&r<=10){var i;for(i in t)SiebelJS.Log("scriptDebuggerProfileWindow: refresh: "+i),n[i]!==!0&&(mn.update.call(this,i)===!0?n[i]=!0:SiebelJS.Log("scriptDebuggerProfileWindow: refresh: "+i+": fails"));SiebelJS.Log("scriptDebuggerProfileWindow: refresh: "+r+"st loop"),SiebelJS.Log("scriptDebuggerProfileWindow: refresh: expected: "+Object.keys(t).length),SiebelJS.Log("scriptDebuggerProfileWindow: refresh: completed: "+Object.keys(n).length),r++}SiebelJS.Log("scriptDebuggerProfileWindow: refresh: done")},update:function(t){SiebelJS.Log("scriptDebuggerProfileWindow: update");var r=n.IsTrue(SiebelApp.S_App.IsAutoOn()),i=$("#scriptDebuggerProfiler"),s=i.find("#scriptDebuggerProfilerTree");s.find("ul").length===0&&s.append(cn.appendUL);var o=this.GetPM(),a=o.Get("ProfileNodes");if(n.IsEmpty(t)||n.IsEmpty(a)){SiebelJS.Log("scriptDebuggerProfileWindow: update, either thisNode or ProfileNodes is empty");return}var f=a[t];if(n.IsEmpty(f)){SiebelJS.Log("scriptDebuggerProfileWindow: update, profileNodes has no data for "+t);return}SiebelJS.Log("scriptDebuggerProfileWindow: update, handle:"+t+", parent:"+f.m_pParent);var c=s.find("#"+f.m_pThisNode),h;if(c.length===0){var p;SiebelJS.Log("scriptDebuggerProfileWindow: update: need to add a new node"),f.m_pParent==="0"?p=s:p=s.find("#"+f.m_pParent);if(p.length===0)return SiebelJS.Log("scriptDebuggerProfileWindow: update: fail to locate parent node"),!1;h=hn.call(this,cn.profileEntry_li,{thisNode:f.m_pThisNode}),p&&p.find("ul").length===0&&(p.append(cn.appendUL),p.find(".siebui-sd-profile-tree-entry").first().addClass("siebui-sd-expanded"),p.find(".siebui-sd-profile-tree-entry").first().addClass("siebui-open")),p.find(">ul").append(h),c=s.find("#"+f.m_pThisNode)}else SiebelJS.Log("scriptDebuggerProfileWindow: update: found an existed node");c=c.find(">.siebui-sd-profile-tree-entry");if(c.length===0)return SiebelJS.Log("scriptDebuggerProfileWindow: update: fails to locate thisNode"),!1;var d,v,m,g,y="",b="";if(f.m_pParent==="0")f.m_sMethodName=e.get("ROOT_NODE"),y="siebui-sd-print";else{var w=/[a-z]+\[[a-z\s]+\]::[a-z0-9]+/i;if(w.test(f.m_sMethodName)){y="siebui-sd-checkbox-unchecked",c.hasClass("siebui-open")===!1&&c.hasClass("siebui-closed")===!1&&(c.addClass("siebui-sd-expanded"),c.addClass("siebui-open"),c.find(">ul").length===0&&c.append(cn.appendUL));var E=f.m_sMethodName.split(":"),S=E[0].split("[");g=E[0],d=S[0],v=S[1].split("]")[0],m=E[2],b=d+":"+v+":"+m}f.m_Lines!==null&f.m_Lines.length>0&&(y="siebui-sd-checkbox-checked")}var x=f.m_Level+",";y!==""?x+="1":x+="0",h=hn.call(this,cn.profileEntry_data,{thisNode:f.m_pThisNode,parentNode:f.m_pParent,hiddenV:x,menu:"",method:f.m_sMethodName,callcount:f.m_nCallCount,totalt:f.m_nTotalTime,maxt:f.m_nMaxTime,mint:f.m_nMinTime,totalselft:f.m_nTotalSelfTime,maxselft:f.m_nMaxSelfTime,minselft:f.m_nMinSelfTime}),c.html(h),c.find(".siebui-sd-profile-entry-value_m").addClass(y);var T;if(r&&y!==""){T=c.find(".siebui-sd-profile-entry-value_m");if(f.m_pParent==="0"){var N="Profile"+f.m_sMethodName;pn.call(this,T,u,N,N)}else pn.call(this,T,u,f.m_sMethodName,f.m_sMethodName)}var C=$("#scriptDebuggerProfiler").find(".siebui-sd-profile-header-column_w").width(),k=$("#scriptDebuggerProfiler").find(".siebui-sd-profile-header-column").width(),L=$("#scriptDebuggerProfiler").find(".siebui-sd-profile-header-column_m").width(),A=0;y!==""&&(A=13);var O=f.m_Level*20+A,M=C-O;c.find(">.siebui-sd-profile-entry-value_w").css("width",M),c.find(">.siebui-sd-profile-entry-value").css("width"
,k),c.find(">.siebui-sd-profile-entry-value_m").css("width",L),c=c.parent();var _=c.find(">ul").find(">.siebui-sd-profile-tree-li-profile");_.remove();if(f.m_Lines!==null&f.m_Lines.length>0){c.find(">ul").length===0&&(SiebelJS.Log("scriptDebuggerProfileWindow: update: error: it should have ul already."),c.append(cn.appendUL),c.find(">.siebui-sd-profile-tree-entry").addClass("siebui-sd-expanded"),c.find(">.siebui-sd-profile-tree-entry").addClass("siebui-open"));var D=o.Get("ScriptLangType");o.ExecuteMethod("GetEventData",m,{isScriptDebugger:!0,scriptObjType:d,scriptObjName:v,scriptLang:D});var P=o.Get("ActiveEventData"),H=P.split("\n");SiebelJS.Log("scriptDebuggerProfileWindow: update, method: "+f.m_sMethodName),SiebelJS.Log("scriptDebuggerProfileWindow: update, eventData: "+P);var B=CCFMiscUtil_CreatePropSet(),j=CCFMiscUtil_CreatePropSet(),F,I;for(I=0;I<f.m_Lines.length;I++){F=f.m_Lines[I];var q=CCFMiscUtil_CreatePropSet();q.SetProperty("ScriptLangType",D),q.SetProperty("_vobj",g),q.SetProperty("_vproc",m),q.SetProperty("_vlnum",F.m_nLineNum),B.AddChild(q)}o.ExecuteMethod("InvokeServiceMethod","RebuildCallStackData",B,j);for(I=0;I<f.m_Lines.length;I++){F=f.m_Lines[I],SiebelJS.Log("scriptDebuggerProfileWindow: update, line"+I+":"+F.m_nLineNum+","+F.m_nCount+","+F.m_nTimeTotal),x=f.m_Level+1,x+=",lp;",x+=b;var R="";if(j.IsEmpty()===!1&&j.GetChild(I)){var U=j.GetChild(I).GetProperty("_vlnum");SiebelJS.Log("scriptDebuggerProfileWindow: update, line"+I+":"+F.m_nLineNum+"-->"+U),R=U+":",H.length>=U&&(R+=H[U-1])}h=hn.call(this,cn.profileEntry_li_lp_data,{hiddenV:x,method:R,callcount:F.m_nCount,totalt:F.m_nTimeTotal}),c.find(">ul").find(">.siebui-sd-profile-tree-li-profile").length===0?c.find(">ul").prepend(h):c.find(">ul").find(">.siebui-sd-profile-tree-li-profile:last").after(h);if(r){T=c.find(">ul").find(">.siebui-sd-profile-tree-li-profile:last"),T=T.find(".siebui-sd-profile-entry-value_w");var z=R.replace(/[^\w]/gi,"");pn.call(this,T,l,z,z)}}O=(f.m_Level+1)*20;var W=c.find(">ul").find(">.siebui-sd-profile-tree-li-profile");M=C-O,W.find(".siebui-sd-profile-entry-value_w").css("width",M),W.find(".siebui-sd-profile-entry-value").css("width",k),W.find(".siebui-sd-profile-entry-value_m").css("width",L)}return s.find(".siebui-sd-profile-tree-entry").off("click").on("click",function(e){e.preventDefault(),e.stopPropagation();if(e.currentTarget===e.target){var t=$(e.currentTarget);t.next().length!==0&&(t.toggleClass("siebui-open").next().toggle(),t.toggleClass("siebui-closed").next().toggle(),t.toggleClass("siebui-sd-expanded").next().toggle())}if(e.target.className.indexOf("siebui-sd-profile-entry-value_w")>=0){var n=$(e.target).text(),r=n.split(":"),i=r[0];if($(e.target).parent().find(">.siebui-sd-profile-entry-value_h").text().indexOf(",lp")>=0){var s=$(e.target).parent().find(">.siebui-sd-profile-entry-value_h").text(),u=s.split(";");if(u.length===2){var a=u[1].split(":");if(a.length!==3)return;var f=a[0],l=a[1],c=a[2],h=o.Get("ScriptLangType");vn.gotoDebuggerEditorLine(f,l,c,h,i-1,!1)}}return}if(e.target.className.indexOf("siebui-sd-profile-entry-value_m")>=0){SiebelJS.Log("scriptDebuggerProfileWindow: click: siebui-sd-profile-entry-value_m");if(e.target.className.indexOf("siebui-sd-print")>=0){SiebelJS.Log("scriptDebuggerProfileWindow: click: siebui-sd-profile-entry-value_m: P"),$("#scriptDebuggerContent").addClass("siebui-sd-profile-print").addClass("forcehide"),$("#scriptDebuggerHeader").addClass("siebui-sd-profile-print").addClass("forcehide"),$("#_sweview").addClass("siebui-sd-profile-print").addClass("forcehide"),$("#_swecontent").addClass("siebui-sd-profile-print").addClass("forcehide"),$("#s_sctrl").addClass("siebui-sd-profile-print").addClass("forcehide"),$("#scriptDebuggerProfilerTree").addClass("siebui-noscroll"),window.print(),$("#scriptDebuggerContent").removeClass("siebui-sd-profile-print").removeClass("forcehide"),$("#scriptDebuggerHeader").removeClass("siebui-sd-profile-print").removeClass("forcehide"),$("#_sweview").removeClass("siebui-sd-profile-print").removeClass("forcehide"),$("#_swecontent").removeClass("siebui-sd-profile-print").removeClass("forcehide"),$("#s_sctrl").removeClass("siebui-sd-profile-print").removeClass("forcehide"),$("#scriptDebuggerProfilerTree").removeClass("siebui-noscroll");return}var p,d;e.target.className.indexOf("siebui-sd-checkbox-checked")>=0&&(SiebelJS.Log("scriptDebuggerProfileWindow: click: siebui-sd-profile-entry-value_m: E"),d=$(e.target).parent().find(".siebui-sd-profile-entry-value_w").text(),p=!1),e.target.className.indexOf("siebui-sd-checkbox-unchecked")>=0&&(SiebelJS.Log("scriptDebuggerProfileWindow: click: siebui-sd-profile-entry-value_m: D"),d=$(e.target).parent().find(".siebui-sd-profile-entry-value_w").text(),p=!0);if(p===!0||p===!1){var v=$(e.target).css("background-color");$(e.target).css("background-color","blue"),$(e.target).css("background-color",v),SiebelJS.Debug("[ScriptEditorPR] UpdateLineProfileRule: "+d,!0),o.ExecuteMethod("UpdateLineProfileRule",d,p),$(e.target).toggleClass("siebui-sd-checkbox-checked"),$(e.target).toggleClass("siebui-sd-checkbox-unchecked")}}}),!0},hide:function(){SiebelJS.Log("scriptDebuggerProfileWindow: hide"),this.hideWindowSectionBodyData("#scriptDebuggerProfilerHeader",!0),this.hideWindowSectionBodyData("#scriptDebuggerProfilerTree",!0);var e=$("#scriptDebuggerProfiler");e.removeClass("siebui-sd-profile-frame"),$("#scriptDebuggerProfilerTree").css("height","0px")},hideWindowSectionBodyData:function(e,t){var n=$("#scriptDebuggerProfiler"),r=n.find(e).find("ul");r&&r.remove()}},gn={init:function(e){this.renderer=null,this.jqScriptDebugger=$(),this.eventHelper=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper"),e&&(this.renderer=e.renderer||null,this.jqScriptDebugger=e.jqScriptDebugger||$())},endLife:function(){this.renderer=null,this.jqScriptDebugger=null,this.eventHelper=null},showUI:function(){var e=this.jqScriptDebugger.find("#scriptDebuggerWindowsPanel"),t=e.find("#scriptDebuggerWindowsWatchPanel"
);t.append(hn.call(this,cn.scriptDebuggerWindowItem,{windowItemId:Mt,windowItemName:Bt,windowItemNoEntry:It}));var r=e.find("#scriptDebuggerWindowsScriptCallPanel");r.append(hn.call(this,cn.scriptDebuggerWindowItem,{windowItemId:_t,windowItemName:jt,windowItemNoEntry:qt}));var i=e.find("#scriptDebuggerWindowsErrorPanel");i.append(hn.call(this,cn.scriptDebuggerWindowItem,{windowItemId:Dt,windowItemName:Ft,windowItemNoEntry:Rt})),i.find(".siebui-sd-window-section-header").append(cn.scriptDebuggerErrorButtons);if(n.IsTrue(SiebelApp.S_App.IsAutoOn())){var s,o;for(var u=0,a=un.length;u<a;u++)s=an[un[u]],n.IsEmpty(s)||(o=e.find("#"+s.id),pn.call(this.renderer,o,s.type,s.id,s.text))}},bindEvents:function(){if(this.eventHelper){var e=this.jqScriptDebugger.find(".siebui-sd-window-section-header");e.length>0&&this.eventHelper.Manage(e,"click",{ctx:this},this.onClickWindowSectionToggle);var t=this.jqScriptDebugger.find("#scriptDebuggerWindowsErrorPanel").find(".siebui-sd-error-clear");t.length>0&&this.eventHelper.Manage(t,"click",{ctx:this},this.onClickErrorClear)}},doOpenDataWindow:function(e,t){e.find(".siebui-sd-window-section-toggle").toggleClass("siebui-sd-window-section-expanded"),e.parent().find(".siebui-sd-window-section-body").toggleClass("forcehide"),e.parent().find(".siebui-sd-btns").toggleClass("forcehide"),t||this.renderer.GetPM().ExecuteMethod("SetDebugDataWindowState",e[0].id.slice(14,-5),e.parent().find(".siebui-sd-window-section-body").hasClass("forcehide"))},notifyExpandDataWindow:function(e){this.doOpenDataWindow(this.jqScriptDebugger.find("#scriptDebugger"+e+"Title"),!0)},onClickWindowSectionToggle:function(e){e.preventDefault(),e.stopPropagation(),e.data.ctx.doOpenDataWindow($(e.currentTarget),!1)},onClickErrorClear:function(e){e.preventDefault(),e.stopPropagation(),e.data.ctx.renderer.GetPM().ExecuteMethod("RemoveErrorData")},showWindowSectionBodyData:function(e,t){var n=this.jqScriptDebugger.find(e);n.find(".siebui-sd-window-section-body-default").addClass("forcehide"),n.find(".siebui-sd-window-section-body-data").removeClass("forcehide"),t&&n.find(".siebui-sd-window-section-body-data").find("ul").remove()},hideWindowSectionBodyData:function(e,t){var n=this.jqScriptDebugger.find(e);n.find(".siebui-sd-window-section-body-default").removeClass("forcehide"),n.find(".siebui-sd-window-section-body-data").addClass("forcehide"),t&&n.find(".siebui-sd-window-section-body-data").find("ul").remove()},removeErrorData:function(){this.hideWindowSectionBodyData("#scriptDebuggerWindowsErrorPanel",!0)},addErrorData:function(e){if(n.IsEmpty(e)||e.GetPropertyCount()===0)return;this.showWindowSectionBodyData("#scriptDebuggerWindowsErrorPanel",!1);var t=this.jqScriptDebugger.find("#scriptDebuggerWindowsErrorPanel .siebui-sd-window-section-body-data");t.find("ul").length===0&&t.append(cn.appendUL);for(var r=0,i=e.GetPropertyCount();r<i;r++){var s=hn.call(this,cn.tmplDebugErrorMsg,{errmsg:e.GetProperty(""+r)});t.find("ul").append(s)}},removeScriptCallData:function(){this.hideWindowSectionBodyData("#scriptDebuggerWindowsScriptCallPanel",!0)},setScriptCallData:function(t){if(n.IsEmpty(t)||t.GetChildCount()===0){this.removeScriptCallData();return}this.showWindowSectionBodyData("#scriptDebuggerWindowsScriptCallPanel",!0);var r=this.jqScriptDebugger.find("#scriptDebuggerWindowsScriptCallPanel .siebui-sd-window-section-body-data");r.append(cn.appendUL);var i=n.IsTrue(SiebelApp.S_App.IsAutoOn());for(var s=0,o=t.GetChildCount();s<o;s++){var u,a,f,c,h=0,p=t.GetChild(s);if(p){var d={},v;for(var m=!0;(v=p.EnumProperties(m))!==null;m=!1){var g=p.GetProperty(v);switch(v){case e.get("SCRIPTDEBUG_DATA_LINENUMBER"):case"lineNum":v="lineNum",h=parseInt(g,10);if(n.IsEmpty(h)||isNaN(h))h=0;break;case e.get("SCRIPTDEBUG_DATA_OBJECT"):case"object":if(v==="object"){var y=g.replace("(","[");g=y.replace(")","]")}v="object";var b=g.indexOf("["),w=g.lastIndexOf("]");u=g.substring(0,b),a=g.substring(b+1,w);break;case e.get("SCRIPTDEBUG_DATA_PROC"):case"procName":v="procName",f=g;break;case"ScriptLangType":v="scriptLang",c=g;break;default:SiebelJS.Log("[ScriptDebugger] setScriptCallData - not supported property: ["+v+"]='"+g+"'",!0)}d[v]=g}var E=hn.call(this,cn.tmplScriptCall,d);r.find("ul").append(E);if(i){var S=d.object+":"+d.procName+":"+d.lineNum;pn.call(this,r.find("ul > li").last(),l,S,S)}}s===0&&(h>0&&(h-=1),vn.gotoDebuggerEditorLine(u,a,f,c,h,!0))}var x=r.find("ul > .siebui-sd-script-call-entry");x.first().addClass("selected"),x.off("click").on("click",function(e){$(this).hasClass("selected")||($(this).siblings(".selected").removeClass("selected"),$(this).addClass("selected"));var t=$(this).attr("data-object"),n=t.indexOf("["),r=t.lastIndexOf("]"),i=t.substring(0,n),s=t.substring(n+1,r),o=$(this).attr("data-procName"),u=$(this).attr("data-scriptLang"),a=$(this).attr("data-lineNum");SiebelJS.LogLevel==="debug"&&SiebelJS.Debug("[ScriptDebugger] Script Call Entry Clicked:  Object Type='"+i+"'; Object Name='"+s+"'; Script Event Name='"+o+"'; Line Number='"+a,!0),a>0&&(a-=1),vn.gotoDebuggerEditorLine(i,s,o,u,a,!1)})},removeWatchData:function(){this.hideWindowSectionBodyData("#scriptDebuggerWindowsWatchPanel",!0)},setWatchData:function(e){if(n.IsEmpty(e)||e.GetChildCount()===0&&e.GetPropertyCount()===0){this.removeWatchData();return}this.showWindowSectionBodyData("#scriptDebuggerWindowsWatchPanel",!0);var t=this.jqScriptDebugger.find("#scriptDebuggerWindowsWatchPanel .siebui-sd-window-section-body-data");this.addPropertySetContent(e,0,t),t.find(".siebui-sd-watch-entry").off("click").on("click",function(e){var t=$(e.currentTarget);e.preventDefault(),e.stopPropagation(),t.next().length!==0&&t.toggleClass("siebui-sd-expanded").next().toggle()})},addPropertySetContent:function(e,t,n){var r=e.GetChildCount(),i=e.GetPropertyCount();if(i+r<=0)return;n.find("> .siebui-sd-watch-entry").first().addClass("siebui-sd-watch-entry-has-children");var s=0,o=0;n.append(cn.appendUL);if(i>0){var u=[];for(var a=!0,f;(f=e.EnumProperties(a))!==null
;a=!1)u.push({key:f,value:e.GetProperty(f)});u.sort(function(e,t){return e.key.localeCompare(t.key)});for(s=0,o=u.length;s<o;s++){var l=hn.call(this,cn.watchEntry,u[s]);n.find("> ul").last().append(l)}}if(r>0)for(s=0;s<r;s++){var c=e.GetChild(s);c&&this.addPropertySet(c,t,n)}t>1&&n.find("> ul").toggle()},addPropertySet:function(e,t,r){var i=e.GetType();n.IsEmpty(i)&&(i="PS: Property Set");var s=hn.call(this,t===0?cn.watchEntryLevel0:cn.watchEntry,{key:i,value:e.GetValue()}),o=$(s).appendTo(r.find("> ul").last()),u=o.find("> .siebui-sd-watch-entry").first().addClass("siebui-sd-folder");n.IsEmpty(e.GetValue())||u.addClass("siebui-sd-has-data"),this.addPropertySetContent(e,t+1,o)},applyDebugServerBP:function(e){var t=null;for(var n=0;n<e.GetChildCount();n++){var r=e.GetChild(n),i=r.GetProperty("ObjType"),s=r.GetProperty("ObjName"),o=r.GetProperty("ProcName"),u=i+"@"+s+"@"+o,a=vn.existTabByKey(u);if(a){var f=r.GetProperty("LineNum");a.bpLineArr.push(f),vn.isActiveTab(i,s,o)&&(t=a)}}t!==null&&vn.loadBreakpoints(t.bpLineArr)}};return SiebelJS.Extend(yn,SiebelAppFacade.PhysicalRenderer),yn.prototype.Init=function(){SiebelAppFacade.ScriptEditorPR.superclass.Init.apply(this,arguments),this.AttachPMBinding("ActiveEventEditable",Gn,{scope:this}),this.AttachPMBinding("SetScriptState",bn,{scope:this}),this.AttachPMBinding("UpdateTreeNode",Qn,{scope:this}),this.AttachPMBinding("ProcessScriptValidationInfo",er,{scope:this}),this.AttachPMBinding("WriteScriptData",function(){this.GetUIWrapper(this.GetPM().Get("GetControls")[b]).WriteScriptData()},{scope:this}),this.AttachPMBinding("IsScriptDebuggerShown",En,{scope:this}),this.AttachPMBinding("NotifyDebugTreeRefresh",function(e){dn.handleServerScriptObjTypeClick(e,!0)},{scope:this}),this.AttachPMBinding("NotifyExpandDataWindow",function(e){gn.notifyExpandDataWindow(e)},{scope:this}),this.AttachPMBinding("SetActiveTab",function(e){vn.setActiveTab(e)},{scope:this}),this.AttachPMBinding("ShowProfileWindow",function(e){e?mn.show():mn.hide()},{scope:this}),this.AttachPMBinding("UpdateProfileWindow",function(e){mn.update.call(this,e)},{scope:this}),this.AttachPMBinding("RefreshProfileWindow",function(){mn.refresh.call(this)},{scope:this}),this.AttachPMBinding("NotifyDebugStateChanged",Sn,{scope:this}),this.AttachPMBinding("AutoStartScriptDebugging",Tn,{scope:this}),this.AttachPMBinding("EnableRestart",xn,{scope:this}),this.AttachPMBinding("DebugToggleBreakpoint",function(e){vn.toggleBreakpoint(e)}),this.AttachPMBinding("DebugSettings",function(e){tr.call(this)}),this.AttachPMBinding("DebugStepToCursor",function(e){vn.stepToCursor(e)}),this.AttachPMBinding("DebugClearAllBreakpoints",function(){vn.clearAllBreakpoints()}),this.AttachPMBinding("DebugClearAllScriptObjBreakpoints",function(e,t){vn.clearAllScriptObjBreakpoints(e,t)}),this.AttachPMBinding("RemoveWatchData",function(){gn.removeWatchData()}),this.AttachPMBinding("RemoveScriptCallData",function(){gn.removeScriptCallData()}),this.AttachPMBinding("RemoveErrorData",function(){gn.removeErrorData()}),this.AttachPMBinding("SetWatchData",function(e){gn.setWatchData(e)}),this.AttachPMBinding("SetScriptCallData",function(e){gn.setScriptCallData(e)}),this.AttachPMBinding("AddErrorData",function(e){gn.addErrorData(e)}),this.AttachPMBinding("ApplyDebugServerBP",function(e){gn.applyDebugServerBP(e)}),this.AttachPMBinding("NotifyBreakpointHit",function(){wn()})},yn.prototype.EndLife=function(){this.GetPM().Get("IsScriptDebugger")?(dn.endLife(),vn.endLife(),gn.endLife()):(this.GetUIWrapper(this.GetPM().Get("GetControls")[b]).DetachScriptAssistant(),this.GetUIWrapper(this.GetPM().Get("GetControls")[b]).RemoveResizeEventHandlers(),SiebelApp.EventManager.removeListner("refreshScriptEditorBreakpoints",this.RefreshScriptEditorBreakpoints,this),SiebelApp.EventManager.removeListner("postload",this.PostLoadScriptEditor,this)),SiebelAppFacade.ScriptEditorPR.superclass.EndLife.apply(this,arguments),$(window).off(xt),$("html").removeClass("siebui-se-mode")},yn.prototype.ShowUI=function(){SiebelAppFacade.ScriptEditorPR.superclass.ShowUI.apply(this,arguments);var e=this.GetPM(),t=n.IsTrue(SiebelApp.S_App.IsAutoOn()),r=0,i=0,s,o;if(e.Get("IsScriptDebugger")===!0){var u=$(Yt),a=null,f=null;u.length===0&&($(cn.scriptDebuggerFrame).insertAfter("#_swecontent"),u=$(Yt)),a=u.find("#scriptDebuggerCaption"),a.length>0&&(a.parent("div").attr("title",Ht),a.attr("aria-label",Ht),a.text(Ht)),u.find("#scriptDebuggerCheckSyntax").parent().addClass("forcehide"),e.Get("IsScriptDebuggerDocked")||u.addClass("siebui-sd-float"),f=u.find("#scriptDebuggerDockToggle");if(f.length>0){var l=f.find("#scriptDebuggerDockToShowPin"),c=f.find("#scriptDebuggerDockToShowUnpin"),h=u.hasClass("siebui-sd-float");l.length>0&&h&&l.show().attr("aria-hidden",!1),c.length>0&&h&&c.hide().attr("aria-hidden",!0)}Sn.call(this),Nn.call(this);if(t)for(r=0,i=sn.length;r<i;r++)s=an[sn[r]],n.IsEmpty(s)||(o=u.find("#"+s.id),pn.call(this,o,s.type,s.id,s.text));dn.init({renderer:this,jqScriptDebugger:u}),dn.showUI(),vn.init({renderer:this,jqScriptDebugger:u}),vn.showUI(),gn.init({renderer:this,jqScriptDebugger:u}),gn.showUI()}else{$("html").addClass("siebui-se-mode");var p=$("#"+e.Get("GetFullId"));p.addClass(ot);var d=e.Get("GetControls")[e.Get("ScriptObjectTreeId")];if(!n.IsEmpty(d)){var v=$('<div class="siebui-se-tree" id="'+d.GetDisplayName()+'" type="'+d.GetUIType()+'" name="'+d.GetInputName()+'" >');this.GetUIWrapper(e.Get("GetControls")[b]).GetEl().parent().prepend(v),v=null}d=null;var m=SiebelApp.S_App.GetActiveView();m&&(m=SiebelAppFacade.ComponentMgr.FindComponent({id:m.GetName()}),m&&m.GetPM().SetProperty("EnableRestoreContext",!0)),p.find(".siebui-restore-context").after(cn.checkSyntaxButtons),p.find(".siebui-restore-context").before(cn.chooseApplicaiton),$("#scriptEditorApplicationListSelect").change(function(){var t=$(this).find("option:selected").text();e.ExecuteMethod("SetApplicationContextPrefrence",t),e.ExecuteMethod("SetAppOptions")}),Vn.call(this),E?p.find(".siebui-btn-grp-applet"
).prepend(hn.call(this,cn.scriptStateButtons)):p.find(".siebui-btn-grp-applet").prepend(hn.call(this,cn.scriptStateCheck));if(t)for(r=0,i=en.length;r<i;r++)s=tn[en[r]],n.IsEmpty(s)||(o=p.find("#"+s.id),pn.call(this,o,s.type,s.id,s.text))}},yn.prototype.BindEvents=function(){SiebelAppFacade.ScriptEditorPR.superclass.BindEvents.apply(this,arguments);var t=this.GetPM();if(t.Get("IsScriptDebugger")===!0){var n=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper");if(n){var r=$(Yt);if(r.length>0){An.call(this);var i=r.find(".siebui-sd-debug-button");i.length>0&&(n.Manage(i,"click",{ctx:this},Cn),n.Manage(i,"keydown",{ctx:this},kn));var s=r.find("#scriptDebuggerDockToggle");s.length>0&&(n.Manage(s,"click",{ctx:this},Ln),n.Manage(s,"keydown",{ctx:this},Mn));var o=r.find("#scriptDebuggerClose");o.length>0&&(n.Manage(o,"click",{ctx:this},_n),n.Manage(o,"keydown",{ctx:this},Dn)),dn.bindEvents(),vn.bindEvents(),gn.bindEvents()}r=null}n=null}else{var u=this,a=$("#"+t.Get("GetFullId"));a.find("#scriptEditorCheckSyntaxCurrent").on("click",function(n){t.Get("IsActive")||t.OnControlEvent(e.get("PHYEVENT_APPLET_FOCUS")),SiebelJS.Debug("[ScriptEditorPR] Check Syntax - Current Script.",!0),u.GetUIWrapper(t.Get("GetControls")[b]).ValidateScriptData(!1)}),a.find("#scriptEditorCheckSyntax").on("click",function(n){t.Get("IsActive")||t.OnControlEvent(e.get("PHYEVENT_APPLET_FOCUS")),SiebelJS.Debug("[ScriptEditorPR] Check Syntax.",!0),u.GetUIWrapper(t.Get("GetControls")[b]).ValidateScriptData()}),E?a.find("#scriptEditorActivateScript, #scriptEditorInactivateScript").on("click",function(n){t.Get("IsActive")||t.OnControlEvent(e.get("PHYEVENT_APPLET_FOCUS")),bn.call(u,!t.Get("ActiveEventInactive"))}):a.find("#scriptEditorScriptStateCheck").on("click",function(n){$(n.currentTarget).focus(),t.Get("IsActive")||t.OnControlEvent(e.get("PHYEVENT_APPLET_FOCUS")),bn.call(u,!t.Get("ActiveEventInactive"))}),a=null;var f=0;$(window).off(xt).on(xt,{ctx:this},function(e){var t=e.data.ctx;f&&(clearTimeout(f),f=0),f=setTimeout(function(){Pn.call(t),t=null,f=0},200)}),SiebelApp.EventManager.addListner("refreshScriptEditorBreakpoints",this.RefreshScriptEditorBreakpoints,this),SiebelApp.EventManager.addListner("postload",this.PostLoadScriptEditor,this)}},yn.prototype.BindData=function(){SiebelAppFacade.ScriptEditorPR.superclass.BindData.call(this);var e=this.GetPM();e.Get("IsScriptDebugger")===!0?(e.SetProperty("AppInfoArray",e.ExecuteMethod(St)),dn.bindData()):$("#"+e.Get("GetFullId")).find(".siebui-applet-title").text("")},yn.prototype.RefreshScriptEditorBreakpoints=function(e){if(n.IsEmpty(e))return;var t=this.GetPM(),r=e.action,i=e.scriptObjType,s=e.scriptObjName,o=e.eventName,u=e.bpLine,a=t.Get("ScriptObjType"),f=t.Get("ScriptObjName"),l=t.Get("ActiveEventName");SiebelJS.Debug('[ScriptEditorPR] Invoking "RefreshScriptEditorBreakpoints": action = "'+r+'"',!0),SiebelJS.Debug('[ScriptEditorPR] Editor Script Object "Type" = "'+a+'", "Name" = "'+f+'", "Active Event Name" = "'+l+'"',!0);if(r==="clearall")t.SetProperty("EventBPLineArray",[]),Bn.call(this,[]),SiebelJS.Debug("[ScriptEditorPR] Editor Active Event breakpoint(s) cleared.",!0);else if(i===a&&s===f)if(r==="toggle"){SiebelJS.Debug('[ScriptEditorPR] event = "'+o+'"; bpLine = "'+u+'"',!0);if(o===l){var c=t.Get("EventBPLineArray"),h=c.indexOf(u);h>-1?c.splice(h,1):(c.push(u),c.sort(function(e,t){return e-t})),t.SetProperty("EventBPLineArray",c),Bn.call(this,c),SiebelJS.Debug('[ScriptEditorPR] Editor Active Event breakpoint toggled. Current breakpoint(s): "'+c.join()+'"',!0)}else SiebelJS.Debug("[ScriptEditorPR] No need to toggle Script Editor breakpoint: Not the Active Event.",!0)}else r==="clearallscriptobj"?(t.SetProperty("EventBPLineArray",[]),Bn.call(this,[]),SiebelJS.Debug("[ScriptEditorPR] Editor Active Event breakpoint(s) cleared.",!0)):SiebelJS.Debug("[ScriptEditorPR] Action not supported.",!0);else SiebelJS.Debug("[ScriptEditorPR] No need to refresh Script Editor breakpoint(s): Not the affected Script Object.",!0);SiebelJS.Debug('[ScriptEditorPR] Done Invoking "RefreshScriptEditorBreakpoints".',!0)},yn.prototype.PostLoadScriptEditor=function(){var e=this.GetPM();if(e.Get("IsScriptDebugger")===!0)return;var r=$("#"+e.Get("GetFullId")),i=this;setTimeout(function(){SiebelJS.Debug("[ScriptEditorPR] PostLoadScriptEditor: uiStatus.Busy",!0),SiebelApp.S_App.uiStatus.Busy({mask:!0}),setTimeout(function(){e.SetProperty("IsTreeInitialLoading",!0),$n.call(i),e.SetProperty("IsTreeInitialLoading",!1),Hn.call(i);var s=t.GetLocalString("WT_SCRIPT_EDITOR_TITLE");s=s.replace("%1",e.Get("ScriptObjType")),s=s.replace("%2",e.Get("ScriptObjName")),r.find(".siebui-applet-title").text(s);if(E)n.IsEmpty(t.GetLocalString("WT_SCRIPT_EDITOR_LABEL_ACTIVATE"))&&r.find("#scriptEditorActivateScript").attr("aria-label","Activate").attr("title","Activate"),n.IsEmpty(t.GetLocalString("WT_SCRIPT_EDITOR_LABEL_INACTIVATE"))&&r.find("#scriptEditorInactivateScript").attr("aria-label","Inactivate").attr("title","Inactivate");else{var o=e.Get("InactiveLabelServer");n.IsEmpty(T)&&!n.IsEmpty(o)&&(r.find("#scriptEditorScriptStateCheck").attr("aria-label",o).attr("title",o),r.find(".siebui-se-script-state-check-label").text(o))}r.find("#scriptEditorCheckSyntax").prop("disabled",!e.Get("EnableScriptValidation")),i.GetUIWrapper(e.Get("GetControls")[b]).SetupGutterMarker(!1);var u=e.Get("ScriptLangType"),a=e.Get("UseDefLangForNewScript"),f=e.Get("ServerScriptDefLang");r=null,e=null,n.IsEmpty(u)&&a&&(u=f),Pn.call(i),SiebelApp.S_App.uiStatus.Free(),SiebelJS.Debug("[ScriptEditorPR] PostLoadScriptEditor: uiStatus.Free",!0),n.IsEmpty(u)?Wn.call(i,f):(In.call(i,u),qn.call(i),Fn.call(i))},w)},w)},yn}(),SiebelAppFacade.ScriptEditorPR})),typeof SiebelAppFacade.ScriptEditorPW=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ScriptEditorPW"),define("siebel/scripteditorpw",["siebel/CMEditorPW","3rdParty/codemirror/lib/codemirror.js","3rdParty/codemirror/mode/javascript/javascript.js","3rdParty/codemirror/mode/vbscript/vbscript.js"
,"3rdParty/codemirror/addon/edit/matchbrackets.js","3rdParty/codemirror/addon/edit/closebrackets.js","3rdParty/codemirror/addon/hint/show-hint.js","3rdParty/codemirror/addon/hint/javascript-hint.js","3rdParty/codemirror/addon/selection/active-line.js"],function(){return $("head").append("<link type='text/css' href='"+SiebelApp.S_App.GetBaseURL()+SIEBEL_BUILD+"3rdParty/codemirror/lib/codemirror.css"+"' rel='stylesheet' />"),$("head").append("<link type='text/css' href='"+SiebelApp.S_App.GetBaseURL()+SIEBEL_BUILD+"3rdParty/codemirror/addon/hint/show-hint.css"+"' rel='stylesheet' />"),SiebelAppFacade.ScriptEditorPW=function(){function I(){SiebelJS.Debug("[ScriptEditor] In ScriptEditorPW Constructor"),SiebelAppFacade.ScriptEditorPW.superclass.constructor.apply(this,arguments),O=!1,M=null,_=null,D=!1,P=!1,H=!1,B=!1}function q(e){SiebelJS.Debug("[ScriptEditor] In autoCompleteDot"),_=null,D=!1,P=!1,H=!1,z.call(this,e,"."),e.showHint(A)}function R(e){SiebelJS.Debug("[ScriptEditor] In autoCompleteLeftParen"),_=null,D=!1,P=!0,H=!1,z.call(this,e,"("),e.showHint(k)}function U(e){SiebelJS.Debug("[ScriptEditor] In autoCompleteList"),_=null,D=!0,P=!1,H=!1,z.call(this,e,""),e.showHint(L)}function z(e,t){var n=e.getSelection();if(n.length>0)e.replaceSelection(t);else{var r=e.getDoc(),i=r.getCursor();r.replaceRange(t,i)}}function W(t,r,i){var s=!0,o=this.Get("ActiveEventName"),u=r.getValue(),a="NoOp";if(!this.Get("ScriptEditable")||!this.Get("ActiveEventEditable"))SiebelJS.Debug("[ScriptEditor] commitEditorChanges: '"+o+"' Read-only",!0),s=!1;else if(!this.Get("ActiveEventExistInDB")&&n.IsEmpty(u))r.setValue(this.Get("ActiveEventData")),SiebelJS.Debug("[ScriptEditor] commitEditorChanges: '"+o+"' no change, script data does not exist and new data is empty",!0),s=!1;else if(s&&this.Get("ActiveEventData")===u)SiebelJS.Debug("[ScriptEditor] commitEditorChanges: '"+o+"' no change, new data is the same as the original data",!0),s=!1;else{var f=X.call(this,u),l=f.length>0?f[0]:"",c=!1,h;if(f.length>1)c=!0,h=v+"\n * "+f.join("\n * ");else if(!n.IsEmpty(l)&&o!==l){SiebelJS.Debug("[ScriptEditor] New Event Name from Data: '"+l+"'",!0);var p=$.ui.fancytree.getTree("#"+this.Get("ScriptObjectTreeId")).getNodeByKey(o),d=$.ui.fancytree.getTree("#"+this.Get("ScriptObjectTreeId")).getNodeByKey(l);o==="(declarations)"||!n.IsEmpty(p)&&p.data.custom?!n.IsEmpty(d)&&!d.folder&&(c=!0,d.data.custom?h=g.replace(/%1/,l):h=m.replace(/%1/,l)):(c=!0,h=y.replace(/%1/,l).replace(/%2/,o))}else n.IsEmpty(l)&&!n.IsEmpty(n.Trim(u))&&o!=="(declarations)"&&(c=!0,h=y.replace(/%1/,l).replace(/%2/,o));if(c){n.Alert(h),t.preventDefault(),t.stopPropagation(),r.hasFocus()||this.SetState(e.get("FOCUS"),!0,0,"ScriptEditor");return}a=this.ExecuteMethod("PostScriptEditorChanges",u,l),this.Get("ActiveEventData")!==u&&r.setValue(this.Get("ActiveEventData"))}if(a==="NoOp"&&(!this.Get("BreakpointGutterEnabled")||!this.Get("ActiveEventExistInDB")))return;if(this.Get("EnableScriptValidation")){var w=[];r.eachLine(function(e){e.gutterMarkers&&e.gutterMarkers[b]&&w.push((r.getLineNumber(e)+1).toString())}),w.sort(function(e,t){return e-t});if(!s){var E=CCFMiscUtil_ArrayToString(w),S=CCFMiscUtil_ArrayToString(this.Get("EventBPLineArray"));E!==S&&(s=!0)}s&&this.ExecuteMethod("ResetBreakpoints",a==="DeleteRecord"?o:this.Get("ActiveEventName"),w)}}function X(e){var t=[],r=e.replace(/\/\*[\s\S]*?\*\/|\/\/.*(?=[\n\r])/g,"").replace(/\t/g," ").replace(/ +/g," ").replace(/^\s*[\r\n]/gm,"").match(/^.*((\r\n|\n|\r)|$)/gm),i,s,o,u,a,f,l=!1,c=this.Get("ScriptLangType");n.IsEmpty(c)?c="JS":c!=="JS"&&(c="SBL");for(s=0;s<r.length;s++){u=V.call(this,r[s]),i=u.trim().split(/\s/);for(o=0,l=!1;o<i.length;o++){a=i[o];if(!l)if(c==="JS")a===j&&(l=!0);else{f=a.toLowerCase();if(f===j||f===F)l=!0}else if(a!==""){t.push(a.split("(")[0]);break}}}return t}function V(e){var t,n,r,i,s,o,u,a,f,l;i=e.indexOf(p),s=e.indexOf(d);if(i!=-1||s!=-1){a=!0,s==-1?u=!0:i==-1?u=!1:i<s?u=!0:u=!1,u?(r=i,f=p):(r=s,f=d),t=e.substr(0,r+1);for(o=r+1,l=!1;o<e.length;o++){n=e.charAt(o);if(a)/\s/.test(n)?n="+":!l&&n===f&&(a=!1),!l&&n==="\\"?l=!0:l=!1;else if(n===p||n===d)a=!0,f=n;t+=n}return t}return e}function J(e,t,n,r){var i=e.getDoc(),s=i.getLine(t).length,o={line:t,ch:0},u=n?{line:t,ch:s}:{line:t+1,ch:0};i.setSelection(o,u),r&&e.scrollIntoView(o,$(e.display.scroller).height()/2)}function K(){var e=$("ul.CodeMirror-hints");if(e.length>0){var t=e.find("li").first(),n=t.position().top;n+=e.height()-t.outerHeight(),e.scrollTop(e.find("li.CodeMirror-hint-active").position().top-n),t=null}e=null}function Q(e,t){SiebelJS.Debug("[ScriptAssist] Pick current option."),t.pick()}function G(e,t){H?(SiebelJS.Debug("[ScriptAssist] AcceptDoubleQuote."),z.call(this,e,'"')):Q.call(this,e,t)}function Y(e,t){P?(SiebelJS.Debug("[ScriptAssist] AcceptLeftParen."),z.call(this,e,"(")):Q.call(this,e,t)}function Z(e,n,r,i){var s=this,o=[];o.push({label:t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_TOGGLE_BREAKPOINT"),action:function(t){e.setGutterMarker(n,r,et(e.lineInfo(n).gutterMarkers)),(!s.Get("ScriptEditable")||!s.Get("ActiveEventEditable"))&&s.ExecuteMethod("ToggleBreakpoint",s.Get("ActiveEventName"),n+1)}}),o.push({label:t.GetLocalString("WT_SCRIPT_DEBUGGER_TOOLTIP_CLEAR_ALL_BREAKPOINTS"),action:function(t){e.clearGutter(r),(!s.Get("ScriptEditable")||!s.Get("ActiveEventEditable"))&&s.ExecuteMethod("ClearAllBreakpoints")}});var u=$(".siebui-se-breakpoint-menu");u.length>0?u.empty():u=$('<ul class="siebui-se-breakpoint-menu siebui-appletmenu ui-menu"></ul>').appendTo(document.body),o.forEach(function(e){var t=$('<li><a href="#">'+e.label+"</a></li>");t.addClass("siebui-se-breakpoint-menu-item siebui-appletmenu-item ui-menu-item"),e.action&&t.find("a").click(function(t){e.action(t)}).mousedown(function(e){e.preventDefault()}).hover(function(){$(this).toggleClass("ui-state-active")}),t.appendTo(u)}),u.show().css({left:i.pageX+1,top:i.pageY+1});var a=$('<div class="siebui-se-breakpoint-menu-background"></div>').css("z-index",u.css("z-index"
)).css("position",u.css("position")).css({left:0,top:0,width:"100%",height:"100%"}).insertBefore(u).on("contextmenu mousedown",function(e){e.preventDefault()}).on("contextmenu click",function(e){return a.remove(),u.remove(),!1});u.find("a").click(function(e){a.remove(),u.remove()})}function et(e){var t=null;return e?t:(t=$('<div class="siebui-se-breakpoint"></div>'),t[0])}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=SiebelJS.Dependency("SiebelApp.Utils"),r=e.get("SWE_PROP_AUTOM_OT"),i=e.get("SWE_PROP_AUTOM_RN"),s=e.get("SWE_PROP_AUTOM_UN"),o="SiebApplet",u=e.get("SWE_PST_BUTTON_CTRL"),a=e.get("SWE_CTRL_CHECKBOX"),f=e.get("SWE_CTRL_COMBOBOX"),l=e.get("SWE_CTRL_LINK"),c=e.get("SWE_CTRL_TEXT"),h=":",p='"',d="'",v=t.GetLocalString("WT_SCRIPT_EDITOR_SCRIPT_MULTIPLE_FUNC_MSG"),m=t.GetLocalString("WT_SCRIPT_EDITOR_BUILDIN_SCRIPT_NAME_NOT_ALLOWED_MSG"),g=t.GetLocalString("WT_SCRIPT_EDITOR_SCRIPT_NAME_DUPLICATE_MSG"),y=t.GetLocalString("WT_SCRIPT_EDITOR_SCRIPT_FUNC_NAMES_MISMATCH_MSG"),b="siebui-se-gutter-breakpoint",w="CodeMirror-linenumbers",E="wtseConfig",S=["AutoCloseBrackets","DisplayLineNumbers","WrapLongLines","HiliteActiveLine","MatchBrackets","IndentWithTabs","IndentSpaces","EnableMethodListing","EnableAutoComplete","EnableFavorites","FixAndGo","DefaultLogin","EnableCompilationWarning","EnableTypeDeduction","UseDefLangForNewScript","ServerScriptDefLang"],x={autoCloseBrackets:S[0],lineNumbers:S[1],lineWrapping:S[2],styleActiveLine:S[3],matchBrackets:S[4],indentWithTabs:S[5],indentUnit:S[6],tabSize:S[6]},T={};T[S[0]]=["autoCloseBrackets"],T[S[1]]=["lineNumbers"],T[S[2]]=["lineWrapping"],T[S[3]]=["styleActiveLine"],T[S[4]]=["matchBrackets"],T[S[5]]=["indentWithTabs"],T[S[6]]=["indentUnit","tabSize"];var N="siebui-script-object",C={0:"siebui-script-object-method",1:"siebui-script-object-property",2:"siebui-script-object-type",3:"siebui-script-object-class",4:"siebui-script-object-primitive",5:"siebui-script-object-buildin-function"},k={closeCharacters:/[]/,extraKeys:{"`":Q,"-":Q,"=":Q,"[":Q,"]":Q,"\\":Q,";":Q,"'":Q,",":Q,".":Q,"Shift-`":Q,"Shift-=":Q,"Shift-[":Q,"Shift-]":Q,"Shift-\\":Q,"Shift-;":Q,"Shift-'":G,"Shift-,":Q,"Shift-.":Q,"Shift-/":Q,"Shift-9":Y}},L=$.extend(!0,{},k);L.extraKeys["/"]=Q,L.extraKeys.Space=Q,L.extraKeys["Shift-0"]=Q;var A=$.extend(!0,{},L);A.completeSingle=!1,k.completeSingle=!1;var O=!1,M=null,_=null,D=!1,P=!1,H=!1,B=!1,j="function",F="sub";return SiebelJS.Extend(I,SiebelAppFacade.CMEditorPW),I.prototype.Init=function(){SiebelAppFacade.ScriptEditorPW.superclass.Init.apply(this,arguments),this.SetMode("javascript"),this.SetEditorResizeEventName("resize.ScriptEditor"),this.SetSettingsResizeEventName("resize.ScriptEditorSettings"),this.SetUpdateElmentValueToCMEditor(!1),this.SetTooltipPrefix(t.GetLocalString("WT_SCRIPT_EDITOR_TOOLTIP_PREFIX")),this.SetIdPrefix("scriptEditor")},I.prototype.ShowUI=function(){SiebelAppFacade.ScriptEditorPW.superclass.ShowUI.apply(this,arguments);if(n.IsTrue(SiebelApp.S_App.IsAutoOn())){var e=this.GetEl().data("cmInstance");$(e.getWrapperElement()).attr(r,o).attr(i,"ScriptEditorCodeMirror").attr(s,"ScriptEditorCodeMirror")}},I.prototype.BindEvents=function(){SiebelAppFacade.ScriptEditorPW.superclass.BindEvents.apply(this,arguments);if(n.IsTrue(SiebelApp.S_App.IsAutoOn())){var e=this.GetEl().data("cmInstance");e.on("renderLine",function(e,t,n){var o="SE-Line"+h+(1+e.lineInfo(t).line);$(n).attr(r,l).attr(i,o).attr(s,o)})}},I.prototype.SetupEditorSettingsAndOptions=function(e,t){var o=this.ExecuteMethod("GetEditorPrefrences"),u=n.IsTrue(SiebelApp.S_App.IsAutoOn());if(e.children().length===0){var l="";for(var h=0,p=S.length;h<p;h++){if(n.IsEmpty(S[h]))continue;var d=o[S[h]],v=E+d.name;d.separator===!0&&(l+='<li class="ui-menu-item ui-menu-divider"></li>'),n.IsEmpty(d.section_title)||(l+='<li class="ui-menu-item siebui-editor-settings-section-title">'+d.section_title+"</li>"),l+='<li class="ui-menu-item">';if(d.type==="boolean")l+='<input type="checkbox" id="'+v+'" value="'+(d.value?"Y":"N")+'" aria-checked='+(d.value?'"true" checked="checked"':'"false"')+(u?r+"="+a+" "+i+'="'+d.name+'" '+s+'="'+d.name+'"':"")+'></input><label for="'+v+'">'+d.label+"</label>";else if(d.type==="integer")l+='<label for="'+v+'">'+d.label+'</label><input type="number" id="'+v+'" '+(u?r+"="+c+" "+i+'="'+d.name+'" '+s+'="'+d.name+'"':"")+' value="'+d.value+'" min="0" max ="8" step="1"></input>';else if(d.type==="combo"){var m=d.options,g=m.length;if(g>0){var y;l+='<select id="'+v+'" '+(u?r+"="+f+" "+i+'="'+d.name+'" '+s+'="'+d.name+'"':"")+">";for(var b=0;b<g;b++)y=d.value===m[b].name?" selected":"",l+='<option value="'+m[b].name+'" label="'+m[b].label+'"'+y+">"+m[b].name+"</option>";l+="</select>"}}else l+=d.label;l+="</li>"}e.append($(l))}t.setOption("autoCloseBrackets",o[x.autoCloseBrackets].value),t.setOption("extraKeys",{".":q,"Shift-9":R,"Ctrl-Space":U}),t.setOption("lineNumbers",o[x.lineNumbers].value),t.setOption("lineWrapping",o[x.lineWrapping].value),t.setOption("styleActiveLine",o[x.styleActiveLine].value),t.setOption("matchBrackets",u?!1:o[x.matchBrackets].value),t.setOption("indentWithTabs",o[x.indentWithTabs].value),t.setOption("indentUnit",o[x.indentUnit].value),t.setOption("tabSize",o[x.tabSize].value),t.setOption("showCursorWhenSelecting",!0),t.setOption("lineWiseCopyCut",!1),t.setOption("viewportMargin",Infinity)},I.prototype.OnSettingsChange=function(e,r){if(e.target.id.indexOf(E)===0){var i,s,o,u,a=0,f=0;i=e.target.id.substr(E.length),o=this.ExecuteMethod("GetUserPrefrenceType",i),u=T[i];if(!n.IsEmpty(i)){var l=n.IsTrue(SiebelApp.S_App.IsAutoOn()),c=!0;f=n.IsEmpty(u)?0:u.length;switch(o){case"boolean":s=e.target.checked,$(e.target).attr("checked",s),$(e.target).attr("aria-checked",s),$(e.target).attr("value",s?"Y":"N");for(a=0;a<f;a++)l&&u[a]==="matchBrackets"?r.setOption(u[a],!1):r.setOption(u[a],s?!0:!1);break;case"integer":s=parseInt(e.target.value,10);if(isNaN(s))c=!1,e.target.value=""+
r.getOption(u[0]);else{var h=parseInt(e.target.min,10),p=parseInt(e.target.max,10);!isNaN(h)&&s<h?(c=!1,SiebelJS.LogLevel==="debug"&&SiebelJS.Debug("[ScriptEditor] "+e.target.labels[0].innerText+" "+s+"; "+t.GetLocalString("IDS_SWE_JQGRID_MSG_MIN_VALUE")+" "+h)):!isNaN(p)&&s>p&&(c=!1,SiebelJS.LogLevel==="debug"&&SiebelJS.Debug("[ScriptEditor] "+e.target.labels[0].innerText+" "+s+"; "+t.GetLocalString("IDS_SWE_JQGRID_MSG_MAX_VALUE")+" "+p));for(a=0;c&&a<f;a++)r.setOption(u[a],s)}break;case"combo":s=e.target.value;for(a=0;a<f;a++)r.setOption(u[a],s);break;default:c=!1}c&&this.ExecuteMethod("SetEditorPrefrence",i,s)}}},I.prototype.UpdateScriptLangPreferences=function(e,t){var n=$("#wtseConfigServerScriptDefLang");n.length&&n[0].value!==t&&(n[0].value=t,n.trigger("change"));var r=$("#wtseConfigUseDefLangForNewScript");r.length&&r[0].checked!==e&&(r[0].checked=e,r.trigger("change"))},I.prototype.SetEditorMode=function(e){var t=e==="SBL"?"vbscript":"javascript";this.SetMode(t),this.GetEl().data("cmInstance").setOption("mode",t)},I.prototype.WriteScriptData=function(){this.GetEl().data("cmInstance").getInputField().blur()},I.prototype.OnEditorBlur=function(e,t,n){var r=this;SiebelApp.S_App.uiStatus.Busy({mask:!0}),setTimeout(function(){W.call(r,e,t,n),SiebelApp.S_App.uiStatus.Free()},10)},I.prototype.SetValue=function(e,t,n){n==="ScriptEditor"&&(SiebelAppFacade.ScriptEditorPW.superclass.SetValue.apply(this,arguments),this.GetEl().data("cmInstance").getDoc().clearHistory())},I.prototype.SetState=function(e,t,n,r){r==="ScriptEditor"&&SiebelAppFacade.ScriptEditorPW.superclass.SetState.apply(this,arguments)},I.prototype.ValidateScriptData=function(e){this.ExecuteMethod("ValidateScriptData",e)},I.prototype.SelectLine=function(e){var t=this.GetEl().data("cmInstance");J.call(this,t,e-1,!0,!0)},I.prototype.AttachScriptAssistant=function(){SiebelJS.Debug("[ScriptEditor] AttachScriptAssistant",!0);var e=n.IsTrue(SiebelApp.S_App.IsAutoOn()),t=this;O=!0,M=CodeMirror.hint.javascript,CodeMirror.hint.javascript=function(u){if(!t.Get("ScriptEditable")||!t.Get("ActiveEventEditable"))return SiebelJS.Debug("[ScriptAssist] ScriptAssist is disabled because the script is not editable.",!0),null;SiebelJS.Debug("[ScriptAssist] AutoComplete = "+D+", LeftParen = "+P,!0);var a=-1,f=0,c=0,p=u.getCursor(),d=u.getLine(p.line),v,m,g,y,b;if(n.IsEmpty(_)){var w=/\w/,E=p.ch,S=p.ch;while(E&&w.test(d.charAt(E-1)))--E;b={list:[],from:CodeMirror.Pos(p.line,E),to:CodeMirror.Pos(p.line,S),saCh:D?S:S-1};var x=d.length;while(S<x&&w.test(d.charAt(S)))++S;b.to.ch=S,_=b,SiebelJS.Debug("[ScriptAssist] GetAssistant: Line = "+b.to.line+", Ch = "+b.saCh,!0);var T=t.ExecuteMethod("GetAssistant",u.getValue(),b.to.line,b.saCh,D,P);v=T.GetProperty("ErrorMessage"),n.IsEmpty(v)||SiebelJS.Debug("[ScriptAssist] "+v),m=T.GetProperty("ReplaceOption");if(!n.IsEmpty(m))b.list.push(m);else{g=T.GetProperty("PartialMatch")||"",y=g.length;var k=[],L=[],A=[],O=[],M=T.GetProperty("OptionNames"),j=T.GetProperty("OptionTypes"),F=T.GetProperty("OptionSignatures"),I=T.GetProperty("OptionFavorites");CCFMiscUtil_StringToArray(M,k),CCFMiscUtil_StringToArray(j,L),CCFMiscUtil_StringToArray(F,A),CCFMiscUtil_StringToArray(I,O),H=n.IsTrue(T.GetProperty("OptionIsQuoted"));for(f=0,c=k.length;f<c;f++){var q=k[f],R=A[f],U=C[L[f]],z=null;if(e){var W="SA-"+q;n.IsEmpty(U)||(W+=U.indexOf(N)===0?U.substr(N.length):h+U),z={},z[r]=l,z[i]=W,z[s]=W}n.IsEmpty(U)?U="siebui-script-object":U="siebui-script-object "+U,O[f]==="1"&&(U+=" siebui-script-object-favorite"),y!==0&&a===-1&&q.indexOf(g)===0&&(a=f),b.list.push({displayText:q,text:H?'"'+q+'"':q,className:U,title:R,optionType:L[f],automAttrs:z,render:function(e,t,r){var i=$(e);i.append($("<span>"+r.displayText+"</span>")),n.IsEmpty(r.title)||i.prop("title",r.title),n.IsEmpty(r.automAttrs)||i.attr(r.automAttrs),i=null}})}}CodeMirror.on(b,"shown",function(){SiebelJS.Debug("[ScriptAssist] Options List Shown.",!0),K.call(this),H&&!B&&u.getOption("autoCloseBrackets")&&(SiebelJS.Debug("[ScriptAssist] Cache and disable CodeMirror Auto-Close Brackets option."),B=!0,u.setOption("autoCloseBrackets",!1)),e&&$("ul.CodeMirror-hints").attr(r,o).attr(i,"ScriptAssist").attr(s,"ScriptAssist"),$("ul.CodeMirror-hints").on("mousedown",function(e){e.preventDefault()})}),CodeMirror.on(b,"pick",function(e){if(e!==null&&!n.IsEmpty(e.displayText)){SiebelJS.Debug("[ScriptAssist] Pick = '"+e.displayText+"'; optionType: '"+e.optionType+"'");var r=t.ExecuteMethod("AddFavorite",e.displayText,e.optionType)}else typeof e=="string"&&SiebelJS.Debug("[ScriptAssist] Pick = '"+e+"'");$("ul.CodeMirror-hints").off("mousedown")}),CodeMirror.on(b,"close",function(){SiebelJS.Debug("[ScriptAssist] Options List Close."),H&&B&&(SiebelJS.Debug("[ScriptAssist] Restore CodeMirror Auto-Close Brackets option."),u.setOption("autoCloseBrackets",!0),B=!1),u=null,_=null})}else{SiebelJS.Debug("[ScriptAssist] Re-use current hint."),b=_,b.to.ch+=p.ch-b.saCh,b.saCh=p.ch,g=d.substr(b.from.ch,b.saCh-b.from.ch),H&&g.startsWith('"')?g=g.substr(1):g=n.LTrim(g),y=g.length;for(f=0,c=b.list.length;f<c;f++)if(y!==0&&a===-1&&b.list[f].displayText.indexOf(g)===0){a=f;break}}return b.list.length>0?(SiebelJS.LogLevel==="debug"&&(n.IsEmpty(m)?SiebelJS.Debug("[ScriptAssist] partialMatchStr = '"+g+"'"):SiebelJS.Debug("[ScriptAssist] replaceOption = '"+m+"'"),SiebelJS.Debug("[ScriptAssist] IsQuoted = "+H),SiebelJS.Debug("[ScriptAssist] From = "+b.from.line+":"+b.from.ch+"; To = "+b.to.line+":"+b.to.ch+"; saCh = "+b.saCh)),a!==-1?(SiebelJS.LogLevel==="debug"&&SiebelJS.Debug("[ScriptAssist] Option matched; Selected = '"+b.list[a].displayText+"'; Index = "+a),b.selectedHint=a):b.from.ch===b.to.ch||n.IsEmpty(b.selectedHint)?(SiebelJS.Debug("[ScriptAssist] No option matched. Reset to default."),b.selectedHint=undefined):SiebelJS.LogLevel==="debug"&&SiebelJS.Debug("[ScriptAssist] No option matched, Keep current Selected = '"+b.list[b.selectedHint].displayText+"'; Index = "+b.selectedHint)):SiebelJS.Debug("[ScriptAssist] No option returned."
,!0),b}},I.prototype.DetachScriptAssistant=function(){SiebelJS.Debug("[ScriptEditor] DetachScriptAssistant"),O&&(CodeMirror.hint.javascript=M,O=!1,M=null),_=null},I.prototype.LoadBreakpoints=function(e){var t=this.GetEl().data("cmInstance");t.clearGutter(b);if(!n.IsEmpty(e))for(var r=0,i=e.length;r<i;r++){var s=parseInt(e[r],10);!n.IsEmpty(s)&&!isNaN(s)&&t.setGutterMarker(s-1,b,et(t.lineInfo(s-1).gutterMarkers))}},I.prototype.SetupGutterMarker=function(t){var n=this.GetEl().data("cmInstance"),r=[w],i=this;this.SetProperty("BreakpointGutterEnabled",t),t&&r.unshift(b),n.setOption("gutters",r),n.on("gutterClick",function(n,r,s,o){o.which===1&&(t&&s===b?i.Get("ActiveEventExistInDB")&&(n.setGutterMarker(r,s,et(n.lineInfo(r).gutterMarkers)),(!i.Get("ScriptEditable")||!i.Get("ActiveEventEditable"))&&i.ExecuteMethod("ToggleBreakpoint",i.Get("ActiveEventName"),r+1)):J.call(i,n,r)),n.hasFocus()||i.SetState(e.get("FOCUS"),!0,0,"ScriptEditor")}),t&&n.on("gutterContextMenu",function(e,t,n,r){r.preventDefault(),r.stopPropagation(),(n===b||n===w)&&i.Get("ActiveEventExistInDB")&&Z.call(i,e,t,b,r)})},I}(),SiebelApp.S_App.PluginBuilder.AttachPW(SiebelApp.Constants.get("SWE_CTRL_TEXTAREA"),SiebelAppFacade.ScriptEditorPW,function(e){return e.GetApplet().GetPModel().Get("EnableAttachingScriptEditorPW")===!0&&e.GetName()==="Script"}),SiebelAppFacade.ScriptEditorPW})),typeof SiebelAppFacade.OdhEditorPW=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.OdhEditorPW"),define("siebel/odheditorpw",["siebel/FieldPW","3rdParty/codemirror/lib/codemirror.js","3rdParty/codemirror/mode/xml/xml.js","3rdParty/codemirror/mode/htmlmixed/htmlmixed.js","3rdParty/codemirror/addon/fold/xml-fold.js","3rdParty/codemirror/addon/edit/matchbrackets.js","3rdParty/codemirror/addon/edit/closetag.js","3rdParty/codemirror/addon/hint/show-hint.js","3rdParty/codemirror/addon/hint/html-hint.js","3rdParty/codemirror/addon/hint/xml-hint.js","3rdParty/codemirror-ext.js"],function(){return $("head").append("<link type='text/css' href='"+SiebelApp.S_App.GetBaseURL()+SIEBEL_BUILD+"3rdParty/codemirror/lib/codemirror.css"+"' rel='stylesheet' />"),$("head").append("<link type='text/css' href='"+SiebelApp.S_App.GetBaseURL()+SIEBEL_BUILD+"3rdParty/codemirror/addon/hint/show-hint.css"+"' rel='stylesheet' />"),SiebelAppFacade.OdhEditorPW=function(){function l(){SiebelAppFacade.OdhEditorPW.superclass.constructor.apply(this,arguments)}function c(e,t){var n=this,r=$("#"+n.Get("GetFullId"));DOMUtils.Read(function(){var n=r.find(".siebui-applet").outerHeight(),i=r.find(".siebui-applet-header").outerHeight();DOMUtils.Write(function(){$(e.display.scroller).height(n-i),DOMUtils.Write(function(){SiebelJS.Debug("[ObjectDesignEditor] SetScrollerHeight - htmlEditor.setValue - Start",!0),e.setValue(t.val()),SiebelJS.Debug("[ObjectDesignEditor] SetScrollerHeight - htmlEditor.setValue - End",!0),r=null})})})}function h(){SiebelJS.Debug('[ObjectDesignEditor] AutoTidy - Name = "'+this.Get("GetRawRecordSet")[this.Get("GetSelection")].Name+'"',!0),SiebelJS.Debug("[ObjectDesignEditor] AutoTidy - Start",!0);var e=this.GetEl(),t=e.val(),n=t.split("\n"),r=e.data("cmInstance"),i=n.length,s;for(s=0;s<i;s++)r.indentLine(s+1);SiebelJS.Debug("[ObjectDesignEditor] AutoTidy - End",!0)}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=SiebelJS.Dependency("SiebelApp.Utils"),r=t.GetLocalString("ODH_EDITOR_CONFIG_AUTO_CLOSE"),i=t.GetLocalString("ODH_EDITOR_CONFIG_DISPLAY_HINT"),s=t.GetLocalString("ODH_EDITOR_CONFIG_DISPLAY_LINE_NUMBERS"),o=t.GetLocalString("ODH_EDITOR_CONFIG_SHOW_OD_HIERARCHY"),u=t.GetLocalString("ODH_EDITOR_CONFIG_AUTO_TIDY"),a=t.GetLocalString("ODH_EDITOR_CONFIG_INDENT_TAB"),f=t.GetLocalString("ODH_EDITOR_CONFIG_INDENT_SPACES");return SiebelJS.Extend(l,SiebelAppFacade.FieldPW),l.prototype.ShowUI=function(){SiebelAppFacade.OdhEditorPW.superclass.ShowUI.apply(this,arguments);var e=this.GetEl(),t=e[0],l=$("#"+this.Get("GetFullId")).find(".siebui-btn-grp-applet").append('<div class="siebui-editor-settings "><button class="siebui-editor-settings-ctrl" disabled="true"></button></div>');l=l.find(".siebui-editor-settings");var h=this.ExecuteMethod("GetEditorPrefrences"),p={autoCloseTags:h[1]===""?!0:n.IsTrue(h[1]),displayHints:h[2]===""?!0:n.IsTrue(h[2]),displayLineNumber:h[3]===""?!0:n.IsTrue(h[3]),displayOdHierarchy:h[4]===""?!1:n.IsTrue(h[4]),autoTidy:h[5]===""?!1:n.IsTrue(h[5]),indentWithTabs:h[6]===""?!1:n.IsTrue(h[6]),indentSpaces:parseInt(h[7],10)?parseInt(h[7],10):4};this.SetProperty("AutoTidyOn",(h||[])[5]),$(".siebui-editor-settings-panel").length===0&&l.append($('<ul class="siebui-editor-settings-panel hide ui-menu ui-autocomplete" tabIndex="0"><li class="ui-menu-item" ><input type="checkbox" id="edConfigAutoCloseTags" value="Auto-close tags" '+(p.autoCloseTags?'checked="true"':"")+'/> <label for="edConfigAutoCloseTags" >'+r+"</label></li>"+'<li class="ui-menu-item" ><input type="checkbox" id="edConfigDisplayHint" value="Display Hint" '+(p.displayHints?'checked="true"':"")+'/> <label for="edConfigDisplayHint" >'+i+" </label></li>"+'<li class="ui-menu-item" ><input type="checkbox" id="edConfigDisplayLineNum" value="Display line numbers" '+(p.displayLineNumber?'checked="true"':"")+'/> <label for="edConfigDisplayLineNum" >'+s+" </label></li>"+'<li class="ui-menu-item" ><input type="checkbox" id="edConfigShowTreeNum" value="Show Tree" '+(p.displayOdHierarchy?'checked="true"':"")+'/> <label for="edConfigShowTreeNum" >'+o+" </label></li>"+'<li class="ui-menu-item" ><input type="checkbox" id="edConfigAutoTidy" value="Auto Tidy" '+(p.autoTidy?'checked="true"':"")+'/> <label for="edConfigAutoTidy" >'+u+"</label></li>"+'<li class="ui-menu-item" ><input type="checkbox" id="edConfigTabIndent" value="Indent with tabs" '+(p.indentWithTabs?'checked="true"':"")+'/> <label for="edConfigTabIndent" >'+a+"</label></li>"+'<li class="ui-menu-item" ><label  for="edConfigIndentSpaces">'+f+' <input id="edConfigIndentSpaces" value="'+p.indentSpaces+'" type="number" min="0" max ="8" step="1"></input></li>'+"</ul>"
));var d=CodeMirror.fromTextArea(t,{value:e[0].value,autoCloseTags:p.autoCloseTags,extraKeys:p.displayHints?{"Ctrl-Space":"autocomplete"}:{},lineNumbers:p.displayLineNumber,indentWithTabs:p.indentWithTabs,indentUnit:p.indentSpaces,mode:"text/html",autoClearEmptyLines:!0,viewportMargin:Infinity,addODCloseComments:p.autoCloseTags});p.displayOdHierarchy?$(".siebui-odh-tree").addClass("forceshow"):$(".siebui-odh-tree").removeClass("forceshow"),e.data("cmInstance",d),e.addClass("forcehide"),c.call(this,d,e)},l.prototype.BindEvents=function(){SiebelAppFacade.OdhEditorPW.superclass.BindEvents.apply(this,arguments);var e=this.GetEl(),t=e.data("cmInstance"),n=this;$($("ul.siebui-editor-settings-panel").eq(0)).find("input").bind("change",function(e){var r,i;switch(e.target.id){case"edConfigAutoCloseTags":i=this.checked,t.setOption("autoCloseTags",i),r=1;break;case"edConfigDisplayHint":i=this.checked?!0:!1,t.setOption("extraKeys",i),r=2;break;case"edConfigDisplayLineNum":i=this.checked,t.setOption("lineNumbers",this.checked?!0:!1),r=3;break;case"edConfigShowTreeNum":i=this.checked,this.checked?$(".siebui-odh-tree").addClass("forceshow"):$(".siebui-odh-tree").removeClass("forceshow"),r=4;break;case"edConfigAutoTidy":i=this.checked,n.SetProperty("AutoTidyOn",this.checked),r=5,this.checked&&h.apply(n);break;case"edConfigTabIndent":i=this.checked,t.setOption("indentWithTabs",this.checked?!0:!1),r=6;break;case"edConfigIndentSpaces":i=parseInt(this.value,10),t.setOption("indentUnit",i),t.setOption("tabSize",i),r=7}r>=0&&n.ExecuteMethod("SetEditorPrefrences",r,i)});var r=SiebelApp.S_App.GetDirection();$(".siebui-editor-settings-ctrl ").on("click",function(e){var t=$(".siebui-editor-settings-panel");t.toggleClass("hide"),t.hasClass("hide")||(t.eq(0).position({my:r?"right top":"left top",at:r?"right bottom":"left bottom",of:$(this),collision:"flipfit flipfit"}),t.find("li input").eq(0).focus()),t=null}),t.on("change",function(e,t){e.save()}),t.on("focus",function(e){n.ExecuteMethod("SetActiveControl",n.control)}),t.on("blur",function(t){n.ExecuteMethod("LeaveField",n.control,e.val(),!0)}),t.on("keydown",function(e,t){(t.ctrlKey&&t.which===$.ui.keyCode.SPACE||t.which===$.ui.keyCode.ENTER)&&t.stopPropagation()}),$(window).off("resize.ODHEditor"),$(window).on("resize.ODHEditor",{ctx:this},function(e){var t=e.data.ctx,n=t.GetEl();c.call(t,n.data("cmInstance"),n)}),$(window).off("resize.ODHSettings").on("resize.ODHSettings",function(){var e=$(".siebui-editor-settings-panel");e.hasClass("hide")||e.addClass("hide"),e=null}),$("ul.siebui-editor-settings-panel").on("focusout",function(){var e=$(this);setTimeout(function(){var t=document.activeElement;e.find($(t)).length===0&&e[0]!==t&&t!==$(".siebui-editor-settings-ctrl")[0]&&e.addClass("hide")},10)})},l.prototype.SetValue=function(){SiebelAppFacade.OdhEditorPW.superclass.SetValue.apply(this,arguments);var e=this.GetEl(),t=e.val(),r=t.split("\n"),i=e.data("cmInstance");i.getValue()!==t&&(SiebelJS.Debug('[ObjectDesignEditor] SetValue - Name = "'+this.Get("GetRawRecordSet")[this.Get("GetSelection")].Name+'"',!0),this.Get("GetRawRecordSet")[this.Get("GetSelection")],SiebelJS.Debug("[ObjectDesignEditor] SetValue - Start",!0),i.setValue(t),SiebelJS.Debug("[ObjectDesignEditor] SetValue - End",!0)),n.IsTrue(this.Get("AutoTidyOn"))&&h.apply(this)},l.prototype.SetState=function(t,n,r){SiebelAppFacade.OdhEditorPW.superclass.SetState.apply(this,arguments);var i=this.GetEl();t===e.get("EDITABLE")&&(i.data("cmInstance").setOption("readOnly",!n),$(".siebui-editor-settings-ctrl").attr("disabled",!n))},l.prototype.EndLife=function(){$(window).off("resize.ODHEditor"),$(window).off("resize.ODHSettings"),SiebelAppFacade.OdhEditorPW.superclass.EndLife.apply(this,arguments)},l.prototype.positionCursor=function(e){var t=this.GetEl(),n,r,i=t.data("cmInstance");i.focus();var s=i.getTextArea().value,o="od-type=",u=0,a=null,f;while(u<e&&a!==-1)a=s.indexOf(o,a+1),u++;f=i.posFromIndex(a),n=f.line,o=i.getLine(n),r=o.search(/\S/),i.setCursor({line:f.line,ch:r})},l}(),SiebelApp.S_App.PluginBuilder.AttachPW(consts.get("SWE_CTRL_TEXTAREA"),SiebelAppFacade.OdhEditorPW,function(e){return e.GetApplet().GetName()==="Object Design - HTML"&&e.GetName()==="Definition"}),SiebelAppFacade.OdhEditorPW})),typeof SiebelAppFacade.ODHPreviewPW=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ODHPreviewPW"),define("siebel/odhpreviewpw",["siebel/basepw"],function(){var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.Utils"),n="FormattedHtml",r="FormattedLabel",i="Overlapping controls have been detected",s=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),o=s.GetLocalString("IDS_SWE_JQGRID_DEL_CAPTION"),u=s.GetLocalString("MORE"),a=s.GetLocalString("LESS"),f=s.GetLocalString("IDS_COMM_PANEL_TOGGLE_SHOW_MORE"),l=s.GetLocalString("IDS_COMM_PANEL_TOGGLE_SHOW_LESS"),c=s.GetLocalString("WT_APPLET_EDITOR_SET_TAB_ORDER"),h=s.GetLocalString("IDS_CLIENT_SAVE"),p=s.GetLocalString("IDS_CLIENT_CANCEL"),d=s.GetLocalString("SHOW_UNMAPPED"),v=8,m=e.get("SWE_PROP_AUTOM_OT"),g=e.get("SWE_PROP_AUTOM_RN"),y=e.get("SWE_PROP_AUTOM_UN"),b=e.get("SWE_CTRL_PLAINTEXT"),w=24;return CTRL_DEFAULT_WIDTH=120,isAutoOn=!1,SiebelAppFacade.ODHPreviewPW=function(){function s(){var e,t={};t.PreviewId=-1,t.ParsedTree={},t.StaleUIId=[],t.odIdMap={},t.GridPids=[];var n={},r=0,i=0,s=[],o={},u={};this.GetIFrame=function(){return e},this.SetIFrame=function(t){e=t},this.GetProp=function(e){return t[e]},this.SetProp=function(e,n){t[e]=n},this.GetCtrlPIDMap=function(e){return n[e]},this.SetCtrlPIDMap=function(e,t){n[e]||(n[e]=[]),n[e].push(t)},this.GetCurrTabOrder=function(){return r},this.NextTabOrder=function(){return i!=0&&r<i&&r++,r},this.ResetCurrTabOrder=function(){r=0},this.GetMaxTabOrder=function(){return i},this.GetTabOrderArray=function(){return s},this.GetTabOrderInfo=function(e){return o[e]},this.UpsertTabOrder=function(e,t,n,r,u,a){var f=o[e];f!==undefined?(f.id=t,f.odId=n,f.control=r,f.seq=u,f.tabOrder=a):(o[e]={id
:t,odId:n,control:r,seq:u,tabOrder:a},s.push(e),i++)},this.DeleteTabOrder=function(e){var t=s.indexOf(e);t>-1&&(s.splice(t,1),delete o[e],i--)},this.SortTabOrderArray=function(){s.sort(function(e,t){var n=o[e],r=o[t],i=isNaN(parseFloat(n.tabOrder))?0:parseFloat(n.tabOrder),s=isNaN(parseFloat(r.tabOrder))?0:parseFloat(r.tabOrder);return i-s||parseInt(n.odId)-parseInt(r.odId)})},this.UpdateTabOrder=function(e,t){var n=o[e];n.tabOrder=t},this.GetControlRowId=function(e){return u[e]},this.SetControlRowId=function(e,t){u[e]=t},this.InitControlRowIdMap=function(){u={}},SiebelAppFacade.ODHPreviewPW.superclass.constructor.apply(this,arguments)}function y(e,t,n,r){var i=this;_.call(this,e,t,"gridParent",n),D.call(this,r,e,n),$.when(P.call(i,r)).done(function(){M.call(i),SiebelApp.S_App.uiStatus.Free()})}function E(e,t,n,r){var i=new $.Deferred,s=[],o=[],u=[],a=this,f=this.GetProp("GridPids"),l=r[e],c,h,p,d,v,m,g;SiebelApp.S_App.uiStatus.Busy();for(h=0,c=f.length;h<c;h++)p=r[f[h]],d={},p&&p.mapped&&e!=p.id&&(v=parseInt(p.left),m=parseInt(p.top),t&&parseInt(l.left)<parseInt(p.left)&&(d.id=p.id,v+=t,d.left=v+"px"),n&&parseInt(l.top)<parseInt(p.top)&&(d.id=p.id,m+=n,d.top=m+"px"),d.id&&(g=j.call(this,v,m)+"",d.odId=g,d.hasDomRef=p.hasDomRef,_.call(this,d,p,"gridParent",r),D.call(this,d.id,d,r,!0),o.push(P),u.push([d.id])));return A.call(this,o,u,i),i.done(function(){M.call(a),i.resolve(),SiebelApp.S_App.uiStatus.Free()}),i.promise()}function S(e){var t=new $.Deferred,n=this.GetProp("ParsedTree"),r=n[e],i=this;return SiebelApp.S_App.uiStatus.Busy(),$.when(i.ExecuteMethod("OnItemDelete",r)).done(function(){i.onmouseUp=!1,$.when(i.ExecuteMethod("DeleteRecord",r.itemName)).done(function(){D.call(i,e,O.call(i),n);var s=i.GetProp("odIdMap");if(s[r.odId]){var o=s[r.odId].indexOf(r.id);s[r.odId].splice(o,1),s[r.odId].length===0&&delete s[r.odId]}M.call(i),t.resolve(),SiebelApp.S_App.uiStatus.Free()}).fail(function(){SiebelApp.S_App.uiStatus.Free()})}),t.promise()}function x(e){var t=$(e.target),n=t.parent(),r=n.attr("pid"),i=new $.Deferred,s=this.GetProp("ParsedTree"),o=s[r],u=o.control,a=this,f=[],l={},c=this.GetCtrlPIDMap(u),h=c.length;SiebelApp.S_App.uiStatus.Busy();var p=[],d=[];for(var v=0;v<h;v++)l.mode=n.hasClass("siebui-odh-preview-show-more")?"":"More",l.id=c[v],D.call(this,l.id,l),p.push(P),d.push([l.id]);return A.call(this,p,d,i),i.done(function(){M.call(a),SiebelApp.S_App.uiStatus.Free()}),i.promise()}function T(e,t){var n=new $.Deferred,r=this,i=!1,s=!1,o=this.GetProp("ParsedTree"),u=t.element.attr("pid"),a=o[u];SiebelApp.S_App.uiStatus.Busy();var f=t.position.left,l=t.position.top,c=t.size.height,h=t.size.width,p={};p.top=l,p.left=f,p.height=c+"px",p.width=h+"px",p.rowSpan=Math.ceil(c/v)+"",p.colSpan=Math.ceil(h/v)+"",p.itemName=a.itemName,p.odId=a.odId,p.hasDomRef=!0,p.id=a.id;if(N.call(this,p,o))B.call(this,$("[pid='"+u+"']"),a),SiebelApp.S_App.uiStatus.Free(),n.resolve();else{var d={},m=c-parseInt(a.height),g=h-parseInt(a.width);d["HTML Height"]=parseInt(a["HTML Height"]||a.height)+m,p["HTML Height"]=d["HTML Height"]+"",m&&Math.sign(m)!==-1&&(i=!0),d["HTML Width"]=parseInt(a["HTML Width"]||a.width)+g,p["HTML Width"]=d["HTML Width"]+"",g&&Math.sign(g)!==-1&&(s=!0);var y=j.call(this,f,l)+"";p.odId=y,p.id=u,_.call(this,p,a,"gridParent",o),D.call(this,u,p);var d={"HTML Height":p["HTML Height"],"HTML Width":p["HTML Width"],name:a.itemName};$.when(P.call(r,u)).done(function(){var e=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Control Properties Applet"});$.when(r.ExecuteMethod("WriteRecord",a.itemName,d,e,!1)).done(function(){M.call(r),n.resolve(),SiebelApp.S_App.uiStatus.Free()})})}return n.promise()}function N(e,n,r,s){n=n||this.GetProp("ParsedTree");var o=this.GetProp("GridPids"),u=!1,a,f=parseInt(e.left,10),l=parseInt(e.top,10),c=parseInt(e.height,10),h=parseInt(e.width,10),p,d,v=r?!0:!1,m=this.GetProp("ActivePidArray"),g=m&&m.length>1;for(var y=0,b=o.length;y<b;y++){a=n[o[y]];if(a&&a.mapped&&(!g||m.indexOf(""+a.id)===-1)&&e.id!==a.id){p=parseInt(a.top,10),d=parseInt(a.left,10);if(Math.abs(l-p)<(l<=p?c:parseInt(a.height,10))&&Math.abs(f-d)<(f<=d?h:parseInt(a.width,10))){u=!0;if(!v){s||t.Alert(i);break}r.push(""+a.id)}}}return u}function C(){M.call(this)}function k(e,t,n,r){var i=new $.Deferred,s=this.GetProp("ParsedTree"),o=s[e],u=this;if(o){var a={srcItem:t,newItem:n,targetId:e,targetOdId:o.odId};$.when(this.ExecuteMethod("OnItemDrop",a)).done(function(){SiebelApp.S_App.uiStatus.Busy();var a=O.call(u,t);D.call(u,t.id,O.call(u),s),$.when(!o.mapped||H.call(u,e,s)).done(function(){e=D.call(u,e,a,s),$.when(t.bSkipCommit||P.call(u,e,n)).done(function(){var s;u.Get("ItemMode")==="Applet"&&n&&(s=$("[pid='"+e+"']").children(":not('.siebui-identifier-span')").detach());var o=SiebelAppFacade.ComponentMgr.FindComponent({id:u.Get("ObjectWTIName")});if(o){var a=o.Get("GetRecordSet"),f=o.Get("GetSelection");a&&a[f]&&a[f].Name!==t.itemName&&(u.GetProp("ParsedTree")[e].itemName=a[f].Name)}r||(C.call(u),s&&s.length&&($("[pid='"+e+"']").append(s),s=null)),u.dragInprogress=!1,SiebelApp.S_App.uiStatus.Free(),i.resolve()})})}).fail(function(){i.reject()})}else i.resolve();return i.promise()}function L(e,t,n,r){if(r){var i=new $.Deferred,s=this.GetProp("ActivePidArray"),o=[],u=[],a=this.GetProp("ParsedTree"),f=this;for(var l=0,c=s.length;l<c;l++)o.push(k),u.push([e,a[s[l]],n,!0]);return A.call(this,o,u,i),i.done(function(){C.call(f)}),i.promise()}return k.apply(this,arguments)}function A(e,t,n){var r=this,i=function(){e.length>0?e.shift().apply(r,t.shift(0)).done(i).fail(function(){n.reject()}):n&&n.resolve()};i.call(this)}function O(e){var t={mapped:!1};return e&&(t.odDispName=e.odDispName,t.odHtmlType=e.odHtmlType,t.itemName=e.itemName,t.hasDomRef=e.hasDomRef,t.bGridCtrl=e.bGridCtrl,e.bGridCtrl&&(t.left=e.left,t.top=e.top,t.height=e.height,t.width=e.width,t.rowSpan=e.rowSpan,t.colSpan=e.colSpan,t.id=e.id,t.control=e.control,t.odId=e.odId,t.gridProperty=e.gridProperty,t.type=e.type,t.property=e.property
,t.mode=e.mode,t["HTML Sequence"]=e["HTML Sequence"]),t.mapped=!0),t}function M(){var e=this.GetProp("StaleUIId"),t=this.GetProp("ParsedTree"),n,r=this.GetIFrame(),i=$("#wti_applet_show_more"),s=i.hasClass("siebui-odh-preview-more")?!0:!1;for(var o=0,u=e.length;o<u;o++)n=e[o],B.call(this,$("[pid='"+n+"']",r),t[n],s);this.SetProp("StaleUIId",[])}function _(e,t,n,r){if(!e.hasDomRef)$("[pid ="+n+" ]").append(St.call(this,e));else{t=r[e.id];var i=this.GetProp("odIdMap");if(i[t.odId]){var s=i[t.odId].indexOf(e.id);i[t.odId].splice(s,1)}t.odId=e.odId,wt.call(this,t.id,t,["od-property"],i)}}function D(e,t,n,r){if(e){n=n||this.GetProp("ParsedTree"),r=r==="undefined"?!1:r;var i=n[e];if(i){var s=i.odId;s==="gridparent"&&(_.call(this,t,i,e,n),e=t.id),s=t.odId||i.odId;var o=this.GetProp("odIdMap")[s]||[],u=o.length,a;for(var f=0;f<u;f++){a=n[o[f]];if(!r||e===a.id)for(var l in t)a[l]=t[l];this.GetProp("StaleUIId").indexOf(o[f])===-1&&this.GetProp("StaleUIId").push(o[f])}}}return e}function P(e,t){var n=new $.Deferred,r=this.GetProp("ParsedTree"),i=r[e],s=this;t&&(t=$.extend({"Item Identifier":i.odId},t),this.ExecuteMethod("NewRecord",t));var o={"Item Identifier":i.odId,"Row Span":i.rowSpan,"Column Span":i.colSpan,Mode:i.mode};return i.control&&(o.Control=i.control),this.ExecuteMethod("UpdateRecord",i.itemName,$.extend(o,t),t).done(function(){if(t&&s.Get("ItemMode")==="Applet"){var r=CCFMiscUtil_CreatePropSet();r.SetProperty("AppletName",t.Applet);var o={async:!0,cb:function(){n.resolve()}};SiebelAppFacade.ComponentMgr.FindComponent({id:s.Get("ObjectWTIName")}).ExecuteMethod("InvokeMethod","ShowAppletLayout",r,o)}else{var u=SiebelAppFacade.ComponentMgr.FindComponent({id:s.Get("ObjectWTIName")});if(u){var a=u.Get("GetRecordSet"),f=u.Get("GetSelection");a&&a[f]&&a[f].Name!==i.itemName&&(s.GetProp("ParsedTree")[e].itemName=a[f].Name)}n.resolve()}}).fail(function(){n.reject()}),n.promise()}function H(e,t){var n=new $.Deferred;t=t||this.GetProp("ParsedTree");var r=this,i=Number(e),s=i,o=t[s],u=!1,a=this.GetProp("PreviewId");while(!u){i++,i===a&&(i=-1);if(i===s)break;u=t[i]&&t[i].odItem&&t[i].odId!==o.odId}e=i;if(!u)n.reject();else{var f=t[e];$.when(!f.mapped||H.call(r,e,t)).done(function(){var i=r.Get("odIdMap"),u=i[o.odId],a;for(var l=0;l<u.length;l++)if(u[l].Name===o.itemName){a=u.splice(l,1)[0];break}D.call(r,e,O.call(r,o),t),D.call(r,s,O.call(r),t),P.call(r,e).done(function(){a["Item Identifier"]=f.odId,i[f.odId]?i[f.odId].push(a):i[f.odId]=[a],n.resolve()})})}return n.promise()}function B(e,r,i){if(r.property){var s=r.property,o,u,a=r.type;this.Get("ItemMode")==="Applet"&&a==="applet"?o="siebui-odh-preview-applet":o="siebui-odh-preview-control",s==="RequiredIndicator"?(e=$('<span class="siebui-icon-icon_required" title="Required"><img src="images/icon_req.gif" border="0" space="0" hspace="0" alt="Required" title="Required"></span>'),r.hasDomRef=!0):["formattedhtml","formattedlabel","displayname","listheader"].indexOf(s.toLowerCase())>-1&&r.odId&&["control","pageitem"].indexOf(r.type.toLowerCase())>-1||e.attr("od-type")==="applet"?(o+=" odh-preview-placeholder",r.hasDomRef=!0):r.hasDomRef=!1;if(r.hasDomRef&&s!=="RequiredIndicator")if(r.mapped){u=r.odDispName;var f=r.odHtmlType,l=!1;o+=" siebui-odh-preview-mapped",a&&(o=o+" odh-item-type-"+a);if(s.toLowerCase()!=="listheader"&&s.toLowerCase()!=="displayname"&&s.toLowerCase()!=="formattedlabel"){f=f||"Field";var c=f;switch(f){case"RadioButton":break;case"Button":case"MiniButton":u="<button class='appletButton'>"+u+"</button>";break;case"CheckBox":u='<input type="checkbox"  checked="checked" readonly="readonly" class="siebui-ctrl-checkbox"/>';break;case"ComboBox":var h=r.width?Number(r.width.replace("px","")):CTRL_DEFAULT_WIDTH;e.html($('<input type="text" readonly="readonly" style="width:'+(""+h-22)+'px"><span class="siebui-icon-dropdown" ></span>')),e.find("input").val(u+(r.bGridCtrl?"":" ("+r.odId+")")),u="";break;case"Link":case"Mailto":case"URL":e.html($('<a  class="drilldown" >'+u+(r.bGridCtrl?"":" ("+r.odId+")")+"</a>")),u="";break;case"Text":case"TextBox":case"Field":c="text",e.html($('<input readonly="readonly" type="'+c+'"/>')),e.find("input").val(u+(r.bGridCtrl?"":" ("+r.odId+")")),l=!0;break;case"TextArea":e.html($('<textarea readonly="readonly"></textarea>')),e.find("textarea").val(u+(r.bGridCtrl?"":" ("+r.odId+")")),u="",l=!0;break;default:f.indexOf("Button")>-1&&(u="<button class='appletButton'>"+u+"</button>")}}r.bGridCtrl&&(s.toLowerCase()==="formattedlabel"||s===n)&&i&&(r.mode==="More"?o+=" siebui-odh-preview-show-more":e.hasClass("siebui-odh-preview-show-more")&&e.removeClass("siebui-odh-preview-show-more")),r.odId&&(u&&!r.bGridCtrl&&(u+=" <span class='siebui-identifier-span'>("+r.odId+")</span>"),e.attr("title",r.odId),t.IsTrue(SiebelApp.S_App.IsAutoOn())&&e.attr(g,"placeholder-"+r.id).attr(m,b)),u&&e.html(u);if(r.bGridCtrl){o+=" siebui-odh-preview-grid-item "+(s===n?" ":"siebui-odh-preview-grid-label");if(this.Get("ItemMode")!=="Applet"){e.css({position:"absolute",top:r.top,left:r.left,height:r.height,width:r.width});if(s===n&&l){e.html("");var p=$('<div class="siebui-odh-preview-grid-ctrl"></div>');p.html(u==""?r.odDispName:u),p.css({position:"absolute",top:r.top,left:r.left,height:r["HTML Height"]||r.height||w+"px",width:r["HTML Width"]||r.width||CTRL_DEFAULT_WIDTH+"px"}),e.append(p)}s===n&&r.odHtmlType!=="FormSection"&&this.UpsertTabOrder(r.id,e.attr("id"),r.odId,r.control,r["HTML Sequence"],isNaN(parseFloat(r["HTML Sequence"]))?0:parseFloat(r["HTML Sequence"]))}else o+=" siebui-odh-preview-grid-min-width"}e.addClass(o),e.removeClass("siebui-odh-preview-unmapped"),r.hasDomRef=!0,this.SetProp("UnMappedInfo",null)}else if(r.bGridCtrl)e.remove(),r.hasDomRef=!1;else{u=" ",o+=" siebui-odh-preview-unmapped",r.hintText&&(u=r.hintText),r.odId&&(u&&(u+=" <span class='siebui-identifier-span'>("+r.odId+")</span>"),e.attr("title",r.odId),t.IsTrue(SiebelApp.S_App.IsAutoOn())&&e.attr(g,"placeholder-"+r.id).attr(m,b)),e.addClass(o),e.removeClass("siebui-odh-preview-mapped"
),e.html(u),r.hasDomRef=!0;if(this.Get("OptimizeLayout")){var v=parseInt(r.odId,10),y=this.GetProp("UnMappedInfo");if(!y)y={},y.prevUnMappedId=v,this.SetProp("UnMappedInfo",y);else if(y.prevUnMappedId+1===parseInt(r.odId,10)){y.lastId=v,y.prevUnMappedId=v,e.addClass("siebui-odh-preview-unmapped-sequence");if(!y.hidden){y.hidden=!0,y.pidArray=[];var E=$("<button class='siebui-unmapped-more siebui-icon-newrecord' title=\""+d+'"></button>');E.attr("unmappedpid",r.id),isAutoOn&&E.attr({ot:"Button",rn:r.id,un:r.id}),e=E.add(e)}r.unMappedInfo=y,y.pidArray.push(r.id)}else y={},y.prevUnMappedId=v,this.SetProp("UnMappedInfo",y)}}}return r.hasDomRef&&r.odId&&(e.attr("pid",r.id),e.filter(".siebui-unmapped-more").removeAttr("pid")),e}function j(e,t){return(parseInt(t/v,10)+1)*1e3+parseInt(e/v,10)+1}function F(e,t,n){var r=this.GetProp("ActivePidArray"),i,s={},o,u,a=[],f=!0,l=this.GetProp("ParsedTree"),c=r.length;for(var h=0;h<c;h++)if(Number(r[h])!==Number(e.id)){s={},i=l[r[h]],o=parseInt(i.left,10)+(parseInt(e.left,10)-parseInt(t.left,10)),u=parseInt(i.top,10)+(parseInt(e.top,10)-parseInt(t.top,10)),o=o<0?0:o,u=u<0?0:u,s.top=u+"px",s.left=o+"px",s.odId=j.call(this,o,u)+"",s.width=i.width,s.height=i.height,s.id=i.id;if(u<0||o<0){if(!n){f=!1;break}}else if(!N.call(this,s,null,!1,n))a.push(s),n&&n.push(s);else{if(!n){f=!1;break}n.push(s)}}else n||a.push(null);if(f){if(!n)for(var p=0;p<c;p++)if(a[p]){var d=this.GetProp("odIdMap");if(d[i.odId]){var v=d[i.odId].indexOf(i.id);d[i.odId].splice(v,1),d[i.odId].length===0&&delete d[i.odId]}i=l[r[p]],i.top=a[p].top,i.left=a[p].left,i.odId=a[p].odId}}else a=[];return a}function I(){var e=this;if(e.activeHoverEle&&e.activeHoverEle.length){e.activeHoverEle.removeClass("siebui-odh-drag-candidate-hover"),e.activeHoverEle=null;var t=$("#wti_delete");t&&t.length&&(e.deleteIcon=t.detach()),t=null;var n=$("#wti_show_more");n&&n.length&&(e.showMoreIcon=n.detach()),n=null}}function q(e){var t=e.data.ctx;if(!t.disableHoverEvents){var n,r=$(e.originalEvent.target),i;if(r.attr("id")!=="wti_delete"&&r.attr("id")!=="wti_show_more"&&r.attr("id")!=="wti_item_show_more"){i=t.activeHoverEle,r.length&&(n=r.closest(".siebui-odh-preview-mapped")),n.is(i)||I.call(t);if(!t.GetProp("MultiSelectMode")&&n.length&&(!i||!n.is(i))){var s=n.eq(0),o=t.Get("ItemMode")!=="Applet";i=s;if(o||!i.hasClass("siebui-odh-preview-control"))i.append(t.deleteIcon),$("#wti_delete",i).data("pid",s.attr("pid"));if(o&&i.parent("#gridparent").length){var f=i.hasClass("siebui-odh-preview-show-more")?a:u;t.showMoreIcon&&(t.showMoreIcon.attr("title",f),i.append(t.showMoreIcon),$("#wti_show_more",i).data("pid",s.attr("pid")))}s.addClass("siebui-odh-drag-candidate-hover"),t.activeHoverEle=s}}}}function R(){$("#wti_delete").remove(),this.GetIFrame().append($('<button type="button" class="siebui-ctrl-btn siebui-icon-delete-wti" id="wti_delete" title="'+o+'"" ></button>'));var e=$("#wti_delete"),t=this,n=t.Get("ItemMode")==="Applet";e.on("click",function(e){var r;n&&(r=$(t.droppableSel,t.GetIFrame())),I.call(t),S.call(t,$(this).data("pid")).done(function(){n&&(r.droppable("destroy"),r=null,$(t.droppableSel,t.GetIFrame()).droppable(t.droppableOptions))}),e.stopImmediatePropagation(),e.preventDefault()}),e&&e.length&&(t.deleteIcon=e.detach()),e=null}function U(e,t){var n=this,r=n.GetProp("MultiSelectMode"),i=t.ctrlKey;if(r){var s=n.GetProp("ActivePidArray");s||(s=[],n.SetProp("ActivePidArray",s)),s.indexOf(e.attr("pid"))>-1&&(i=!0)}st.call(n,{data:{ctx:n},originalEvent:{target:e},ctrlKey:i,shiftKey:t.shiftKey})}function z(){$("#wti_show_more").remove(),this.GetIFrame().append($('<button type="button" class="siebui-ctrl-btn siebui-show-more-ctrl" id="wti_show_more" title="'+u+'""></button>'));var e=$("#wti_show_more"),t=this;e.on("click",function(e){t.onmouseUp=!1,t.GetProp("MultiSelectMode")||(st.call(t,{data:{ctx:t},originalEvent:{target:$(this).parent()},ctrlKey:!1,shiftKey:!1}),x.call(t,e),I.call(t),e.stopImmediatePropagation(),e.preventDefault())}),e&&e.length&&(e=e.detach(),t.showMoreIcon=e)}function W(){var e=this.GetIFrame(),t=e.find("body");t=t.length?t:e,t.off("mouseover.preview").on("mouseover.preview",{ctx:this},q)}function X(){var e=this;return function(t){var n=$(this),r=e.hasGrid&&n.hasClass("siebui-odh-preview-grid-item");U.call(e,n,t);var i=e.GetProp("ActivePidArray");if(r){var s="[pid='"+i[0]+"']";for(var o=1;o<i.length;o++)s=s+",[pid='"+i[o]+"']";return $("#gridparent").append($(s).clone().addClass("siebui-mutiple-drag-clones")),e.gridClones=$(".siebui-mutiple-drag-clones"),e.gridClones.find("#wti_delete , #wti_show_more").remove(),$("<div class='forcehide'></div>")}if(e.Get("ItemMode")==="Applet"){var u=$("<div></div");return kt.call(e,u,n),u.addClass("siebui-odh-preview-control"),u.text(n.contents().eq(0).text()),u}return n.clone().removeAttr("id")}}function V(e){var t=$("#gridparent").offset(),n=e.top-t.top,r=e.left-t.left;return n=n<0?0:n,r=r<0?0:r,j.call(this,r,n)+""}function J(){var e=this;return function(t,n){var r=$(this);if(e.hasGrid&&r.hasClass("siebui-odh-preview-grid-item")){var i=e.GetProp("ActivePidArray"),s=i.length,o=r.attr("pid"),u=e.GetProp("ParsedTree")[o],a=V.call(this,n.offset),f={odId:u.odId,left:u.left,top:u.top},l=Tt.call(e,a);u.left=l.x+"px",u.top=l.y+"px",u.odId=a;var c=N.call(e,u,e.GetProp("ParsedTree"),!1,!0),h=e.gridClones.filter("[pid='"+u.id+"']");h.css({top:u.top,left:u.left}),c?h.addClass("siebui-invalid-drop"):h.removeClass("siebui-invalid-drop");var p=[],d=[];s>1&&(p=F.call(e,u,f,d),c||p.length<i.length-1?e.gridClones.addClass("siebui-invalid-drop"):e.gridClones.removeClass("siebui-invalid-drop"));var v;for(var m=0,g=d.length;m<g;m++)v=d[m],e.gridClones.filter("[pid='"+v.id+"']").css({top:v.top,left:v.left});u.left=f.left,u.top=f.top,u.odId=f.odId}}}function K(){var e=this;return function(t,n){n.helper.removeClass("siebui-odh-drop-candidate-hover"),e.disableHoverEvents=!0,e.dragInprogress=!0,e.hasGrid&&($(".siebui-selection-area").addClass("forcehide"),e.selInProgress=!1
,e.onmouseUp=!1)}}function Q(){var e=this;return function(t,n){!e.DropEventStart&&e.hasGrid&&$(this).hasClass("siebui-odh-preview-grid-item")&&(n.draggable=$(this),Z.call(e).call($("#gridparent"),t,n)),e.timeoutId=setTimeout(function(){et.call(e)},5e3),e.disableHoverEvents=!1,e.dragInprogress=!1}}function G(){var e=this;e.draggableOptions={cursorAt:{top:2,left:2},helper:X.call(e),cancel:".siebui-odh-preview-unmapped,.odh-preview-prevent-drag "+e.draggableSel,start:K.call(e),drag:J.call(e),stop:Q.call(e),cursor:"move"},$(e.draggableSel,e.GetIFrame()).draggable(e.draggableOptions)}function Y(){var e=this;e.resizeOption={handles:"all",start:function(t,n){n.helper.removeClass("siebui-odh-drop-candidate-hover"),e.disableHoverEvents=!0,e.dragInprogress=!0},stop:function(t,n){e.disableHoverEvents=!0,I.call(e),T.call(e,t,n).done(function(){$(n.element).resizable(e.resizeOption),e.disableHoverEvents=!1,e.dragInprogress=!1})}},$(e.resizableSel,e.GetIFrame()).resizable(e.resizeOption)}function Z(){var e=this;return function(t,i){e.DropEventStart=!0;var s,o=i.helper.data("recordMap"),u=$(this),a=!1,f,l=e.Get("ItemMode")==="Applet";l&&(s=$(e.droppableSel),o?e.SetProperty("ExpandedODH_Placeholder",u):f=$(i.draggable).children(":not('.siebui-identifier-span')").clone()),e.disableHoverEvents=!0,I.call(e);var c=i.draggable.attr("pid"),h=c?e.GetProp("ParsedTree")[c]:i.helper.data("srcitem");u.removeClass("siebui-odh-drop-candidate-hover");var p=!1,d=!1;$(".siebui-selection-area").addClass("forcehide"),e.selInProgress=!1,e.onmouseUp=!1;var m,g=e.GetProp("odIdMap");if(u.closest("#gridparent").length>0){var y=V.call(this,i.offset),b={};if(o){var w=h.Height||o.Height,E=h.Width||o.Width;o["Grid Property"]=h.odHtmlType==="CtrlLabel"?r:n,o["Row Span"]=w?Math.ceil(w/v)+"":"3",o["Column Span"]=E?Math.ceil(E/v)+"":"15",o["Item Identifier"]=y,o["HTML Height"]=w,o["HTML Width"]=E,h.newItem=!0,$.extend(h,xt.call(e,o)),p=!0;if(N.call(e,h,e.GetProp("ParsedTree"))){e.disableHoverEvents=!1,e.DropEventStart=!1,et.call(e);return}g[b.odId]&&(m=g[b.odId].indexOf(c),g[b.odId].splice(m,1),g[b.odId].length===0&&delete g[b.odId])}else{var S=e.GetProp("ActivePidArray");b={odId:h.odId,left:h.left,top:h.top},h.odId=y;var x=Tt.call(e,y);h.left=x.x+"px",h.top=x.y+"px",d=!0;if(N.call(e,h,e.GetProp("ParsedTree"))){h.odId=b.odId,h.left=b.left,h.top=b.top,e.disableHoverEvents=!1,e.DropEventStart=!1,et.call(e);return}g[b.odId]&&(m=g[b.odId].indexOf(c),g[b.odId].splice(m,1),g[b.odId].length===0&&delete g[b.odId]);if(S.length>1){if(!(F.call(e,h,b).length>0)){e.disableHoverEvents=!1,e.DropEventStart=!1,et.call(e);return}a=!0}}}else if(i.draggable.hasClass("siebui-odh-preview-grid-item")){e.DropEventStart=!1,et.call(e);return}L.call(e,u.attr("pid"),h,o,a).always(function(){e.disableHoverEvents=!1,p?$("[pid='"+h.id+"']").draggable(e.draggableOptions).resizable(e.resizeOption):d&&$("[pid='"+h.id+"']").resizable(e.resizeOption),l&&(s.droppable("destroy"),s=null,$(e.droppableSel).droppable(e.droppableOptions),$("[pid='"+h.id+"']").draggable(e.draggableOptions),f&&f.length&&u.append(f),e.SetProperty("ExpandedODH_Placeholder","")),et.call(e),f=null,e.DropEventStart=!1})}}function et(e){e=this,e.gridClones&&(e.gridClones.remove(),e.gridClones=null),clearTimeout(e.timeoutId),e.timeoutId=null}function tt(){var e=this;e.droppableOptions={accept:".odh-preview-placeholder",drop:Z.call(e),over:function(){$(this).addClass("siebui-odh-drop-candidate-hover")},out:function(){$(this).removeClass("siebui-odh-drop-candidate-hover")}},$(e.droppableSel,e.GetIFrame()).droppable(e.droppableOptions)}function nt(){var e=$("#gridparent"),t=$("<div class='siebui-selection-area forcehide'></div>");e.append(t),t=$(".siebui-selection-area");var n=0,r=0,i=e.offset().left,s=e.offset().top,o=this;e.on("mousedown",function(e){$(this).removeClass("odh-preview-prevent-drag"),o.selInProgress=!1,o.onmouseUp=!1,t.addClass("forcehide");if(!o.dragInprogress){o.onmouseUp=!0,n=e.pageX,r=e.pageY;var u=$("#gridparent").offset();i=u.left,s=u.top,t.css("left",n-i+"px"),t.css("top",r-s+"px"),t.css("width","0px"),t.css("height","0px"),e.preventDefault()}}),e.on("mousemove",function(e){o.dragInprogress!==undefined&&(o.dragInprogress?(o.onmouseUp=!1,t.addClass("forcehide")):o.onmouseUp&&Math.abs(e.pageX-n)>8&&(o.selInProgress=!0,t.removeClass("forcehide"),t.css("width",Math.abs(e.pageX-n)),t.css("height",Math.abs(e.pageY-r)),$(this).addClass("odh-preview-prevent-drag"),e.pageX<n&&t.css("left",e.pageX-i+"px"),e.pageY<r&&t.css("top",e.pageY-s+"px")))}),e.on("click",function(e){if(o.selInProgress){var n=[],r=o.GetProp("ParsedTree"),i={};i.top=t.css("top"),i.left=t.css("left"),i.height=t.css("height"),i.width=t.css("width"),i.odId="",o.SetProp("MultiSelectMode",!1),o.SetProp("ActivePidArray",[]),ut.call(o,!1),N.call(o,i,r,n)&&n.length>0&&(o.SetProp("MultiSelectMode",!0),o.SetProp("ActivePidArray",n),ut.call(o,!0)),e.stopImmediatePropagation(),e.preventDefault()}$(this).removeClass("odh-preview-prevent-drag"),o.selInProgress=!1,o.onmouseUp=!1,t.addClass("forcehide")}),$("body").on("click.GridSelection",function(){t.hasClass("forcehide")||($("#gridparent").removeClass("odh-preview-prevent-drag"),o.selInProgress=!1,o.onmouseUp=!1,t.addClass("forcehide"))}),e=null}function rt(){var e=this;e.disableHoverEvents=!1,e.selInProgress=!1,e.onmouseUp=!1,e.Get("ItemMode")==="Applet"?(e.draggableSel=".siebui-odh-preview-applet",e.droppableSel=".siebui-odh-preview-applet.siebui-odh-preview-unmapped",e.resizableSel=""):(e.draggableSel=".odh-preview-placeholder",e.droppableSel=".odh-preview-placeholder:not(#gridparent .odh-preview-placeholder), #gridparent",e.resizableSel=e.hasGrid?"#gridparent .odh-preview-placeholder":""),W.call(e),R.call(e),G.call(e),tt.call(e),e.hasGrid&&(z.call(e),Y.call(e),nt.call(e))}function it(e,t,n){function o(e,t){var n=this,r=n.GetProp("ParsedTree"),i=e.attr("unmappedpid"),s=r[i],u=s.unMappedInfo;e.next(".siebui-odh-preview-unmapped-sequence").removeClass("siebui-odh-preview-unmapped-sequence"
),u.pidArray.shift();var a=u.pidArray[0];a?(e.attr("unmappedpid",a),isAutoOn&&e.attr({rn:a,un:a,"od-Id":r[a].odId}),$("[pid= '"+u.pidArray[0]+"']").before(e.detach())):(e.remove(),s.unMappedInfo=null);if(!t){var f=n.GetProp("odIdMap")[s.odId]||[],l=f.length,c;for(var h=0;h<l;h++)parseInt(i,10)!==f[h]&&(c=$("[pid='"+f[h]+"']").siblings(".siebui-unmapped-more"),c.length&&o.call(n,c,!0))}}if(e){e=e.replace(/<html[^>]*>|<\/html>/gi,"").trim();if(e.indexOf("<head")>-1||e.indexOf("<HEAD")>-1)e=gt.call(this,e);if(e.indexOf("<body")>-1||e.indexOf("<BODY")>-1)e=e.replace(/<body[^>]*>|<\/body>/gi,"").trim();var r;try{r=yt.call(this,e).children()}catch(i){r=[],console.log(i)}this.Get("DndEnabled")?this.SetProperty("OptimizeLayout",this.ExecuteMethod("CanInvokeMethod","WriteRecord")):"";if(this.Get("ExpandedODH_Placeholder"))this.Get("ExpandedODH_Placeholder").append(ft.call(this,r).children());else{n.empty(),this.SetProp("PreviewId",-1),this.SetProp("ParsedTree",{}),this.SetProp("odIdMap",{}),this.SetProp("StaleUIId",[]),n.append(ft.call(this,r));var s=n.parent();this.Get("DndEnabled")?(s.removeClass("siebui-preview-readonly"),isAutoOn&&s.attr("readonly","readonly"),rt.call(this),$(".siebui-unmapped-more").on("click",{ctx:this},function(e){o.call(e.data.ctx,$(this))})):(s.addClass("siebui-preview-readonly"),isAutoOn&&s.attr("readonly","")),ot.call(this)}this.SetProperty("OptimizeLayout",!1)}t=n=null,this.ExecuteMethod("UpdateUIState","ActiveWebTemplate",{stateValue:this.Get("GetActiveWebTemplate")})}function st(t){var n=t.data.ctx;if(!n.DropEventStart){var i=$(t.originalEvent.target),s=n.Get("ItemMode")==="Applet",o;if(n.OnControlEvent(e.get("PHYEVENT_APPLET_FOCUS"))&&i.length){var u,a,f;s?u=i.closest(".siebui-odh-preview-applet.siebui-odh-preview-mapped"):(u=i.closest(".siebui-odh-preview-mapped"),n.Get("IsGridLayout")&&(a=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Control Properties Applet"}),f=$("#"+a.GetPM().Get("GetFullId"))));if(u.length){var l=n.GetProp("ParsedTree"),c=u.attr("pid"),h=l[c];o=s?"View Web Template Item":"";var p=!1;(t.ctrlKey||t.shiftKey)&&i.closest("#gridparent").length&&(p=!0),n.SetProp("MultiSelectMode",p),ut.call(n,!1);if(p){var d=n.GetProp("ActivePidArray");d||(d=[],n.SetProp("ActivePidArray",d)),d.indexOf(c)>-1?t.shiftKey&&(d.splice(d.indexOf(c),1),c=d[d.length-1],h=l[c]):d.push(c)}else n.SetProp("ActivePidArray",[c]);ut.call(n,!0),n.SetProp("ActivePid",c),at.call(n,h,o),f&&(!s&&h.gridProperty===r?$(".siebui-ide-property").addClass("siebui-config-mode"):($(".siebui-ide-property").removeClass("siebui-config-mode"),f.attr("readonly","readonly")))}else s?u=i.closest(".siebui-odh-preview-applet.siebui-odh-preview-unmapped"):(u=i.closest(".siebui-odh-preview-unmapped"),f&&$(".siebui-ide-property").removeClass("siebui-config-mode")),u.length?at.call(this,undefined,"Unmapped"):at.call(this,undefined,"Default"),ut.call(n,!1),n.SetProp("ActivePidArray",[]),n.SetProp("ActivePid",""),n.SetProp("MultiSelectMode",!1)}}}function ot(){var e=this.GetIFrame(),t=e.find("body");t=t.length?t:e,t.find(".siebui-odh-preview").off("click.Selection").on("click.Selection",{ctx:this},st)}function ut(e){if(e){var t="",n=this.GetProp("ActivePidArray")||[];for(var r=0,i=n.length;r<i;r++)r>0&&(t+=" , "),t+="[pid='"+n[r]+"']";$(t).addClass("siebui-odh-active-item")}else $(".siebui-odh-active-item").removeClass("siebui-odh-active-item")}function at(e,n){var r=SiebelApp.S_App.GetActiveView().GetName();if(n==="Default"||n==="Unmapped")SiebelAppFacade.ComponentMgr.FindComponent({id:r}).ExecuteMethod("SetActiveState",n);else{var i=SiebelAppFacade.ComponentMgr.FindComponent({id:this.Get("ObjectWTIName")}),s=e.itemName,o=e.odId,u;if(t.IsEmpty(n)){var a=this.Get("odIdMap")[o];if(typeof a!="undefined"){for(var f=0,l=a.length;f<l;f++)if(a[f].Name===s){u=a[f];break}s=u.Control}else u=this.ExecuteMethod("PositionRecord",s,i);switch(u.Type){case"Control":i=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Control List Applet All"}),u=this.ExecuteMethod("PositionRecord",s,i),n="Control";break;case"List Item":i=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository List Column List Applet All"}),u=this.ExecuteMethod("PositionRecord",s,i),n="List Column";break;default:n="Default"}SiebelAppFacade.ComponentMgr.FindComponent({id:r}).ExecuteMethod("SetActiveState",n)}else u=this.ExecuteMethod("PositionRecord",s,i),u&&SiebelAppFacade.ComponentMgr.FindComponent({id:r}).ExecuteMethod("SetActiveState",n)}}function ft(e){var t=[],n=[],r,i=$("<div class='siebui-odh-preview'></div>");for(var s=0,o=e.length;s<o;s++)r=bt.call(this,e.eq(s),i),t.push(r),n.push(r.DOM);if(this.Get("IsGridLayout")!==!0)this.SetProperty("IsGridLayout",!1);else if(this.Get("ItemMode")!=="Applet"){if(!$("#wti_applet_show_more").length){var u=$('<li  class="siebui-odh-preview-more" title="'+l+'"id="wti_applet_show_more" '+(isAutoOn?'rn="preview-show-more" ot="Link" ':"")+" ></li>");$("#siebui-wt-list-responsive").append(u),u.on("click",function(e){lt.call(this,e)}),u=null}if(!$("#wti_applet_tab_order_set").length){var a=$('<li class="siebui-tab-order-btn-grp"></li>');a.append($('<div class="siebui-tab-order-title-wrap" title="'+c+'"><div class="siebui-tab-order-btn siebui-icon-tab-order" title="'+c+'" id="wti_applet_tab_order_set" '+(isAutoOn?'rn="tab-order-set" ot="Link" ':"")+" ></div></div>")),a.append($('<div class="siebui-tab-order-title-wrap" title="'+h+'"><div class="siebui-tab-order-btn siebui-icon-tab-order-save ui-state-disabled" title="'+h+'" id="wti_applet_tab_order_save" '+(isAutoOn?'rn="tab-order-save" ot="Link" ':"")+" ></div></div>")),a.append($('<div class="siebui-tab-order-title-wrap" title="'+p+'"><div class="siebui-tab-order-btn siebui-icon-tab-order-cancel" title="'+p+'" id="wti_applet_tab_order_cancel" '+(isAutoOn?'rn="tab-order-cancel" ot="Link" ':"")+" ></div></div>")),$("#siebui-wt-list-responsive").append(a),$("#wti_applet_tab_order_save").hide(),$("#wti_applet_tab_order_cancel").hide();var f=this
;$("#wti_applet_tab_order_set").on("click",function(e){ct.call(f)}),$("#wti_applet_tab_order_save").on("click",function(e){vt.call(f,!0),ct.call(f)}),$("#wti_applet_tab_order_cancel").on("click",function(e){mt.call(f),ct.call(f)})}this.Get("DndEnabled")?$("#wti_applet_tab_order_set").removeClass("ui-state-disabled"):$("#wti_applet_tab_order_set").addClass("ui-state-disabled")}return i}function lt(){var e=$("#wti_applet_show_more"),t=e.attr("title"),n=$(".odh-html-preview");t===l?(e.removeClass("siebui-odh-preview-more"),e.addClass("siebui-odh-preview-less"),e.attr("title",f),n.addClass("siebui-preview-less-wti")):(e.removeClass("siebui-odh-preview-less"),e.addClass("siebui-odh-preview-more"),e.attr("title",l),n.removeClass("siebui-preview-less-wti"))}function ct(){var e=$("#wti_applet_tab_order_set"),t=$(".siebui-ide");t.next("#wti_tab_order_on_overlay").length||$("<div id='wti_tab_order_on_overlay' class='ui-widget-overlay'></div>").insertAfter(t).hide(),t.hasClass("siebui-tab-order-on")?(t.removeClass("siebui-tab-order-on"),t.next().hide(),$("#wti_applet_tab_order_save").hide(),$("#wti_applet_tab_order_cancel").hide(),ht.call(this)):(t.addClass("siebui-tab-order-on"),t.next().show(),$("#wti_applet_tab_order_save").show(),$("#wti_applet_tab_order_cancel").show(),pt.call(this))}function ht(){$("#PreviewArea .siebui-tab-order-overlay").remove(),$("#wti_applet_tab_order_save").addClass("ui-state-disabled"),this.ResetCurrTabOrder()}function pt(){var e=this,t=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Control Properties Applet"}),n=t.Get("GetRecordSet");for(var r=0,i=n.length;r<i;r++)e.SetControlRowId(n[r].Name,n[r].Id);e.SortTabOrderArray(),$.each(e.GetTabOrderArray(),function(t,n){var r=e.GetTabOrderInfo(n);r.tabOrder=t+1;var i=$("#PreviewArea").find("[pid='"+n+"']"),s=$('<div class="siebui-tab-order-overlay" ctrlpid="'+n+'"></div>');s.css({position:"absolute",top:i.css("top"),left:i.css("left"),width:i.css("width"),height:i.css("height")});var o=$('<div class="siebui-ctrl-tab-order">'+r.tabOrder+"</div>");s.append(o),i.after(s)});var s=$("#PreviewArea .siebui-tab-order-overlay");s.on("click",function(t){$("#PreviewArea .siebui-tab-order-overlay").removeClass("siebui-active"),$("#wti_applet_tab_order_save").removeClass("ui-state-disabled");var n=$(t.currentTarget),r=n.attr("ctrlpid"),i=e.GetTabOrderInfo(r).tabOrder,s=e.NextTabOrder();i!=s&&(e.UpdateTabOrder(r,s<e.GetMaxTabOrder()?s-.5:s+.5),dt.call(e)),n.addClass("siebui-active"),t.stopImmediatePropagation(),t.preventDefault()})}function dt(){var e=this;e.SortTabOrderArray(),$.each(e.GetTabOrderArray(),function(t,n){var r=e.GetTabOrderInfo(n);r.tabOrder=t+1}),$("#PreviewArea .siebui-tab-order-overlay").each(function(t){var n=e.GetTabOrderInfo($(this).attr("ctrlpid"));$(this).find(".siebui-ctrl-tab-order").text(n.tabOrder)})}function vt(e){var n=new $.Deferred,r=this,i=r.GetProp("ParsedTree"),s=CCFMiscUtil_CreatePropSet(),o=CCFMiscUtil_CreatePropSet(),u;return $.each(r.GetTabOrderArray(),function(e,t){var n=r.GetTabOrderInfo(t),s=i[t];s["HTML Sequence"]=""+n.tabOrder,o.SetProperty(r.GetControlRowId(n.control),n.tabOrder)}),u=o.EncodeAsString(),s.SetProperty("RowIdTabOrderPropSetStr",u),t.IsTrue(e)?s.SetProperty("NotifyNewData","true"):s.SetProperty("NotifyNewData","false"),SiebelApp.S_App.uiStatus.Busy(),$.when(r.ExecuteMethod("SaveTabOrder",s)).done(function(){n.resolve()}).fail(function(){n.reject()}).always(function(){SiebelApp.S_App.uiStatus.Free()}),n.promise()}function mt(){var e=this;$.each(e.GetTabOrderArray(),function(t,n){var r=e.GetTabOrderInfo(n);r.tabOrder=isNaN(parseFloat(r.seq))?0:parseFloat(r.seq)})}function gt(e){var t=/<head>([\s\S]*?)<\/head>/gi,n=e.match(t)?e.match(t):"",r="",i=$("");try{for(var s=0,o=n.length;s<o;s++)r+=n[s].replace(/<head[^>]*>|<\/head>/gi,"").trim();i=$(r)}catch(u){console.log(u)}return i.length>0&&this.GetIFrame().find("head").append(ft.call(this,i)),e.replace(t,"").trim()}function yt(e){var t,n;e=$.trim(e.replace(/<(area|br|col|embed|hr|img|input|link|meta|param)(.*?)\>/ig,"<$1$2/>").replace(/(<\/(area|br|col|embed|hr|img|input|link|meta|param)>)|(\r?\n|\r)/ig,"").replace(/<script/ig,"<noscript").replace(/script>/ig,"noscript>")),t=e.match(/="((?:\\.|[^"\\])*[<|>](?:\\.|[^"\\])*)"/ig),t&&(n=t.map(function(t){var n=t;return t=t.replace(/</g,"#$%1").replace(/>/g,"#$%2"),e=e.replace(n,t),t}));var r=e.split("<"),i=$("<div class ='siebui-odh-parentplaceholder-preview'></div> "),s=i,o="div";r[0]&&s.append($(document.createTextNode($.trim(r[0]))));var u,a;for(var f=1,l=r.length;f<l&&s.length;f++){var c=$.trim(r[f]);if(c){u=c.split(">"),a=u[1],c=u[0],c=c.replace("#$%1","<").replace("#$%2",">");switch(c[0]){case"/":var h=(c.substring(1)||"").toLowerCase(),p=s;while(o!==h&&s.length)s=s.parent(),s.length&&(o=s.prop("tagName").toLowerCase());s.length&&(s=s.parent(),s.length&&(o=s.prop("tagName").toLowerCase())),!s.length&&f!==l-1&&(s=p,o=s.prop("tagName").toLowerCase()),a&&s.append(a);break;case"!":a&&s.append(a);break;default:var d=$("<"+c+">");d.attr("od-type")==="applet"&&d.attr("od-property","FormattedHtml"),c.indexOf("od-form-applet-layout")>-1&&d.attr("od-type","grid-form"),c[c.length-1]!=="/"?(a&&d.html(a),s.append(d),s=d,o=s.prop("tagName").toLowerCase()):(s.append(d),a&&s.append(a))}}}return i}function bt(e,t,n){var r={};n=n||{};var i=this.GetProp("odIdMap");if(e.length>0){var s=this.GetProp("PreviewId")+1;this.SetProp("PreviewId",s),r.id=s,r.parentId=n.id;var o=e.get(0),u=o.nodeType;if(u===3||u===8)u===3&&o.nodeValue.trim()&&t.append(e);else{var a=Lt.call(this,e),f;r.hasDomRef=!0,r.processChild=!0;var l=$("<"+e.prop("tagName").toLowerCase()+"></"+e.prop("tagName").toLowerCase()+">");kt.call(this,l,e),e.prop("tagName").toLowerCase().indexOf("swe")>-1&&(r.hasDomRef=!1);if(a.indexOf("od-type")>-1){f=e.attr("od-type");switch(f.toLowerCase()){case"error":r.hasDomRef=!1,r.processChild=!1;break;case"form":r.hasDomRef=!1;break;case"control":r.hasDomRef=!1;break;case"pageitem":r.hasDomRef=!1;
break;case"applet":r.hasDomRef=!1;break;case"taskviewtitle":r.hasDomRef=!1;break;case"grid-form":r.hasDomRef=!0,r.bGridCtrl=!0,r.processChild=this.Get("ItemMode")==="Applet",l.attr("id","gridparent"),l.attr("od-id","gridparent"),l.addClass("siebui-form-grid-layout"),e.attr("od-id","gridparent"),this.SetProperty("IsGridLayout",!0),this.hasGrid=!0;break;default:r.hasDomRef=!1}}else a.indexOf("od-switch")>-1?(r.hasDomRef=!1,r.typeswitch=e.attr("od-switch")):a.indexOf("od-case")>-1?(r.hasDomRef=!1,r.typecase=e.attr("od-case")):a.indexOf("od-if")>-1?(r.hasDomRef=!1,r.typeif=e.attr("od-if")):a.indexOf("od-iterator")>-1?(r.hasDomRef=!1,r.typecase=e.attr("od-case")):r.tagName=e.prop("tagName").toLowerCase();var c=e.attr("od-type");c&&n&&n.type&&n.type!==c?(r.type=c,r.odId=e.attr("od-id"),r.odDispName=e.attr("od-display-name"),r.odHtmlType=e.attr("od-html-type"),r.hintMap=Ct.call(this,e,a),r.itemName=e.attr("od-item-Name")):(r.type=c||n&&n.type,r.odId=e.attr("od-id")||n&&n.odId,r.odDispName=e.attr("od-display-name")||n&&n.odDispName,r.odHtmlType=e.attr("od-html-type")||n&&n.odHtmlType,r.hintMap=$.extend(n.hintMap,Ct.call(this,e,a)),r.itemName=e.attr("od-item-Name")||n&&n.itemName),r.bGridCtrl=r.bGridCtrl||n.bGridCtrl||!1,r.property=e.attr("od-property"),r.odDispName&&(r.mapped=!0),l=B.call(this,l,r),r.hasDomRef&&(l.attr("od-id",r.odId),t.append(l),t=l,l.attr("id")==="gridparent"&&this.Get("ItemMode")!=="Applet"&&Et.call(this,e,l));if(r.processChild){var h=e.contents();r.children=[];for(var p=0,d=h.length;p<d;p++)r.children.push(bt.call(this,h.eq(p),t,r));r.childLen=d}r.odId&&wt.call(this,s,r,a,i)}r.DOM=t}return r}function wt(e,t,n,r){this.GetProp("ParsedTree")[e]=t,r=r||this.GetProp("odIdMap");if(n.indexOf("od-type")>-1||n.indexOf("od-property")>-1)r[t.odId]?r[t.odId].push(e):r[t.odId]=[e],t.odItem=!0;t.bGridCtrl&&this.GetProp("GridPids").indexOf(e)===-1&&this.GetProp("GridPids").push(e)}function Et(e,t){var n=e.contents();if(n&&n.length){var r=n.find("div[od-item-name]"),i=r.map(function(){return this.getAttribute("od-item-name")}).get(),s=r.map(function(){return{DisplayName:this.getAttribute("od-display-name"),HTMLType:this.getAttribute("od-html-type")}}).get(),o=SiebelAppFacade.ComponentMgr.FindComponent({id:this.Get("ObjectWTIName")}),u=o.Get("GetRecordSet"),a=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Edit Web Layout Palette"}),f=a?a.Get("ControlMap"):{},l=u.length,c=[],h;for(var p=0;p<l;p++){h=i.indexOf(u[p].Name);if(h===-1)continue;u[p].DisplayName=s[h].DisplayName,u[p].HTMLType=f[u[p].Control]?f[u[p].Control].ctrlType:s[h].HTMLType,u[p]["HTML Width"]=f[u[p].Control]?f[u[p].Control]["HTML Width"]:"",u[p]["HTML Height"]=f[u[p].Control]?f[u[p].Control]["HTML Height"]:"",u[p]["HTML Sequence"]=f[u[p].Control]?f[u[p].Control]["HTML Sequence"]:"",c.push(St.call(this,xt.call(this,u[p]),!0))}t.append(c),r=null}}function St(e,t){var n=$("<div id='"+e.odId+"' od-property='"+e.gridProperty+"' od-id='"+e.odId+"' od-type='"+e.type+"' ></div>");return B.call(this,n,e,t),wt.call(this,e.id,e,["od-property"]),n}function xt(e){var t={};t.gridProperty=e["Grid Property"],t.rowSpan=e["Row Span"],t.colSpan=e["Column Span"],t.type="control",t.odId=(e["Item Identifier - Language Override"]||e["Item Identifier"]||"").replace(/\D/g,""),t.odDispName=e.DisplayName||e.Control,t.odHtmlType=e.HTMLType,t.mode=e.Mode,t.itemName=e.Name,t.control=e.Control,t.property=e["Grid Property"],t.bGridCtrl=!0;var n=this.GetProp("PreviewId")+1;this.SetProp("PreviewId",n),t.id=n,this.SetCtrlPIDMap(t.control,n);var r=Nt.call(this,t.odId);t.row=r.row,t.col=r.col;var i=Tt.call(this,t.odId);return t.top=i.y+"px",t.left=i.x+"px",t.height=(e.Height||t.rowSpan*v)+"px",t.width=(e.Width||t.colSpan*v)+"px",t["HTML Height"]=(e["HTML Height"]||e.Height||w)+"px",t["HTML Width"]=(e["HTML Width"]||e.Width||CTRL_DEFAULT_WIDTH)+"px",t["HTML Sequence"]=e["HTML Sequence"],t.odDispName&&(t.mapped=!0),t}function Tt(e){var t,n,r={},i=Nt.call(this,e);return t=i.row,n=i.col,t--,n--,r.y=Math.ceil(t*v),r.x=Math.ceil(n*v),r}function Nt(e){var t={};return t.row=e/1e3,t.col=e%1e3,t}function Ct(e,t){var n=["hintmaptype","hinttext","hintmaplabelid"],r={};for(var i=0;i<2;i++){var s=n[i];t.indexOf(s)>-1&&(r[s]=e.attr(s))}return r}function kt(e,t){var n=t[0],r;for(var i=0,s=n.attributes.length;i<s;i++)r=n.attributes[i],e.attr(r.name,r.value)}function Lt(e){var t=[],n=e[0];if(n.attributes)for(var r=0,i=n.attributes.length;r<i;r++)t.push(n.attributes[r].name);return t}return SiebelJS.Extend(s,SiebelAppFacade.BasePW),s.prototype.Init=function(){this.Get("EditMode")?($("#"+this.control.GetDisplayName()).append($("<div id = 'od-html-preview' class='odh-html-preview'></div>")),this.SetIFrame($("#od-html-preview"))):$("#"+this.control.GetDisplayName()).append($("<iframe id = 'od-html-preview' class='odh-html-preview'></iframe>"));var e="",t=SiebelApp.ThemeManager.getTheme("PLATFORM_DEPENDENT_Application").css;for(var n in t)e=e+'<link rel="stylesheet" href="'+t[n]+'" type="text/css">';this.SetProp("themeEle",e)},s.prototype.ShowUI=function(){isAutoOn=t.IsTrue(SiebelApp.S_App.IsAutoOn())},s.prototype.OnCanvasItemChange=function(e){var t=this.GetProp("ActivePid");if(t){var n=this.GetProp("ParsedTree"),r=this,i=n[t];if(Object.keys(e).length>0){SiebelApp.S_App.uiStatus.Busy();if(e["HTML Height"]||e["HTML Width"]){var s=0,o=0;e.rowSpan=i.rowSpan,e.colSpan=i.colSpan,e.width=i.width,e.height=i.height,parseInt(e["HTML Height"])!==parseInt(i["HTML Height"])&&(s=parseInt(e["HTML Height"])-parseInt(i["HTML Height"]),e.height=parseInt(i.height)+s,e.rowSpan=Math.ceil(parseInt(e.height)/v)+""),parseInt(e["HTML Width"])!==parseInt(i["HTML Width"])&&(o=parseInt(e["HTML Width"])-parseInt(i["HTML Width"]),e.width=parseInt(i.width)+o,e.colSpan=Math.ceil(parseInt(e.width)/v)+""),e.odId=i.odId,e.id=n[t].id,e.hasDomRef=!0,s>0||o>0?$.when(E.call(this,e.id,o,s,n,!0)).done(function(){y.call(r,e,i,n,n[t].id)}):y.call(this,e,i,n,n[t].id)}else{for(var u in e)(i[u]===e[u]||u==="control"&&
this.Get("odIdMap")[i.odId][0].Control===e[u])&&delete e[u];_.call(this,e,i,"gridParent",n),D.call(this,n[t].id,e,n),$.when(!e.control||P.call(r,t)).done(function(){M.call(r),SiebelApp.S_App.uiStatus.Free()})}}}},s.prototype.BuildPreview=function(e){var t,n,r=this;this.Get("EditMode")?(t=this.GetIFrame(),n=t,it.call(r,e,t,n)):setTimeout(function(){t=$("#od-html-preview").contents(),t.find("html").addClass("siebui-ide-canvas"),r.SetIFrame(t),n=t.find("body"),t.find("head").empty().append('<link rel="stylesheet" href="'+SiebelApp.S_App.GetBaseURL()+'files/theme-aurora.css" type="text/css">').append('<link rel="stylesheet" href="'+SiebelApp.S_App.GetBaseURL()+'files/theme-webtools.css" type="text/css">'),it.call(r,e,t,n)},0)},s.prototype.EndLife=function(){$("body").off("mouseover.preview"),this.deleteIcon=null,this.droppableOptions=null,$("#wti_delete").remove(),SiebelAppFacade.ODHPreviewPW.superclass.EndLife.apply(this,arguments)},s}(),SiebelApp.S_App.PluginBuilder.AttachPW(e.get("SWE_CTRL_TEXTAREA"),SiebelAppFacade.ODHPreviewPW,function(e){var t=e.GetApplet().GetName();return(t==="Object Design - HTML"||t==="WT Repository Applet Web Template List Applet"||t==="WT Repository View Web Template List Applet"||t==="WT Repository Web Page List Applet")&&e.GetName()==="PreviewArea"}),SiebelAppFacade.ODHPreviewPW})),typeof SiebelAppFacade.ODHPModel=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ODHPModel"),define("siebel/odhpmodel",["siebel/pmodel"],function(){return SiebelAppFacade.ODHPModel=function(){function n(){SiebelAppFacade.ODHPModel.superclass.constructor.apply(this,arguments)}function r(t){t='"'+t+'"';var n={};n.scope=this,n.cb=function(n,r,i){i&&i.GetProperty(e.get("SWE_RPC_PROP_RETURN_STATUS"))!==e.get("SWE_RPC_PROP_STATUS_ERROR")&&(this.ExecuteMethod("SetFormattedValue",this.Get("GetControls").Name,t)?this.ExecuteMethod("InvokeMethod","ExecuteQuery"):this.ExecuteMethod("InvokeMethod","UndoQuery"))},this.ExecuteMethod("InvokeMethod","NewQuery",CCFMiscUtil_CreatePropSet(),n)}function i(e,t,n,r){if(e==="Preview")if(this.Get("EditorState")==="Preview")this.ExecuteMethod("OnDesignInvoke"),r.CancelOperation=!0,SiebelApp.S_App.uiStatus.Free();else{var i=$("#s_"+this.Get("GetFullId")+"_div");i.hasClass("siebui-commit-pending")&&this.ExecuteMethod("InvokeMethod","WriteRecord")}}function s(){var n=SiebelApp.S_App.GetService(e.get("SWE_OUI_CLIENT_PREF_SERVICE")),r=[];if(!t.IsEmpty(n)){var i=SiebelApp.S_App.NewPropertySet(),s,o,u;for(u=1;u<=7;u++)i.SetProperty("Object Design/"+u,"");s=n.InvokeMethod("GetPreferences",i),o=s.GetChildByType("ResultSet");if(o)for(u=1;u<=7;u++)r[u]=o.GetProperty("Object Design/"+u);return r}}function o(n,r){var i=SiebelApp.S_App.GetService(e.get("SWE_OUI_CLIENT_PREF_SERVICE"));if(!t.IsEmpty(i)){var s=SiebelApp.S_App.NewPropertySet();s.SetProperty("Object Design/"+n,r),i.InvokeMethod("SetPreferences",s)}}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.Utils");return SiebelJS.Extend(n,SiebelAppFacade.PresentationModel),n.prototype.Init=function(){SiebelAppFacade.ODHPModel.superclass.Init.apply(this,arguments),this.AddProperty("ExpandedODH",""),this.AttachNotificationHandler(e.get("SWE_PROP_BC_NOTI_GENERIC"),function(t){if(t.GetProperty("type")==="ExpandedODH"){var n=t.GetProperty(e.get("SWE_PROP_ARGS_ARRAY")),r=[],i;n&&(CCFMiscUtil_StringToArray(n,r),i=CCFMiscUtil_CreatePropSet(),i.DecodeFromString(r[0]),this.SetProperty("ExpandedODH",i.GetProperty("ExpandedODH")))}}),this.AddMethod("OnDesignInvoke",function(){}),this.AddMethod("InvokeMethod",i,{sequence:!0,scope:this}),this.AddMethod("GetEditorPrefrences",s),this.AddMethod("SetEditorPrefrences",o),this.AddMethod("DrillDownOnInclude",r),this.AddProperty("EditorState","Design"),this.AddProperty("OdhArray",[]),this.AddProperty("AutoTidyOn",!1)},n.prototype.UpdateModel=function(){SiebelAppFacade.ODHPModel.superclass.UpdateModel.apply(this,arguments);var t=e.get("SWE_CTRL_TEXT"),n=SiebelAppFacade.PresentationModel.GetCtrlTemplate("ODHTree","ODHTree",t,6);this.ExecuteMethod("AddClientControl",n),t=e.get("SWE_CTRL_TEXTAREA"),n=SiebelAppFacade.PresentationModel.GetCtrlTemplate("PreviewArea","PreviewArea",t,8),this.ExecuteMethod("AddClientControl",n)},n}(),SiebelAppFacade.ODHPModel})),typeof SiebelAppFacade.ODHRenderer=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ODHRenderer"),define("siebel/odhrenderer",["siebel/phyrenderer","siebel/odheditorpw","siebel/odhpreviewpw","3rdParty/fancytree/dist/jquery.fancytree.min.js"],function(){return SiebelAppFacade.ODHRenderer=function(){function n(){SiebelAppFacade.ODHRenderer.superclass.constructor.apply(this,arguments)}function r(){var e=this.GetPM().Get("OdhArray");e.length>0?$(".siebui-odh-tree-back").removeClass("forcehide"):$(".siebui-odh-tree-back").addClass("forcehide")}function i(e,t){var n=$("#ODHTree");t=t||!1,e="<span>"+e+"</span>";var r=$($.parseHTML(e)),i=r.attr("od-type"),s=[],o,u=[],l=i?[1]:[];o={title:"Object Design",folder:!0,expanded:!0,children:u,searchIndex:1,isRoot:!0};var c=f.call(this,r,l);i?u.push({title:i.charAt(0).toUpperCase()+i.slice(1),folder:!0,expanded:!0,children:c,searchIndex:1}):o.children=c,s.push(o);var h=n.parent();n.empty();var p=n;n.remove(),h.prepend(p),a.call(this,p,s),r=null}function s(){var e=this.GetPM(),t=$("#s_"+this.GetPM().Get("GetFullId")+"_div");t.find("#PreviewArea").addClass("forcehide"),t.find(".siebui-editor-settings").removeClass("forcehide"),$("#edConfigShowTreeNum").is(":checked")&&$(".siebui-odh-tree").addClass("forceshow"),t.find(".CodeMirror").removeClass("forcehide"),e.SetProperty("EditorState","Design"),u.call(this,"Preview","Design")}function o(){var e=this.GetPM(),t=this.GetUIWrapper(e.Get("GetControls").PreviewArea);t.BuildPreview(e.Get("ExpandedODH")),t.Get("EditMode")&&t.GetIFrame().find("html").addClass("siebui-ide-canvas");var n=$("#s_"+e.Get("GetFullId")+"_div");n.find("#PreviewArea").removeClass("forcehide"),$(".siebui-odh-tree").removeClass("forceshow"),n.find(".siebui-editor-settings"
).addClass("forcehide"),n.find(".CodeMirror").addClass("forcehide"),e.SetProperty("EditorState","Preview"),u.call(this,"Design","Preview")}function u(e,n){var r=this.GetPM(),i=r.Get("GetControls").Preview,s=r.Get("GetAppletLabel")+":",o={Preview:i.GetDisplayName(),Design:t},u=o[e];this.GetUIWrapper(i).GetEl().attr({"data-display":u,title:s+u,"aria-label":+s+u}).removeClass("appletButton siebui-icon-"+n.toLowerCase()).addClass("appletButton siebui-icon-"+e.toLowerCase()).find("span").text(u)}function a(e,t){var n,r=this,i=this.GetPM();e.length===1&&(n={autoCollapse:!1,imagePath:" ",_classNames:{nodeIcon:null},clickFolderMode:3,minExpandLevel:1,persist:!1,renderNode:function(e,t){var n=t.node;n.data.addClass&&$(n.span).addClass(n.data.addClass);if(n.data.isRoot&&!n.data.isRendered){var s=$(n.span),o=r.GetPM().Get("OdhArray"),u=o.length>0?o[o.length-1]:"";s.find(".fancytree-title").append($('<button type="button" class="siebui-odh-tree-back'+(u?"":" forcehide ")+' siebui-ctrl-btn " title = "'+u+'" ></button>')).find(".siebui-odh-tree-back").bind("odhTreeBack click",function(e){var t=i.Get("OdhArray"),n=t.pop();i.SetProperty("OdhArray",t),i.ExecuteMethod("DrillDownOnInclude",n),e.stopPropagation()}),n.data.isRendered=!0}},click:function(e,t){var n=t.node.title,r=this.GetPM(),i=t.node.data?t.node.data.searchIndex:0,s=!0;if(t.node.data.isLink){var o=r.Get("OdhArray");o.push(r.ExecuteMethod("GetFormattedFieldValue",r.Get("GetControls").Name)),r.SetProperty("OdhArray",o),r.ExecuteMethod("DrillDownOnInclude",n)}else{var u=$(t.originalEvent.target);s=!(u.length&&u.attr("class")?u.attr("class").indexOf("fancytree-title")>=0:!1),this.GetUIWrapper(r.Get("GetControls").Definition).positionCursor(i)}return s}.bind(r)},$.extend(n,{source:t,expanded:!0}),e.fancytree(n))}function f(e,t){var n=e.children(),r=n.length,i,s=[],o,u,a,l;for(var c=0;c<r;c++)u=n.eq(c),a=u.attr("od-type"),a?(t.push("1"),o={title:a.charAt(0).toUpperCase()+a.slice(1),folder:!0,expanded:!0,children:[],searchIndex:t.length},s.push(o)):(l=u.attr("od-include"),l&&(t.push("1"),o={title:l,folder:!0,expanded:!1,children:[],searchIndex:t.length,extraClasses:"siebui-incl-odh drilldown",isLink:!0},s.push(o))),u.children().length&&(i=f.call(this,u,t),i.length&&(a?o.children=i:s=s.length?s.concat(i):i));return s}var e=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),t=e.GetLocalString("ODH_DESIGN");return SiebelJS.Extend(n,SiebelAppFacade.PhysicalRenderer),n.prototype.Init=function(){SiebelAppFacade.ODHRenderer.superclass.Init.apply(this,arguments),this.AttachPMBinding("ExpandedODH",o),this.AttachPMBinding("OnDesignInvoke",s),this.AttachPMBinding("FieldChange",function(e,t){e.GetFieldName()==="Definition"&&i.call(this,t,!0)}),this.AttachPMBinding("ShowSelection",function(){var e=this.GetPM(),t,n=e.Get("GetControls"),r=n.Definition;t=e.ExecuteMethod("GetFieldValue",r),i.call(this,t,!0)}),this.AttachPMBinding("OdhArray",r)},n.prototype.EndLife=function(){SiebelAppFacade.ODHRenderer.superclass.EndLife.apply(this,arguments),$("html").removeClass("siebui-odh-editor-mode")},n.prototype.ShowUI=function(){var e=this.GetPM(),t=null,n,r,s,o=e.Get("GetControls");$("#"+e.Get("GetFullId")).addClass("siebui-odh-applet"),t=o.PreviewArea,$("[name = "+o.Definition.GetInputName()+"]").after($('<div id="'+t.GetDisplayName()+'" type="'+t.GetUIType()+'" name="'+t.GetInputName()+'" class = forcehide>'));var u=this.GetUIWrapper(o.Definition).GetEl();r=u.parent(),t=o.ODHTree,n=$('<div class="siebui-odh-tree" id="'+t.GetDisplayName()+'" type="'+t.GetUIType()+'" name="'+t.GetInputName()+'" >'),r.prepend(n),t=o.Definition,s=e.ExecuteMethod("GetFieldValue",t),i.call(this,s),SiebelAppFacade.ODHRenderer.superclass.ShowUI.apply(this,arguments),this.GetUIWrapper(o.Preview).GetEl().before("<div class='siebui-restore-context'></div>");var a=SiebelApp.S_App.GetActiveView();a&&(a=SiebelAppFacade.ComponentMgr.FindComponent({id:a.GetName()}),a&&a.GetPM().SetProperty("EnableRestoreContext",!0)),$("html").addClass("siebui-odh-editor-mode")},n}(),SiebelAppFacade.ODHRenderer})),typeof SiebelAppFacade.LayoutPreviewPR=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.LayoutPreviewPR"),define("siebel/layoutpreviewpr",["siebel/phyrenderer","siebel/jqgridrenderer","siebel/odheditorpw","siebel/odhpreviewpw","3rdParty/fancytree/dist/jquery.fancytree.min.js"],function(){return SiebelAppFacade.LayoutPreviewPR=function(){function e(){SiebelAppFacade.LayoutPreviewPR.superclass.constructor.apply(this,arguments)}function t(){var e=$("#"+this.GetPM().Get("GetFullId"));e.parent().find("#PreviewArea").addClass("forcehide"),this.GetPM().SetProperty("PreviewOpened",!1)}function n(){var e=this.GetPM(),t=e.GetObjName();this.GetUIWrapper(e.Get("GetControls").PreviewArea).BuildPreview(e.Get("ExpandedODH"));var n=$("#"+e.Get("GetFullId"));$("#PreviewArea").removeClass("forcehide"),e.SetProperty("PreviewOpened",!0)}return SiebelJS.Extend(e,SiebelAppFacade.JQGridRenderer),e.prototype.Init=function(){this.AttachPMBinding("ExpandedODH",n);var e=this.GetPM(),t=$(".siebui-ide").length>=1;e.SetProperty("IDEMode",t),t&&e.SetProperty("defaultAppletDisplayMode","expanded"),e.Get("GetName")==="WT Repository Web Page List Applet"&&$("head").prepend('<link rel="stylesheet" href="files/theme-aurora.css" type="text/css">'),this.AttachPMBinding("RefreshData",function(){e.ExecuteMethod("UpdatePreview")}),SiebelAppFacade.LayoutPreviewPR.superclass.Init.call(this),this.AttachPMBinding("UpdateConditionals",function(){var t=e.Get("IsInQueryMode");if(t){var n=e.Get("GetControls").Preview;n&&this.GetUIWrapper(n).SetState(consts.get("SHOW"),!1,0)}})},e.prototype.ShowUI=function(){var e=this.GetPM(),t=null,r=e.Get("GetControls"),i=SiebelApp.S_App.LocaleObject.GetLocalString("IDS_MSG_CLOSE");t=r.PreviewArea;var s=$('<div id="'+t.GetDisplayName()+'" type="'+t.GetUIType()+'" name="'+t.GetInputName()+'" class="forcehide siebui-canvas-preview">');e.Get("GetName")==="WT Repository Web Page List Applet"?$("#_sweview").addClass("siebui-webpage-preview"
):$("#"+e.Get("GetFullId")).addClass("siebui-wt-list"),$("#_sweview").find(".siebui-ide-canvas").length?($("#_sweview").find(".siebui-ide-canvas").append(s),$("#"+e.Get("GetFullId")).addClass("siebui-wt-list")):(s.addClass("siebui-ide-canvas"),$("#"+e.Get("GetFullId")).addClass("siebui-wt-list").parent().append(s)),e.Get("PreviewOpened")&&n.apply(this),SiebelAppFacade.LayoutPreviewPR.superclass.ShowUI.apply(this,arguments)},e.prototype.EndLife=function(){if(this.GetPM().Get("GetName")==="WT Repository Web Page List Applet"){$("#_sweview").removeClass("siebui-webpage-preview");var e=$(document.getElementsByTagName("head")).find("link[href$='files/theme-aurora.css']:first")[0];e.parentElement.removeChild(e),e=null}t.call(this),SiebelAppFacade.LayoutPreviewPR.superclass.EndLife.apply(this,arguments)},e}(),SiebelAppFacade.LayoutPreviewPR})),typeof SiebelAppFacade.LayoutPreviewPM=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.LayoutPreviewPM"),define("siebel/layoutpreviewpm",["siebel/listpmodel"],function(){return SiebelAppFacade.LayoutPreviewPM=function(){function i(){SiebelAppFacade.LayoutPreviewPM.superclass.constructor.apply(this,arguments);var e=null;this.SetPrevSelection=function(t){e=t},this.GetPrevSelection=function(){return e}}function s(e,t,i,s){var o=t[t.length-1],u=null;if(o&&o.getDiff)if(e==="GetActiveWebTemplate"){var a=this.Get("GetActiveWebTemplate");this.GetStateUIMap().ActiveWebTemplate===a?u=null:u=a,s[r]=u,s[n]=!0}else if(e==="ActiveSelection"){var a=this.Get("GetSelection");this.GetStateUIMap().ActiveSelection===a?u=null:u=a,s[r]=u,s[n]=!0}return s[r]}function o(t){if(t){var n=t.ExecuteMethod("GetFormattedFieldValue",t.ExecuteMethod("GetControl","ApplicationsCombo"));this.SetProperty("ApplicationName",n==="All Applications"?"":n),t.GetPM().AddMethod("InvokeMethod",function(e){if(e==="PostChanges"&&this.Get("ItemMode")!=="Applet"){var n=t.ExecuteMethod("GetFormattedFieldValue",t.ExecuteMethod("GetControl","ApplicationsCombo"));this.SetProperty("ApplicationName",n==="All Applications"?"":n),SiebelApp.S_App.uiStatus.Busy(),this.ExecuteMethod("InvokeMethod","ShowLayout",null,{async:!0,cb:function(){SiebelApp.S_App.uiStatus.Free()}})}},{sequence:!1,scope:this})}var r=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository View Web Template All Item List Applet"});r&&r.GetPM().AttachNotificationHandler(e.get("SWE_PROP_BC_NOTI_GENERIC"),u,{scope:this})}function u(t){if(t.GetProperty("type")==="ExpandedODH"){var n=t.GetProperty(e.get("SWE_PROP_ARGS_ARRAY")),r=[],i;n&&(CCFMiscUtil_StringToArray(n,r),i=CCFMiscUtil_CreatePropSet(),i.DecodeFromString(r[0]),this.SetProperty("ExpandedODH",i.GetProperty("ExpandedODH")))}}function a(e,t){var n=new $.Deferred,r=SiebelAppFacade.ComponentMgr.FindComponent({id:this.Get("ObjectWTIName")}),i=this,s;if(!t){var o=this.Get("odIdMap"),u=this.Get("ApplicationName"),l=[],p=[],v=h.call(i,e,r);if(u&&!v.Expression){var m={};m.Name=m.Expression="NOT "+u,m["Item Identifier"]=v["Item Identifier"],l.push(d),p.push([m]),l.push(f),p.push([m.Name,m]),c.call(this,l,p,n)}else s=a.call(i,e,!0)}else setTimeout(function(){if(h.call(i,e,r)){var t={};t.async=!0,t.cb=function(){n.resolve()};var s=r.Get("GetControls");for(var o in s)if(o.toLowerCase()==="inactive")break;r.ExecuteMethod("SetFormattedValue",s[o],"Y"),r.ExecuteMethod("InvokeMethod","WriteRecord",null,t)}},0);return s||n.promise()}function f(t,n,r,i){var s=new $.Deferred;return i=i==="undefined"?!0:i,r=r||SiebelAppFacade.ComponentMgr.FindComponent({id:this.Get("ObjectWTIName")}),_self=this,setTimeout(function(){if(!i||h.call(_self,n.Name||t,r)){var o={};o.async=!0,o.cb=function(t,n,r){r.GetProperty("Status")===e.get("SWE_RPC_PROP_STATUS_ERROR")?s.reject():s.resolve()};var u;for(var a in n)u=r.ExecuteMethod("GetControl",a),u&&r.ExecuteMethod("SetFormattedValue",u,n[a]);r.ExecuteMethod("InvokeMethod","WriteRecord",null,o)}},0),s.promise()}function l(e,t,n){var r=new $.Deferred,i=SiebelAppFacade.ComponentMgr.FindComponent({id:this.Get("ObjectWTIName")}),s=t["Item Identifier"],o=h.call(this,t.Name||e,i),e=t.Name||e,u=this;if(o){var l=i.ExecuteMethod("GetFieldValue",i.ExecuteMethod("GetControl","Item Identifier")),v=i.ExecuteMethod("GetFieldValue",i.ExecuteMethod("GetControl","Item Identifier - Language Override"));if(s&&s!=l&&this.Get("ItemMode")!=="Applet"){var m=this.Get("odIdMap"),g=this.Get("ApplicationName"),y=[],b=[];if(g){var w=m[l]||[],E=m[s]||[];for(var S=0,x=E.length;S<x;S++)if(E[S].Expression.toLowerCase()==="not "+(g||"").toLowerCase()){y.length==0&&n&&(y.push(p),b.push([n])),y.push(a),b.push([E[S].Name,!0]);break}y.length>0&&n&&(y.push(d),b.push([t]));if(o.Expression)v&&v!==s&&(t["Item Identifier - Language Override"]=s),y.push(f),b.push([e,t]);else if(o["Item Identifier"]!==""){var T={};T.Name=T.Expression="NOT "+g,T["Item Identifier"]=l,v&&v!==l&&(T["Item Identifier - Language Override"]=l),y.push(d),b.push([T]),y.push(f),b.push([T.Name,T]),t=JSON.parse(JSON.stringify(o)),t.Expression=g,t["Item Identifier"]=s,v&&v!==s&&(t["Item Identifier - Language Override"]=s),y.push(d),b.push([t]),y.push(f),b.push([e,t])}else t.Expression=g,v&&v!==s&&(t["Item Identifier - Language Override"]=s),y.push(f),b.push([e,t])}else v&&v!==s&&(t["Item Identifier - Language Override"]=s),y.push(f),b.push([e,t]);c.call(this,y,b,r)}else f.call(u,e,t).done(function(){r.resolve()}).fail(function(){r.reject()})}else r.resolve();return r.promise()}function c(e,t,n){var r=this,i=function(){e.length>0?e.shift().apply(r,t.shift(0)).done(i).fail(function(){n.reject()}):n&&n.resolve()};i.call(this)}function h(e,t){var n=t.ExecuteMethod("GetFormattedFieldValue",t.ExecuteMethod("GetControl","Name")),r=n!==e,i=t.Get("GetRecordSet"),s;if(r){var o=i.length;for(var u=0;u<o;u++)if(i[u].Name===e){s=i[u];break}}else s=i[t.Get("GetSelection")],s.Name=n;return t.ExecuteMethod("SetActiveControl",null),!r||t.ExecuteMethod("HandleRowSelect",u)?s:!1}function p(e,t){var n=new $.Deferred;return t=t||SiebelAppFacade.ComponentMgr.FindComponent
({id:this.Get("ObjectWTIName")}),t.ExecuteMethod("InvokeMethod","UndoRecord"),n.resolve(),n.promise()}function d(e,n){var r=new $.Deferred;n=n||SiebelAppFacade.ComponentMgr.FindComponent({id:this.Get("ObjectWTIName")});var i=n.Get("GetRecordSet"),s=t.GetUniqueName(i,e.Name,0);return e.Name=s,n.ExecuteMethod("SetActiveControl",null),n.ExecuteMethod("InvokeMethod","NewRecord"),n.ExecuteMethod("SetFormattedValue",n.ExecuteMethod("GetControl","Name"),s),r.resolve(),r.promise()}function v(t){var n=new $.Deferred,r=this,i=SiebelAppFacade.ComponentMgr.FindComponent({id:this.Get("ObjectWTIName")});return setTimeout(function(){var r={};r.async=!0,r.cb=function(t,r,i){i.GetProperty("Status")===e.get("SWE_RPC_PROP_STATUS_ERROR")?n.reject():n.resolve()},i.ExecuteMethod("InvokeMethod","SaveTabOrder",t,r)},0),n.promise()}function m(e,t){e==="ShowLayout"&&this.Get("IsInQueryMode")&&(t.CancelOperation=!0,t.ReturnValue=!1)}function g(e,t){e==="ShowLayout"?this.ExecuteMethod("UpdateUIState","ActiveSelection",{stateValue:this.Get("ActiveSelection")}):e==="GotoView"?(SiebelApp.S_App.uiStatus.Free(),SiebelApp.S_App.uiStatus.Busy({mask:!0,timeOut:!1})):e.indexOf("PositionOnRow")!==-1&&this.SetPrevSelection(this.Get("ActiveSelection"))}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.Utils"),n=e.get("SWE_EXTN_CANCEL_ORIG_OP"),r=e.get("SWE_EXTN_RETVAL");return SiebelJS.Extend(i,SiebelAppFacade.ListPresentationModel),i.prototype.Init=function(){var t=!1;SiebelAppFacade.LayoutPreviewPM.superclass.Init.apply(this,arguments),this.SetPrevSelection(this.Get("GetSelection")),this.AddProperty("ExpandedODH",""),this.AddProperty("ExpandedODH_Placeholder",""),this.AddProperty("EditMode",!0),this.AddProperty("OptimizeLayout",!1),this.AddMethod("UpdatePreview",function(){if(this.Get("IDEMode")&&this.Get("GetActiveWebTemplate")&&this.Get("ActiveSelection",{getDiff:!0})>=0){if(!this.Get("DrillDown")){SiebelApp.S_App.uiStatus.Busy({mask:!0});var e=this;setTimeout(function(){e.ExecuteMethod("InvokeMethod","ShowLayout"),SiebelApp.S_App.uiStatus.Free()},0)}this.SetProperty("DrillDown",!1)}}),this.AddProperty("PreviewOpened",!1),this.AttachNotificationHandler(e.get("SWE_PROP_BC_NOTI_GENERIC"),function(n){n.GetProperty("type")==="ExpandedODH"&&(u.call(this,n),t||(t=!0,o.call(this,SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Applications List Applet"}))));if(n.GetProperty("type")===e.get("SWE_INPUT_ROW_SELECTION")){var r=this;setTimeout(function(){if(r){var e=$("#PreviewArea");r.Get("GetName")==="WT Repository Web Page List Applet"&&e.length&&r.Get("GetActiveWebTemplate",{getDiff:!0})!==null?e.addClass("forcehide"):r.GetPrevSelection()!==null&&r.GetPrevSelection()!==r.Get("GetSelection")&&r.ExecuteMethod("UpdatePreview")}},0)}}),this.AddMethod("CanInvokeMethod",m,{sequence:!0,scope:this}),this.AddMethod("InvokeMethod",g,{sequence:!0,scope:this}),this.AddProperty("DndEnabled",function(){var e=SiebelAppFacade.ComponentMgr.FindComponent({id:this.Get("ObjectWTIName")});return e&&(e.ExecuteMethod("CanInvokeMethod","NewRecord")||e.ExecuteMethod("CanInvokeMethod","WriteRecord"))}),this.AddMethod("UpdateRecord",l),this.AddMethod("NewRecord",d),this.AddMethod("DeleteRecord",a),this.AddMethod("WriteRecord",f),this.AddMethod("PositionRecord",h),this.AddMethod("SaveTabOrder",v),this.AddProperty("ApplicationName",""),this.AddProperty("IsGridLayout",undefined),this.AddProperty("GetActiveWebTemplate",function(){return this.ExecuteMethod("GetFormattedFieldValue",this.ExecuteMethod("GetControl","Name"))+":"+this.ExecuteMethod("GetFormattedFieldValue",this.ExecuteMethod("GetControl","Web Template"))},{stateProp:!0}),this.AddProperty("ActiveSelection",function(){return this.Get("GetSelection")},{stateProp:!0});var n=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Applications List Applet"});n&&(t=!0,o.call(this,n)),this.AddMethod("HandlePreGetUIState",s,{sequence:!0,scope:this})},i.prototype.UpdateModel=function(t){SiebelAppFacade.LayoutPreviewPM.superclass.UpdateModel.apply(this,arguments);var n=e.get("SWE_CTRL_TEXTAREA"),r=SiebelAppFacade.PresentationModel.GetCtrlTemplate("PreviewArea","PreviewArea",n,8);r.SetType(e.get("SWE_PST_CNTRL")),this.ExecuteMethod("AddClientControl",r)},i}(),SiebelAppFacade.LayoutPreviewPM})),typeof SiebelAppFacade.ControlPalettePM=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ControlPalettePM"),define("siebel/controlpalettepm",["siebel/listpmodel"],function(){return SiebelAppFacade.ControlPalettePM=function(){function s(){SiebelAppFacade.ControlPalettePM.superclass.constructor.apply(this,arguments)}function o(e,t,n,s){var o=t[t.length-1],u=null;if(o&&o.getDiff)if(e==="GetCompRecordSet"){if(o.Component){var a=this.GetStateUIMap().CompRecordSet;if(a&&a[o.CompName]){var f=a[o.CompName],l=o.Component.Get("GetRecordSet"),c=JSON.stringify(l);f&&f.length===c.length&&f===c?u=null:u=l}else u=o.Component.Get("GetRecordSet");s[i]=u,s[r]=!0}}else if(e==="ShowUnmapped"){var h=this.Get("ShowUnmapped");!this.GetStateUIMap().hasOwnProperty("ShowUnmapped")||this.GetStateUIMap().ShowUnmapped===h?u=null:u=h,s[i]=u,s[r]=!0}return s[i]}function u(e,t,n){var i=this.GetStateUIMap();n[r]=!0,e==="CompRecordSet"?(i.CompRecordSet||(i.CompRecordSet={}),i.CompRecordSet[t.CompName]=t.stateValue):n[r]=!1}function a(e,t){f.call(this,e,t),this.SetProperty("SortInProgress",!0),this.SetProperty("SortInProgress",!1);var n=arguments[arguments.length-1];n.CancelOperation=!0,n.ReturnValue=!0}function f(t,n){switch(n){case e.get("SORT_ASCENDING"):this.Get("CachedData").sort(function(e,n){return e[t]>n[t]?1:-1});break;case e.get("SORT_DESCENDING"):this.Get("CachedData").sort(function(e,n){return e[t]<n[t]?1:-1});break;default:return}this.SetProperty("SortInfo",{control:t,direction:n})}function l(e){var t=this.Get("CachedData")[e].Index;return(this.Get("ShowUnmapped")?this.Get("UnMappedRecordSet"):this.Get("MasterRecordSet"))[t]}function c(e,t,n){var r=t.ExecuteMethod("GetFormattedFieldValue",t.ExecuteMethod("GetControl"
,"Name")),i=r!==e,s,o;if(i){var u=n.length;for(o=0;o<u;o++)if(n[o].Name===e){s=n[o];break}}else s=n[t.Get("GetSelection")],s.Name=r;return t.ExecuteMethod("SetActiveControl",null),!i||t.ExecuteMethod("HandleRowSelect",o)?s:!1}function h(e){var t=arguments[arguments.length-1],n;if(!this.Get("InitLayout"))n=[];else{if(e!==!0&&!this.Get("SortInProgress")){n=p.call(this),this.SetProperty("CachedData",n);var r=this.Get("SortInfo");r.control&&f.call(this,r.control,r.direction)}n=this.Get("CachedData")}return t.CancelOperation=!0,t.ReturnValue=n,n}function p(){var e=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Control List Applet All"}),n=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository List Column List Applet All"}),r=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Web Template All Item List Applet"}),i=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Web Template List Applet"}),s=this.Get("GetCompRecordSet",{getDiff:!0,Component:r,CompName:"AWTI"}),o=this.Get("GetCompRecordSet",{getDiff:!0,Component:e,CompName:"Controls"}),u=this.Get("GetCompRecordSet",{getDiff:!0,Component:n,CompName:"ListColumn"});if(s||o||u){s=r.Get("GetRecordSet"),o=e.Get("GetRecordSet")||[],u=n.Get("GetRecordSet")||[],this.ExecuteMethod("UpdateUIState","CompRecordSet",{stateValue:JSON.stringify(s),CompName:"AWTI"}),this.ExecuteMethod("UpdateUIState","CompRecordSet",{stateValue:JSON.stringify(o),CompName:"Controls"}),this.ExecuteMethod("UpdateUIState","CompRecordSet",{stateValue:JSON.stringify(u),CompName:"ListColumn"});var a=[],f=[],l=!1,c=[],h=Math.max(o.length,u.length),p,d,v,m=0,g=s.length,y=this.Get("ShowUnmapped"),b,w={},E=-1,S="",x=this.Get("CtrlLabelRequire"),T={};this.ExecuteMethod("UpdateUIState","ShowUnmapped",{stateValue:y});for(var N=0;N<h;N++){l=!1,p=o[N],p=p?p.Inactive.toLowerCase()==="y"?null:p:null,eachlistItem=u[N],eachlistItem=eachlistItem?eachlistItem.Inactive.toLowerCase()==="y"?null:eachlistItem:null,d=null,bFoundControl=0,bFoundList=!1,S="";if(p){var C=p.Type,k=p["HTML Type"],L=p["HTML Only"].toLowerCase()=="y"||k&&k!=="Field";L||["CheckBox","ComboBox","TextBox","Group","Label","PushButton","ChartControl","ImageControl"].indexOf(C)>-1?(p.ctrlType=L?k:C,x?(d=p["Field Type"]!=="Message"&&(L?k.indexOf("Button")===-1&&k!=="Hidden"&&k!=="Label":["CheckBox","ComboBox","TextBox"].indexOf(C)>-1),d?(d=JSON.parse(JSON.stringify(p)),d["HTML Type"]="CtrlLabel",d.Name=d.Name+"Label",d.ctrlType="CtrlLabel",d.ctrlName=p.Name):bFoundControl++):bFoundControl++):p=null}for(m=0,g=s.length;m<g;m++){b=s[m];if(E<m&&E<g){E=m;var A=(b["Item Identifier - Language Override"]||b["Item Identifier"]||"").replace(/\D/g,"");w[A]||(w[A]=[]),w[A].push(b)}if(p&&p["Extension Flag"]!=="Y"&&b.Control===p.Name&&b.Type==="Control"&&b.Inactive.toLowerCase()!=="y"){b["Grid Property"]===t?d.Mapped=!0:p.Mapped=!0;if(bFoundControl==1&&(bFoundList||!eachlistItem))break;bFoundControl++,d||bFoundControl++}if(eachlistItem&&b.Control===eachlistItem.Name&&b.Type==="List Item"&&b.Inactive.toLowerCase()!=="y"){eachlistItem.Mapped=!0;if(bFoundControl==2||!p)break;bFoundList=!0}}p&&p.ctrlType&&((!y||y&&!p.Mapped)&&f.push({Name:p.Name,Type:p.ctrlType,Mapped:p.Mapped?"Y":"N",Index:y?a.length:c.length}),p.RecordType=p.ctrlType,p.ItemType="Control",p.Mapped||a.push(p),c.push(p),d&&((!y||y&&!d.Mapped)&&f.push({Name:d.Name,Type:d["HTML Type"],Mapped:d.Mapped?"Y":"N",Index:y?a.length:c.length}),d.ItemType="Control",d.RecordType=d["HTML Type"],d.Mapped||a.push(d),c.push(d)),T[p.Name]=p),eachlistItem&&((!y||y&&!eachlistItem.Mapped)&&f.push({Name:eachlistItem.Name,Type:"Column",Mapped:eachlistItem.Mapped?"Y":"N",Index:y?a.length:c.length}),eachlistItem.ItemType="List Item",eachlistItem.RecordType="Column",eachlistItem.Mapped||a.push(eachlistItem),c.push(eachlistItem))}if(E<g-1)for(m=E;m<g;m++){b=s[m];var O=(b["Item Identifier - Language Override"]||b["Item Identifier"]||"").replace(/\D/g,"");w[O]||(w[O]=[]),w[O].push(b)}i.GetPM().SetProperty("odIdMap",w),this.SetProperty("MasterRecordSet",c),this.SetProperty("UnMappedRecordSet",a),this.SetProperty("ControlMap",T),this.SetProperty("ControlRecordSet",o),this.SetProperty("ListItemRecordSet",u)}else{var M=this.Get("ShowUnmapped",{getDiff:!0});if(M===null)f=this.Get("CachedData");else{f=[];var _=M?this.Get("UnMappedRecordSet"):this.Get("MasterRecordSet"),D;for(var P=0,H=_.length;P<H;P++)D=_[P],f.push({Name:D.Name,Type:D.RecordType,Mapped:D.Mapped?"Y":"N",Index:P});this.ExecuteMethod("UpdateUIState","ShowUnmapped",{stateValue:M})}}return f}var e=SiebelJS.Dependency("SiebelApp.Constants"),t="FormattedLabel",n=SiebelJS.Dependency("SiebelApp.Utils"),r=e.get("SWE_EXTN_CANCEL_ORIG_OP"),i=e.get("SWE_EXTN_RETVAL");return SiebelJS.Extend(s,SiebelAppFacade.ListPresentationModel),s.prototype.Init=function(){SiebelAppFacade.ControlPalettePM.superclass.Init.apply(this,arguments),this.AddMethod("GetRecordSet",h,{sequence:!0,scope:this}),this.AddMethod("OnClickSort",a,{sequence:!0,scope:this}),this.AddMethod("GetRecordDetails",l),this.AddMethod("PositionRecord",c),this.AddMethod("HandlePreGetUIState",o,{sequence:!0,scope:this}),this.AddMethod("UpdateUIState",u,{sequence:!0,scope:this}),this.AddProperty("InitLayout",!1),this.AddProperty("CtrlLabelRequire",!1),this.AddProperty("MasterRecordSet",[]),this.AddProperty("ShowUnmapped",!0,{stateProp:!0}),this.AddProperty("CachedData",[]),this.AddProperty("GetCompRecordSet",{},{stateProp:!0}),this.SetProperty("SortInProgress",!1),this.SetProperty("SortInfo",{control:"Name",direction:e.get("SORT_ASCENDING")});var t=this.Get("GetControls");for(var n in t)t[n].IsSortable=function(){return"1"}},s.prototype.UpdateModel=function(t){var r;t&&(r=t.GetChildByType(e.get("SWE_APPLET_PM_PS")),n.IsEmpty(r)&&(r=CCFMiscUtil_CreatePropSet(),r.SetType(e.get("SWE_APPLET_PM_PS")),t.AddChild(r)),r.SetProperty(e.get("SWE_PROP_CAN_MULTISELECT"),"true"),r.SetProperty(e.get("SWE_PROP_MULTISEL_COL_BEH"),e.get("SWE_MULTISELECT_DISABLE_ON_TOUCH")))
,SiebelAppFacade.ControlPalettePM.superclass.UpdateModel.apply(this,arguments)},s}(),SiebelAppFacade.ControlPalettePM})),typeof SiebelAppFacade.ControlPalettePR=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ControlPalettePR"),define("siebel/controlpalettepr",["siebel/phyrenderer","siebel/jqgridrenderer","siebel/odhpreviewpw"],function(){return SiebelAppFacade.ControlPalettePR=function(){function n(){SiebelAppFacade.ControlPalettePR.superclass.constructor.apply(this,arguments)}var e=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),t=e.GetLocalString("IDE_CONTROL_SHOW_UNMAPPED");return SiebelJS.Extend(n,SiebelAppFacade.JQGridRenderer),n.prototype.Init=function(){this.AttachPMBinding("ShowUnmapped",this.BindData),this.AttachPMBinding("InitLayout",this.BindData),this.AttachPMBinding("SortInProgress",function(e,t){t&&this.BindData(!0)}),SiebelAppFacade.ControlPalettePR.superclass.Init.call(this)},n.prototype.ShowUI=function(){var e=null,n=0,r=null;SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Web Template List Applet"}).GetPM().SetProperty("ObjectWTIName","WT Repository Applet Web Template All Item List Applet"),SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Web Template All Item List Applet"}).GetPM().AddMethod("RefreshData",function(){this.GetPM().ExecuteMethod("RefreshData",!0)},{sequence:!1,scope:this}),SiebelAppFacade.ControlPalettePR.superclass.ShowUI.apply(this,arguments),r=this.GetGrid(),e=r.jqGrid("getGridParam","colModel");for(n=0;n<e.length;n++)r.jqGrid("setColProp",e[n].name,{editable:!1});var i=utils.IsTrue(SiebelApp.S_App.IsAutoOn()),s='<div class=\'siebui-content\'><input type="checkbox" id="unmapped_cb"'+(this.GetPM().Get("ShowUnmapped")?' checked="true"':"")+(i?' rn="UnmappedCheck" ot="JCheckBox" ':"")+'/> <label for="unmapped_cb" >'+t+"</label></div>"+"<div class='siebui-content'><input type=\"text\" "+(i?' rn="ControlSearch" ot="JText" ':"")+"class=\"siebui-list-filter\" value/><span class='siebui-filter siebui-icon-search'></span><span class='siebui-filter-reset'></span></div>";$("#s_"+this.GetPM().Get("GetFullId")+"_div").addClass("siebui-awti-palette").find(".siebui-applet-buttons").after(s)},n.prototype.BindEvents=function(){SiebelAppFacade.ControlPalettePR.superclass.BindEvents.apply(this,arguments),$("#unmapped_cb").on("click",{ctx:this},function(e){e.data.ctx.GetPM().SetProperty("ShowUnmapped",$(this).prop("checked"))}),$(".siebui-filter-reset").click(function(){$(".siebui-list-filter").val("").keyup()}),$(".siebui-list-filter").keyup(function(){var e=$(this),t=e.val(),n=new RegExp(t,"i"),r;t!=""&&t.length>0?(e.addClass("siebui-filtered"),$(".siebui-filter-reset").css("display","inline-block")):(e.removeClass("siebui-filtered"),$(".siebui-filter-reset").styleHide());var i=e.closest(".siebui-applet");t!=""&&t.length>2?(r=i.find(".ui-jqgrid .ui-jqgrid-btable td"),i.find(".ui-jqgrid .ui-jqgrid-btable tr").styleHide(),r.each(function(){$(this).text().match(n)&&$(this).parent("tr").styleShow()})):i.find(".ui-jqgrid .ui-jqgrid-btable tr").styleShow(),i=e=r=null})},n.prototype.BindData=function(){if(this.GetPM().Get("InitLayout")){SiebelAppFacade.ControlPalettePR.superclass.BindData.apply(this,arguments);var e=this,t=$("#s_"+this.GetPM().Get("GetFullId")+"_div");$("#"+this.GetPM().Get("GetPlaceholder")).find("tr").addClass("odh-preview-placeholder").draggable({appendTo:"body",revert:"invalid",helper:function(){var e=$(this).find("td[id$='Mapped']").text()==="Y"?"siebui-odh-preview-mapped":"siebui-odh-preview-unmapped";return $('<div class="odh-awti-candidate '+e+' ">'+$(this).find("td[id$='Name']").text()+" </div>")},start:function(t,n){var r=$(n.helper),i=e.GetPM().ExecuteMethod("GetRecordDetails",Number($(this).attr("id"))-1),s={};s.odDispName=i.Caption||i["Display Name"],s.odHtmlType=i["HTML Type"],s.itemName=i.ctrlName||i.Name,r.data("srcitem",s),r.data("recordMap",{Name:i.Name,Type:i.ItemType,Control:s.itemName,Height:i["HTML Height"],Width:i["HTML Width"],"HTML Sequence":i["HTML Sequence"]})},drag:function(e,t){var n=t.helper.data("recordMap");t.helper.addClass("siebui-ctrl-palette-item-ondrag"),n.Height?t.helper.css("width",n.Height+"px !important"):"",n.Width?t.helper.css("width",n.Width+"px !important"):""},stop:function(e,t){t.helper.removeClass("siebui-ctrl-palette-item-ondrag")},cursor:"move"}),t=null}},n.prototype.OnRowSelect=function(e){var t=this.GetPM();this.ClearSelection(),this.GetGrid().setSelection(e,!1);var n=t.ExecuteMethod("GetRecordDetails",e-1),r=n.Name,i,s,o;if(n.ctrlType==="CtrlLabel"){var u=r.lastIndexOf("Label");r=r.substring(0,u)}switch(n.ItemType){case"Control":i=t.Get("ControlRecordSet"),s=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Control List Applet All"}),n=t.ExecuteMethod("PositionRecord",r,s,i),o="Control";break;case"List Item":i=t.Get("ListItemRecordSet"),s=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository List Column List Applet All"}),n=t.ExecuteMethod("PositionRecord",r,s,i),o="List Column";break;default:o="Default"}var a=SiebelApp.S_App.GetActiveView().GetName();return SiebelAppFacade.ComponentMgr.FindComponent({id:a}).ExecuteMethod("SetActiveState",o),!0},n}(),SiebelAppFacade.ControlPalettePR})),typeof SiebelAppFacade.AppletPalettePR=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.AppletPalettePR"),define("siebel/appletpalettepr",["siebel/phyrenderer","siebel/jqgridrenderer","siebel/odhpreviewpw"],function(){return SiebelAppFacade.AppletPalettePR=function(){function n(){SiebelAppFacade.AppletPalettePR.superclass.constructor.apply(this,arguments)}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=["Chart","Calendar","Form","Infolet","List","Map","Standard","Tile","Timeline","Tree"];return SiebelJS.Extend(n,SiebelAppFacade.JQGridRenderer),n.prototype.Init=function(){SiebelAppFacade.AppletPalettePR.superclass.Init.apply(this,arguments),this.GetPM().AddMethod("InvokeMethod",function(n,r,i,s){if(n==="Find"){var o=this.GetPM().Get("GetControls")[e.get("SWE_QUERY_COMBO_BOX"
)],u=this.GetPM().Get("GetControls")[e.get("SWE_QUERY_SEARCH_SPEC")],a="Type";if(u){var f=this.GetUIWrapper(u).GetEl().val();t.indexOf(f)===-1&&(a="Name")}o&&this.GetPM().ExecuteMethod("SetFormattedValue",o,a)}},{scope:this,sequence:!0})},n.prototype.ShowUI=function(){var t=this.GetPM().Get("GetControls")[e.get("SWE_QUERY_SEARCH_SPEC")];if(t){var n=this.GetPM().Get("GetControls")[e.get("SWE_QUERY_COMBO_BOX")];n&&(n=this.GetUIWrapper(n).GetEl(),n.addClass("forcehide"))}SiebelAppFacade.AppletPalettePR.superclass.ShowUI.apply(this,arguments);var r=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository View Web Template List Applet"}),i="";if(r){var s=r.GetPM();recordSet=s.Get("GetRecordSet"),selection=s.Get("GetSelection"),i="<div class='siebui-wt-name'><span>Web Template</span>"+recordSet[selection]["Web Template"]+"</div>"}$("#s_"+this.GetPM().Get("GetFullId")+"_div").addClass("siebui-applet-palette"),$(".siebui-ide-object-pane").prepend(i),this.GetGrid().hideCol("Type")},n.prototype.BindData=function(){SiebelAppFacade.AppletPalettePR.superclass.BindData.apply(this,arguments);var e=this;$("#"+this.GetPM().Get("GetPlaceholder")).find("tr").addClass("odh-preview-placeholder").draggable({appendTo:"body",revert:"invalid",helper:"clone",start:function(t,n){var r=$(n.helper),i=e.GetPM(),s=i.Get("GetRecordSet")[Number($(this).attr("id"))-1],o={},u={};s&&s.Name&&(o.odDispName=o.itemName=s.Name,u.Name=u.Applet=s.Name),r.data("srcitem",o),r.data("recordMap",u)}})},n}(),SiebelAppFacade.AppletPalettePR})),typeof SiebelAppFacade.ViewEditorPM=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ViewEditorPM"),define("siebel/vieweditorpm",["siebel/viewpm"],function(){return SiebelAppFacade.ViewEditorPM=function(){function t(){SiebelAppFacade.ViewEditorPM.superclass.constructor.apply(this,arguments);var e={};this.SetPropAppletMap=function(t,n){e[t]=n},this.GetPropAppletMap=function(){return e}}function n(t,n){var r=SiebelApp.S_App.GetService(e.get("SWE_OUI_CLIENT_PREF_SERVICE"));if(this.Get("UserPref:"+t)!=n){if(!utils.IsEmpty(r)){var i=SiebelApp.S_App.NewPropertySet();i.SetProperty("EditorPref/"+t,n),r.InvokeMethod("SetPreferences",i)}this.SetProperty("UserPref:"+t,n)}}function r(t){var n=SiebelApp.S_App.GetService(e.get("SWE_OUI_CLIENT_PREF_SERVICE"));if(!utils.IsEmpty(n)){var r=SiebelApp.S_App.NewPropertySet(),i,s,o=t.length;for(s=0;s<o;s++)r.SetProperty("EditorPref/"+t[s],"");var u=this,a={async:!0,scope:this,cb:function(e,n,r){var i=r.GetChildByType("ResultSet");if(i)for(s=0;s<o;s++)u.SetProperty("UserPref:"+t[s],i.GetProperty("EditorPref/"+t[s]))}};n.InvokeMethod("GetPreferences",r,a)}}function i(e,t){this.GetPropAppletMap()[e]!==this.Get("ActivePropContext")&&this.SetProperty("ActivePropContext",this.GetPropAppletMap()[e])}function s(){return SiebelAppFacade.ComponentMgr.FindComponent({id:this.Get("ActivePropContext")})}function o(){var e=this.Get("PaletteApplets"),t={},n,r,i,s,o,u;for(var a=0,f=e.length;a<f;a++){n=SiebelAppFacade.ComponentMgr.FindComponent({id:e[a]});if(n){var r=n.Get("GetRecordSet");u=r.length;for(o=0;o<u;o++)i=r[o].Name,appletName=n.Get(i+"_Applet"),appletName&&(s=SiebelAppFacade.ComponentMgr.FindComponent({id:appletName}),s&&(t[i]={Comp:s,NameField:n.Get(i+"_Name"),UIElement:n.Get(i+"_UIElement")}))}}this.SetProperty("ConfigComponentMap",t)}var e=SiebelJS.Dependency("SiebelApp.Constants");return SiebelJS.Extend(t,SiebelAppFacade.ViewPM),t.prototype.Init=function(){SiebelAppFacade.ViewEditorPM.superclass.Init.apply(this,arguments),this.AddProperty("DroppedItemDeferred",null),this.AddProperty("DroppedItemInfo",null),this.AddProperty("ConfigComponentMap",{}),this.AddProperty("itemName",""),this.AddProperty("ComponentMap",{}),this.AddProperty("ActivePropContext",""),this.AddProperty("ActivePropContextComp",s),this.AddProperty("PaletteApplets",["Visualization Pallette Applet","Visualization Chart Pallette Applet"]),this.AddProperty("UserPref:EditorPanesSize","",{stateProp:!0}),this.AddProperty("UserPref:ObjectPaneClose","false",{stateProp:!0}),this.AddProperty("UserPref:ConfigPaneClose","false",{stateProp:!0}),this.AddMethod("AttachHandlers",this.AttachHandlers,{scope:this}),this.AddMethod("HandleNewItemDrop",function(){},{scope:this}),this.AddMethod("HandleNewItemCreation",function(){},{scope:this}),this.AddMethod("SetActiveState",i),this.AddMethod("SetConfigMap",o,{scope:this}),this.AddMethod("SetEditorPrefrences",n),this.SetPropAppletMap("Default","WT Repository View Properties Applet"),this.SetPropAppletMap("View Web Template Item","WT Repository View Web Template Item Properties Applet"),this.SetPropAppletMap("Unmapped",""),r.call(this,["EditorPanesSize"])},t.prototype.AttachHandlers=function(){var t=this.Get("ComponentMap"),n=this;t.set||(t.AppletWebTemplate=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository View Web Template List Applet"}),this.ExecuteMethod("SetConfigMap"),t.set=!0),t.AppletWebTemplate&&(t.AppletWebTemplate.GetPM().SetProperty("ObjectWTIName","WT Repository View Web Template All Item List Applet"),t.AppletWebTemplate.ExecuteMethod("InvokeMethod","ShowLayout",null,{async:!0,cb:function(){SiebelApp.S_App.uiStatus.Free()}}),t.AppletWebTemplate.GetPM().AddMethod("OnItemDrop",function(e){var t=new $.Deferred,n=e.newItem;return n?n.Name?t.resolve():(this.SetProperty("DroppedItemDeferred",t),this.SetProperty("DroppedItemInfo",e)):t.resolve(),t.promise()},{scope:this}));var r=this.Get("ConfigComponentMap"),i;for(var s in r)i=r[s].Comp.GetPM(),i.AttachPostProxyExecuteBinding("CreateNewApplet",function(t){return function(r,i,s){if(s.GetProperty("Status")!==e.get("SWE_RPC_PROP_STATUS_ERROR")){var o=n.Get("itemName");srcItem=n.Get("DroppedItemInfo").srcItem||{},newItem=n.Get("DroppedItemInfo").newItem||{},srcItem.itemName=srcItem.odDispName=newItem.Name=newItem.Applet=o,srcItem.bSkipCommit=!0,n.ExecuteMethod("HandleNewItemCreation",t);var u=CCFMiscUtil_CreatePropSet();u.SetProperty("AppletName",o);var a={async:!0,cb:function(e,t,r){n.Get("DroppedItemDeferred"
)?n.Get("DroppedItemDeferred").resolve():null,n.SetProperty("DroppedItemDeferred",null),n.SetProperty("DroppedItemInfo",{}),n.SetProperty("itemName","")}};SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository View Web Template All Item List Applet"}).ExecuteMethod("InvokeMethod","ShowAppletLayout",u,a)}}}(),{scope:i}),i.AddMethod("InvokeMethod",function(e,t){return function(r,i,s,o){r==="Cancel"&&(n.ExecuteMethod("HandleNewItemCreation",e),n.Get("DroppedItemDeferred")?n.Get("DroppedItemDeferred").reject():null,n.SetProperty("DroppedItemDeferred",null),n.SetProperty("DroppedItemInfo",{})),r==="CreateNewApplet"&&(this.Get("GetControls")[t]?n.SetProperty("itemName",this.ExecuteMethod("GetFormattedFieldValue",this.Get("GetControls")[t])):n.SetProperty("itemName",""),this.Get("GetBusComp").SetFormattedValue("Item Identifier",n.Get("DroppedItemInfo").targetOdId))}}(s,r[s].NameField),{scope:i,sequence:!0}),i.AddMethod("CanInvokeMethod",function(e,t){e==="WriteRecord"&&(t.CancelOperation=!0,t.ReturnValue=!1)},{scope:this,sequence:!0})},t}(),SiebelAppFacade.ViewEditorPM})),typeof SiebelAppFacade.ViewEditorPR=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ViewEditorPR"),define("siebel/vieweditorpr",["siebel/viewpr"],function(){return SiebelAppFacade.ViewEditorPR=function(){function v(){SiebelAppFacade.ViewEditorPR.superclass.constructor.apply(this,arguments)}function m(){var e=this,t=$(".siebui-ide-property").children("div");t.length&&DOMUtils.Read(function(){DOMUtils.Write(function(){var n=e.GetPM();$(".siebui-ide-property").children("div").addClass("forcehide");var r=null;n.Get("ActivePropContext")!==""&&(r=$("#"+n.Get("ActivePropContextComp").Get("GetFullId")),r.removeClass("forcehide")),r=t=null})})}function g(e){function r(e){if(e)return e.UIElement?$(e.UIElement):$("#s_"+e.Comp.Get("GetFullId")+"_div").parent()}var t,n=this.GetPM().Get("ConfigComponentMap");return e?t=r.call(this,n[e]):t=$(".siebui-ide-config-app").children(),t}function y(){var e=utils.IsTrue(SiebelApp.S_App.IsAutoOn());$(".siebui-editor-entityname").after('<div class="siebui-wt-responsive-bar">                        <ul id="siebui-wt-list-responsive" class="siebui-wt-list-btn" >                            <li class="siebui-wt-responsive-desktop siebui-active" data-value="Large" title="'+u+'" '+(e?'rn="preview-desktop" ot="Link" ':"")+' ></li>                            <li class="siebui-wt-responsive-tablet" data-value="Medium" title="'+a+'" '+(e?'rn="preview-tablet" ot="Link" ':"")+'></li>                            <li class="siebui-wt-responsive-phone" data-value="Compact" title="'+f+'" '+(e?'rn="preview-phone" ot="Link" ':"")+"></li>                        </ul>                    </div>"),$("#siebui-wt-list-responsive").on("click","li",function(e){var t=$(this),n=$(e.target),r=n.data("value");r&&t.children("siebui-active")[0]!==e.target&&($("#PreviewArea").addClass(b.call(this,r)).removeClass(b.call(this,$(this).siblings(".siebui-active").data("value"))),t.siblings(".siebui-active").removeClass("siebui-active"),n.addClass("siebui-active"))})}function b(e){var t="siebui-default-preview";switch(e){case"Medium":t="siebui-tablet-preview";break;case"Compact":t="siebui-mobile-preview"}return t}function w(){function y(e,t){e.size.height=t.origHeight;var r=t.factor*(e.size.width-e.originalSize.width),i;e.size.width=t.origWidth+r;if(e.size.width<p)t.resizePane.hasClass("siebui-panel-open")&&(t.resizePane.data("isresize",!0),t.resizePane.find(".siebui-panel-button").click()),e.size.width=p,i=a-e.size.width-t.otherPaneWidth-v*2-2,i>d&&n.css("width",i+"px");else{t.resizePane.hasClass("siebui-panel-closed")&&(t.resizePane.data("isresize",!0),t.resizePane.find(".siebui-panel-button").click()),i=a-e.size.width-t.otherPaneWidth-v*2-2;if(i>d)n.css("width",i+"px");else{n.css("width",d+"px");var s=a-e.size.width-d-v*2-2;s>p?(t.otherPane.css("width",s+"px"),t.otherPaneWidth=s):(t.otherPane.hasClass("siebui-panel-open")&&(t.otherPane.data("isresize",!0),t.otherPane.find(".siebui-panel-button").click()),n.css("width",d+"px"),t.otherPane.css("width",p+"px"),t.otherPaneWidth=p,e.size.width=g)}}}function b(){s=t[0].getBoundingClientRect().width,o=n[0].getBoundingClientRect().width,u=r[0].getBoundingClientRect().width;var e=(s/a*100).toFixed(2),f=(u/a*100).toFixed(2),l="calc("+(100-e-f).toFixed(2)+"% - "+v*2+"px)";m.GetPM().ExecuteMethod("SetEditorPrefrences","EditorPanesSize",""+e+"%:"+l+":"+f+"%"),r.css("height",""),t.css("height",""),i=null,t=null,n=null,r=null,SiebelApp.EventManager.fireEvent("forceResize")}var e='<div class="siebui-resize-handle"></div>',t,n,r,i,s,o,u,a,f,l,c,h=function(e,f){i=$(".siebui-ide"),t=i.find(".siebui-ide-object-pane"),n=i.find(".siebui-ide-canvas"),r=i.find(".siebui-ide-config-pane"),s=t[0].getBoundingClientRect().width,o=n[0].getBoundingClientRect().width,u=r[0].getBoundingClientRect().width,a=i[0].getBoundingClientRect().width,l=t[0].getBoundingClientRect().height,c=r[0].getBoundingClientRect().height,g=a-p-d-v*2},v,m=this,g;h.call(this),t.after($(e).addClass("siebui-resize-handle-e")),n.after($(e).addClass("siebui-resize-handle-w")),v=$(".siebui-resize-handle")[0].getBoundingClientRect().width,t.resizable({handles:{e:$(".siebui-resize-handle-e")},start:h,resize:function(e,n){var i={origHeight:l,factor:1,origWidth:s,resizePane:t,otherPane:r,otherPaneWidth:u};y.call(this,n,i),u=i.otherPaneWidth},minWidth:-1e5,stop:b}),r.resizable({handles:{w:$(".siebui-resize-handle-w")},start:h,resize:function(e,n){var i={origHeight:c,factor:-1,origWidth:u,resizePane:r,otherPane:t,otherPaneWidth:s};y.call(this,n,i),s=i.otherPaneWidth},minWidth:-1e5,stop:b}),i=null,t=null,n=null,r=null}function E(){var e=this.GetPM().Get("UserPref:EditorPanesSize",{getDiff:!0});if(e){var t=$(".siebui-ide");e=e.split(":"),t.find(".siebui-ide-object-pane").css("width",e[0]),t.find(".siebui-ide-canvas").css("width",e[1]),t.find(".siebui-ide-config-pane").css("width",e[2]),t=null}}function S(){if(this.GetPM().Get("PaneEventsBound")){var e
,t,n,r=this.GetPM().Get("UserPref:ObjectPaneClose",{getDiff:!0});r!==null&&r!==""&&(e=r==="false",n=$(".siebui-ide-object-pane"),t=n.hasClass("siebui-panel-open"),(t&&!e||!t&&e)&&n.find(".siebui-panel-button").click());var i=this.GetPM().Get("UserPref:ConfigPaneClose",{getDiff:!0});i!==null&&i!==""&&(e=i==="false",n=$(".siebui-ide-config-pane"),t=n.hasClass("siebui-panel-open"),(t&&!e||!t&&e)&&n.find(".siebui-panel-button").click()),n=null}}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=t.GetLocalString("IDE_WEB_CONTROL"),r=t.GetLocalString("IDE_TAB_CONFIG"),i=t.GetLocalString("IDE_TAB_LIBRARY"),s=t.GetLocalString("IDS_NEW_STRING"),o=t.GetLocalString("IDE_TAB_PROPERTIES"),u=t.GetLocalString("IDE_RES_DESKTOP"),a=t.GetLocalString("IDE_RES_TABLET"),f=t.GetLocalString("IDE_RES_PHONE"),l=t.GetLocalString("CLOSE"),c=e.get("SWE_PROP_AUTOM_RN"),h=e.get("SWE_PROP_AUTOM_OT"),p=5,d=200;return SiebelJS.Extend(v,SiebelAppFacade.ViewPR),v.prototype.Init=function(){SiebelAppFacade.ViewEditorPR.superclass.Init.apply(this,arguments),this.AttachPMBinding("ActivePropContext",m,{scope:this}),this.AttachPMBinding("DroppedItemInfo",this.OnItemDrop),this.AttachPMBinding("HandleNewItemCreation",function(e,t){var n=g.call(this,e);if(n&&n.length){var r=$("[pid='"+n.closest(".siebui-ide-config-app").attr("data-pos")+"']",$("#PreviewArea"));r.find(".siebui-odh-inline-config").remove(),n.removeAttr("data-pos"),n.addClass("forcehide"),setTimeout(function(){$(".siebui-ide").removeClass("siebui-config-mode")})}if(!this.GetPM().Get("UserPref:EditorPanesSize")){var i=$(".siebui-ide-canvas");$(".siebui-ide-config-pane").css("width",""),i.css("width",i.data("initWidth")+"px"),i-null}$(".siebui-ide-property").trigger("ActivateTab")}),this.AttachPMBinding("AttachHandlers",this.DecorateArtifacts),this.AttachPMBinding("UserPref:EditorPanesSize",E),this.AttachPMBinding("UserPref:ObjectPaneClose",S),this.AttachPMBinding("UserPref:ConfigPaneClose",S)},v.prototype.OnItemDrop=function(){var e,t=this.GetPM(),n=t.Get("DroppedItemInfo");if(n.srcItem){e=g.call(this,n.srcItem.appletType);if(e&&e.length){$(".siebui-ide").addClass("siebui-config-mode"),e.closest(".siebui-ide-config-app").attr("data-pos",n.targetId);var r=e.removeClass("forcehide"),i="siebui-icon-"+n.srcItem.appletType.toLowerCase().replace(" ","_"),s="<span class='siebui-odh-inline-config "+i+"' ></span>";$("[pid='"+n.targetId+"']").append($(s));if(!this.GetPM().Get("UserPref:EditorPanesSize")){var o=$(".siebui-ide-canvas"),u=$(".siebui-ide-config-pane"),a=u.width();u.css("width",a*2);var f=o.width();o.css("width",f-a-2+"px").data("initWidth",f),o=null,u=null}r.closest(".siebui-panel-content").trigger("ActivateTab")}}},v.prototype.ManagePanel=function(){var e={direction:"right",parentEle:$(".siebui-ide-config-pane"),contents:[{ele:$(".siebui-ide-property").children("div").length>0?$(".siebui-ide-property"):null,title:o,showOnClose:!1,addClass:""}]};SiebelAppFacade.ContainerPanelManager.Init(e);var t={direction:"left",tabify:!0,parentEle:$(".siebui-ide-object-pane"),contents:[{ele:$(".siebui-editor-applet-list"),title:i,showOnClose:!1,addClass:""}]};SiebelAppFacade.ContainerPanelManager.Init(t)},v.prototype.MakeAccordian=function(e,t){$(e).after("<span class='siebui-trigger siebui-icon-arrowsm-up' ></span>"),t.addClass("siebui-content-collapse"),$(e).nextAll(".siebui-trigger").on("click",{target:t},function(e){var t=e.data.target;$(this).toggleClass("siebui-icon-arrowsm-up siebui-icon-arrowsm-down"),$(t).toggleClass("siebui-content-expand siebui-content-collapse")})},v.prototype.ShowUI=function(){$(".siebui-ide").find(".siebui-span-xl-2,.siebui-span-xl-8").removeClass("siebui-span-xl-2 siebui-span-lg-2 siebui-span-md-2 siebui-span-xl-8 siebui-span-lg-8 siebui-span-md-8"),SiebelAppFacade.ViewEditorPR.superclass.ShowUI.apply(this,arguments);var e=utils.IsTrue(SiebelApp.S_App.IsAutoOn()),t=this.GetPM();t.ExecuteMethod("UpdateUIState","UserPref:ObjectPaneClose",{stateValue:"false"}),t.ExecuteMethod("UpdateUIState","UserPref:ConfigPaneClose",{stateValue:"false"}),$("html").addClass("siebui-preview"),t.ExecuteMethod("AttachHandlers"),y.call(this),$(".siebui-application-list").before("<div class='siebui-restore-context' title=\""+l+'" '+(e?' rn="Exit Editor" ot="Link" ':"")+"></div>"),t.SetProperty("EnableRestoreContext",!0),this.ManagePanel(),$(".siebui-ide").hasClass("siebui-applet-wizard")===!1&&$("#sidebarCloseButton").click(),E.call(this),w.call(this),SiebelAppFacade.ComponentMgr.FindComponent({id:SiebelApp.S_App.GetActiveView().GetName()}).ExecuteMethod("SetActiveState","Default"),e&&$("#PreviewArea").attr(c,"PreviewArea").attr(h,"SiebApplet")},v.prototype.BindEvents=function(){SiebelAppFacade.ViewEditorPR.superclass.BindEvents.apply(this,arguments);var e=!0,t=!0,n=this.GetPM();$(".siebui-ide-object-pane,.siebui-ide-config-pane").on("OnPanelChange",function(r){var i=$(this),s=i.hasClass("siebui-ide-object-pane"),o=$(".siebui-ide-canvas"),u=$(".siebui-ide-object-pane"),a=$(".siebui-ide-config-pane"),f=i.hasClass("siebui-panel-open"),l=i.data("isresize");if(!l){var c=$(".siebui-ide")[0].getBoundingClientRect().width;i.css("width","");var h=n.Get("UserPref:EditorPanesSize").split(":"),p=s?"":h[0]?h[0]:"",v=s?h[2]?h[2]:"":"",m="",g=c-a[0].getBoundingClientRect().width-u[0].getBoundingClientRect().width-2*$(".siebui-resize-handle")[0].getBoundingClientRect().width;if(g<d)m=d/c*100+"%",s?(v=(c-d-u[0].getBoundingClientRect().width-2*$(".siebui-resize-handle")[0].getBoundingClientRect().width)/c*100+"%",a.css("width",v)):(p=(c-d-a[0].getBoundingClientRect().width-2*$(".siebui-resize-handle")[0].getBoundingClientRect().width)/c*100+"%",u.css("width",p));else if(!(f&&(s?t:t))||p||v)m=g/c*100+"%";o.css("width",m);var y=p+":"+m+":"+v;!p&&!v&&(y=""),n.ExecuteMethod("UpdateUIState","UserPref:EditorPanesSize",{stateValue:y}),n.ExecuteMethod("SetEditorPrefrences","EditorPanesSize",y),f}n.ExecuteMethod("UpdateUIState","UserPref:"+(s?"ObjectPaneClose"
:"ConfigPaneClose"),{stateValue:""+!f}),s?e=f:t=f,i.data("isresize",!1),o=u=a=null}).on("OnContainerActivation",function(e,t){(t.hasClass("siebui-editor-applet-list")||t.hasClass("siebui-awti-palette"))&&SiebelApp.EventManager.fireEvent("forceResize")}),n.SetProperty("PaneEventsBound",!0),S.call(this)},v.prototype.DecorateArtifacts=function(){SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Applications List Applet"})&&$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Applications List Applet"}).Get("GetFullId")).addClass("siebui-application-list");var e=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository View Web Template List Applet"});if(e){$("#"+e.Get("GetFullId")).addClass("siebui-wt-list");var t=e.GetPR();if(t.GetGrid()){var n=t.GetGrid().getGridParam("colModel");for(var r=1,i=n.length;r<i;r++)n[r].name!=="Web_Template"&&t.GetGrid().hideCol(n[r].name);t.GetGrid().setGridWidth(parseInt($("#gbox_"+e.GetPM().Get("GetPlaceholder")).parent().width(),10),!0)}$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository View Web Template All Item List Applet"}).Get("GetFullId")).addClass("forcehide siebui-wt-item-list"),$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository View Form Applet"}).Get("GetFullId")).addClass("siebui-editor-entityname")}SiebelAppFacade.ComponentMgr.FindComponent({id:"Visualization Applet List Applet"})&&$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"Visualization Applet List Applet"}).Get("GetFullId")).addClass("siebui-editor-applet-list"),SiebelAppFacade.ComponentMgr.FindComponent({id:"Visualization Pallette Applet"})&&($("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"Visualization Pallette Applet"}).Get("GetFullId")).addClass("siebui-editor-vis-palette forcehide"),$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"Visualization Chart Pallette Applet"}).Get("GetFullId")).addClass("siebui-editor-chart-palette forcehide"));var s=g.call(this);s&&s.length&&s.addClass("forcehide siebui-questionnaire")},v.prototype.EndLife=function(){$("#sidebarOpenButton").click(),$("html").removeClass("siebui-preview"),SiebelAppFacade.ViewEditorPR.superclass.EndLife.apply(this,arguments)},v}(),SiebelAppFacade.ViewEditorPR})),typeof SiebelAppFacade.VisualizationPalettePR=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.VisualizationPalettePR"),define("siebel/visualizationpalettepr",["siebel/phyrenderer","siebel/jqgridrenderer","siebel/odheditorpw","siebel/odhpreviewpw"],function(){return SiebelAppFacade.VisualizationPalettePR=function(){function e(){SiebelAppFacade.VisualizationPalettePR.superclass.constructor.apply(this,arguments)}return SiebelJS.Extend(e,SiebelAppFacade.JQGridRenderer),e.prototype.Init=function(){SiebelAppFacade.VisualizationPalettePR.superclass.Init.call(this)},e.prototype.ShowUI=function(){SiebelAppFacade.VisualizationPalettePR.superclass.ShowUI.apply(this,arguments),$("#s_"+this.GetPM().Get("GetFullId")+"_div").addClass("siebui-awti-palette");if(this.GetGrid()){var e=this.GetGrid().getGridParam("colModel");for(var t=1,n=e.length;t<n;t++)e[t].name!=="Icon"&&this.GetGrid().hideCol(e[t].name);this.GetGrid().setGridWidth(parseInt($("#gbox_"+this.GetPM().Get("GetPlaceholder")).parent().width(),10),!0)}},e.prototype.BindEvents=function(){SiebelAppFacade.VisualizationPalettePR.superclass.BindEvents.apply(this,arguments)},e.prototype.BindData=function(){SiebelAppFacade.VisualizationPalettePR.superclass.BindData.apply(this,arguments)},e}(),SiebelAppFacade.VisualizationPalettePR})),typeof SiebelAppFacade.AppletEditorPM=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.AppletEditorPM"),define("siebel/appleteditorpm",["siebel/vieweditorpm"],function(){return SiebelAppFacade.AppletEditorPM=function(){function n(){SiebelAppFacade.AppletEditorPM.superclass.constructor.apply(this,arguments)}function r(){return SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository List List Applet"}).Get("GetSelection")>-1}function i(e,t){var n=new $.Deferred,r=e.webControlType,i="HTML "+r,s=e.newListColumn?SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository List Column List Applet All"}):SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Control List Applet All"}),o=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Web Template List Applet"}),u={};return u.Name=i,u["HTML Type"]=r,u["HTML Only"]="Y",o.ExecuteMethod("NewRecord",u,s),o.ExecuteMethod("WriteRecord",i,u,s).done(function(){i=u.Name,e.odDispName=i,e.odHtmlType=r,e.itemName=i,t.Name=i,t.Type=e.newListColumn?"List Item":"Control",t.Control=i,n.resolve()}),n.promise()}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.Utils");return SiebelJS.Extend(n,SiebelAppFacade.ViewEditorPM),n.prototype.Init=function(){SiebelAppFacade.AppletEditorPM.superclass.Init.apply(this,arguments),this.AddMethod("CreateNewControl",i),this.AddProperty("AppletEditor",!0),this.SetPropAppletMap("Default","WT Repository Applet Properties Applet"),this.SetPropAppletMap("Control","WT Repository Control Properties Applet"),this.SetPropAppletMap("List Column","WT Repository List Column Properties Applet")},n.prototype.AttachHandlers=function(){var e=this.Get("ComponentMap"),t=this;e.set||(e.AppletWebTemplateItem=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Web Template List Applet"}),e.ControlPalette=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Edit Web Layout Palette"}),e.PropWindControl=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Control Properties Applet"}),e.PropWindListCol=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository List Column Properties Applet"}),e.set=!0),e.AppletWebTemplateItem&&(e.AppletWebTemplateItem.GetPM().AddMethod("OnItemDrop",function(e){var t=new $.Deferred,n=e.newItem;return n?n.Name?t.resolve():(this.SetProperty("DroppedItemDeferred",t),this.SetProperty("DroppedItemInfo",e)):t.resolve(),t.promise()},{scope:this}),e.ControlPalette&&e.AppletWebTemplateItem
.GetPR().AttachPMBinding("IsGridLayout",function(){e.ControlPalette.GetPM().SetProperty("CtrlLabelRequire",arguments[1]),e.ControlPalette.GetPM().SetProperty("InitLayout",!0)})),e.PropWindControl&&e.PropWindControl.GetPM().AttachPostProxyExecuteBinding("WriteRecord",function(){var t=this,n=t.Get("GetControls"),r=t.ExecuteMethod("GetFormattedFieldValue",n.Name);e.AppletWebTemplateItem.GetPR().GetUIWrapper(e.AppletWebTemplateItem.Get("GetControls").PreviewArea).OnCanvasItemChange({control:r,odDispName:t.ExecuteMethod("GetFormattedFieldValue",n.Caption)||r,odHtmlType:t.ExecuteMethod("GetFormattedFieldValue",n["HTML Type"]),"HTML Width":t.ExecuteMethod("GetFormattedFieldValue",n["HTML Width"])+"px","HTML Height":t.ExecuteMethod("GetFormattedFieldValue",n["HTML Height"])+"px"})}),e.PropWindListCol&&e.PropWindListCol.GetPM().AttachPostProxyExecuteBinding("WriteRecord",function(){var t=this,n=t.Get("GetControls"),r=t.ExecuteMethod("GetFormattedFieldValue",n.Name);e.AppletWebTemplateItem.GetPR().GetUIWrapper(e.AppletWebTemplateItem.Get("GetControls").PreviewArea).OnCanvasItemChange({control:r,odDispName:t.ExecuteMethod("GetFormattedFieldValue",n["Display Name"])||r,odHtmlType:t.ExecuteMethod("GetFormattedFieldValue",n["HTML Type"])})})},n}(),SiebelAppFacade.AppletEditorPM})),typeof SiebelAppFacade.AppletEditorPR=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.AppletEditorPR"),define("siebel/appleteditorpr",["siebel/appleteditorpr"],function(){return SiebelAppFacade.AppletEditorPR=function(){function i(){SiebelAppFacade.AppletEditorPR.superclass.constructor.apply(this,arguments)}function s(){var e=o.call(this);e&&this.GetPM().SetProperty("DroppedItemInfo",{srcItem:{appletType:e},targetId:"applet_placeholder"})}function o(){var e=this.GetPM().Get("PaletteApplets"),t=null,n,r,i;for(var s=0,o=e.length;s<o;s++){n=SiebelAppFacade.ComponentMgr.FindComponent({id:e[s]}),r=n.Get("GetRecordSet"),i=r.length;if(i===1){t=r[0].Name;break}}return t}function u(){var e={};e.async=!0,e.cb=function(){SiebelApp.S_App.uiStatus.Free()},SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Web Template List Applet"}).ExecuteMethod("InvokeMethod","ShowLayout",null,e);var t=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository List List Applet"});t&&t.Get("GetRecordSet").length===0&&$("#webControlPalette").addClass("siebui-disable-lc-creation");var n={appendTo:"body",cancel:".siebui-disable-lc-creation .siebui-list-enabled",revert:"invalid",helper:function(){return $('<div class="odh-awti-candidate siebui-odh-preview-unmapped ">'+$(this).attr("data-val")+" </div>")},start:function(e,t){var n=$(this),r={};r.webControlType=n.attr("data-val"),r.newListColumn=n.children().hasClass("siebui-listitem"),t.helper.data("srcitem",r),t.helper.data("recordMap",r)},drag:function(e,t){t.helper.addClass("siebui-ctrl-palette-item-ondrag")},stop:function(e,t){t.helper.removeClass("siebui-ctrl-palette-item-ondrag")},cursor:"move"};$(".siebui-ctrl-palette-item").addClass("odh-preview-placeholder").draggable(n)}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=t.GetLocalString("IDE_WEB_CONTROL"),r=t.GetLocalString("IDE_TAB_PROPERTIES");return SiebelJS.Extend(i,SiebelAppFacade.ViewEditorPR),i.prototype.Init=function(){SiebelAppFacade.AppletEditorPR.superclass.Init.apply(this,arguments)},i.prototype.OnItemDrop=function(){var e=this.GetPM();if(!e.Get("AppletEditor"))SiebelAppFacade.AppletEditorPR.superclass.OnItemDrop.apply(this,arguments);else{var t=e.Get("DroppedItemInfo");t.srcItem&&t.srcItem.webControlType&&e.ExecuteMethod("CreateNewControl",t.srcItem,t.newItem).done(function(){e.Get("DroppedItemDeferred")?e.Get("DroppedItemDeferred").resolve():null,e.SetProperty("DroppedItemDeferred",null),e.SetProperty("DroppedItemInfo",{})})}},i.prototype.DecorateArtifacts=function(){if(this.GetPM().Get("AppletEditor")){$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Applications List Applet"}).Get("GetFullId")).addClass("siebui-application-list"),$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Web Template List Applet"}).Get("GetFullId")).addClass("siebui-wt-list"),$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Web Template All Item List Applet"}).Get("GetFullId")).addClass("forcehide siebui-wt-item-list"),$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Control List Applet All"}).Get("GetFullId")).addClass("forcehide"),$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository List Column List Applet All"}).Get("GetFullId")).addClass("forcehide"),$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository List List Applet"}).Get("GetFullId")).addClass("forcehide"),$("#"+SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Form Applet"}).Get("GetFullId")).addClass("siebui-editor-entityname");var e=SiebelAppFacade.ComponentMgr.FindComponent({id:"WT Repository Applet Web Template List Applet"});if(e){var t=e.GetPR();if(t.GetGrid()){var n=t.GetGrid().getGridParam("colModel");for(var r=1,i=n.length;r<i;r++)n[r].name!=="Name"&&t.GetGrid().hideCol(n[r].name);t.GetGrid().setGridWidth(parseInt($("#gbox_"+e.GetPM().Get("GetPlaceholder")).parent().width(),10),!0)}}}else SiebelAppFacade.AppletEditorPR.superclass.DecorateArtifacts.apply(this,arguments)},i.prototype.ManagePanel=function(){if(this.GetPM().Get("AppletEditor")){var e=utils.IsTrue(SiebelApp.S_App.IsAutoOn()),t=e?' rn="WebControlPalette" ot="SiebApplet" ':"";$(".siebui-ide-object-pane .siebui-wt-item-list").after('<div><div id="webControlPalette" class="siebui-webcontrols-palette" title="'+n+'" '+t+"></div></div>");var i=$("#webControlPalette");i.append(SiebelAppFacade.WTTemplateFactory.GetTemplate("Web Control"));var s={direction:"right",parentEle:$(".siebui-ide-config-pane"),contents:[{ele:$(".siebui-ide-property"),title:r,showOnClose:!1,addClass:""}]};SiebelAppFacade.ContainerPanelManager.Init(s);var o=$(".siebui-awti-palette"
),u={direction:"left",tabify:!0,parentEle:$(".siebui-ide-object-pane"),contents:[{ele:$("#webControlPalette").parent(),title:n,showOnClose:!1,addClass:""},{ele:o,title:o.find(".siebui-applet-title").text(),showOnClose:!1,addClass:""}]};SiebelAppFacade.ContainerPanelManager.Init(u);var a=$(".siebui-ide-object-pane").find(".siebui-panel-tab-cont").detach();$(".siebui-ide-object-pane").find(".siebui-wt-item-list").after(a)}else SiebelAppFacade.AppletEditorPR.superclass.ManagePanel.apply(this,arguments)},i.prototype.ShowUI=function(){var e=this.GetPM();if(!e.Get("AppletEditor")){var t=$('<div id="PreviewArea" type="JTextArea" name="PreviewArea" class="siebui-default-preview applet_editor"><div id="od-html-preview" class="odh-html-preview sibeui-new-applet-canvas"><div pid="applet_placeholder" class="siebui-odh-preview-applet"></div></div></div>');$(".siebui-ide-canvas").append(t),$(".siebui-ide").addClass("siebui-applet-wizard")}else $("html").addClass("siebui-applet-editor");SiebelAppFacade.AppletEditorPR.superclass.ShowUI.apply(this,arguments),e.Get("AppletEditor")||s.call(this)},i.prototype.BindEvents=function(){SiebelAppFacade.AppletEditorPR.superclass.BindEvents.apply(this,arguments);var e=this,t=this.GetPM();t.Get("AppletEditor")?SiebelApp.EventManager.addListner("refreshview",u,this):$("#PreviewArea").droppable({drop:function(t,n){e.GetPM().SetProperty("DroppedItemInfo",{srcItem:n.helper.data("srcitem"),targetId:"applet_placeholder"})}})},i.prototype.EndLife=function(){SiebelAppFacade.AppletEditorPR.superclass.EndLife.apply(this,arguments),$("html").removeClass("siebui-applet-editor"),SiebelApp.EventManager.removeListner("refreshview",u,this)},i}(),SiebelAppFacade.AppletEditorPR})),typeof SiebelAppFacade.ContainerPanelManager=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.ContainerPanelManager"),define("siebel/containerpanelmgrho",function(){return SiebelAppFacade.ContainerPanelManager=function(){function o(){var e=0;this.GetLatestId=function(t){return t&&e++,e}}function u(e){var t=e.closest(".siebui-panel-parent"),n=t.data("ActiveTabIdentifier");tabIdentifier=e.data("identifier"),t.find("[panel-identifier='panel-"+n+"' ]").addClass("forcehide"),t.find("[tab-identifier='tab-"+n+"' ],"+"[tab-identifier='tab-"+tabIdentifier+"' ]").toggleClass("siebui-tab-active"),t.find("[tab-identifier='tab-"+tabIdentifier+"' ]").addClass("siebui-tab-active"),t.data("ActiveTabIdentifier",tabIdentifier),t.find("[panel-identifier='panel-"+tabIdentifier+"' ]").removeClass("forcehide").trigger("OnContainerActivation",[t.find("[panel-identifier='panel-"+tabIdentifier+"' ]")]),t=null}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=t.GetLocalString("CLOSE"),r=t.GetLocalString("OPEN"),i=e.get("SWE_PROP_AUTOM_OT"),s=e.get("SWE_PROP_AUTOM_RN");return o.prototype.Init=function(t){if(t){t=$.extend({retainContainerClass:"",retainContId:[],direction:"right",id:this.GetLatestId(!0),tabify:!0},t);var r=t.selector,o;if(r)o=$(r),t.contents=[],o.each(function(){t.contents.push({ele:$(this),title:"",showOnClose:$(this).hasClass(retainContainerClass),addClass:""})}),o=t.contents;else{if(!t.contents)return;o=t.contents,t.selector=".siebui-panel-content"}var a=$("<div class=siebui-panel-tab-cont><ul class='siebui-panel-tab'></ul></div>"),f=0,l=t.direction,c=t.parentEle;t.tabClass&&a.addClass(t.tabClass),c?c.attr("data-parentid","widget_parent_"+t.id).addClass("siebui-panel-parent siebui-panel-open siebui-panel-parent-"+l).prepend($('<button title="'+n+'" class="siebui-panel-button siebui-panel-button-close siebui-panel-button-'+l+' forcehide"></button>')):o[0].ele.parent().eq(0).append($('<div data-parentid="widget_parent_'+t.id+'" class="siebui-panel-parent siebui-panel-open siebui-panel-parent-'+l+'"><button class="siebui-panel-button siebui-panel-button-close siebui-panel-button-'+l+'"></button>'));var h=c.find(".siebui-panel-button");o.forEach(function(n){var r=n.ele;if(r&&r.length){var o=r.attr("id"),u;r.addClass("siebui-panel-content"),c.append(r.detach()),r.data("identifier",t.id+"_"+f),r.attr("panel-identifier","panel-"+t.id+"_"+f),n.beforeTab&&(h=r),n.showOnClose?r.addClass("showOnClose"):(t.tabify&&r.addClass("forcehide"),u=r.find(".siebui-panel-icon").length?r.find(".siebui-panel-icon").detach():$("<li class='siebui-panel-icon'><a></a></li>"),n.addClass&&r.addClass(n.addClass),n.title?(u.find("a").text(n.title).attr("title",n.title),utils.IsTrue(SiebelApp.S_App.IsAutoOn())&&u.attr(s,"Tab-"+n.title).attr(i,e.get("SWE_CTRL_LINK"))):u.find("a").text("Open"),u.data("identifier",t.id+"_"+f),u.attr("tab-identifier","tab-"+t.id+"_"+f),a.find("ul").append(u)),f++}}),t.tabify||a.addClass("forcehide"),h.after(a),u.call(this,a.find("li").eq(0)),this.BindEvents(t,c),o=null,c=null}},o.prototype.GetName=function(){return"ContainerPanelManager"},o.prototype.ActivateTab=function(e,t){var n=e,r=n.closest(".siebui-panel-parent"),i=n.data("identifier"),s=r.data("ActiveTabIdentifier"),o=r.find("[panel-identifier='panel-"+i+"' ]");if(!r.hasClass("siebui-panel-open")){switch(t.direction){case"right":atDir="left bottom",ofDir="right top";break;case"left":atDir="right top",ofDir="left bottom"}i!==s&&(r.find("[tab-identifier='tab-"+s+"' ],"+"[tab-identifier='tab-"+i+"' ]").toggleClass("siebui-tab-active"),r.data("ActiveTabIdentifier",i),r.trigger("OnTabChange",i));var a=o.prev(),o=o.detach();r.after(o),o=r.next(),o.removeClass("forcehide"),o.css({"max-width":"20%"});var f=r.find("[tab-identifier='tab-"+i+"' ]"),l=f.offset(),c,h;t.direction==="left"?(c=l.top+f.height(),h=l.left+f.width()):(c=l.top+f.height(),h=l.left-o.width()),o.css({position:"fixed",top:c,left:h,"z-index":"999"}),o.attr("tabIndex",-1),o.focus();var p;o.off("focusout.panel").on("focusout.panel",function(){p=setTimeout(function(){o.css({position:"",top:"",left:"","z-index":"","max-width":""}),o.addClass("forcehide"),a.length>0?a.after(o.detach()):r.prepend(o.detach())})}),o.off("focusin.panel").on("focusin.panel",
function(){clearTimeout(p)})}else o.off("focusout.panel"),o.off("focusin.panel"),i!==s&&u.call(this,r.find("[tab-identifier='tab-"+i+"' ]"));n=null},o.prototype.BindEvents=function(e,t){var i,s,o=this;t.find(e.selector).on("ActivateTab",function(){o.ActivateTab($(this),e)}),$(".siebui-panel-button",t).on("click.panelbutton",function(){var t=$(this),i=t.closest(".siebui-panel-parent"),s=i.hasClass("siebui-panel-open");t.toggleClass("siebui-panel-button-close siebui-panel-button-open"),i.toggleClass("siebui-panel-closed siebui-panel-open");if(!s){t.attr("title",n);var a=i.find(e.selector);e.tabify||(t.siblings(".siebui-panel-tab-cont").addClass("forcehide"),a.removeClass("forcehide")),a.off("focusout.panel"),a.off("focusin.panel"),u.call(o,i.find(".siebui-tab-active")),a=null}else t.attr("title",r),t.siblings(".siebui-panel-tab-cont").removeClass("forcehide"),i.find(e.selector).each(function(){var e=$(this);e.hasClass("showOnClose")||e.addClass("forcehide")});i.trigger("OnPanelChange",!s),i=null,t=null}),$(".siebui-panel-icon",t).on("click.paneltab",function(){o.ActivateTab($(this),e)})},new o}(),SiebelApp.S_App.PluginBuilder.AttachHelper(SiebelAppFacade.ContainerPanelManager.GetName(),SiebelAppFacade.ContainerPanelManager),SiebelAppFacade.ContainerPanelManager})),typeof SiebelAppFacade.AddtoArchiveModel=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.AddtoArchiveModel"),define("siebel/addtoarchivemodel",["siebel/listpmodel"],function(){return SiebelAppFacade.AddtoArchiveModel=function(){function e(){SiebelAppFacade.AddtoArchiveModel.superclass.constructor.apply(this,arguments)}function t(){this.SetProperty("PaneStatus","Show")}function n(e,t,n,r){["Hide","Collapse"].indexOf(e)!==-1&&(this.SetProperty("PaneStatus",e),["Hide","Collapse"].indexOf(e)!=-1&&(r.CancelOperation=!0),SiebelApp.S_App.uiStatus.Free())}return SiebelJS.Extend(e,SiebelAppFacade.ListPresentationModel),e.prototype.Setup=function(e){SiebelAppFacade.AddtoArchiveModel.superclass.Setup.call(this,e)},e.prototype.Init=function(){SiebelAppFacade.AddtoArchiveModel.superclass.Init.call(this),this.AddProperty("PaneStatus","Hide"),this.AddMethod("notifyAddtoArchive",t),this.AddMethod("InvokeMethod",n,{sequence:!0,scope:this}),this.AttachEventHandler("AddtoArchive",function(){this.Get("PaneStatus")==="Hide"&&this.SetProperty("PaneStatus","Show")})},e}(),SiebelAppFacade.AddtoArchiveModel})),typeof SiebelAppFacade.AddtoArchiveRenderer=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.AddtoArchiveRenderer"),define("siebel/addtoarchiverenderer",["siebel/jqgridrenderer"],function(){return SiebelAppFacade.AddtoArchiveRenderer=function(){function e(){SiebelAppFacade.AddtoArchiveRenderer.superclass.constructor.apply(this,arguments)}return SiebelJS.Extend(e,SiebelAppFacade.JQGridRenderer),e.prototype.Init=function(){SiebelAppFacade.AddtoArchiveRenderer.superclass.Init.call(this),this.AttachPMBinding("PaneStatus",function(){var e=$("#archivecontainer"),t=$("#_swecontent"),n=this.GetPM().Get("PaneStatus");n==="Hide"&&(e.addClass("forcehide"),t.addClass("siebui-max-width"),$("[id^='gview_s']").resize()),n==="Collapse"&&(e.addClass("siebui-closed"),t.addClass("siebui-max-width"),$("[id^='gview_s']").resize()),n==="Show"&&(e.removeClass("forcehide"),e.removeClass("siebui-closed"),t.removeClass("siebui-max-width"),$("[id^='gview_s']").resize()),SiebelAppFacade.AddtoArchiveRenderer.superclass.resize.call(this)})},e.prototype.ShowUI=function(){SiebelAppFacade.AddtoArchiveRenderer.superclass.ShowUI.call(this),$("#archivecontainer").data("data-pane",0),utils.IsTrue(SiebelApp.S_App.IsAutoOn())&&($(".siebui-archive-open").data("data-autom-parent","SiebScreenTabs"),$(".siebui-archive-open").attr("ot","Button"),$(".siebui-archive-open").attr("rn","ExpandAddArchive"),$(".siebui-archive-open").attr("un","ExpandAddArchive"))},e.prototype.BindEvents=function(){SiebelAppFacade.AddtoArchiveRenderer.superclass.BindEvents.call(this);var e=$("#archivecontainer"),t=$("#_swecontent");$(".siebui-archive-open").bind("click",{ctx:this},function(n){e.removeClass("siebui-closed"),t.removeClass("siebui-max-width"),$("[id^='gview_s']").resize()})},e.prototype.BindData=function(e){SiebelAppFacade.AddtoArchiveRenderer.superclass.BindData.call(this,e),$("#archivecontainer").data("data-pane")!=0&&this.GetPM().ExecuteMethod("notifyAddtoArchive"),$("#archivecontainer").removeData("data-pane")},e}(),SiebelAppFacade.AddtoArchiveRenderer})),typeof SiebelAppFacade.CMEditorPW=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.CMEditorPW"),define("siebel/CMEditorPW",["siebel/FieldPW","3rdParty/codemirror/lib/codemirror.js"],function(){return $("head").append("<link type='text/css' href='"+SiebelApp.S_App.GetBaseURL()+SIEBEL_BUILD+"3rdParty/codemirror/lib/codemirror.css"+"' rel='stylesheet' />"),SiebelAppFacade.CMEditorPW=function(){function o(){SiebelAppFacade.CMEditorPW.superclass.constructor.apply(this,arguments);var e=null,t="resize.CMEditor",n="resize.CMEditorSettings",r=!0,i="",s="cmEditor";this.GetMode=function(){return e},this.SetMode=function(t){e=t},this.GetEditorResizeEventName=function(){return t},this.SetEditorResizeEventName=function(e){t=e},this.GetSettingsResizeEventName=function(){return n},this.SetSettingsResizeEventName=function(e){n=e},this.IsUpdateElmentValueToCMEditor=function(){return r},this.SetUpdateElmentValueToCMEditor=function(e){r=e},this.GetTooltipPrefix=function(){return i},this.SetTooltipPrefix=function(e){i=e},this.GetIdPrefix=function(){return s},this.SetIdPrefix=function(e){s=e}}function u(e,t){var n=this,r=$("#"+n.Get("GetFullId"));DOMUtils.Read(function(){var i=r.find(".siebui-applet").outerHeight(),s=r.find(".siebui-applet-header").outerHeight();DOMUtils.Write(function(){$(e.display.scroller).height(i-s-5),DOMUtils.Write(function(){n.IsUpdateElmentValueToCMEditor()&&e.setValue(t.val()),r=null})})})}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=SiebelJS.Dependency("SiebelApp.S_App.LocaleObject"),n=SiebelJS.Dependency("SiebelApp.Utils"),r=t.GetLocalString
("WT_CMEDITOR_TOOLTIP_RESTORE_CONTEXT"),i=t.GetLocalString("WT_CMEDITOR_TOOLTIP_SETTINGS"),s={buttons:'<div id="{{idPrefix}}RestoreContext" class="siebui-restore-context" title="{{tooltip_restore_context}}" aria-label="{{tooltip_restore_context}}"></div><div id="{{idPrefix}}Settings" class="siebui-editor-settings" title="{{tooltip_settings}}" aria-label="{{tooltip_settings}}"><button class="siebui-ctrl-btn appletButton siebui-editor-settings-ctrl"></button><ul class="siebui-editor-settings-panel siebui-appletmenu ui-menu hide" tabIndex="0"></ul></div>'};return SiebelJS.Extend(o,SiebelAppFacade.FieldPW),o.prototype.ShowUI=function(){SiebelAppFacade.CMEditorPW.superclass.ShowUI.apply(this,arguments);var e=this.GetEl(),t=e[0],o=$("#"+this.Get("GetFullId")),a=n.replaceAll(s.buttons,"{{tooltip_restore_context}}",this.GetTooltipPrefix()+r);a=n.replaceAll(a,"{{tooltip_settings}}",this.GetTooltipPrefix()+i),a=n.replaceAll(a,"{{idPrefix}}",this.GetIdPrefix()),o.find(".siebui-btn-grp-applet").prepend(a);var f=o.find("ul.siebui-editor-settings-panel");o=null;var l=CodeMirror.fromTextArea(t,{value:this.IsUpdateElmentValueToCMEditor()?t.value:""});n.IsEmpty(this.GetMode())||l.setOption("mode",this.GetMode()),e.data("cmInstance",l),e.addClass("forcehide"),this.SetupEditorSettingsAndOptions(f,l),f=null,u.call(this,l,e)},o.prototype.BindEvents=function(){SiebelAppFacade.CMEditorPW.superclass.BindEvents.apply(this,arguments);var e=this.GetEl(),t=e.data("cmInstance"),n=this,r=$("ul.siebui-editor-settings-panel");$(r.eq(0)).find("input").bind("change",function(e){n.OnSettingsChange(e,t)}),$(r.eq(0)).find("select").bind("change",function(e){n.OnSettingsChange(e,t)}),r.on("focusout",function(){var e=$(this);setTimeout(function(){var t=document.activeElement;e.find($(t)).length===0&&e[0]!==t&&t!==$(".siebui-editor-settings-ctrl")[0]&&e.addClass("hide"),e=null},10)}),r=null;var i=SiebelApp.S_App.GetDirection();$(".siebui-editor-settings-ctrl").on("click",function(e){var t=$("ul.siebui-editor-settings-panel");t.toggleClass("hide"),t.hasClass("hide")||(t.eq(0).position({my:i?"right top":"left top",at:i?"right bottom":"left bottom",of:$(this),collision:"flipfit flipfit"}),t.find("li input").eq(0).focus()),t=null}),t.on("change",function(e,t){e.save()}),t.on("focus",function(e,t){n.ExecuteMethod("SetActiveControl",n.control)}),t.on("blur",function(t,r){if(r.relatedTarget===t.display.scrollbars.horiz||r.relatedTarget===t.display.scrollbars.vert){r.preventDefault(),r.stopPropagation();return}n.OnEditorBlur(r,t,e)}),t.on("keydown",function(e,t){(t.ctrlKey&&t.which===$.ui.keyCode.SPACE||t.which===$.ui.keyCode.ENTER)&&t.stopPropagation()});var s=0;$(window).off(this.GetEditorResizeEventName()).on(this.GetEditorResizeEventName(),{ctx:this},function(e){var t=e.data.ctx,n=t.GetEl();s&&(clearTimeout(s),s=0),s=setTimeout(function(){u.call(t,n.data("cmInstance"),n),t=null,n=null,s=0},200)}),$(window).off(this.GetSettingsResizeEventName()).on(this.GetSettingsResizeEventName(),function(){$("ul.siebui-editor-settings-panel").addClass("hide")})},o.prototype.EndLife=function(){this.RemoveResizeEventHandlers(),SiebelAppFacade.CMEditorPW.superclass.EndLife.apply(this,arguments)},o.prototype.RemoveResizeEventHandlers=function(){$(window).off(this.GetEditorResizeEventName()),$(window).off(this.GetSettingsResizeEventName())},o.prototype.SetupEditorSettingsAndOptions=function(e,t){},o.prototype.OnSettingsChange=function(e,t){},o.prototype.OnEditorBlur=function(e,t,n){this.ExecuteMethod("LeaveField",this.control,n.val(),!0)},o.prototype.SetValue=function(e,t){SiebelAppFacade.CMEditorPW.superclass.SetValue.apply(this,arguments);var n=this.GetEl().data("cmInstance");n.getValue()!==e&&n.setValue(e)},o.prototype.SetState=function(t,n,r){SiebelAppFacade.CMEditorPW.superclass.SetState.apply(this,arguments);var i;t===e.get("EDITABLE")?(i=this.GetEl().data("cmInstance"),i.setOption("readOnly",!n)):t===e.get("FOCUS")&&n===!0&&(i=this.GetEl().data("cmInstance"),setTimeout(function(){i.focus(),i.refresh(),i=null},10))},o}(),SiebelAppFacade.CMEditorPW}));
