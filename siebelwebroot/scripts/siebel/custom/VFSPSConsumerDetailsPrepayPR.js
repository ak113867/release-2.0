if(typeof(SiebelAppFacade.VFSPSConsumerDetailsPrepayPR)==="undefined"){var placeholder="";SiebelJS.Namespace("SiebelAppFacade.VFSPSConsumerDetailsPrepayPR");define("siebel/custom/VFSPSConsumerDetailsPrepayPR",["order!siebel/phyrenderer"],function(){SiebelAppFacade.VFSPSConsumerDetailsPrepayPR=(function(){var siebConsts=SiebelJS.Dependency("SiebelApp.Constants");function VFSPSConsumerDetailsPrepayPR(pm){SiebelAppFacade.VFSPSConsumerDetailsPrepayPR.superclass.constructor.call(this,pm);this.GetPM().AttachPMBinding("FieldChanged",VFSPSEnableNextButton,{scope:this});this.InputList=["Title","First Name","Last Name","Date of Birth","WSDL Address","Home Phone","Email Address"];this.InputListMA=["Title","First Name","Last Name","Date of Birth","Type","Street Type","Street","Street Address","Suburb","State","Postal Code","Country","Home Phone","Email Address"];this.NextBtn=""}SiebelJS.Extend(VFSPSConsumerDetailsPrepayPR,SiebelAppFacade.PhysicalRenderer);VFSPSConsumerDetailsPrepayPR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSConsumerDetailsPrepayPR.superclass.ShowUI.call(this);var InputOptionalList,InputList;var controls=this.GetPM().Get("GetControls");var pm=this.GetPM();var sActiveView=SiebelApp.S_App.GetActiveView();var sView=sActiveView.GetName();var playbarapplet=sActiveView.GetApplet("VF SPS Task Playbar Applet - Top");var ctrls=playbarapplet.GetControls();var NextBtn=ctrls.ButtonNext.GetInputName();this.NextBtn=NextBtn;var ExplictCall;VFTabletIntegrationConstants.SetConstants("VFSPSAllowScanFlag","true");if(sActiveView.GetApplet("VF SPS Customer Details Prepaid Mobile Form Applet - Consumer")){InputList=this.InputList;InputOptionalList=["Middle Name"];$("input[name='"+controls["Address Status"].GetInputName()+"'],input[name='"+controls["Manual Address Entry"].GetInputName()+"']").parent().hide().prev().hide();ExplictCall=true;var AddressStatus=controls["Address Status"];var AddrStatus=this.GetPM().ExecuteMethod("GetFieldValue",AddressStatus);setTimeout(function(){VFSPSEnableNextButton(pm,InputList,NextBtn,ExplictCall)},50)}else{InputList=this.InputListMA;InputOptionalList=["Floor Type","Address Floor","Address Building","Middle Name"];$("input[name='"+controls["Floor Type"].GetInputName()+"']").attr("placeholder","--Select--").after('<img id="VFSPSCustomerFloorDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">');$("input[name='"+controls["Street Type"].GetInputName()+"']").attr("placeholder","--Select--").after('<img id="VFSPSCustomerStreetDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">');$("input[name='"+controls["State"].GetInputName()+"']").attr("placeholder","--Select--").after('<img id="VFSPSCustomerStateDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">');ExplictCall=true;setTimeout(function(){VFSPSEnableNextButton(pm,InputList,NextBtn,ExplictCall)},50)}$("input[name='"+controls["Title"].GetInputName()+"']").attr("placeholder","--Select--").after('<img id="VFSPSCustomerTitleDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">');$("input[name='"+controls["Date of Birth"].GetInputName()+"']").attr("placeholder","--DD/MM/YYYY--");var InputOptionalLength=InputOptionalList.length;for(var i=0;i<InputOptionalLength;i++){$("input[name='"+controls[InputOptionalList[i]].GetInputName()+"']").closest("tr").append('<td><div class="VFSPSOptionaldiv">Optional</div></td>')}setTimeout(function(){if(!$("img").hasClass("VFSSPSAddressvalidationicon")&&AddrStatus=="Valid"){console.log("showtick");$("input[name='"+controls["WSDL Address"].GetInputName()+"']").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPStick.png"></img>')}$(".applet-form-date").attr("src","images/VFSPScalendar-icon.png").addClass("VFSPSCustomerDetailsCalIcon");$(".applet-form-combo").attr("src","images/VFSPSdropdown-arrow.png").addClass("VFSPSCustomerDetailPickIcon");var PlaybarAppletId=sActiveView.GetApplet("VF SPS Task Playbar Applet - Top").GetFullId();$("#s_"+PlaybarAppletId+"_div").addClass("VFSPSBottomAppletMargin")},50);setTimeout(function(){$('[aria-labelledby*="WSDL_"]').not('[aria-labelledby="WSDL_Address_Label"]').closest("td").parent().css("display","none");$('[aria-labelledby="WSDL_Address_Label"]').parent().find("img").remove();$('[aria-labelledby="Address_Label"]').parent().find("img").remove();$('[aria-labelledby="Cal_Full_Address_Label"]').parent().parent().parent().hide()},1);if(sView=="VF SPS Capture Customer Details PrePay Mobile View"){var bo=SiebelApp.S_App.GetActiveBusObj();var bc=bo.GetBusCompByName("VF Capture Customer Details TBC");$('[aria-labelledby="WSDL_Address_Label"]').autocomplete({source:function(request,response){$(".VFSSPSAddressvalidationicon").remove();$("input[name='"+controls["WSDL Address"].GetInputName()+"']").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPSaddress-loader.gif"></img>');var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();var sValue=$('[aria-labelledby="WSDL_Address_Label"]').val();inPS.SetProperty("SearchString",sValue);setTimeout(function(){if(service){var outPS=service.InvokeMethod("DoSearchProxy",inPS);var resultSet=outPS.GetChild(0);var addrCount=resultSet.GetChildCount();var addrArray=[];if(resultSet){for(var i=0;i<=addrCount;i++){if(i==addrCount){addrArray.push("Address Not Found? Click Here"+"~^"+"404")}else{addrArray.push(resultSet.GetChild(i).GetProperty("QAS Wsdl Address")+"~^"+resultSet.GetChild(i).GetProperty("QAS Wsdl Moniker"))}}}$(".VFSSPSAddressvalidationicon").remove()}response($.map(addrArray,function(item,id){var res=item.split("~^");return{value:res[0],id:res[1]}}))},20)},minLength:10,appendTo:$('[aria-labelledby="WSDL_Address_Label"]').parent(),select:function(event,ui){var sPickAddr=ui.item.value;var sMonikerval=ui.item.id;var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();inPS.SetProperty("PickMoniker",sMonikerval);inPS.SetProperty("PickFullAddr",sPickAddr);if(sMonikerval=="404"){bc.SetFieldValue("Manual Address Entry","Y");$("#_sweview div").trigger("click")}else{if(!$("img").hasClass("VFSSPSAddressvalidationicon")){$("input[name='"+controls["WSDL Address"].GetInputName()+"']").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPStick.png"></img>')}var outPS=service.InvokeMethod("GetAddressPostpayOUI",inPS);var resultSet=outPS.GetChild(0).GetChild(0);var sPickFullAddr=resultSet.GetProperty("QAS Wsdl Address");var sUnitType=resultSet.GetProperty("Floor Type");var sUnitNumber=resultSet.GetProperty("Floor");var sBuildingName=resultSet.GetProperty("Address Building");var sBuildingNumber=resultSet.GetProperty("Street Number");var sStreetName=resultSet.GetProperty("Street Name");var sStreetType=resultSet.GetProperty("Street Type");var sSuburb=resultSet.GetProperty("Suburb");var sState=resultSet.GetProperty("State");var sPostcode=resultSet.GetProperty("Post Code");var sCountry=resultSet.GetProperty("Country");var sDPID=resultSet.GetProperty("DPID");var WSDLValidationStatus=resultSet.GetProperty("Validation Status");var WSDLAddressType=resultSet.GetProperty("Address Type");var WSDLPOBox=resultSet.GetProperty("PO Box");var WSDLPrivateBag=resultSet.GetProperty("Private Bag");bc.SetFieldValue("WSDL Floor Type",sUnitType);bc.SetFieldValue("WSDL Floor",sUnitNumber);bc.SetFieldValue("WSDL Address Building",sBuildingName);bc.SetFieldValue("WSDL Street Number",sBuildingNumber);bc.SetFieldValue("WSDL Street Name",sStreetName);bc.SetFieldValue("WSDL Street Type",sStreetType);bc.SetFieldValue("WSDL Suburb",sSuburb);bc.SetFieldValue("WSDL State",sState);bc.SetFieldValue("WSDL Post Code",sPostcode);bc.SetFieldValue("WSDL Country",sCountry);bc.SetFieldValue("WSDL DPID",sDPID);bc.SetFieldValue("WSDL Validation Status","1");bc.SetFieldValue("WSDL Address Type",WSDLAddressType);bc.SetFieldValue("WSDL PO Box",WSDLPOBox);bc.SetFieldValue("WSDL Private Bag",WSDLPrivateBag);bc.SetFieldValue("Address Selected",sPickFullAddr);bc.SetFieldValue("Address Status Display","Valid");bc.SetFieldValue("Address Status","1")}}})}};VFSPSConsumerDetailsPrepayPR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSConsumerDetailsPrepayPR.superclass.BindEvents.call(this);var pm=this.GetPM();$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSScanId","click",function(){var CheckIDCaptureTBC=VFCustomSiebelInterface.VFSPSGetAvailableIDCaptureBC();console.log(CheckIDCaptureTBC);if(!CheckIDCaptureTBC){alert("You cannot scan more than 4 documents")}else{VFTabletIntegrationConstants.SetConstants("VFSPSUpdateIDCaptureTBC",CheckIDCaptureTBC);VFTabletIntegrationConstants.SetConstants("VFSPSScanKeyName","OCRPrimaryIdScan");VFSPSShowIDList();console.log("scan allowed")}});$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSCustomerTitleDropDown","click",{ctx:this},VFSPSCustomerTitleDropDown);$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSCustomerFloorDropDown","click",{ctx:this},VFSPSCustomerFloorDropDown);$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSCustomerStreetDropDown","click",{ctx:this},VFSPSCustomerStreetDropDown);$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSCustomerStateDropDown","click",{ctx:this},VFSPSCustomerStateDropDown)};VFSPSConsumerDetailsPrepayPR.prototype.EndLife=function(){SiebelAppFacade.VFSPSConsumerDetailsPrepayPR.superclass.EndLife.call(this);$("#openModal").remove()};function VFSPSCustomerTitleDropDown(e){VFSPSUdateUIFrameWork.VFSPSShowPicklistValues("VF Capture Customer Details TBC","Title","LOV","MR_MS","Siebel","")}function VFSPSCustomerFloorDropDown(e){VFSPSUdateUIFrameWork.VFSPSShowPicklistValues("VF Capture Customer Details TBC","Address Floor Type","LOV","VF_ADDRESS_FLOOR_TYPE","Siebel","")}function VFSPSCustomerStreetDropDown(e){VFSPSUdateUIFrameWork.VFSPSShowPicklistValues("VF Capture Customer Details TBC","Address Street Type","LOV","VF_ADDRESS_STREET_TYPE","Siebel","")}function VFSPSCustomerStateDropDown(e){VFSPSUdateUIFrameWork.VFSPSShowPicklistValues("VF Capture Customer Details TBC","State","LOV","VF_ADDRESS_STATE","Siebel","")}function VFSPSShowIDList(e){var PriLength=VFCustomSiebelInterface.PrimaryIDList.length;if(PriLength==0){VFCustomSiebelInterface.GetIdList();PriLength=VFCustomSiebelInterface.PrimaryIDList.length}if(!$("#openModal").length){$("body").append(GetIDTemplate())}$("#openModal #VFSPSPrimaryIDTypes").html("");$("#openModal .VFSPSIDPopUpHeader").html("Choose 1 of the following ID");$("#VFSPSPrimaryIDTypes").append("<div class='VFSPSTopLineSpace'></div>");for(var i=0;i<PriLength;i++){console.log("high:"+VFCustomSiebelInterface.PrimaryIDList[i].Primary+"low:"+VFCustomSiebelInterface.PrimaryIDList[i].ProofOfAddress);var Template='<div class="VFSPSIDTypeLine VFSPSIDTypeLineSelect" Type="'+VFCustomSiebelInterface.PrimaryIDList[i].Type+'" Points="'+VFCustomSiebelInterface.PrimaryIDList[i].Points+'" IsPrimary="'+VFCustomSiebelInterface.PrimaryIDList[i].Primary+'" ProofOFAddress="'+VFCustomSiebelInterface.PrimaryIDList[i].ProofOfAddress+'">																													<div class="VFSPSIDType">'+VFCustomSiebelInterface.PrimaryIDList[i].Type+'</div>																													<div class="VFSPSIDTypeChevron"></div>																													<div class="VFSPSLineSpace"></div>																													</div>';$("#VFSPSPrimaryIDTypes").append(Template)}$("#openModal").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#openModal").undelegate();$("#openModal").delegate(".VFSPSDialogClose","click",{},function(e){$("#openModal").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")});$("#openModal").delegate(".VFSPSIDTypeLineSelect","click",{},VFSPSScanID)}function GetIDTemplate(){return(' <div id = "openModal" class = "modalDialog VFSPSDisplayNone">  																									 <div>  																									 <span  title = "Close" class = "VFSPSDialogClose" ><img src="images/vfspsclose.jpg"></span>  																									 <h2 class="VFSPSIDPopUpHeader"> Choose 1 of the following ID </h2>  																									 <div id = "VFSPSPrimaryIDTypes">  																									 </div>  																									 </div>  																									 </div> ')}function VFSPSScanID(e){var cardType=$(this).attr("type");var points=$(this).attr("Points");var IsPrimary=$(this).attr("IsPrimary");var ProofOAddress=$(this).attr("ProofOfAddress");VFTabletIntegrationConstants.SetConstants("VFSPSCardType",cardType);if(cardType=="Driver's Licence"||cardType=="Boating Licence"||cardType=="Police ID"){var stateShortArray=VFCustomSiebelInterface.GetPickListValues("VF_ID_ISSUER");$("#openModal #VFSPSPrimaryIDTypes").html("");$("#openModal .VFSPSIDPopUpHeader").html("Choose 1 of the following State");$("#VFSPSPrimaryIDTypes").append("<div class='VFSPSTopLineSpace'></div>");for(var i=0;i<stateShortArray.length;i++){var Template='<div class="VFSPSIDTypeLine VFSPSStateLineSelect" Type="'+stateShortArray[i]+'">																																				<div class="VFSPSIDType">'+stateShortArray[i]+'</div>																																				<div class="VFSPSIDTypeChevron"></div>																																				<div class="VFSPSLineSpace"></div>																																				</div>';$("#VFSPSPrimaryIDTypes").append(Template)}$("#openModal").undelegate();$("#openModal").delegate(".VFSPSDialogClose","click",{},function(e){$("#openModal").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")});$("#openModal").delegate(".VFSPSStateLineSelect","click",{cardType:cardType,points:points,IsPrimary:IsPrimary,ProofOAddress:ProofOAddress},VFSPSGetState)}else{VFSPSStartScanID(cardType,points,IsPrimary,ProofOAddress,"")}}function VFSPSGetState(e){var state=$(this).attr("type");VFSPSStartScanID(e.data.cardType,e.data.points,e.data.IsPrimary,e.data.ProofOAddress,state)}function VFSPSMapCardType(CardType,State){var sCardMap="";switch(CardType){case ("Driver's Licence"):sCardMap=State.toUpperCase()+"_"+"LICENCE";break;case ("Passport"):sCardMap="PASSPORT_AUS";break;case ("Armed Forces ID"):sCardMap="Armed Forces ID";break;case ("Police ID"):sCardMap="Police ID";break;default:}return sCardMap}function VFSPSStartScanID(cardType,points,IsPrimary,ProofOAddress,State){var bo1=SiebelApp.S_App.GetActiveBusObj();var bc1=bo1.GetBusCompByName("VF Capture Customer Details TBC");var sessionId=bc1.GetFieldValue("Session Id");var OCRCardMap=VFSPSMapCardType(cardType,State);var requestData={"Key":"OCRPrimaryIdScan","SettingsData":"","MetaData":"","RequestParam":{"CardType":OCRCardMap,"SessionID":sessionId,"IsImageReq":"True","ReturnData":[{"cardType":cardType,"state":State,"points":points,"ProofOAddress":ProofOAddress,"IsPrimary":IsPrimary}]}};$("#openModal").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");if(typeof(VHAWrapper)=="undefined"){var retVal=VHAWrapperSTUB?VHAWrapperSTUB.scanIDUsingOCR(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0;retVal="1"}else{var retVal=VHAWrapper?VHAWrapper.scanIDUsingOCR(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0}if(retVal){}else{alert("Could not initiate Scan Id. Please go ahead with manual entry.")}}function VFSPSEnableNextButton(pm,InputList,NextBtn,ExplictCall){if(!ExplictCall){pm=this.GetPM();if(SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Customer Details Prepaid Mobile Form Applet - Consumer")){InputList=this.InputList}else{InputList=this.InputListMA}NextBtn=this.NextBtn}var controls=pm.Get("GetControls");var InputListLength=InputList.length;var CustomerFormFieldsEmpty=false;for(var i=0;i<InputListLength;i++){var input=$("input[name='"+controls[InputList[i]].GetInputName()+"']");if(input.val()==""){CustomerFormFieldsEmpty=true;VFTabletIntegrationConstants.SetConstants("VFSPSCustomerFieldempty","True");break}else{VFTabletIntegrationConstants.SetConstants("VFSPSCustomerFieldempty","False")}}if(CustomerFormFieldsEmpty==false){$("#"+NextBtn+"_Ctrl").removeClass("VFSPSPlaybarNextBtnDisabled").addClass("VFSPSPlaybarNextBtnEnabled")}else{$("#"+NextBtn+"_Ctrl").addClass("VFSPSPlaybarNextBtnDisabled").removeClass("VFSPSPlaybarNextBtnEnabled")}}return VFSPSConsumerDetailsPrepayPR}());return"SiebelAppFacade.VFSPSConsumerDetailsPrepayPR"})};