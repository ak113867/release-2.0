if(typeof(SiebelAppFacade.VFSPSCaptureIDDetailsPR1)==="undefined"){var counter;var vSessionId;var controls1;SiebelJS.Namespace("SiebelAppFacade.VFSPSCaptureIDDetailsPR1");define("siebel/custom/VFSPSCaptureIDDetailsPR1",["order!siebel/phyrenderer"],function(){SiebelAppFacade.VFSPSCaptureIDDetailsPR1=(function(){function VFSPSCaptureIDDetailsPR1(pm){SiebelAppFacade.VFSPSCaptureIDDetailsPR1.superclass.constructor.call(this,pm);SiebelApp.EventManager.cleanListners("VFSPSIDUploadfailure");SiebelApp.EventManager.cleanListners("VFSPSIDUploadfailureNoUpload");SiebelApp.EventManager.cleanListners("VFSPSIDUploadSuccess");SiebelApp.EventManager.cleanListners("VFSPSIDBSCall");SiebelApp.EventManager.addListner("VFSPSIDUploadfailure",VFSPSIDUploadfailure,this);SiebelApp.EventManager.addListner("VFSPSIDUploadfailureNoUpload",VFSPSIDUploadfailureNoUpload,this);SiebelApp.EventManager.addListner("VFSPSIDUploadSuccess",VFSPSIDUploadSuccess,this);SiebelApp.EventManager.addListner("VFSPSIDBSCall",VFSPSIDBSCall,this);var sActiveView;this.InputList=["VFPointsPostpay","IdReferenceNumber","ExpiryDate"];this.GetPM().AttachPMBinding("FieldChanged",VFSPSCallEnableNextButton,{scope:this});SiebelApp.EventManager.cleanListners("VFSPSCallEnableNextButton");SiebelApp.EventManager.cleanListners("VFSPSDatePickerField1");SiebelApp.EventManager.cleanListners("VFSPSLOADatePickerField1");SiebelApp.EventManager.addListner("VFSPSCallEnableNextButton",VFSPSCallEnableNextButton,this);SiebelApp.EventManager.addListner("VFSPSDatePickerField1",VFSPSDatePickerField,this);SiebelApp.EventManager.addListner("VFSPSLOADatePickerField1",VFSPSLOADatePickerField1,this)}SiebelJS.Extend(VFSPSCaptureIDDetailsPR1,SiebelAppFacade.PhysicalRenderer);VFSPSCaptureIDDetailsPR1.prototype.ShowUI=function(){SiebelAppFacade.VFSPSCaptureIDDetailsPR1.superclass.ShowUI.call(this);sActiveView=SiebelApp.S_App.GetActiveView();var pm=this.GetPM();controls1=pm.Get("GetControls");VFTabletIntegrationConstants.SetConstants("VFSPSScanKeyName","OCRScanID");$("input[name='"+controls1["ExpiryDate"].GetInputName()+"']").after('<img id="VFSPSCaptureIDDetailsCalender1" class="VFSPSCaptureIDDetailsCalIcon1" src="images/VFSPScalendar-icon.png">');$("input[name='"+controls1["VFSPSLOADate"].GetInputName()+"']").after('<img id="VFSPSLOACaptureIDDetailsCalender1" class="VFSPSCaptureIDDetailsCalIcon1" src="images/VFSPScalendar-icon.png">');setTimeout(function(){$(".applet-form-date").remove()},50);counter=0;$("#ByPassValue").after('<img id="VFSPSIDByPassDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true")};VFSPSCaptureIDDetailsPR1.prototype.BindEvents=function(){SiebelAppFacade.VFSPSCaptureIDDetailsPR1.superclass.BindEvents.call(this);var pm=this.GetPM();var ExplictCall=true;var InputList=this.InputList;var appletName="VFSPS IDDetails Applet1";var appletId=pm.Get("GetFullId");VFSPSIDCaptureInterface.VFSPSScannedIDType(sActiveView,appletName,pm,InputList);$("#s_"+appletId+"_div").delegate(".VFSPSShowIDList","click",function(){VFSPSIDCaptureInterface.GetIDCaptureBC(sActiveView,appletName,pm);VFSPSIDCaptureInterface.VFSPSShowIDList()});$("#s_"+appletId+"_div").delegate(".VFSPSIDCaptureClearBtn","click",function(){VFSPSIDCaptureInterface.GetIDCaptureBC(sActiveView,appletName,pm);VFSPSIDCaptureInterface.VFSPSClearIDDetails()});$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSIDCountryDropDown","click",function(){VFSPSIDCaptureInterface.GetIDCaptureBC(sActiveView,appletName,pm);var IDCaptureTBC=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureTBC");var SearchString="[List Of Values.Type] = 'COUNTRY' AND [List Of Values.Active] = 'Y'";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(IDCaptureTBC,"Country Of Issue","LOV","",SearchString,"Siebel","")});$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSIDStateDropDown","click",function(){VFSPSIDCaptureInterface.GetIDCaptureBC(sActiveView,appletName,pm);var IDCaptureTBC=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureTBC");var SearchString="[List Of Values.Type] = 'VF_ID_ISSUER' AND [List Of Values.Active] = 'Y";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(IDCaptureTBC,"State of Issue","LOV","",SearchString,"Siebel","")});$(".VFSPSIDError>.VFSPSIDCaptureByPassField").delegate("#VFSPSIDByPassDropDown","click",{ctx:this},VFSPSIDByPassDropDown);$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSCaptureIDDetailsCalender1","click",{ctx:this},VFSPSCaptureIDDetailsCalender1);$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSLOACaptureIDDetailsCalender1","click",{ctx:this},VFSPSCaptureIDDetailsCalender2);$(".VFSPSIDCaptureVew").delegate(".VFSPSIDCaptureUploadbtn","click",function(){var bo1=SiebelApp.S_App.GetActiveBusObj();var bc1=bo1.GetBusCompByName("VF Capture Customer Details TBC");var AccountId=bc1.GetFieldValue("Customer Row Id");var vOrdNbr=bc1.GetFieldValue("Order Number");var vTBUISessionId=bc1.GetFieldValue("Session Id");var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("AccountId",AccountId);Inputs.SetProperty("vOrdNbr",vOrdNbr);Outputs=VFCustomSiebelInterface.CallBS("VF SPS IDCaputre BS","GetIDUploadParameters",Inputs,{"Type":"JSONString"});var Outputs=JSON.parse(Outputs);var CustomerID=Outputs["CustomerID"];var ContactID=Outputs["ContactID"];var CSURL=Outputs["CS_URL"];var IDDocRef=Outputs["IDDocRef"];var CustFName=Outputs["CustFName"];var CustLName=Outputs["CustLName"];var UniqueID=Outputs["UniqueID"];var SessionID=vTBUISessionId;vSessionId=Outputs["SessionID"];var DealerCode=Outputs["DealerCode"];var DealerGroup=Outputs["DealerGroup"];var ClientID=Outputs["ClientID"];var ContractID=Outputs["ContractID"];var Password=Outputs["Password"];var RequestType=Outputs["RequestType"];var UserName=Outputs["UserName"];var Timeout=Outputs["Timeout"];var MetadataVersion=Outputs["MetadataVersion"];var CSPaperlessURL=Outputs["CSPaperlessURL"];var SettingsData=VFTabletIntegrationConstants.GetSettingData("JSON");var MetaData={"DealerCode":DealerCode,"CustomerID":CustomerID,"IdDocRef":IDDocRef,"DealerGroup":DealerGroup,"UniqueID":UniqueID,"MetadataVersion":MetadataVersion,"customerFirstName":CustFName,"CustomerLastName":CustLName,"CustomerMiddleName":"","CustomerEmail":"","SessionID":SessionID,"CustomerDOB":"","ContractID":ContractID,"ClientID":ClientID,"RequestType":RequestType,"UserName":UserName,"ContactID":ContactID,"Password":Password,"StoreName":"","SalesPersonName":""};var requestData={"Key":"UploadDoc","SettingsData":SettingsData,"MetaData":MetaData,"RequestParam":{"SessionID":vSessionId,"isPrintRequired":"true"}};if(typeof(VHAWrapper)=="undefined"){var ResponseData={"StatusCode":"200","StatusMessage":"No ID Card image exists to upload.","Data":"","Key":"UploadDoc"};VFTabletIntegration.Success(JSON.stringify(ResponseData));console.log("Wrapper call is not intiated")}else{VHAWrapper.uploadIDDocument(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure");console.log("Wrapper Call")}})};VFSPSCaptureIDDetailsPR1.prototype.EndLife=function(){SiebelAppFacade.VFSPSCaptureIDDetailsPR1.superclass.EndLife.call(this);$("#openModal").remove()};function VFSPSCaptureIDDetailsCalender1(e){var currentVal=$("input[name='"+controls1["ExpiryDate"].GetInputName()+"']").val();VFSPSUdateUIFrameWork.ShowDatePicker("VFSPSIDDetailsTBC1","Expiry Date","Siebel",currentVal,"0:100","VFSPSDatePickerField1")}function VFSPSCaptureIDDetailsCalender2(e){var currentVal=$("input[name='"+controls1["VFSPSLOADate"].GetInputName()+"']").val();VFSPSUdateUIFrameWork.ShowDatePicker("VFSPSIDDetailsTBC1","VF SPS LOA Date","Siebel",currentVal,"0:100","VFSPSLOADatePickerField1")}function VFSPSIDUploadSuccess(){$(".VFSPSIDCaptureUploadbtn,.VFSPSIDCaptureMsg").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSIDCaptureSuccessmsg").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone")}function VFSPSIDUploadfailure(){counter=counter+1;if(counter=="1"){$(".VFSPSIDCaptureMsg").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone")}else{if(counter=="2"){$(".VFSPSIDCaptureByPassField input.VFSPSBillingField").val("Scanner Not Working");VFSPSIDBSCall();$(".VFSPSIDCaptureerrorMsg .VFSPSIDStick").attr("src","images/VFSPSerror.png");$(".VFSPSIDCaptureUploadbtn,.VFSPSIDCaptureMsg").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSIDError").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone")}}}function VFSPSIDUploadfailureNoUpload(){$(".VFSPSIDCaptureByPassField input.VFSPSBillingField").val("Scanner Not Working");VFSPSIDBSCall();$(".VFSPSIDCaptureerrorMsg .VFSPSIDStick").attr("src","images/VFSPSerror.png");$(".VFSPSIDCaptureUploadbtn,.VFSPSIDCaptureMsg").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSIDError").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone")}function VFSPSIDBSCall(){var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();var sByPass=$(".VFSPSIDError>.VFSPSIDCaptureByPassField>input").val();Inputs.SetProperty("sSessionId",vSessionId);Inputs.SetProperty("sBypassReason",sByPass);Outputs=VFCustomSiebelInterface.CallBS("VF SPS IDCaputre BS","UpdateByPass",Inputs,{})}function VFSPSDatePickerField(){var App=SiebelApp.S_App.GetActiveView().GetApplet("VFSPS IDDetails Applet1");var pm=App.GetPModel();var pr=pm.GetRenderer();var InputList=pr.InputList;var controls=pm.Get("GetControls");var ExpireDate=$("input[name='"+controls["ExpiryDate"].GetInputName()+"']").val();ExpireDate=VFTabletNavigation.VFSPSGetSiebelDateFormat(ExpireDate);var BS="VF SPS IDCaputre BS";var Method="SetDateFieldValues";var Inputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("BCName","VFSPSIDDetailsTBC1");Inputs.SetProperty("FieldName","Expiry Date");Inputs.SetProperty("FieldValue",ExpireDate);Outputs=VFCustomSiebelInterface.CallBS(BS,Method,Inputs,{});VFSPSCallEnableNextButton(pm,InputList,true)}function VFSPSLOADatePickerField1(){var App=SiebelApp.S_App.GetActiveView().GetApplet("VFSPS IDDetails Applet1");var pm=App.GetPModel();var pr=pm.GetRenderer();var InputList=pr.InputList;var controls=pm.Get("GetControls");var VFSPSLOADate=$("input[name='"+controls["VFSPSLOADate"].GetInputName()+"']").val();VFSPSLOADate=VFTabletNavigation.VFSPSGetSiebelDateFormat(VFSPSLOADate);var BS="VF SPS IDCaputre BS";var Method="SetDateFieldValues";var Inputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("BCName","VFSPSIDDetailsTBC1");Inputs.SetProperty("FieldName","VF SPS LOA Date");Inputs.SetProperty("FieldValue",VFSPSLOADate);Outputs=VFCustomSiebelInterface.CallBS(BS,Method,Inputs,{});VFSPSCallEnableNextButton(pm,InputList,true)}function VFSPSCallEnableNextButton(pm,InputList,ExplictCall){if(!ExplictCall){pm=this.GetPM();InputList=this.InputList}VFSPSIDCaptureInterface.VFSPSEnableNextButton(pm,InputList,"VFSPS IDDetails Applet1")}function VFSPSIDByPassDropDown(){var SearchString="[List Of Values.Type] = 'PP_IDSCAN_BYPASS_CODE' AND [List Of Values.Active] = 'Y' AND [List Of Values.High] = 'UI'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector=".VFSPSIDError>.VFSPSIDCaptureByPassField>input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML","VFSPSIDBSCall")}return VFSPSCaptureIDDetailsPR1}());return"SiebelAppFacade.VFSPSCaptureIDDetailsPR1"})};