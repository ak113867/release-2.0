if(typeof(VFCustomSiebelInterface)==="undefined"){var VFCustomSiebelInterface={};VFCustomSiebelInterface.CallWorkflow=function(WorkflowName,Inputs,Options){var ser=SiebelApp.S_App.GetService("Workflow Process Manager");Inputs.SetProperty("ProcessName",WorkflowName);var out=ser.InvokeMethod("RunProcess",Inputs);var ResultSet=out.GetChildByType("ResultSet");if(typeof(Options)=="object"){if(Options.Type&&Options.Type=="JSONString"){return JSON.stringify(this.GetJSON(ResultSet))}else{if(Options.Type&&Options.Type=="JSON"){return this.GetJSON(ResultSet)}else{return ResultSet}}}else{return ResultSet}};VFCustomSiebelInterface.GetJSON=function(ResultSet){var PropertyLength=ResultSet.GetPropertyCount();var Data={};var propName=ResultSet.GetFirstProperty();if(propName!=null){for(i=0;i<PropertyLength;i++){Data[propName]=ResultSet.GetProperty(propName);propName=ResultSet.GetNextProperty()}}return Data};VFCustomSiebelInterface.CallBS=function(BSName,Method,Inputs,Options){try{var ser=SiebelApp.S_App.GetService("VF BS Process Manager");var propName=Inputs.GetFirstProperty();Inputs.SetProperty("Service Name",BSName);Inputs.SetProperty("Method Name",Method);var out=ser.InvokeMethod("Run Process",Inputs);var ResultSet=out.GetChildByType("ResultSet");if(typeof(Options)=="object"){if(Options.Type&&Options.Type=="JSONString"){return JSON.stringify(this.GetJSON(ResultSet))}else{if(Options.Type&&Options.Type=="JSON"){return this.GetJSON(ResultSet)}else{return ResultSet}}}else{return ResultSet}}catch(e){console.log("Error : "+e)}};VFCustomSiebelInterface.SiebelMessageToArray=function(pa){var recordCount=0;if(pa){var recordCount=pa.childArray.length}if(recordCount){var arrayData=[];for(var i=0;i<recordCount;i++){var arr=pa.childArray[i];var arrLen=arr.propArrayLen;if(arrLen){var tArr=new Object;var indVal=arr.GetFirstProperty();for(var j=0;j<arrLen;j++){tArr[indVal]=arr.propArray[indVal];indVal=arr.GetNextProperty()}arrayData[i]=tArr}}return arrayData}else{return false}};VFCustomSiebelInterface.PrimaryIDListCustomerCaptureVodlo=new Array();VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo=new Array();VFCustomSiebelInterface.PrimaryIDList=new Array();VFCustomSiebelInterface.SecondaryIDList=new Array();VFCustomSiebelInterface.GetIdList=function(){if(VFCustomSiebelInterface.PrimaryIDList.length==0){var inp=SiebelApp.S_App.NewPropertySet();inp.SetProperty("Method Name","RunProcess");var options={};options.Type="";var out=VFCustomSiebelInterface.CallWorkflow("VF ID Details Workflow",inp);var IO="LS Clinical List Of Values";var RawData=out.GetChildByType("SiebelMessage").GetChildByType("ListOf"+IO);var Description;RawData=VFCustomSiebelInterface.SiebelMessageToArray(RawData);for(var i=0;i<RawData.length;i++){if(RawData[i]["Weighting Factor"]=="100"){Description="A"}else{Description="B"}if(Number(RawData[i]["Target Low"])==70){VFCustomSiebelInterface.PrimaryIDList[VFCustomSiebelInterface.PrimaryIDList.length]={"Type":RawData[i]["Value"],"Points":RawData[i]["Target Low"],"Primary":RawData[i]["High"],"ProofOfAddress":RawData[i]["Low"],"Description":Description,"WeightingFactor":RawData[i]["Weighting Factor"]}}else{VFCustomSiebelInterface.SecondaryIDList[VFCustomSiebelInterface.SecondaryIDList.length]={"Type":RawData[i]["Value"],"Points":RawData[i]["Target Low"],"Primary":RawData[i]["High"],"ProofOfAddress":RawData[i]["Low"],"Description":Description,"WeightingFactor":RawData[i]["Weighting Factor"]}}}}if(VFCustomSiebelInterface.PrimaryIDListCustomerCaptureVodlo.length==0){var inp=SiebelApp.S_App.NewPropertySet();inp.SetProperty("LOVType","VF_SPS_OCR_ID_TYPE");inp.SetProperty("Method Name","RunProcess");var out=VFCustomSiebelInterface.CallWorkflow("VF ID Details Workflow",inp);var IO="LS Clinical List Of Values";var RawData=out.GetChildByType("SiebelMessage").GetChildByType("ListOf"+IO);var Description;RawData=VFCustomSiebelInterface.SiebelMessageToArray(RawData);for(var i=0;i<RawData.length;i++){if(RawData[i]["Weighting Factor"]=="100"){Description="A"}else{Description="B"}VFCustomSiebelInterface.PrimaryIDListCustomerCaptureVodlo[VFCustomSiebelInterface.PrimaryIDListCustomerCaptureVodlo.length]={"Type":RawData[i]["Value"],"Points":RawData[i]["Target Low"],"Primary":RawData[i]["High"],"ProofOfAddress":RawData[i]["Low"],"Description":Description,"WeightingFactor":RawData[i]["Weighting Factor"]}}}if(VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo.length==0){var inp=SiebelApp.S_App.NewPropertySet();inp.SetProperty("LOVType","VF_SPS_OCR_ID_TYPE_2");inp.SetProperty("Method Name","RunProcess");var out=VFCustomSiebelInterface.CallWorkflow("VF ID Details Workflow",inp);var IO="LS Clinical List Of Values";var RawData=out.GetChildByType("SiebelMessage").GetChildByType("ListOf"+IO);var Description;RawData=VFCustomSiebelInterface.SiebelMessageToArray(RawData);for(var i=0;i<RawData.length;i++){if(RawData[i]["Weighting Factor"]=="100"){Description="A"}else{Description="B"}VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo.length]={"Type":RawData[i]["Value"],"Points":RawData[i]["Target Low"],"Primary":RawData[i]["High"],"ProofOfAddress":RawData[i]["Low"],"Description":Description,"WeightingFactor":RawData[i]["Weighting Factor"]}}}};VFCustomSiebelInterface.GetUnSelectedIDList=function(ChoosenIdArray){var tempPrimaryIDList=VFCustomSiebelInterface.PrimaryIDList;var PrimaryIDList=new Array();for(var i=0;i<ChoosenIdArray.length;i++){var indexofChoosen=tempPrimaryIDList.indexOf(ChoosenIdArray[i]);if(indexofChoosen!=-1){tempPrimaryIDList[indexofChoosen]["Type"]="";tempPrimaryIDList[indexofChoosen]["Points"]=""}}for(var i=0;i<tempPrimaryIDList.length;i++){if(tempPrimaryIDList[i]["Type"]!=""){PrimaryIDList[PrimaryIDList.length]=tempPrimaryIDList[i]}}return PrimaryIDList};VFCustomSiebelInterface.GetPickListValues=function(LOVType,SearchString){var inp=SiebelApp.S_App.NewPropertySet();inp.SetProperty("Method Name","RunProcess");inp.SetProperty("LOVType",LOVType);inp.SetProperty("SearchString",SearchString);var options={};options.Type="";var out=VFCustomSiebelInterface.CallWorkflow("VF ID Details Workflow",inp);var IO="LS Clinical List Of Values";var RawData=out.GetChildByType("SiebelMessage").GetChildByType("ListOf"+IO);var Picklist=new Array();RawData=VFCustomSiebelInterface.SiebelMessageToArray(RawData);RawDataLen=RawData.length;for(var i=0;i<RawDataLen;i++){Picklist[Picklist.length]=RawData[i]["Value"]}return Picklist};VFCustomSiebelInterface.VFSPSGetAvailableIDCaptureBC=function(){var IDCaptureTBC=false;var SiebelBusComp,SiebelBusObj;for(i=1;i<=4;i++){SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();SiebelBusComp=SiebelBusObj.GetBusCompByName("VFSPSIDDetailsTBC"+i);var IDType=SiebelBusComp.GetFieldValue("ID type");console.log("IDType "+IDType);if(IDType==""){IDCaptureTBC="VFSPSIDDetailsTBC"+i;console.log("BC "+SiebelBusComp.GetName());break}}return IDCaptureTBC};VFCustomSiebelInterface.VFSPSCheckIDTypeExist=function(cardtype){var SiebelBusComp,SiebelBusObj;SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();var IDCaptureTBC=VFTabletIntegrationConstants.GetConstants("VFSPSUpdateIDCaptureTBC");for(i=1;i<=4;i++){SiebelBusComp=SiebelBusObj.GetBusCompByName("VFSPSIDDetailsTBC"+i);var IDType=SiebelBusComp.GetFieldValue("ID type");if(cardtype==IDType){IDCaptureTBC="VFSPSIDDetailsTBC"+i;break}}return IDCaptureTBC};VFCustomSiebelInterface.VFSPSPrepayGetAvailableIDCaptureBC=function(){var IDCaptureTBC=false;var SiebelBusComp,SiebelBusObj;for(i=1;i<=2;i++){SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();SiebelBusComp=SiebelBusObj.GetBusCompByName("VFSPSIDDetailsTBC"+i);var IDType=SiebelBusComp.GetFieldValue("ID type");if(IDType==""){IDCaptureTBC="VFSPSIDDetailsTBC"+i;console.log("BC "+SiebelBusComp.GetName());break}}return IDCaptureTBC};VFCustomSiebelInterface.VFSPSPrepayCheckIDTypeExist=function(cardtype){var SiebelBusComp,SiebelBusObj;SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();var IDCaptureTBC=VFTabletIntegrationConstants.GetConstants("VFSPSUpdateIDCaptureTBC");for(i=1;i<=2;i++){SiebelBusComp=SiebelBusObj.GetBusCompByName("VFSPSIDDetailsTBC"+i);var IDType=SiebelBusComp.GetFieldValue("ID type");if(cardtype==IDType){IDCaptureTBC="VFSPSIDDetailsTBC"+i;break}}return IDCaptureTBC};VFCustomSiebelInterface.VFSPSConvertDateFormat=function(CurrentDate){var oldValue=CurrentDate.substr(0,5);var newValue=CurrentDate.substr(0,5).split("/").reverse().join("/");var FormattedDate=CurrentDate.replace(oldValue,newValue);return FormattedDate};VFCustomSiebelInterface.GetSystemPreferenc=function(SysPreName){var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("System Preference Name",SysPreName);Outputs=VFCustomSiebelInterface.CallBS("VF Get System Preference","Get System Preference",Inputs,{});return(Outputs.GetProperty("System Preference Value"))};VFCustomSiebelInterface.SetProfileAttr=function(ProfileName,ProfileVal){var inp=SiebelApp.S_App.NewPropertySet();inp.SetProperty("Profile Attribute Name",ProfileName);inp.SetProperty("Profile Attribute Value",ProfileVal);var outs=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",inp,{})}};