if(typeof(SiebelAppFacade.VFSPSAdditionalContactPR)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.VFSPSAdditionalContactPR");define("siebel/custom/VFSPSAdditionalContactPR",["order!siebel/phyrenderer"],function(){SiebelAppFacade.VFSPSAdditionalContactPR=(function(){function VFSPSAdditionalContactPR(pm){SiebelAppFacade.VFSPSAdditionalContactPR.superclass.constructor.call(this,pm);this.InputList=["#VFSPSDecisionMakerFieldTitle","#VFSPSDecisionMakerFieldFName","#VFSPSDecisionMakerFieldLName ","#VFSPSDecisionMakerFieldContactno","#VFSPSDecisionMakerFieldEmail"];this.InputListAC=["#VFSPSAuthorisedContactFieldTitle","#VFSPSAuthorisedContactFieldFName","#VFSPSAuthorisedContactFieldLName","#VFSPSAuthorisedContactFieldContactno","#VFSPSAuthorisedContactFieldEmail"];this.InputListDynamic=[" #VFSPSAuthorisedContactFieldTitle"," #VFSPSAuthorisedContactFieldFName"," #VFSPSAuthorisedContactFieldLName"," #VFSPSAuthorisedContactFieldContactno"," #VFSPSAuthorisedContactFieldEmail"]}SiebelJS.Extend(VFSPSAdditionalContactPR,SiebelAppFacade.PhysicalRenderer);VFSPSAdditionalContactPR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSAdditionalContactPR.superclass.ShowUI.call(this);var sActiveView=SiebelApp.S_App.GetActiveView();var PlaybarAppletId=sActiveView.GetApplet("VF SPS Task Playbar Applet - Top").GetFullId();$("#s_"+PlaybarAppletId+"_div").hide();var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();var sBO=SiebelApp.S_App.GetActiveBusObj();var sBC=sBO.GetBusCompByName("VF Capture Customer Details TBC");var sCustAcctId=sBC.GetFieldValue("Customer Row Id");Input.SetProperty("sCustAcctId",sCustAcctId);Output=VFCustomSiebelInterface.CallBS("VF SPS Additional Contacts BS","QueryDecisionMaker",Input,{});Output=VFCustomSiebelInterface.SiebelMessageToArray(Output);if(!$("#VFSPSDecisionMakerFieldTitle").hasClass("VFSPSAddedTitle")){$("#VFSPSDecisionMakerFieldTitle").after('<img id="VFSPSDecisionMakerTitle" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').addClass("VFSPSAddedTitle").attr("disabled","true")}$("#VFSPSDecisionMakerFieldContactno").attr("type","number");$("#VFSPSAuthorisedContactFieldContactno").attr("type","number");$(".VFSPSDecisionMakerParDiv").attr("sContactId","");for(i=0;i<Output.length;i++){if(Output[i]["sContactRole"]=="Decision Maker"){if(Output[i]["sEnableNext"]=="Y"){$(".VFSPSCustomNextButton").addClass("VFSPSPlaybarNextBtnEnabled").removeClass("VFSPSPlaybarNextBtnDisabled")}else{$(".VFSPSCustomNextButton").addClass("VFSPSPlaybarNextBtnDisabled").removeClass("VFSPSPlaybarNextBtnEnabled")}$("#VFSPSDecisionMakerFieldTitle").val(Output[i]["sTitle"]);$("#VFSPSDecisionMakerFieldFName").val(Output[i]["sFirstName"]);$("#VFSPSDecisionMakerFieldMName").val(Output[i]["sMidName"]);$("#VFSPSDecisionMakerFieldLName").val(Output[i]["slastName"]);$("#VFSPSDecisionMakerFieldContactno").val(Output[i]["sContactNo"]);$("#VFSPSDecisionMakerFieldEmail").val(Output[i]["sEmail"]);$(".VFSPSDecisionMakerParDiv").attr("sContactId",Output[i]["sContactId"]);if(Output[i]["sPrimary"]=="Y"){$("#VFSPSDecisionMakerFieldTitle").attr("readonly","readonly");$("#VFSPSDecisionMakerFieldFName").attr("readonly","readonly");$("#VFSPSDecisionMakerFieldMName").attr("readonly","readonly");$("#VFSPSDecisionMakerFieldLName").attr("readonly","readonly");$("#VFSPSDecisionMakerFieldContactno").attr("readonly","readonly");$("#VFSPSDecisionMakerFieldEmail").attr("readonly","readonly");$(".VFSPSDecisionMakerSaveClearDivPar").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$("#VFSPSDecisionMakerClear").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSDecisionMakerSave").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock")}}else{if(Output[i]["sContactRole"]=="Authorised Contact"){var template=$(".VFSPSAuthorisedtemplate").html();$(".VFSPSAuthorisedContactAppenDiv").append(GetParentTielContainer(i));$("#VFSPSAuthorisedContactTileParId"+i).append(template);$("#VFSPSAuthorisedContactTileParId"+i).attr("rowId",i);$("#VFSPSAuthorisedContactTileParId"+i).attr("sContactId",Output[i]["sContactId"]);$(".VFSPSAuthorisedContactAppenDiv").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldTitle").after('<img id="VFSPSAuthorisedContactTitle" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldTitle").val(Output[i]["sTitle"]);$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldFName").val(Output[i]["sFirstName"]);$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldMName").val(Output[i]["sMidName"]);$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldLName").val(Output[i]["slastName"]);$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldContactno").val(Output[i]["sContactNo"]);$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldEmail").val(Output[i]["sEmail"]);if(Output[i]["sPrimary"]=="Y"){$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldTitle").attr("readonly","readonly");$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldFName").attr("readonly","readonly");$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldMName").attr("readonly","readonly");$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldLName").attr("readonly","readonly");$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldContactno").attr("readonly","readonly");$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldEmail").attr("readonly","readonly");$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactClear").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactSave").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock")}}}}var InputList=this.InputList;var InputListAC=this.InputListAC;var ShowUICall=VFTabletIntegrationConstants.SetConstants("VFSPSShowUICall","Y");VFSPSSaveButtonEnable(InputList);VFSPSACSaveButtonEnable(InputListAC)};function GetParentTielContainer(i){return"<div id='VFSPSAuthorisedContactTileParId"+i+"' class='VFSPSAuthorisedContactTileParId'></div>"}function VFSPSSaveButtonEnable(){if(VFTabletIntegrationConstants.GetConstants("VFSPSShowUICall")!="Y"){$(".VFSPSDecisionMakerSave").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$("#VFSPSDCSavediv").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock")}var App=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Additional Contact Applet");var pm=App.GetPModel();var pr=pm.GetRenderer();InputList=pr.InputList;var InputListLength=InputList.length;var sButton="";for(var i=0;i<InputListLength;i++){if($(InputList[i]).val()==""){$(InputList[i]).removeClass("VFSDefaultBorderColour").addClass("VFSTextFilledBorderColour");sButton="Y"}else{$(InputList[i]).removeClass("VFSTextFilledBorderColour").addClass("VFSDefaultBorderColour")}}if(sButton=="Y"){$(".VFSPSDecisionMakerSave").addClass("VFSPSPlaybarNextBtnDisabled").removeClass("VFSPSPlaybarNextBtnEnabled")}else{$(".VFSPSDecisionMakerSave").addClass("VFSPSPlaybarNextBtnEnabled").removeClass("VFSPSPlaybarNextBtnDisabled");if(VFTabletIntegrationConstants.GetConstants("VFSPSShowUICall")!="Y"){$(".VFSPSCustomNextButton").addClass("VFSPSPlaybarNextBtnDisabled").removeClass("VFSPSPlaybarNextBtnEnabled")}}VFTabletIntegrationConstants.SetConstants("VFSPSShowUICall","N")}function VFSPSACSaveButtonEnable(){var App=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Additional Contact Applet");var pm=App.GetPModel();var pr=pm.GetRenderer();InputList=pr.InputListAC;var InputListDynamic=pr.InputListDynamic;var InputListLength=InputList.length;var sACButton="";if(VFTabletIntegrationConstants.GetConstants("VFSPSShowUICall")!="Y"){InputListLength=InputListDynamic.length;var row=$(this).parent().parent().parent().attr("rowId");if(row==""||row==undefined){row=VFTabletIntegrationConstants.GetConstants("row")}$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSACSavediv").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactSave").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");for(var i=0;i<InputListLength;i++){if($("#VFSPSAuthorisedContactTileParId"+row+InputListDynamic[i]).val()==""){$("#VFSPSAuthorisedContactTileParId"+row+InputListDynamic[i]).removeClass("VFSDefaultBorderColour").addClass("VFSTextFilledBorderColour");sACButton="Y"}else{$("#VFSPSAuthorisedContactTileParId"+row+InputListDynamic[i]).removeClass("VFSTextFilledBorderColour").addClass("VFSDefaultBorderColour")}}}else{for(var i=0;i<InputListLength;i++){if($(InputList[i]).val()==""){$(InputList[i]).removeClass("VFSDefaultBorderColour").addClass("VFSTextFilledBorderColour");sACButton="Y"}else{$(InputList[i]).removeClass("VFSTextFilledBorderColour").addClass("VFSDefaultBorderColour")}}}VFTabletIntegrationConstants.SetConstants("VFSPSShowUICall","N");if(sACButton=="Y"){$(".VFSPSAuthorisedContactSave").addClass("VFSPSPlaybarNextBtnDisabled").removeClass("VFSPSPlaybarNextBtnEnabled")}else{$(".VFSPSAuthorisedContactSave").addClass("VFSPSPlaybarNextBtnEnabled").removeClass("VFSPSPlaybarNextBtnDisabled")}}VFSPSAdditionalContactPR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSAdditionalContactPR.superclass.BindEvents.apply(this,arguments);$(".VFSPSDecisionMakerParDiv").delegate(".VFSPSDecisionMakerFieldvalue>input","input",{ctx:this},VFSPSSaveButtonEnable);$(".VFSPSAuthorisedContactAppenDiv").delegate(".VFSPSAuthorisedContactFieldvalue>input","input",{ctx:this},VFSPSACSaveButtonEnable);$(".VFSPSDecisionMakerFieldvalue").delegate("#VFSPSDecisionMakerTitle","click",{ctx:this},VFSPSDecisionMakerDropDown);$(".VFSPSDecisionMakerParDiv").delegate(".VFSPSDecisionMakerSave","click",{ctx:this},VFSPSUpsertDecisisonMaker);$(".VFSPSDecisionMakerParDiv").delegate(".VFSPSDecisionMakerClear","click",{ctx:this},VFSPSClearDecisisonMaker);$(".VFSPSAuthorisedContactAppenDiv").delegate(".VFSPSAuthorisedContactSave","click",{ctx:this},VFSPSUpsertAuthorisedContact);$(".VFSPSAuthorisedContactAppenDiv").delegate(".VFSPSAuthorisedContactClear","click",{ctx:this},VFSPSClearAuthorisedContact);$(".VFSPSAdditionalContactsApplet").delegate(".VFSPSNewAuthorisedContact","click",{ctx:this},VFSPSAddAuthorisedContact);$(".VFSPSACPlaybarButton").delegate(".VFSPSCustomNextButton","click",{ctx:this},VFSPSTaskNext);$(".VFSPSACPlaybarButton").delegate(".VFSPSCancelClick","click",{ctx:this},VFSPSTaskCancel)};function VFSPSClearAuthorisedContact(){var row=$(this).parent().parent().parent().attr("rowId");$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldTitle").val("");$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldFName").val("");$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldMName").val("");$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldLName").val("");$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldContactno").val("");$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldEmail").val("");$("#VFSPSAuthorisedContactTileParId"+row).remove()}function VFSPSClearDecisisonMaker(){$("#VFSPSDecisionMakerFieldFName").val("");$("#VFSPSDecisionMakerFieldLName").val("");$("#VFSPSDecisionMakerFieldTitle").val("");$("#VFSPSDecisionMakerFieldMName").val("");$("#VFSPSDecisionMakerFieldContactno").val("");$("#VFSPSDecisionMakerFieldEmail").val("");$(".VFSPSDecisionMakerSave").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$(".VFSPSCustomNextButton").addClass("VFSPSPlaybarNextBtnDisabled").removeClass("VFSPSPlaybarNextBtnEnabled");$("#VFSPSDCSavediv").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");VFSPSSaveButtonEnable()}function VFSPSAddAuthorisedContact(){var i=$(".VFSPSAuthorisedContactAppenDiv").children().length+1;var template=$(".VFSPSAuthorisedtemplate").html();$(".VFSPSAuthorisedContactAppenDiv").append(GetParentTielContainer(i));$("#VFSPSAuthorisedContactTileParId"+i).append(template);$("#VFSPSAuthorisedContactTileParId"+i).attr("rowId",i);$("#VFSPSAuthorisedContactTileParId"+i).attr("sContactId","");$("#VFSPSAuthorisedContactTileParId"+i+" #VFSPSAuthorisedContactFieldTitle").after('<img id="VFSPSAuthorisedContactTitle" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$(".VFSPSAuthorisedContactAppenDiv").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$(".VFSPSAuthorisedContactFieldvalue").delegate("#VFSPSAuthorisedContactTitle","click",{ctx:this},VFSPSAuthorisedContactDropDown);VFTabletIntegrationConstants.SetConstants("row",i);VFSPSACSaveButtonEnable(e)}function VFSPSUpsertAuthorisedContact(){var row=$(this).parent().parent().parent().attr("rowid");var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();var sBO=SiebelApp.S_App.GetActiveBusObj();var sBC=sBO.GetBusCompByName("VF Capture Customer Details TBC");var sCustAcctId=sBC.GetFieldValue("Customer Row Id");var sContactId=$("#VFSPSAuthorisedContactTileParId"+row).attr("sContactId");Input.SetProperty("sCustAcctId",sCustAcctId);Input.SetProperty("sContactId",sContactId);Input.SetProperty("sContactRole","Authorised Contact");Input.SetProperty("sFirstName",$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldFName").val());Input.SetProperty("slastName",$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldLName").val());Input.SetProperty("sTitle",$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldTitle").val());Input.SetProperty("sMidName",$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldMName").val());Input.SetProperty("sContactNo",$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldContactno").val());Input.SetProperty("sEmail",$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldEmail").val());Output=VFCustomSiebelInterface.CallBS("VF SPS Additional Contacts BS","UpsertDecisionMaker",Input,{});if(Output.GetProperty("sContactId")!=""){$("#VFSPSAuthorisedContactTileParId"+row).attr("sContactId",Output.GetProperty("sContactId"));$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSACSavediv").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$("#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactSave").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock")}}function VFSPSUpsertDecisisonMaker(){var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();var sBO=SiebelApp.S_App.GetActiveBusObj();var sBC=sBO.GetBusCompByName("VF Capture Customer Details TBC");var sCustAcctId=sBC.GetFieldValue("Customer Row Id");var sContactId=$(".VFSPSDecisionMakerParDiv").attr("sContactId");Input.SetProperty("sCustAcctId",sCustAcctId);Input.SetProperty("sContactId",sContactId);Input.SetProperty("sContactRole","Decision Maker");Input.SetProperty("sFirstName",$("#VFSPSDecisionMakerFieldFName").val());Input.SetProperty("slastName",$("#VFSPSDecisionMakerFieldLName").val());Input.SetProperty("sTitle",$("#VFSPSDecisionMakerFieldTitle").val());Input.SetProperty("sMidName",$("#VFSPSDecisionMakerFieldMName").val());Input.SetProperty("sContactNo",$("#VFSPSDecisionMakerFieldContactno").val());Input.SetProperty("sEmail",$("#VFSPSDecisionMakerFieldEmail").val());Output=VFCustomSiebelInterface.CallBS("VF SPS Additional Contacts BS","UpsertDecisionMaker",Input,{});if(Output.GetProperty("sContactId")!=""){$(".VFSPSDecisionMakerParDiv").attr("sContactId",Output.GetProperty("sContactId"));$(".VFSPSCustomNextButton").addClass("VFSPSPlaybarNextBtnEnabled").removeClass("VFSPSPlaybarNextBtnDisabled");$("#VFSPSDecisionMakerSave").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$("#VFSPSDCSavediv").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone")}}function VFSPSTaskCancel(){var view=SiebelApp.S_App.GetActiveView();var applet=view.GetApplet("VF SPS Task Playbar Applet - Top");applet.InvokeMethod("CancelTask")}function VFSPSTaskNext(){if($(this).hasClass("VFSPSPlaybarNextBtnEnabled")==true){var view=SiebelApp.S_App.GetActiveView();var applet=view.GetApplet("VF SPS Task Playbar Applet - Top");applet.InvokeMethod("NavigateNext")}}function VFSPSDecisionMakerDropDown(e){if($(this).prev().attr("readonly")!="disabled"){var SearchString="[List Of Values.Type] = 'MR_MS' AND [List Of Values.Active] = 'Y'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector="#VFSPSDecisionMakerFieldTitle";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML","")}}function VFSPSAuthorisedContactDropDown(e){if($(this).prev().attr("readonly")!="disabled"){var row=$(this).parent().parent().parent().attr("rowId");var SearchString="[List Of Values.Type] = 'MR_MS' AND [List Of Values.Active] = 'Y'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector="#VFSPSAuthorisedContactTileParId"+row+" #VFSPSAuthorisedContactFieldTitle";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML","")}}return VFSPSAdditionalContactPR}());return"SiebelAppFacade.VFSPSAdditionalContactPR"})};