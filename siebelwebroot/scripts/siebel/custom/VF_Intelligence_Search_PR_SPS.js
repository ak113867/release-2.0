if(typeof(SiebelAppFacade.VFSPSCustomerDetailsPR)==="undefined"){var placeholder="";SiebelJS.Namespace("SiebelAppFacade.VFSPSCustomerDetailsPR");define("siebel/custom/VFSPSCustomerDetailsPR",["order!siebel/phyrenderer"],function(){SiebelAppFacade.VFSPSCustomerDetailsPR=(function(){var siebConsts=SiebelJS.Dependency("SiebelApp.Constants");function VFSPSCustomerDetailsPR(pm){SiebelAppFacade.VFSPSCustomerDetailsPR.superclass.constructor.call(this,pm)}SiebelJS.Extend(VFSPSCustomerDetailsPR,SiebelAppFacade.PhysicalRenderer);VFSPSCustomerDetailsPR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSCustomerDetailsPR.superclass.ShowUI.call(this);var InputOptionalList;var controls=this.GetPM().Get("GetControls");var sActiveView=SiebelApp.S_App.GetActiveView();var sView=sActiveView.GetName();if(sActiveView.GetApplet("VF SPS Capture Customer Details Toggle Form Applet Mobile Person")){InputOptionalList=["Middle Name"]}else{InputOptionalList=["Floor Type","Address Floor","Address Building","Middle Name"]}$("input[name='"+controls["Title"].GetInputName()+"']").attr("placeholder","--Select--");$("input[name='"+controls["Date of Birth"].GetInputName()+"']").attr("placeholder","--DD/MM/YYYY--");var InputOptionalLength=InputOptionalList.length;for(var i=0;i<InputOptionalLength;i++){$("input[name='"+controls[InputOptionalList[i]].GetInputName()+"']").closest("tr").append('<td><div class="VFSPSOptionaldiv">Optional</div></td>')}setTimeout(function(){if($("img").hasClass("VFSSPSAddressvalidationicon")==-1&&AddrStatus=="Valid"){$("input[name='"+controls["WSDL Address"].GetInputName()+"']").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPStick.png"></img>')}$(".applet-form-date").attr("src","images/VFSPScalendar-icon.png").addClass("VFSPSCustomerDetailsCalIcon");$(".applet-form-combo").attr("src","images/VFSPSdropdown-arrow.png").addClass("VFSPSCustomerDetailPickIcon");$('button[aria-label="Previous"]').hide();var PlaybarAppletId=sActiveView.GetApplet("VF SPS Task Playbar Applet - Top").GetFullId();$("#s_"+PlaybarAppletId+"_div").addClass("VFSPSBottomAppletMargin")},50);setTimeout(function(){$('[aria-labelledby*="WSDL_"]').not('[aria-labelledby="WSDL_Address_Label"]').closest("td").parent().css("display","none");$('[aria-labelledby="WSDL_Address_Label"]').parent().find("img").remove();$('[aria-labelledby="Address_Label"]').parent().find("img").remove();$('[aria-labelledby="Cal_Full_Address_Label"]').parent().parent().parent().hide()},1);if(sView=="VF Capture Customer Details Postpay Mobile View"){$('[aria-labelledby="Address_Label"]').autocomplete({source:function(request,response){var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();var sValue=$('[aria-labelledby="Address_Label"]').val();inPS.SetProperty("SearchString",sValue);if(service){var outPS=service.InvokeMethod("DoSearchProxy",inPS);var resultSet=outPS.GetChild(0);var addrCount=resultSet.GetChildCount();var addrArray=[];if(resultSet){for(var i=0;i<addrCount;i++){addrArray.push(resultSet.GetChild(i).GetProperty("QAS Wsdl Address")+"~^"+resultSet.GetChild(i).GetProperty("QAS Wsdl Moniker"))}}}response($.map(addrArray,function(item,id){var res=item.split("~^");return{value:res[0],id:res[1]}}))},minLength:10,appendTo:$('[aria-labelledby="Address_Label"]').parent(),select:function(event,ui){var sPickAddr=ui.item.value;var sMonikerval=ui.item.id;var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();inPS.SetProperty("PickMoniker",sMonikerval);inPS.SetProperty("PickFullAddr",sPickAddr);if(service){var outPS=service.InvokeMethod("GetAddressPrepayOUI",inPS);var Prepaybo=SiebelApp.S_App.GetActiveBusObj();var Prepaybc=Prepaybo.GetBusCompByName("VF New Account Contact PrePay TBC");Prepaybc.SetFieldValue("Address Selected",sPickAddr);Prepaybc.SetFieldValue("Address Status Display","Valid");Prepaybc.SetFieldValue("Address Status","1")}}})}var sViewName=SiebelApp.S_App.GetProfileAttr("ViewName");if(sView=="VF Capture Customer Details Postpay Mobile View"){$('[aria-labelledby="WSDL_Address_Label"]').autocomplete({source:function(request,response){var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();var sValue=$('[aria-labelledby="WSDL_Address_Label"]').val();inPS.SetProperty("SearchString",sValue);if(service){$(".VFSSPSAddressvalidationicon").remove();$("input[name='"+controls["WSDL Address"].GetInputName()+"']").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPSaddress-loader.gif"></img>');var outPS=service.InvokeMethod("DoSearchProxy",inPS);var resultSet=outPS.GetChild(0);var addrCount=resultSet.GetChildCount();var addrArray=[];if(resultSet){for(var i=0;i<=addrCount;i++){if(i==addrCount){addrArray.push("Address Not Found? Click Here"+"~^"+"404")}else{addrArray.push(resultSet.GetChild(i).GetProperty("QAS Wsdl Address")+"~^"+resultSet.GetChild(i).GetProperty("QAS Wsdl Moniker"))}}$(".VFSSPSAddressvalidationicon").remove()}}response($.map(addrArray,function(item,id){var res=item.split("~^");return{value:res[0],id:res[1]}}))},minLength:10,select:function(event,ui){var sPickAddr=ui.item.value;var sMonikerval=ui.item.id;var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();inPS.SetProperty("PickMoniker",sMonikerval);inPS.SetProperty("PickFullAddr",sPickAddr);if(sMonikerval=="404"){bc.SetFieldValue("Manual Address Entry","Y");$("div").trigger("click")}else{if(!$("img").hasClass("VFSSPSAddressvalidationicon")){$("input[name='"+controls["WSDL Address"].GetInputName()+"']").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPStick.png"></img>')}var outPS=service.InvokeMethod("GetAddressPostpayOUI",inPS);var resultSet=outPS.GetChild(0).GetChild(0);var sPickFullAddr=resultSet.GetProperty("QAS Wsdl Address");var sUnitType=resultSet.GetProperty("Floor Type");var sUnitNumber=resultSet.GetProperty("Floor");var sBuildingName=resultSet.GetProperty("Address Building");var sBuildingNumber=resultSet.GetProperty("Street Number");var sStreetName=resultSet.GetProperty("Street Name");var sStreetType=resultSet.GetProperty("Street Type");var sSuburb=resultSet.GetProperty("Suburb");var sState=resultSet.GetProperty("State");var sPostcode=resultSet.GetProperty("Post Code");var sCountry=resultSet.GetProperty("Country");var sDPID=resultSet.GetProperty("DPID");var WSDLValidationStatus=resultSet.GetProperty("Validation Status");var WSDLAddressType=resultSet.GetProperty("Address Type");var WSDLPOBox=resultSet.GetProperty("PO Box");var WSDLPrivateBag=resultSet.GetProperty("Private Bag");var bo=SiebelApp.S_App.GetActiveBusObj();var bc=bo.GetBusCompByName("VF Capture Customer Details TBC");bc.SetFieldValue("WSDL Floor Type",sUnitType);bc.SetFieldValue("WSDL Floor",sUnitNumber);bc.SetFieldValue("WSDL Address Building",sBuildingName);bc.SetFieldValue("WSDL Street Number",sBuildingNumber);bc.SetFieldValue("WSDL Street Name",sStreetName);bc.SetFieldValue("WSDL Street Type",sStreetType);bc.SetFieldValue("WSDL Suburb",sSuburb);bc.SetFieldValue("WSDL State",sState);bc.SetFieldValue("WSDL Post Code",sPostcode);bc.SetFieldValue("WSDL Country",sCountry);bc.SetFieldValue("WSDL DPID",sDPID);bc.SetFieldValue("WSDL Validation Status","1");bc.SetFieldValue("WSDL Address Type",WSDLAddressType);bc.SetFieldValue("WSDL PO Box",WSDLPOBox);bc.SetFieldValue("WSDL Private Bag",WSDLPrivateBag);bc.SetFieldValue("Address Selected",sPickFullAddr);bc.SetFieldValue("Address Status Display","Valid");bc.SetFieldValue("Address Status","1")}}});$('[aria-labelledby="CAPIN_Label"]').trigger("click")}var sViewName=SiebelApp.S_App.GetProfileAttr("ViewName");if(""+sView=="VF Connection Wizard View – Shopping Cart – TBUI"||""+sView=="VF Customise Services View –  TBUI"){$('[aria-labelledby="VF_Intelligence_Search_Address_Label"]').autocomplete({source:function(request,response){var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();var sValue=$('[aria-labelledby="VF_Intelligence_Search_Address_Label"]').val();inPS.SetProperty("SearchString",sValue);if(service){var outPS=service.InvokeMethod("DoSearchProxy",inPS);var resultSet=outPS.GetChild(0);var addrCount=resultSet.GetChildCount();var addrArray=[];if(resultSet){for(var i=0;i<addrCount;i++){addrArray.push(resultSet.GetChild(i).GetProperty("QAS Wsdl Address")+"~^"+resultSet.GetChild(i).GetProperty("QAS Wsdl Moniker"))}}}response($.map(addrArray,function(item,id){var res=item.split("~^");return{value:res[0],id:res[1]}}))},minLength:10,select:function(event,ui){var sPickAddr=ui.item.value;var sMonikerval=ui.item.id;var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();inPS.SetProperty("PickMoniker",sMonikerval);inPS.SetProperty("PickFullAddr",sPickAddr);if(service){var outPS=service.InvokeMethod("GetShippingAddressOUI",inPS)}}})}};VFSPSCustomerDetailsPR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSCustomerDetailsPR.superclass.BindEvents.call(this);$("#VFSScanId").click(function(){ctx:this},VFSPSShowIDList)};function VFSPSShowIDList(e){var PriLength=VFCustomSiebelInterface.PrimaryIDList.length;if(PriLength==0){VFCustomSiebelInterface.GetIdList();PriLength=VFCustomSiebelInterface.PrimaryIDList.length}if(!$("#openModal").length){$("body").append(GetIDTemplate())}$("#openModal #VFSPSPrimaryIDTypes").html("");for(var i=0;i<PriLength;i++){var Template='<div class="VFSPSIDTypeLine VFSPSIDTypeLineSelect" Type="'+VFCustomSiebelInterface.PrimaryIDList[i].Type+'">																			<div class="VFSPSIDType">'+VFCustomSiebelInterface.PrimaryIDList[i].Type+'</div>																			<div class="VFSPSIDTypeChevron"></div>																			<div class="VFSPSLineSpace"></div>																			</div>';$("#VFSPSPrimaryIDTypes").append(Template)}$("#openModal").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#openModal").delegate(".VFSPSDialogClose","click",{},function(e){$("#openModal").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")});$("#openModal").delegate(".VFSPSIDTypeLineSelect","click",{},VFSPSScanID)}function VFSPSScanID(e){var bo1=SiebelApp.S_App.GetActiveBusObj();var bc1=bo1.GetBusCompByName("VF Capture Customer Details TBC");var sessionId=bc1.GetFieldValue("Session Id");var requestData={"Key":"OCRPrimaryIdScan","SettingsData":"","MetaData":"","RequestParam":[{"Name":"CardType","Value":"Passport"},{"Name":"SessionID","Value":"123129-1239i9023"},{"Name":"CustomerID","Value":"1-FDAS04"},{"Name":"IsImageReq","Value":"True"}]};var retVal=VHAWrapper?VHAWrapper.scanIDUsingOCR(JSON.stringify(requestData),"s","s"):0;retVal="1";if(retVal){}else{alert("Counld not initiate Bar code scaning. Please go ahead with manual entry.")}}function GetIDTemplate(){return(' <div id = "openModal" class = "modalDialog VFSPSDisplayNone">  																										 <div>  																										 <span  title = "Close" class = "VFSPSDialogClose" ><img src="images/vfspsclose.jpg"></span>  																										 <h2 class="VFSPSIDPopUpHeader"> Choose 1 of the following ID </h2>  																										 <div id = "VFSPSPrimaryIDTypes">  																										 </div>  																										 </div>  																										 </div> ')}return VFSPSCustomerDetailsPR}());return"SiebelAppFacade.VFSPSCustomerDetailsPR"})};