if(typeof(SiebelAppFacade.VFSPSCreateOrderPrepaidAppletPR)==="undefined"){var DDMMYYDateFormat=true;SiebelJS.Namespace("SiebelAppFacade.VFSPSNewCustomerPostPaidSelectCustomizeListAppletPR");define("siebel/custom/VFSPSCreateOrderPrepaidAppletPR",["order!siebel/phyrenderer"],function(){SiebelAppFacade.VFSPSCreateOrderPrepaidAppletPR=(function(){function VFSPSCreateOrderPrepaidAppletPR(pm){SiebelAppFacade.VFSPSCreateOrderPrepaidAppletPR.superclass.constructor.call(this,pm);this.NextBtn=""}SiebelJS.Extend(VFSPSCreateOrderPrepaidAppletPR,SiebelAppFacade.PhysicalRenderer);VFSPSCreateOrderPrepaidAppletPR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSCreateOrderPrepaidAppletPR.superclass.ShowUI.call(this);var AppletMap=SiebelApp.S_App.GetActiveView().GetAppletMap();var applet=AppletMap["VF SPS Order Line Item Details Applet - TBUI"];var pm=applet.GetPModel();var appletId=pm.Get("GetFullId");$("#"+appletId).addClass("VFSPSDisplayNone");var playbarapplet=AppletMap["VF SPS Prepay Task Playbar Applet - Top"];var ctrls=playbarapplet.GetControls();var NextBtn=ctrls.ButtonCreateOrder.GetInputName();this.NextBtn=NextBtn;var ExistData=GetFieldValueOrderEntryLineItem();setTimeout(function(){VFSPSEnableNextButton()},50);DDMMYYDateFormat=true};VFSPSCreateOrderPrepaidAppletPR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSCreateOrderPrepaidAppletPR.superclass.BindEvents.call(this);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSPreCreateOrderOpenPlan","click",{ctx:this},VFSPSOpenAccordDetails);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreateOrderChooseServiceRadio","click",{typeClass:"VFSPSCreateOrderChooseServiceRadio",ctx:this},VFSPSRadioButtonSelect);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreOrderChooseMobileRadio","click",{typeClass:"VFSPSCreOrderChooseMobileRadio",ctx:this},VFSPSRadioButtonSelect);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreOrderScanIMEIButton","click",{ctx:this},VFSPSScanIMEI);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreOrderPickMobileImg,.VFSPSCreOrderPickOldMobileSearchImg","click",{ctx:this},VFSPSSearchMobileNumber);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreateOrderAssetPinFldValue","keyup",{typeClass:"VFSPSCreateOrderAssetPinFldValue",ctx:this},VFSPSCalSetFieldVal);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreOrderPickOldMobileValue","keyup",{typeClass:"VFSPSCreOrderPickOldMobileValue",ctx:this},VFSPSCalSetFieldVal);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreOrderOldMobilePlanTypeRadio","click",{typeClass:"VFSPSCreOrderOldMobilePlanTypeRadio",ctx:this},VFSPSRadioButtonSelect);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreOrderPortIn","click",{ctx:this},VFSPSInvokePortIn);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreOrderPickIMEIImg","click",{typeClass:"VFSPSCreOrderChooseDeviceInStockValue",ctx:this},VFSPSValidateIMEI);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreOrderPickOldMobileNumDOBValueImg","click",{ctx:this},VFSPSCreOrderCalender);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreOrderPickMobileNumFromResultDiv,.VFSPSCreOrderPickOldMobileNumFromResultDiv","click",{ctx:this},VFSPSCreOrderPickNewMobileNumber);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreOrderContextHelp","click",{ctx:this},VFSPSGetCreditContexualInfo);$(".VFSPSPreCreateOrderParDiv").delegate(".VFSPSCreateOrderAssetPinFldValue","keydown",{ctx:this},VFSPSCheckLengthFour)};function VFSPSGetCreditContexualInfo(e){var curId=$(this).attr("id");if(curId=="VFSPSCreOrderPreviousDOB"){VFSPSUdateUIFrameWork.VFSPSSelectContextualMessage("PortInPrepaidInfo")}else{if(curId=="VFSPSCreOrderPreviousAccountNum"){VFSPSUdateUIFrameWork.VFSPSSelectContextualMessage("PortInPostpaidInfo")}else{if(curId=="VFSPSCreOrderAssetPinContextHelpId"){VFSPSUdateUIFrameWork.VFSPSSelectContextualMessage("AssetPinInfo")}}}}function VFSPSEnableNextButton(){var ExistData=GetFieldValueOrderEntryLineItem();var AppletMap=SiebelApp.S_App.GetActiveView().GetAppletMap();var playbarapplet=AppletMap["VF SPS Prepay Task Playbar Applet - Top"];var ctrls=playbarapplet.GetControls();var NextBtn=ctrls.ButtonCreateOrder.GetInputName();var CanEnable=false;var canEnablenextCreOrerDiv=false;if(ExistData["salesType"]=="SIM + Device"){$(".VFSPSIMEIDiv").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");if(ExistData["AssetPIN"]!=""&&ExistData["NewIMEI"]!=""){var assetLen=ExistData["AssetPIN"].length;if(assetLen==4){canEnablenextCreOrerDiv=true}}}else{if(ExistData["salesType"]=="SIM Only"){$(".VFSPSIMEIDiv").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");if(ExistData["AssetPIN"]!=""&&ExistData["NewIMEI"]==""){var assetLen=ExistData["AssetPIN"].length;if(assetLen==4){canEnablenextCreOrerDiv=true}}}}if(ExistData["ConnectionType"]=="New Number"){if(ExistData["NewMSISDN"]!=""){CanEnable=true}}else{if(ExistData["ConnectionType"]=="Port In from other carrier"){if(ExistData["PostPay"]=="Y"){if(ExistData["NewMSISDN"]!=""&&ExistData["ExtAccountRef"]!=""&&ExistData["PortedMobileNumber"]!=""){CanEnable=true}}else{if(ExistData["PostPay"]=="N"){if(ExistData["NewMSISDN"]!=""&&ExistData["ExternalDOB"]!=""&&ExistData["PortedMobileNumber"]!=""){CanEnable=true}}}}}if(CanEnable==true&&canEnablenextCreOrerDiv==true){$("#"+NextBtn+"_Ctrl").removeClass("VFSPSPlaybarNextBtnDisabled").addClass("VFSPSPlaybarNextBtnEnabled");playbarapplet.DoExecuteUIUpdate()}else{$("#"+NextBtn+"_Ctrl").removeClass("VFSPSPlaybarNextBtnEnabled").addClass("VFSPSPlaybarNextBtnDisabled")}}function VFSPSCreOrderPickNewMobileNumber(e){var ExistData=GetFieldValueOrderEntryLineItem();var MobPickVal=$(this).children().html();var showPickDiv;if($(this).hasClass("VFSPSCreOrderPickMobileNumFromResultDiv")){showPickDiv="VFSPSCreOrderMobileNumSearchResultDivPar";$(".VFSPSCreOrderPickMobileValue").val(MobPickVal).attr("disabled","true");$(".VFSPSCreOrderPickMobileImg").attr("action","SelectionComplete");$(".VFSPSCreOrderPickMobileImg").children("img").attr("src","images/VFSPSCrossMark.png")}else{if($(this).hasClass("VFSPSCreOrderPickOldMobileNumFromResultDiv")){showPickDiv="VFSPSCreOrderOldMobileNumSearchResultDivPar";$(".VFSPSCreOrderOldPickMobileSearchValue").val(MobPickVal).attr("disabled","true");$(".VFSPSCreOrderPickOldMobileSearchImg").attr("action","SelectionComplete");$(".VFSPSCreOrderPickOldMobileSearchImg").children("img").attr("src","images/VFSPSCrossMark.png")}}$("."+showPickDiv).hide();SetFocusToControl("VF SPS New MSISDN");SetFieldValueOrderEntryLineItem("New MSISDN",MobPickVal);VFSPSEnableNextButton()}function VFSPSCreOrderCalender(e){var selector=".VFSPSCreOrderPickOldMobileNumDOBValue";var currentVal=$(this).siblings("input").val();VFSPSUdateUIFrameWork.ShowDatePicker("",selector,"HTML",currentVal,"100:0","");VFSPSEnableNextButton()}function VFSPSValidateIMEI(e){if($(this).attr("action")=="Search"){$(".VFSPSCreOrderPickMobileFldInp").removeClass("VFSTextFilledBorderColour");$(this).attr("action","ValidationComplete");$(this).children("img").attr("src","images/VFSPSCrossMark.png");$(".VFSPSCreOrderChooseDeviceInStockValue").attr("disabled","true");var typeClass=e.data.typeClass;if(typeClass=="VFSPSCreOrderChooseDeviceInStockValue"){curVal=$("."+typeClass).val();var BSName="VF SPS Prepaid Utilities";var Method="validateIMEI";var Inputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("IMEI",curVal);var outs=VFCustomSiebelInterface.CallBS(BSName,Method,Inputs,{});var status=outs.GetProperty("sStatus");if(status=="Valid"){SetFocusToControl("VF SPS New IMEI");SetFieldValueOrderEntryLineItem("New IMEI",curVal)}}}else{$(this).attr("action","Search");$(this).children("img").attr("src","images/VFSPSSearchICON.png");$(".VFSPSCreOrderChooseDeviceInStockValue").val("").removeAttr("disabled");SetFocusToControl("VF SPS New IMEI");SetFieldValueOrderEntryLineItem("New IMEI","")}VFSPSEnableNextButton()}function VFSPSCalSetFieldVal(e){var typeClass=e.data.typeClass;var curVal;if(typeClass=="VFSPSCreOrderPickOldMobileValue"){curVal=$("."+typeClass).val();SetFieldValueOrderEntryLineItem("Ported Mobile Number",curVal)}else{if(typeClass=="VFSPSCreateOrderAssetPinFldValue"){curVal=$("."+typeClass).val();SetFieldValueOrderEntryLineItem("New PIN",curVal)}}VFSPSEnableNextButton()}function VFSPSInvokePortIn(e){var PickOldMob=false;var PickType="";$(".VFSPSCreOrderOldMobilePlanTypeRadio").each(function(index){if($(this).is(":checked")){PickOldMob=true;PickType=$(this).val();switch(PickType){case ("Postpaid number"):PickType="PostPaid";break;case ("Prepaid number"):PickType="PrePaid";break;default:}}});if(PickOldMob&&PickType=="PostPaid"){var AcctNum=$(".VFSPSCreOrderPickOldMobileAcctNumValue").val();var OldNum=$(".VFSPSCreOrderPickOldMobileValue").val();var NewNum=$(".VFSPSCreOrderOldPickMobileSearchValue").val();var errMsg="Please enter";if(OldNum==""){errMsg=errMsg+" current mobile number"}if(AcctNum==""){if(errMsg!="Please enter"){errMsg=errMsg+" and previous service account number"}else{errMsg=errMsg+" previous service account number"}}if(NewNum==""){if(errMsg=="Please enter current mobile number and previous service account number"){errMsg="Please enter current mobile number, previous service account number and new mobile number"}else{if(errMsg!="Please enter"){errMsg=errMsg+" and new mobile number"}else{errMsg=errMsg+" new mobile number"}}}if(errMsg!="Please enter"){alert(errMsg)}SetFocusToControl("VF SPS Post Pay");SetFieldValueOrderEntryLineItem("Post Pay","Y");SetFocusToControl("VF SPS Ext Account Ref");SetFieldValueOrderEntryLineItem("Ext Account Ref",AcctNum);SetFocusToControl("VF SPS Ported Mobile Number");SetFieldValueOrderEntryLineItem("Ported Mobile Number",OldNum);SetFocusToControl("VF SPS New MSISDN");SetFieldValueOrderEntryLineItem("New MSISDN",NewNum);var ExistData=GetFieldValueOrderEntryLineItem();if(ExistData["ExternalDOB"]!=""){SetFocusToControl("VF SPS External DOB");SetFieldValueOrderEntryLineItem("External DOB","")}VFSPSEnableNextButton()}else{var DOB=$(".VFSPSCreOrderPickOldMobileNumDOBValue").val();var OldNum=$(".VFSPSCreOrderPickOldMobileValue").val();var NewNum=$(".VFSPSCreOrderOldPickMobileSearchValue").val();var errMsg="Please enter";if(OldNum==""){errMsg=errMsg+" current mobile number"}if(DOB==""){if(errMsg!="Please enter"){errMsg=errMsg+" and date of birth"}else{errMsg=errMsg+" date of birth"}}if(NewNum==""){if(errMsg=="Please enter current mobile number and date of birth"){errMsg="Please enter current mobile number, date of birth and new mobile number"}else{if(errMsg!="Please enter"){errMsg=errMsg+" and new mobile number"}else{errMsg=errMsg+" new mobile number"}}}if(errMsg!="Please enter"){alert(errMsg)}SetFocusToControl("VF SPS Post Pay");SetFieldValueOrderEntryLineItem("Post Pay","N");SetFocusToControl("VF SPS Ported Mobile Number");SetFieldValueOrderEntryLineItem("Ported Mobile Number",OldNum);SetFocusToControl("VF SPS External DOB");if(DDMMYYDateFormat==true){DOB=VFTabletNavigation.VFSPSGetVHADateFormat(DOB);SetFieldValueOrderEntryLineItem("External DOB",DOB)}else{if(DDMMYYDateFormat==false){SetFieldValueOrderEntryLineItem("External DOB",DOB);DDMMYYDateFormat=true}}SetFocusToControl("VF SPS New MSISDN");SetFieldValueOrderEntryLineItem("New MSISDN",NewNum);var ExistData=GetFieldValueOrderEntryLineItem();if(ExistData["ExtAccountRef"]!=""){SetFocusToControl("VF SPS Ext Account Ref");SetFieldValueOrderEntryLineItem("Ext Account Ref","")}VFSPSEnableNextButton()}}function VFSPSCreateOrderDivPopulateData(ExistData){if(ExistData["salesType"]=="SIM + Device"){$("#VFSPSCreateOrderChooseServiceRadio").prop("checked",false);$("#VFSPSSIMWithDevice").prop("checked",true)}else{if(ExistData["salesType"]=="SIM Only"){$("#VFSPSCreateOrderChooseServiceRadio").prop("checked",false);$("#VFSPSSIMOnly").prop("checked",true)}}if(ExistData["NewIMEI"]!=""){$(".VFSPSCreOrderChooseDeviceInStockValue ").val(ExistData["NewIMEI"]);$(".VFSPSCreOrderPickIMEIImg ").attr("action","ValidationComplete");$(".VFSPSCreOrderPickIMEIImg").children("img").attr("src","images/VFSPSCrossMark.png");$(".VFSPSCreOrderChooseDeviceInStockValue").attr("disabled","true")}else{$(".VFSPSCreOrderChooseDeviceInStockFldInp").addClass("VFSTextFilledBorderColour")}if(ExistData["AssetPIN"]!=""){$(".VFSPSCreateOrderAssetPinFldValue").val(ExistData["AssetPIN"])}else{if(ExistData["AssetPIN"]==""){var assetPinVal=SiebelApp.S_App.GetProfileAttr("NewCAPIN");$(".VFSPSCreateOrderAssetPinFldValue").val(assetPinVal);SetFocusToControl("VF SPS Asset PIN");SetFieldValueOrderEntryLineItem("New PIN",assetPinVal)}}}function GetFieldValueOrderEntryLineItem(){var busObj=SiebelApp.S_App.GetActiveBusObj();var bc=busObj.GetBusCompByName("VF SPS New Account Contact PrePay TBC");var ExistData={};ExistData["AssetPIN"]=bc.GetFieldValue("New PIN");ExistData["salesType"]=bc.GetFieldValue("Sales Type");ExistData["ConnectionType"]=bc.GetFieldValue("Connection Type");ExistData["ExternalDOB"]=bc.GetFieldValue("External DOB");ExistData["NewMSISDN"]=bc.GetFieldValue("New MSISDN");ExistData["PortedMobileNumber"]=bc.GetFieldValue("Ported Mobile Number");ExistData["ExtAccountRef"]=bc.GetFieldValue("Ext Account Ref");ExistData["NewIMEI"]=bc.GetFieldValue("New IMEI");ExistData["PostPay"]=bc.GetFieldValue("Post Pay");ExistData["RowId"]=bc.GetFieldValue("VF SPS Customer Id");ExistData["DOB"]=bc.GetFieldValue("DOB");return ExistData}function VFSPSCheckLengthFour(e){if((event.which!=8)&&(event.which!=46)){var val=$(this).val();if(val.length==4){event.preventDefault();event.stopPropagation()}}}function VFSPSOpenAccordDetails(e){var parent=$(this).parent().parent();var curClass;if(parent.hasClass("VFSPSPreCreateorderInactive")){parent.addClass("VFSPSCreateorderActive").removeClass("VFSPSPreCreateorderInactive");curClass="VFSPSCreateorderActive"}else{parent.addClass("VFSPSPreCreateorderInactive").removeClass("VFSPSCreateorderActive");curClass="VFSPSPreCreateorderInactive"}var ExistData=GetFieldValueOrderEntryLineItem();if($(this).hasClass("VFSPSCreOrderChooseMobileTitle")){VFSPSPopulateMobileNumber(ExistData,curClass);if(parent.hasClass("VFSPSPreCreateorderInactive")){$("#VFSPSCreateOrderMobileAccordImg").attr("src","images/VFSPSSelCusChooseMobileNumpng.png")}else{$("#VFSPSCreateOrderMobileAccordImg").attr("src","images/VFSPSSelCusChooseMobileNumpng_White.png")}}else{if($(this).hasClass("VFSPSPreCreateOrderTitle")){VFSPSCreateOrderDivPopulateData(ExistData);if(parent.hasClass("VFSPSPreCreateorderInactive")){$("#VFSPSPreCreateOrderAccordImg").attr("src","images/VFSPSChoosePlanClosePrepayImg.png")}else{$("#VFSPSPreCreateOrderAccordImg").attr("src","images/VFSPSChoosePlanOpenPrepayImg.png")}}else{if($(this).hasClass("VFSPSPreCreOrderIMEITitle")){VFSPSCreateOrderDivPopulateData(ExistData);if(parent.hasClass("VFSPSPreCreateorderInactive")){$("#VFSPCreateOrderSIMEInumberAccordImg").attr("src","images/VFSPSSelCusSelectDevice.png")}else{$("#VFSPCreateOrderSIMEInumberAccordImg").attr("src","images/VFSPSSelCusSelectDevice_White.png")}}}}}function VFSPSPopulateMobileNumber(ExistData,curClass){if(curClass=="VFSPSCreateorderActive"){if(ExistData["ConnectionType"]==""){console.log("Port In Type not found.")}else{if(ExistData["ConnectionType"]=="New Number"){$(".VFSPSCreOrderPickNewMobileNumberParDiv").show();$(".VFSPSCreOrderPickOldMobileNumberParDiv").hide();$(".VFSPSCreOrderChooseMobileNewRadio").attr("checked","true");$(".VFSPSCreOrderChooseMobileOldRadio").removeAttr("checked");$(".VFSPSCreOrderPickMobileFldInp").val("");if(ExistData["NewMSISDN"]==""){$(".VFSPSCreOrderPickMobileValue").val("").removeAttr("disabled");$(".VFSPSCreOrderPickMobileImg").attr("action","Search");$(".VFSPSCreOrderPickMobileImg").children("img").attr("src","images/VFSPSSearchICON.png");$(".VFSPSCreOrderPickMobileFldInp").addClass("VFSTextFilledBorderColour")}else{$(".VFSPSCreOrderPickMobileValue").val(ExistData["NewMSISDN"]).attr("disabled","true");$(".VFSPSCreOrderPickMobileImg").attr("action","SearchComplete");$(".VFSPSCreOrderPickMobileImg").children("img").attr("src","images/VFSPSCrossMark.png");$(".VFSPSCreOrderPickMobileFldInp").removeClass("VFSTextFilledBorderColour")}}else{$(".VFSPSCreOrderPickNewMobileNumberParDiv").hide();$(".VFSPSCreOrderPickOldMobileNumberParDiv").show();if(ExistData["NewMSISDN"]==""){$(".VFSPSCreOrderOldPickMobileSearchValue ").val("").removeAttr("disabled");$(".VFSPSCreOrderPickOldMobileSearchImg ").attr("action","Search");$(".VFSPSCreOrderPickOldMobileSearchImg").children("img").attr("src","images/VFSPSSearchICON.png")}else{$(".VFSPSCreOrderOldPickMobileSearchValue ").val(ExistData["NewMSISDN"]).attr("disabled","true");$(".VFSPSCreOrderPickOldMobileSearchImg ").attr("action","SearchComplete");$(".VFSPSCreOrderPickOldMobileSearchImg").children("img").attr("src","images/VFSPSCrossMark.png")}$(".VFSPSCreOrderChooseMobileNewRadio").removeAttr("checked");$(".VFSPSCreOrderChooseMobileOldRadio").attr("checked","true");$(".VFSPSCreOrderPickOldMobileValue").val(ExistData["PortedMobileNumber"]);if(ExistData["PostPay"]=="Y"){$(".VFSPSCreOrderPickOldMobileNumAcctNumPar").show();$(".VFSPSCreOrderPickOldMobileNumDOBPar").hide();$(".VFSPSCreOrderOldMobilePlanTypePostPaidRadio").attr("checked","true");$(".VFSPSCreOrderOldMobilePlanTypePrePaidRadio").removeAttr("checked");$(".VFSPSCreOrderPickOldMobileAcctNumValue").val(ExistData["ExtAccountRef"])}else{if(ExistData["PostPay"]=="N"){$(".VFSPSCreOrderPickOldMobileNumAcctNumPar").hide();$(".VFSPSCreOrderPickOldMobileNumDOBPar").show();$(".VFSPSCreOrderOldMobilePlanTypePostPaidRadio").removeAttr("checked");$(".VFSPSCreOrderOldMobilePlanTypePrePaidRadio").attr("checked","true");if(ExistData["ExternalDOB"]==""){$(".VFSPSCreOrderPickOldMobileNumDOBValue").val(VFTabletNavigation.VFSPSGetVHADateFormat(ExistData["DOB"]));DDMMYYDateFormat=false}else{if(DDMMYYDateFormat!=false){DDMMYYDateFormat=false;$(".VFSPSCreOrderPickOldMobileNumDOBValue").val(VFTabletNavigation.VFSPSGetVHADateFormat(ExistData["ExternalDOB"]))}else{$(".VFSPSCreOrderPickOldMobileNumDOBValue").val(ExistData["ExternalDOB"])}}}else{console.log("Port In Type not found.")}}}}}}function VFSPSScanIMEI(e){var requestData={"Key":"IMEI"};if(typeof(VHAWrapper)=="undefined"){var retVal=VHAWrapperSTUB?VHAWrapperSTUB.ScanBarcode(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0;retVal="1"}else{var retVal=VHAWrapper?VHAWrapper.scanBarcode(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0}if(retVal){}else{alert("Could not start Bar code scanner, please proceed with manual entry.")}}function VFSPSSearchMobileNumber(e){if($(this).attr("action")=="Search"){$(".VFSPSCreOrderPickMobileFldInp").removeClass("VFSTextFilledBorderColour");var showDiv;if($(this).hasClass("VFSPSCreOrderPickMobileImg")){showDiv="VFSPSCreOrderMobileNumSearchResultDivPar"}else{if($(this).hasClass("VFSPSCreOrderPickOldMobileSearchImg")){showDiv="VFSPSCreOrderOldMobileNumSearchResultDivPar"}}var BSName="VF SPS TBUI Utilities";var Method="GetMSISDN";var Inputs=SiebelApp.S_App.NewPropertySet();var SearchMSISDN=$(this).siblings("input").val();if(SearchMSISDN.length){if(SearchMSISDN.length>2&&SearchMSISDN.length<6){SearchMSISDN="*"+SearchMSISDN+"*"}}Inputs.SetProperty("MSISDN",SearchMSISDN);VFSPSUdateUIFrameWork.VFSPSBlockUI("");setTimeout(function(){try{var outs=VFCustomSiebelInterface.CallBS(BSName,Method,Inputs,{});var NumCount=outs.GetChildCount();if(NumCount){for(var i=0;i<NumCount&&i<4;i++){var CurrChild=outs.GetChild(i);var MSISDN=CurrChild.GetProperty("MSISDN");if(showDiv=="VFSPSCreOrderMobileNumSearchResultDivPar"){$("#VFSPSCreOrderMobileNum"+Number(i+1)+" span").html(MSISDN)}else{$("#VFSPSCreOrderOldMobileNum"+Number(i+1)+" span").html(MSISDN)}}$("."+showDiv).show()}else{$("."+showDiv).hide()}VFSPSUdateUIFrameWork.VFSPSUnblockUI()}catch(e){console.log(e.message)}finally{}},1000)}else{$(this).attr("action","Search");$(this).children("img").attr("src","images/VFSPSSearchICON.png");$(this).siblings("input").val("").removeAttr("disabled");SetFieldValueOrderEntryLineItem("New MSISDN","")}VFSPSEnableNextButton()}function SetFieldValueOrderEntryLineItem(FieldName,Value){var app=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Order Line Item Details Applet - TBUI");var BC=app.GetBusComp();if(FieldName!="External DOB"){BC.SetFieldValue(FieldName,Value)}else{BC.SetFormattedValue(FieldName,Value)}}function VFSPSRadioButtonSelect(e){var typeClass=e.data.typeClass;$("."+typeClass).prop("checked",false);$(this).prop("checked",true);var value=$(this).val();switch(typeClass){case ("VFSPSCreateOrderChooseServiceRadio"):if(value=="SIMWithDevice"){$(".VFSPSIMEIDiv").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");SetFieldValueOrderEntryLineItem("Sales Type","SIM + Device")}else{$(".VFSPSIMEIDiv").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");var ExistData=GetFieldValueOrderEntryLineItem();if(ExistData["NewIMEI"]!=""){SetFieldValueOrderEntryLineItem("New IMEI","")}SetFieldValueOrderEntryLineItem("Sales Type","SIM Only")}VFSPSEnableNextButton();break;case ("VFSPSCreOrderChooseMobileRadio"):VFSPSCreOrderChooseMobileRadio(e);break;case ("VFSPSCreOrderOldMobilePlanTypeRadio"):VFSPSCreOrderOldMobilePlanTypeRadio(e);break;default:}}function VFSPSCreOrderChooseMobileRadio(e){var PickNewMob=false;var PickType="";var ExistData=GetFieldValueOrderEntryLineItem();$(".VFSPSCreOrderChooseMobileRadio").each(function(index){if($(this).is(":checked")){PickNewMob=true;PickType=$(this).val();switch(PickType){case ("I want to get a new number"):PickType="New";break;case ("I want to keep my current number"):PickType="Old";break;default:}}});if(PickNewMob&&PickType=="New"){$(".VFSPSCreOrderPickNewMobileNumberParDiv").show();$(".VFSPSCreOrderPickOldMobileNumberParDiv").hide();if(ExistData["ConnectionType"]=="New Number"){}else{SetFocusToControl("VF SPS Connection Type");SetFieldValueOrderEntryLineItem("Connection Type","New Number");setProfileAttr("VFTBUIConnType","New Number");if(ExistData["PortedMobileNumber"]!=""){SetFocusToControl("VF SPS Ported Mobile Number");SetFieldValueOrderEntryLineItem("Ported Mobile Number","")}if(ExistData["PostPay"]!=""){SetFocusToControl("VF SPS Post Pay");SetFieldValueOrderEntryLineItem("Post Pay","")}if(ExistData["ExtAccountRef"]!=""){SetFocusToControl("VF SPS Ext Account Ref");SetFieldValueOrderEntryLineItem("Ext Account Ref","")}if(ExistData["ExternalDOB"]!=""){SetFocusToControl("VF SPS External DOB");SetFieldValueOrderEntryLineItem("External DOB","")}if(ExistData["NewMSISDN"]!=""){$(".VFSPSCreOrderPickMobileValue").val(ExistData["NewMSISDN"]).attr("disabled","true");$(".VFSPSCreOrderPickMobileImg").attr("action","SearchComplete");$(".VFSPSCreOrderPickMobileImg").children("img").attr("src","images/VFSPSCrossMark.png")}else{$(".VFSPSCreOrderPickMobileValue").val("").removeAttr("disabled");$(".VFSPSCreOrderPickMobileImg").attr("action","Search");$(".VFSPSCreOrderPickMobileImg").children("img").attr("src","images/VFSPSSearchICON.png")}VFSPSEnableNextButton()}}else{$(".VFSPSCreOrderPickNewMobileNumberParDiv").hide();$(".VFSPSCreOrderPickOldMobileNumberParDiv").show();if(ExistData["ConnectionType"]=="New Number"){SetFocusToControl("VF SPS Connection Type");SetFieldValueOrderEntryLineItem("Connection Type","Port In from other carrier");setProfileAttr("VFTBUIConnType","Port In from other carrier");if(ExistData["NewMSISDN"]!=""){$(".VFSPSCreOrderOldPickMobileSearchValue").val(ExistData["NewMSISDN"]).attr("disabled","true");$(".VFSPSCreOrderPickOldMobileSearchImg").attr("action","SearchComplete");$(".VFSPSCreOrderPickOldMobileSearchImg").children("img").attr("src","images/VFSPSCrossMark.png")}else{$(".VFSPSCreOrderOldPickMobileSearchValue").val("").removeAttr("disabled");$(".VFSPSCreOrderPickOldMobileSearchImg").attr("action","Search");$(".VFSPSCreOrderPickOldMobileSearchImg").children("img").attr("src","images/VFSPSSearchICON.png")}}else{}VFSPSEnableNextButton()}}function VFSPSCreOrderOldMobilePlanTypeRadio(e){var PickOldMob=false;var PickType="";$(".VFSPSCreOrderOldMobilePlanTypeRadio").each(function(index){if($(this).is(":checked")){PickOldMob=true;PickType=$(this).val();switch(PickType){case ("Postpaid number"):PickType="PostPaid";break;case ("Prepaid number"):PickType="PrePaid";break;default:}}});if(PickOldMob&&PickType=="PostPaid"){$(".VFSPSCreOrderPickOldMobileNumAcctNumPar").show();$(".VFSPSCreOrderPickOldMobileNumDOBPar").hide();SetFocusToControl("VF SPS Post Pay");SetFieldValueOrderEntryLineItem("Post Pay","Y");var ExistData=GetFieldValueOrderEntryLineItem();if(ExistData["ExtAccountRef"]!=""){$(".VFSPSCreOrderPickOldMobileAcctNumValue").val(ExistData["ExtAccountRef"])}VFSPSEnableNextButton()}else{$(".VFSPSCreOrderPickOldMobileNumAcctNumPar").hide();$(".VFSPSCreOrderPickOldMobileNumDOBPar").show();SetFocusToControl("VF SPS Post Pay");SetFieldValueOrderEntryLineItem("Post Pay","N");var ExistData=GetFieldValueOrderEntryLineItem();if(ExistData["ExternalDOB"]!=""){if(DDMMYYDateFormat!=false){$(".VFSPSCreOrderPickOldMobileNumDOBValue").val(VFTabletNavigation.VFSPSGetVHADateFormat(ExistData["ExternalDOB"]));DDMMYYDateFormat=false}else{$(".VFSPSCreOrderPickOldMobileNumDOBValue").val(ExistData["ExternalDOB"])}}else{DDMMYYDateFormat=false;$(".VFSPSCreOrderPickOldMobileNumDOBValue").val(VFTabletNavigation.VFSPSGetVHADateFormat(ExistData["DOB"]))}VFSPSEnableNextButton()}}function SetFocusToControl(ControlName){var app=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Order Line Item Details Applet - TBUI");var controls=app.GetControls();app.SetFocusToCtrl(controls[ControlName].GetName(),true)}function setProfileAttr(ProfileAttrName,ProfileAttrValue){var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("Profile Attribute Name",ProfileAttrName);Input.SetProperty("Profile Attribute Value",ProfileAttrValue);Output=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",Input,{})}return VFSPSCreateOrderPrepaidAppletPR}());return"SiebelAppFacade.VFSPSCreateOrderPrepaidAppletPR"})};