if(typeof(VFSPSIDCaptureInterface)==="undefined"){var VFSPSIDCaptureInterface={};VFSPSIDCaptureInterface.VFSPSShowIDList=function(){var PriLength=VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo.length;if(PriLength==0){VFCustomSiebelInterface.GetIdList();PriLength=VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo.length}var BO=SiebelApp.S_App.GetActiveBusObj();var BC=BO.GetBusCompByName("VF Capture Customer Details TBC");var sCustomerType=BC.GetFieldValue("Customer Type");$("#openModal").remove();$("#openModal_C").remove();if(!$("#openModal").length){$("body").append(GetIDTemplate())}$("#openModal #VFSPSPrimaryIDTypesIDDetails").html("");for(var i=0;i<PriLength;i++){var Points=VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Points+" points";if(VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Type=="Letter of Authority"){Points=""}if((sCustomerType=="Person"&&VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Type!="Letter of Authority")||sCustomerType!="Person"){var Template='<div class="VFSPSIDTypeLine VFSPSIDTypeLineSelect" Type="'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Type+'" Points="'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Points+'" IsPrimary="'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Primary+'" ProofOFAddress="'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].ProofOfAddress+'">																			<div class="VFSPSIDType">'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Type+'</div>																			<div class="VFSPSIDTypeChevron">'+Points+'</div>																			<span class="VFSPSIDTypeEndTag">></span>																			<div class="VFSPSLineSpace"></div>																			</div>';$("#VFSPSPrimaryIDTypesIDDetails").append(Template)}}if(VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo.length){$("#VFSPSPrimaryIDTypesIDDetails").append('<div class="VFSPSIDTypeLine">																			<div class="VFSPSIDType" id="VFSPSShowMoreID">More ID Types</div>																			<div class="VFSPSIDPoints"></div>																			</div>')}$("#openModal").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#openModal").undelegate();$("#openModal").delegate(".VFSPSDialogClose","click",{},function(e){$("#openModal").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")});$("#openModal").delegate("#VFSPSShowMoreID","click",{},VFSPSShowMoreIds);$("#openModal").delegate(".VFSPSIDTypeLineSelect","click",{"Popup":"SMALL"},VFSPSScanID)};function VFSPSShowMoreIds(e){$("#openModal").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#openModal").remove();$("#openModal_C").remove();if(!$("#openModal_C").length){$("body").append(GetCompleteIDTemplate())}$("#openModal_C #VFSPSPrimaryIDTypesIDDetails").html("");for(var i=0;i<VFCustomSiebelInterface.PrimaryIDList.length;i++){var Template='<div class="VFSPSIDTypeLine VFSPSIDTypeLineSelect" Points="'+VFCustomSiebelInterface.PrimaryIDList[i].Points+'" Type="'+VFCustomSiebelInterface.PrimaryIDList[i].Type+'" IsPrimary="'+VFCustomSiebelInterface.PrimaryIDList[i].Primary+'" ProofOFAddress="'+VFCustomSiebelInterface.PrimaryIDList[i].ProofOfAddress+'">																			<div class="VFSPSIDType">'+VFCustomSiebelInterface.PrimaryIDList[i].Type+'</div>																			<div class="VFSPSIDTypeChevron">'+VFCustomSiebelInterface.PrimaryIDList[i].Points+' points</div>																			<span class="VFSPSIDTypeEndTag">></span>																			<div class="VFSPSLineSpace"></div>																			</div>';$("#openModal_C #VFSPSPrimaryIDTypesIDDetails").append(Template)}$("#openModal_C #VFSPSSecondraryIDTypes").html("");for(var i=0;i<VFCustomSiebelInterface.SecondaryIDList.length;i++){var Template='<div class="VFSPSIDTypeLine VFSPSIDTypeLineSelect" Type="'+VFCustomSiebelInterface.SecondaryIDList[i].Type+'" Points="'+VFCustomSiebelInterface.SecondaryIDList[i].Points+'" IsPrimary="'+VFCustomSiebelInterface.SecondaryIDList[i].Primary+'" ProofOFAddress="'+VFCustomSiebelInterface.SecondaryIDList[i].ProofOfAddress+'">																			<div class="VFSPSIDType">'+VFCustomSiebelInterface.SecondaryIDList[i].Type+'</div>																			<div class="VFSPSIDTypeChevron">'+VFCustomSiebelInterface.SecondaryIDList[i].Points+' points</div>																			<span class="VFSPSIDTypeEndTag">></span>																			<div class="VFSPSLineSpace"></div>																			</div>';$("#openModal_C #VFSPSSecondraryIDTypes").append(Template)}$("#openModal_C").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#openModal_C").delegate(".VFSPSDialogClose,span.VFSPSMoreIdCancel","click",{},function(e){$("#openModal_C").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")});$("#openModal_C").delegate(".VFSPSIDTypeLineSelect","click",{"Popup":"MORE"},VFSPSScanID)}function VFSPSScanID(e){var cardType=$(this).attr("type");var points=$(this).attr("Points");var IsPrimary=$(this).attr("IsPrimary");var ProofOAddress=$(this).attr("ProofOfAddress");VFTabletIntegrationConstants.SetConstants("VFSPSCardType",cardType);if(cardType=="Driver's Licence"||cardType=="Learner's Permit"||cardType=="Proof of Age Card"){if(e.data.Popup=="MORE"){$("#openModal_C").remove();$("#openModal").remove();if(!$("#openModal").length){$("body").append(GetIDTemplate())}}var StateArray=["New South Wales","Northern Territory","Queensland","South Australia","Tasmania","Victoria","Western Australia"];var stateShortArray=VFCustomSiebelInterface.GetPickListValues("VF_ID_ISSUER","");$("#openModal #VFSPSPrimaryIDTypesIDDetails").html("");$("#openModal .VFSPSIDPopUpHeader").html("Choose 1 of the following State");for(var i=0;i<stateShortArray.length;i++){var Template='<div class="VFSPSIDTypeLine VFSPSStateLineSelect" Type="'+stateShortArray[i]+'">																								<div class="VFSPSIDType">'+stateShortArray[i]+'</div>																								<div class="VFSPSIDTypeChevron"></div>																								<div class="VFSPSLineSpace"></div>																								</div>';$("#VFSPSPrimaryIDTypesIDDetails").append(Template)}$("#openModal").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#openModal").delegate(".VFSPSStateLineSelect","click",{cardType:cardType,points:points,IsPrimary:IsPrimary,ProofOAddress:ProofOAddress},VFSPSGetState)}else{VFSPSStartScanID(cardType,points,IsPrimary,ProofOAddress,"")}}function VFSPSGetState(e){var state=$(this).attr("type");VFSPSStartScanID(e.data.cardType,e.data.points,e.data.IsPrimary,e.data.ProofOAddress,state)}function VFSPSMapCardType(CardType,State){var sCardMap="";switch(CardType){case ("Learner's Permit"):case ("Driver's Licence"):sCardMap=State.toUpperCase()+"_"+"LICENCE";break;case ("Passport"):sCardMap="PASSPORT";break;case ("Armed Forces ID"):sCardMap="Armed Forces ID";break;case ("Police ID"):sCardMap="Police ID";break;case ("Medicare Card"):sCardMap="MEDICARE";break;case ("Credit Card"):sCardMap="CREDIT_CARD";break;case ("Proof of Age Card"):sCardMap=State.toUpperCase()+"_PROOFOFAGE";break;case ("Pensioner Card"):sCardMap="PENSION_AUS";break;case ("Utility Bill"):sCardMap="UTILITYBILL";break;default:sCardMap=CardType}return sCardMap}function VFSPSStartScanID(cardType,points,IsPrimary,ProofOAddress,State){$(".VFSPSIDError,.VFSPSIDCaptureMsg,.VFSPSIDCaptureSuccessmsg").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSIDCaptureUploadbtn").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");var appletId=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureApplet");var appletName=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureAppletName");var bo1=SiebelApp.S_App.GetActiveBusObj();var OCRCardMap=VFSPSMapCardType(cardType,State);var bc1=bo1.GetBusCompByName("VF Capture Customer Details TBC");var sessionId=bc1.GetFieldValue("Session Id");VFTabletIntegrationConstants.SessionArray={"cardType":cardType,"points":points,"state":State};ProofOAddress=typeof(ProofOAddress)=="undefined"?"N":ProofOAddress;IsPrimary=typeof(IsPrimary)=="undefined"?"N":IsPrimary;var requestData={"Key":"OCRScanID","SettingsData":"","MetaData":"","RequestParam":{"CardType":OCRCardMap,"SessionID":sessionId,"IsImageReq":"True","ReturnData":[{"cardType":cardType,"state":State,"points":points,"ProofOAddress":ProofOAddress,"IsPrimary":IsPrimary,"appletId":appletId,"appletName":appletName}]}};$("#openModal,#openModal_C").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");var IsIDTypeExist=VFTabletIntegrationConstants.GetConstants("IDTypeExist");if(typeof(VHAWrapper)=="undefined"){var retVal=VHAWrapperSTUB?VHAWrapperSTUB.scanIDUsingOCR(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0;retVal=1}else{var retVal=VHAWrapper?VHAWrapper.scanIDUsingOCR(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0}if(retVal){}else{responseData={"Key":"OCRScanID","Data":[{"Accuracy":[],"Value":[{"cardType":cardType,"state":State,"points":points,"ProofOAddress":ProofOAddress,"IsPrimary":IsPrimary,"appletId":appletId,"appletName":appletName}],"Key":"ReturnData"}],"StatusCode":"200","StatusMessage":"Success message"};VFTabletIntegration.Success(JSON.stringify(responseData));alert("Could not initiate Bar code scaning. Please go ahead with manual entry.")}}function GetIDTemplate(){return(' <div id = "openModal" class = "modalDialog VFSPSDisplayNone">  																 <div>  																 <span  title = "Close" class = "VFSPSDialogClose" ><img src="images/vfspsclose.jpg"></span>  																 <h2 class="VFSPSIDPopUpHeader"> Choose ID Type </h2>  																 <div id = "VFSPSPrimaryIDTypesIDDetails">  																 </div>  																 </div>  																 </div> ')}function GetCompleteIDTemplate(){return(' <div id = "openModal_C" class = "modalDialog_C VFSPSDisplayNone">  																 <div>  																 <div>																 <span  title = "Close" class = "VFSPSDialogClose" ><img src="images/vfspsclose.jpg"></span>  																 <h2> Identification List </h2>  																 <h3>Primary Documentation</h3>																 <div id = "VFSPSPrimaryIDTypesIDDetails">  																 </div>  																 <h3>Secondrary Documentation</h3>																  <div id = "VFSPSSecondraryIDTypes">  																 </div>  																 </div>  																 </div>																 <span class="VFSPSMoreIdCancel"><span>Cancel</span></span>																 </div> ')}function VFSPSIDPointsCalc(){SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();var applet=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Task Playbar Applet - Top");IDPoints=0;var IDCaptureStatus;for(i=1;i<=4;i++){SiebelBusComp=SiebelBusObj.GetBusCompByName("VFSPSIDDetailsTBC"+i);IDPoints=IDPoints+SiebelBusComp.GetFieldValue("VF Points Postpay")*1}var totalpoints=100;var pointsleft=totalpoints-IDPoints;if(pointsleft>=0&&pointsleft<=100){$("#VFSPSPointsLeft").text(pointsleft+" points left")}else{IDPoints=100}switch(IDPoints){case (100):width="100%";$("#VFSPSPointsLeft").text("You have 100 points of ID!");$("#VFSPSTotalProgress").removeClass().addClass("VFSPSIDFullPoints");IDCaptureStatus="true";break;case (0):width=0;$("#VFSPSTotalProgress").removeClass().addClass("VFSPSIDZeroPoints");IDCaptureStatus="false";break;default:var nextVal=(Math.floor(IDPoints/10))*10;$("#VFSPSTotalProgress").removeClass().addClass("VFSPSIDPoints"+nextVal);IDCaptureStatus="false";break}VFTabletIntegrationConstants.SetConstants("IDCaptureStatus",IDCaptureStatus);applet.DoExecuteUIUpdate()}VFSPSIDCaptureInterface.VFSPSClearIDDetails=function(){var appletId=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureApplet");var IDCaptureTBC=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureTBC");var appletName=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureAppletName");$("#s_"+appletId+"_div #VFSPIDTypeHeader").html("Choose an ID Type");var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("IDCaptureTBC",IDCaptureTBC);VFCustomSiebelInterface.CallBS("VF SPS IDCaputre BS","ClearIDDetails",Input,{});VFSPSIDPointsCalc();VFSPSIDCaptureInterface.VFSPSToggleIDFields(appletName,"",appletId);$("#s_"+appletId+"_div input").removeClass("VFSTextFilledBorderColour VFSDefaultBorderColour")};VFSPSIDCaptureInterface.VFSPSToggleIDFields=function(appletName,cardType,appletId){var sActiveView=SiebelApp.S_App.GetActiveView();var IDCaptureApplet1=sActiveView.GetApplet(appletName);var IDCtrls1=IDCaptureApplet1.GetControls();if($("#s_"+appletId+"_div").has("#VFSPSIDCountryDropDown,#VFSPSIDStateDropDown").length==0){$("input[name='"+IDCtrls1.CountryOfIssue.GetInputName()+"']").attr("placeholder","--Select--").after('<img id="VFSPSIDCountryDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$("input[name='"+IDCtrls1.StateofIssue.GetInputName()+"']").attr("placeholder","--Select--").after('<img id="VFSPSIDStateDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true")}if(cardType=="Driver's Licence"||cardType=="Learner's Permit"||cardType=="Proof of Age Card"){$("input[name='"+IDCtrls1.StateofIssue.GetInputName()+"']").parent().closest("tr").show();$("input[name='"+IDCtrls1.CountryOfIssue.GetInputName()+"']").parent().closest("tr").hide();$("input[name='"+IDCtrls1.VFSPSLOAName.GetInputName()+"']").parent().closest("tr").hide();$("input[name='"+IDCtrls1.VFSPSLOADate.GetInputName()+"']").parent().closest("tr").hide()}else{if(cardType=="Passport"){$("input[name='"+IDCtrls1.CountryOfIssue.GetInputName()+"']").parent().closest("tr").show();$("input[name='"+IDCtrls1.StateofIssue.GetInputName()+"']").parent().closest("tr").hide();$("input[name='"+IDCtrls1.VFSPSLOAName.GetInputName()+"']").parent().closest("tr").hide();$("input[name='"+IDCtrls1.VFSPSLOADate.GetInputName()+"']").parent().closest("tr").hide()}else{if(cardType=="Letter of Authority"){$("input[name='"+IDCtrls1.VFSPSLOAName.GetInputName()+"']").parent().closest("tr").show();$("input[name='"+IDCtrls1.VFSPSLOADate.GetInputName()+"']").parent().closest("tr").show();if($(".VFSPSLOAOnLetter_Label").length>0){}else{$("span[id*=LOAName_Label").parent().append('<div id="VFSPSLOAOnLetter_Label" class="VFSPSLOAOnLetter_Label">(on letter)</div>')}$("input[name='"+IDCtrls1.StateofIssue.GetInputName()+"']").parent().closest("tr").hide();$("input[name='"+IDCtrls1.CountryOfIssue.GetInputName()+"']").parent().closest("tr").hide();$("input[name='"+IDCtrls1.IdReferenceNumber.GetInputName()+"']").parent().closest("tr").hide();$("input[name='"+IDCtrls1.ExpiryDate.GetInputName()+"']").parent().closest("tr").hide()}else{$("input[name='"+IDCtrls1.StateofIssue.GetInputName()+"'],input[name='"+IDCtrls1.CountryOfIssue.GetInputName()+"']").parent().closest("tr").hide();$("input[name='"+IDCtrls1.VFSPSLOAName.GetInputName()+"']").parent().closest("tr").hide();$("input[name='"+IDCtrls1.VFSPSLOADate.GetInputName()+"']").parent().closest("tr").hide();$("input[name='"+IDCtrls1.IdReferenceNumber.GetInputName()+"']").parent().closest("tr").show();$("input[name='"+IDCtrls1.ExpiryDate.GetInputName()+"']").parent().closest("tr").show()}}}VFSPSIDCaptureInterface.VFSPSEnableNextButton("","",appletName)};VFSPSIDCaptureInterface.VFSPSCheckIDTypeExist=function(cardtype){var SiebelBusComp,SiebelBusObj;SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();var IDCaptureTBC=false;for(i=1;i<=4;i++){SiebelBusComp=SiebelBusObj.GetBusCompByName("VFSPSIDDetailsTBC"+i);var IDType=SiebelBusComp.GetFieldValue("ID type");if(cardtype==IDType){IDCaptureTBC="VFSPSIDDetailsTBC"+i;break}}return IDCaptureTBC};VFSPSIDCaptureInterface.GetIDCaptureBC=function(sActiveView,appletName,pm){var appletId=pm.Get("GetFullId");var IDCaptureApplet1=sActiveView.GetApplet(appletName);var IDCaptureTBC=IDCaptureApplet1.GetBusComp().GetName();VFTabletIntegrationConstants.SetConstants("VFSPSIDCaptureApplet",appletId);VFTabletIntegrationConstants.SetConstants("VFSPSIDCaptureAppletName",appletName);VFTabletIntegrationConstants.SetConstants("VFSPSIDCaptureTBC",IDCaptureTBC)};VFSPSIDCaptureInterface.VFSPSScannedIDType=function(sActiveView,appletName,pm,InputList){var appletId=pm.Get("GetFullId");var IDCaptureApplet1=sActiveView.GetApplet(appletName);var IDCaptureTBC=IDCaptureApplet1.GetBusComp().GetName();VFSPSIDPointsCalc();var SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();var SiebelBusComp=SiebelBusObj.GetBusCompByName(IDCaptureTBC);IDType=SiebelBusComp.GetFieldValue("ID type");VFSPSIDCaptureInterface.VFSPSToggleIDFields(appletName,IDType,appletId);if(IDType!=""){$("#s_"+appletId+"_div #VFSPIDTypeHeader").html(IDType);setTimeout(function(){VFSPSIDCaptureInterface.VFSPSEnableNextButton(pm,InputList,appletName)},50)}};VFSPSIDCaptureInterface.VFSPSEnableNextButton=function(pm,InputList,AppletName){var ActiveView=SiebelApp.S_App.GetActiveView();var IdApplet1=ActiveView.GetApplet(AppletName);var canContinue=false;if(VerifyIDTile(IdApplet1.GetPModel())){canContinue=true}else{canContinue=false}};function VerifyIDTile(pm){var controls=pm.Get("GetControls");var appletId=pm.Get("GetFullId");var InputList=["VFPointsPostpay","IdReferenceNumber","ExpiryDate","StateofIssue","CountryOfIssue","VFSPSLOADate","VFSPSLOAName"];var SelectedIDType=$("input[name='"+controls.IDtype.GetInputName()+"']").val();var InputListLength=InputList.length;var Continue=false;if(SelectedIDType==""){return Continue}for(var i=0;i<InputListLength;i++){var input=$("input[name='"+controls[InputList[i]].GetInputName()+"']");var Value=input.val();switch(InputList[i]){case ("StateofIssue"):if((SelectedIDType=="Driver's Licence"||SelectedIDType=="Learner's Permit"||SelectedIDType=="Proof of Age Card")&&Value==""){Continue=true}break;case ("CountryOfIssue"):if((SelectedIDType=="Passport")&&Value==""){Continue=true}break;case ("VFSPSLOADate"):case ("VFSPSLOAName"):if((SelectedIDType=="Letter of Authority")&&Value==""){Continue=true}break;default:if(Value==""){Continue=true}}if(Continue){input.removeClass("VFSDefaultBorderColour").addClass("VFSTextFilledBorderColour")}else{input.removeClass("VFSTextFilledBorderColour").addClass("VFSDefaultBorderColour")}if(Continue){break}}return Continue}};