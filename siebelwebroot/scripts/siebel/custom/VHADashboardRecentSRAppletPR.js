if(typeof(SiebelAppFacade.VHADashboardRecentSRAppletPR)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.VHADashboardRecentSRAppletPR");define("siebel/custom/VHADashboardRecentSRAppletPR",["order!siebel/jqgridrenderer"],function(){SiebelAppFacade.VHADashboardRecentSRAppletPR=(function(){function VHADashboardRecentSRAppletPR(pm){SiebelAppFacade.VHADashboardRecentSRAppletPR.superclass.constructor.call(this,pm);SiebelApp.EventManager.cleanListners("VHADashboardServiceRequestsIC");SiebelApp.EventManager.addListner("VHADashboardServiceRequestsIC",VHADashboardServiceRequestsIc,this)}SiebelJS.Extend(VHADashboardRecentSRAppletPR,SiebelAppFacade.JQGridRenderer);VHADashboardRecentSRAppletPR.prototype.ShowUI=function(){SiebelAppFacade.VHADashboardRecentSRAppletPR.superclass.ShowUI.call(this);VHADashboardServiceRequestsIc()};function VHADashboardServiceRequestsIc(e){var ParentIC=VHAAppUtilities.GetConstants("VHADashboardParentIC");if(!ParentIC){VHADashboardCommon.VHADasboardGetICProp("AssetHeader");ParentIC=VHAAppUtilities.GetConstants("VHADashboardParentIC")}var ServReqIC=ParentIC.GetChildByType("ListOfService Requests");var childcount=ServReqIC.GetChildCount();var ArrayDAta=new Array();var srnum;for(i=0;i<childcount;i++){var Propset=ServReqIC.GetChild(i);var tempArray=Propset.propArray;var tempArray1=new Array();if(tempArray["Status"]=="Open"){srnum=tempArray["SR Number"]+"Y"}else{srnum=tempArray["SR Number"]}tempArray1["SR #"]=srnum;tempArray1["Type"]=tempArray["SR Type"];tempArray1["Sub Area"]=tempArray["Sub-Area"];ArrayDAta.push(tempArray1)}$("#VHASRTable").jqGrid({datatype:"local",height:"100%",autowidth:true,data:ArrayDAta,shrinktofit:true,autoencode:true,ignoreCase:true,toolbar:[true,"top"],gridview:true,rowNum:5,pager:"#SRPager",loadonce:true,viewrecords:true,colNames:["SR #","Type","Sub Area"],colModel:[{name:"SR #",index:"SR #",width:20,search:true,formatter:function(cellvalue,options,rowObject){var lastChar=cellvalue.substr(cellvalue.length-1);if(lastChar=="Y"){cellvalue=cellvalue.substring(0,cellvalue.length-1)}return cellvalue},cellattr:function(val,rawObject,rdata){var celval=rdata["SR #"];var lch=celval.substr(celval.length-1);if(lch=="Y"){return' style="background-color: yellowgreen;"'}else{return}}},{name:"Type",index:"Type",width:40,search:true},{name:"Sub Area",index:"Sub Area",width:40,search:true}]})}VHADashboardRecentSRAppletPR.prototype.BindEvents=function(){SiebelAppFacade.VHADashboardRecentSRAppletPR.superclass.BindEvents.call(this);$("#SRSearch").on("keyup",function(){grid=$("#VHASRTable");var searchFiler=$("#SRSearch").val(),f;if(searchFiler.length===0){grid[0].p.search=false;$.extend(grid[0].p.postData,{filters:""})}f={groupOp:"OR",rules:[]};f.rules.push({field:"SR #",op:"cn",data:searchFiler});f.rules.push({field:"Type",op:"cn",data:searchFiler});f.rules.push({field:"Sub Area",op:"cn",data:searchFiler});grid[0].p.search=true;$.extend(grid[0].p.postData,{filters:JSON.stringify(f)});grid.trigger("reloadGrid",[{page:1,current:true}])});$("#VHAServiceReqbuttons").on("click","#VHASRExpandCollapse",{ctx:this},function(t){var sAW=$(this).closest(".siebel-MediumCards").find(".siebui-applet").width();$("#VHASRTable").jqGrid("setGridWidth",sAW-10,true);var sGridWdth=$(this).closest(".siebel-MediumCards").find(".siebui-applet").find(".ui-jqgrid").width();$("#VHAServiceReqbuttons").parent().siblings().toggle();$("#VHASRExpandCollapse").toggleClass("VHADashBoardAppExp").toggleClass("VHADashBoardAppColl");if($("#VHASRExpandCollapse").hasClass("VHADashBoardAppColl")){(!($(".siebel-MediumCards").addClass("MedCardsAdjHeight")))?$(".siebel-MediumCards").addClass("MedCardsAdjHeight"):""}if($("#VHASRExpandCollapse").hasClass("VHADashBoardAppExp")){if($("#VHANBAOffersExpandCollapse").hasClass("VHADashBoardAppExp")&&$("#VHAOrdersExpandCollapse").hasClass("VHADashBoardAppExp")&&$("#VHAOtherServExpandCollapse").hasClass("VHADashBoardAppExp")&&$("#VHASRExpandCollapse").hasClass("VHADashBoardAppExp")){($(".siebel-MediumCards").addClass("MedCardsAdjHeight"))?$(".siebel-MediumCards").removeClass("MedCardsAdjHeight"):""}}var t_this=$(this);setTimeout(function(){t_this.closest(".siebel-MediumCards").find(".siebui-applet").width(sGridWdth+10).addClass("HardCodedWidth");t_this.closest(".siebel-MediumCards").prev(".siebel-MediumCards").find(".siebui-applet").width(sGridWdth+10).addClass("HardCodedWidth");t_this.closest(".siebel-MediumCards").width(sGridWdth+20).addClass("HardCodedWidth");t_this.closest(".siebel-LineCards").width(sGridWdth+30).addClass("HardCodedWidth");var sNewWd=t_this.closest(".siebel-LineCards").width()*2;t_this.closest(".flex_row_container").width(sNewWd+8).addClass("HardCodedWidth");$(".siebel-InnerContainer.Left>.siebel-LineCards").width(sNewWd+8).addClass("HardCodedWidth");t_this.closest(".siebel-InnerContainer.Left").css("max-width",sNewWd+8).addClass("HardCodedWidth");var gridName="VHASRTable";var objHeader=$("table[aria-labelledby='gbox_"+gridName+"'] tr[role=rowheader] th");for(var i=0;i<objHeader.length;i++){var col=$("table[id='"+gridName+"'] td[aria-describedby='"+objHeader[i].id+"']");var width=col.outerWidth()-1;$(objHeader[i]).css("width",width)}$("#gview_VHASRTable").addClass("HdrWdthAdded")},100)});$("#VHAServiceReqbuttons").on("click","#VHAGotoSRView",{ctx:this},function(t){var Inputs=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();var ser=SiebelApp.S_App.GetService("VF BS Process Manager");Inputs.SetProperty("Service Name","VHA MSISDN GotoView BS");Inputs.SetProperty("Method Name","GotoView");Inputs.SetProperty("BusObjName","VF Asset");Inputs.SetProperty("BusCompName","Asset Mgmt - Asset - Header");var ParentIC=VHAAppUtilities.GetConstants("VHADashboardParentIC");var RecordId=ParentIC.GetProperty("Installed Asset Id");Inputs.SetProperty("RowId",RecordId);Inputs.SetProperty("ViewName","VF Service Asset List View");var Output=ser.InvokeMethod("Run Process",Inputs)})};return VHADashboardRecentSRAppletPR}());return"SiebelAppFacade.VHADashboardRecentSRAppletPR"})};