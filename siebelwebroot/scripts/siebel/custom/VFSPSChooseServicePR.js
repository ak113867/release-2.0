if(typeof(SiebelAppFacade.VFSPSChooseServicePR)==="undefined"){var controls;SiebelJS.Namespace("SiebelAppFacade.VFSPSChooseServicePR");define("siebel/custom/VFSPSChooseServicePR",["order!siebel/phyrenderer","order!siebel/custom/VFSPSUdateUIFrameWork"],function(){SiebelAppFacade.VFSPSChooseServicePR=(function(){function VFSPSChooseServicePR(pm){SiebelAppFacade.VFSPSChooseServicePR.superclass.constructor.call(this,pm);this.GetPM().AttachPMBinding("FieldChanged",VFSPSEnableNextButton,{scope:this});SiebelApp.EventManager.addListner("VFSPSNoOfEmployees",VFSPSNextButtonEnable,this)}SiebelJS.Extend(VFSPSChooseServicePR,SiebelAppFacade.PhysicalRenderer);VFSPSChooseServicePR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSChooseServicePR.superclass.ShowUI.call(this);var controls=this.GetPM().Get("GetControls");setTimeout(function(){$("input[name='"+controls["Choose Plan"].GetInputName()+"']").attr("checked",false);$("input[name='"+controls["Choose Customer"].GetInputName()+"']").attr("checked",false);$("input[name='"+controls["CA Pin"].GetInputName()+"']").val("");$("input[name='"+controls["Activation Key"].GetInputName()+"']").val("");$("input[name='"+controls["Service PIN"].GetInputName()+"']").val("");$("input[name='"+controls["Business Type"].GetInputName()+"']").attr("checked",false);$("input[name='"+controls["VF No Of Employees"].GetInputName()+"']").val("");VFSPSSetActivationKeyImage(controls)},50);$("input[name='"+controls["VF No Of Employees"].GetInputName()+"']").attr("disabled",true);$("input[name='"+controls["Choose Customer"].GetInputName()+"']").addClass("VFSPSCutomerTypeRadio").parent().addClass("VFRadioButtonLabel");$("input[name='"+controls["VF No Of Employees"].GetInputName()+"']").parent().addClass("VFSPSNoOfEmployeeswidth").removeClass("VFSPSExistingServiceField");$("input[name='"+controls["Choose Plan"].GetInputName()+"']").addClass("VFSPSChooseServiceRadio").parent().addClass("VFRadioButtonLabel");$("input[name='"+controls["Business Type"].GetInputName()+"']").addClass("VFSPSBusinessTypeRadio").parent().addClass("VFRadioButtonLabel");$('[aria-label="VF SPS Choose Service Applet:Cancel"]').addClass("VFSPSCancelbutton");$('[aria-label="VF SPS Choose Service Applet:Next"]').addClass("VFSPSNextButton");$("#"+controls["Next"].GetInputName()+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseNewServiceNextBtn");$("#"+controls["Cancel"].GetInputName()+"_Ctrl").addClass("VFSPSChooseServiceCancelBtnEnabled");$("#"+controls["Scan Key"].GetInputName()+"_Ctrl").addClass("VFChooseFlowScanBtn").addClass("VFSPSChooseServiceNextBtnEnabled").addClass("VFSPSChooseNewServiceScanBtn");$("input[name='"+controls["CA Pin"].GetInputName()+"']").addClass("VFSPSChooseFlowPinInput").attr("placeholder","Must be 4 digits").attr("type","number");$("input[name='"+controls["Activation Key"].GetInputName()+"']").addClass("VFSPSChooseFlowActivationInput");$("input[name='"+controls["Service PIN"].GetInputName()+"']").addClass("VFSPSServicePIN").addClass("VFSPSChooseFlowPinInput");$("#Service_PIN_Label").parent().addClass("VFSPSRegisterLabel");$("#Activation_Key_Label").parent().addClass("VFSPSRegisterLabel");$("input[name='"+controls["VF No Of Employees"].GetInputName()+"']").attr("placeholder","--Select--").after('<img id="VFSPSEmployeeDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">');VFSPSPrepaidRegisterHide(controls);VFSPSBusinessTypeHide(controls);var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("Profile Attribute Name","VFSPSEnableWR");Input.SetProperty("Profile Attribute Value","");Output=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",Input,{});VFTabletIntegrationConstants.SetConstants("VFSPSValidActivationKey","N")};function VFSPSSetActivationKeyImage(controls){var sAactivationKey=$("input[name='"+controls["Activation Key"].GetInputName()+"']").val();var sServicePIN=$("input[name='"+controls["Service PIN"].GetInputName()+"']").val();$("input[name='"+controls["Activation Key"].GetInputName()+"']").attr("type","number");if(sAactivationKey!=""&&sServicePIN!=""){$("input[name='"+controls["Activation Key"].GetInputName()+"']").after('<img id = "VFSPSValidateActivationKey" class="VFSSPSAddressvalidationicon VFSPSNewActivationCross VFSPSChooseNewServiceClearSearch" src="images/VFSPScross.png"></img>')}else{$("input[name='"+controls["Activation Key"].GetInputName()+"']").after('<img id = "VFSPSValidateActivationKey" class="VFSPSNewActivationSearchImg VFSPSChooseNewServiceSearchImg" src="images/VFSPSSearchICON.png"></img>')}$("input[name='"+controls["Service PIN"].GetInputName()+"']").attr("placeholder","Must be 4 digits").attr("type","number")}VFSPSChooseServicePR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSChooseServicePR.superclass.BindEvents.call(this);var pm=this.GetPM();var Ctrls=pm.Get("GetControls");var PinCtrl=Ctrls["CA Pin"].GetInputName();var sActivationKey=Ctrls["Activation Key"].GetInputName();var sServicePIN=Ctrls["Service PIN"].GetInputName();var iNoofEmp=Ctrls["VF No Of Employees"].GetInputName();$("#s_"+pm.Get("GetFullId")+"_div").delegate("input[name='"+PinCtrl+"']","keyup",{ctx:this},VFSPSNextButtonEnable);$("#s_"+pm.Get("GetFullId")+"_div").delegate("input[name='"+PinCtrl+"']","keydown",{ctx:this},VFSPSCheckLengthFour);$("#s_"+pm.Get("GetFullId")+"_div").delegate("input.VFSPSChooseServiceRadio","click",{ctx:this},VFSPSNextButtonEnable);$("#s_"+pm.Get("GetFullId")+"_div").delegate("input.VFSPSCutomerTypeRadio","click",{ctx:this},VFSPSNextButtonEnable);$("#s_"+pm.Get("GetFullId")+"_div").delegate("input.VFSPSBusinessTypeRadio","click",{ctx:this},VFSPSNextButtonEnable);$("#s_"+pm.Get("GetFullId")+"_div").delegate("input[name='"+sActivationKey+"']","keyup",{ctx:this},VFSPSNextButtonEnable);$("#s_"+pm.Get("GetFullId")+"_div").delegate("input[name='"+sServicePIN+"']","keyup",{ctx:this},VFSPSNextButtonEnable);$("#s_"+pm.Get("GetFullId")+"_div").delegate("input[name='"+sServicePIN+"']","keydown",{ctx:this},VFSPSCheckLengthFour);$(".VFChooseServiceApplet").delegate("#VFSPSValidateActivationKey","click",{ctx:this},VFSPSValidateActivationKey);$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSEmployeeDropDown","click",{ctx:this},VFSPSEmployeeDropDown);$(".VFChooseServiceApplet").delegate(".VFChooseFlowScanBtn","click",{ctx:this},VFSPSScanActivationKey)};function VFSPSCheckLengthFour(e){if((event.which!=8)&&(event.which!=46)){var val=$(this).val();if(val.length==4){event.preventDefault();event.stopPropagation()}}}function VFSPSEmployeeDropDown(e){var SearchString="[List Of Values.Type] = 'VF_EMP_RANGE' AND [List Of Values.Active] = 'Y' AND [List Of Values.Value] <> 'VGE'";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues("VF SPS Flow Select VBC","VF Number of Employees","LOV","",SearchString,"Siebel","VFSPSNoOfEmployees")}function VFSPSSetFieldValueService(e){var ctx=e.data.ctx;var pm=ctx.GetPM();var Ctrls=pm.Get("GetControls");var PinCtrl=Ctrls["CA Pin"].GetInputName();var NextBtn=Ctrls["Next"].GetInputName();var val=$(this).attr("value");pm.SetProperty("ServiceType",val);var ServiceType=val;var CustomerType=pm.Get("CustomerType");var ServiceType=pm.Get("ServiceType");var BusinessType=pm.Get("BusinessType");var Pin=$("input[name='"+PinCtrl+"']").val();if((Pin!=null&&Pin.length==4)&&CustomerType.length&&ServiceType.length){if(CustomerType=="Business Use"&&BusinessType.length){$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}else{if(CustomerType=="Business Use"&&BusinessType==""){$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}else{$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}}}else{$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}if(ServiceType=="Prepaid"){VFSPSPrepaidRegisterShow(Ctrls)}else{if(ServiceType=="Postpaid"){VFSPSPrepaidRegisterHide(Ctrls)}else{}}}function VFSPSSetFieldValueBusiness(e){var ctx=e.data.ctx;var pm=ctx.GetPM();var Ctrls=pm.Get("GetControls");var PinCtrl=Ctrls["CA Pin"].GetInputName();var NextBtn=Ctrls["Next"].GetInputName();var val=$(this).attr("value");pm.SetProperty("BusinessType",val);var ServiceType=val;var CustomerType=pm.Get("CustomerType");var ServiceType=pm.Get("ServiceType");var BusinessType=pm.Get("BusinessType");var Pin=$("input[name='"+PinCtrl+"']").val();if((Pin!=null&&Pin.length==4)&&CustomerType.length&&ServiceType.length&&BusinessType.length){$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}else{$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}}function VFSPSSetFieldValueCustomer(e){var ctx=e.data.ctx;var pm=ctx.GetPM();var Ctrls=pm.Get("GetControls");var PinCtrl=Ctrls["CA Pin"].GetInputName();var NextBtn=Ctrls["Next"].GetInputName();var val=$(this).attr("value");pm.SetProperty("CustomerType",val);var CustomerType=val;var ServiceType=pm.Get("ServiceType");var BusinessType=pm.Get("BusinessType");var Pin=$("input[name='"+PinCtrl+"']").val();if((Pin!=null&&Pin.length==4)&&CustomerType.length&&ServiceType.length){if(CustomerType=="Business Use"&&BusinessType.length){$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}else{if(CustomerType=="Business Use"&&BusinessType==""){$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}else{$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}}}else{$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}if(CustomerType=="Personal Use"){VFSPSBusinessTypeHide(Ctrls)}else{if(CustomerType=="Business Use"){VFSPSBusinessTypeShow(Ctrls)}else{}}}function VFSPSValidateNext(e){var val=$(this).val();var ctx=e.data.ctx;var pm=ctx.GetPM();var Ctrls=pm.Get("GetControls");var CustomerType=pm.Get("CustomerType");var ServiceType=pm.Get("ServiceType");var BusinessType=pm.Get("BusinessType");var NextBtn=Ctrls["Next"].GetInputName();if((CustomerType!="")&&(ServiceType!="")&&val!=null&&val.length==4){if(CustomerType=="Business Use"&&BusinessType.length){$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}else{if(CustomerType=="Business Use"&&BusinessType==""){$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}else{$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}}}else{$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}}function VFSPSEnableNextButton(){var pm=this.GetPM();var bc=pm.Get("GetBusComp");var CustomerType=bc.GetFieldValue("VF SPS Customer Type");var ServiceType=bc.GetFieldValue("VF SPS Flow Type");var Pin=bc.GetFieldValue("CA Pin");var Ctrls=pm.Get("GetControls");var NextBtn=Ctrls["Next"].GetInputName();var BusinessType=pm.Get("BusinessType");if(CustomerType==null||ServiceType==null||Pin==null){$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}else{if(Pin!=null&&Pin.length==4){$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}else{if(CustomerType=="Business Use"&&BusinessType.length){$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}else{if(CustomerType=="Business Use"&&BusinessType==""){$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}else{$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}}}}}function VFSPSPrepaidRegisterHide(controls){$("#Activation_Key_Label").parent().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#Service_PIN_Label").parent().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#Register_your_Pack_Label").parent().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("input[name='"+controls["Activation Key"].GetInputName()+"']").parent().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("input[name='"+controls["Service PIN"].GetInputName()+"']").parent().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#"+controls["Scan Key"].GetInputName()+"_Ctrl").parent().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#VFSPSLine4").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#Service_PIN_Label").parent().parent().parent().hide();$("#Activation_Key_Label").parent().parent().parent().hide();$("#Register_your_Pack_Label").parent().parent().parent().hide();$("input[name='"+controls["Activation Key"].GetInputName()+"']").parent().parent().parent().hide();$("input[name='"+controls["Service PIN"].GetInputName()+"']").parent().parent().parent().hide()}function VFSPSPrepaidRegisterShow(controls){$("#Activation_Key_Label").parent().removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#Service_PIN_Label").parent().removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#Register_your_Pack_Label").parent().removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("input[name='"+controls["Activation Key"].GetInputName()+"']").parent().removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("input[name='"+controls["Service PIN"].GetInputName()+"']").parent().removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#"+controls["Scan Key"].GetInputName()+"_Ctrl").parent().removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#VFSPSLine4").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#Service_PIN_Label").parent().parent().parent().show();$("#Activation_Key_Label").parent().parent().parent().show();$("#Register_your_Pack_Label").parent().parent().parent().show();$("input[name='"+controls["Activation Key"].GetInputName()+"']").parent().parent().parent().show();$("input[name='"+controls["Service PIN"].GetInputName()+"']").parent().parent().parent().show()}function VFSPSBusinessTypeHide(controls){$("#Business_Type_Label").parent().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("input[name='"+controls["Business Type"].GetInputName()+"']").parent().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("input[name='"+controls["Business Type"].GetInputName()+"']").parent().next().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#VF_No_Of_Employees_Label").parent().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("input[name='"+controls["VF No Of Employees"].GetInputName()+"']").parent().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("input[name='"+controls["VF No Of Employees"].GetInputName()+"']").parent().next().removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")}function VFSPSBusinessTypeShow(controls){$("#VF_No_Of_Employees_Label").parent().removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("input[name='"+controls["VF No Of Employees"].GetInputName()+"']").parent().removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("input[name='"+controls["VF No Of Employees"].GetInputName()+"']").parent().next().removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock")}function VFSPSScanActivationKey(e){var requestData={"Key":"ActivationKey"};if(typeof(VHAWrapper)=="undefined"){var retVal=VHAWrapperSTUB?VHAWrapperSTUB.ScanBarcode(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0;retVal="1"}else{var retVal=VHAWrapper?VHAWrapper.scanBarcode(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0}if(retVal){}else{alert("Could not start Bar code scanner, please proceed with manual entry.")}}function VFSPSNextButtonEnable(e){var App=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Choose Service Applet");var controls=App.GetControls();var InputList=["Choose Plan","Choose Customer","CA Pin"];var InputListBT=["Choose Plan","Choose Customer","CA Pin","VF No Of Employees"];var InputListPrepayBT=["Choose Plan","Choose Customer","CA Pin","Activation Key","Service PIN","Business Type"];var InputListPrepay=["Choose Plan","Choose Customer","CA Pin","Activation Key","Service PIN"];var NextBtn=controls["Next"].GetInputName();var nCAPIN=$("input[name='"+controls["CA Pin"].GetInputName()+"']").val();var nNoofEmp=$("input[name='"+controls["VF No Of Employees"].GetInputName()+"']").val();var sPlanType=$("input[type='radio'][name='"+controls["Choose Plan"].GetInputName()+"']:checked").val();var CustomerType=$("input[type='radio'][name='"+controls["Choose Customer"].GetInputName()+"']:checked").val();if(sPlanType=="Prepaid"){VFSPSPrepaidRegisterShow(controls);if(CustomerType=="Personal Use"){InputList=InputListPrepay}else{if(CustomerType=="Business Use"){InputList=InputListPrepay}}}else{VFSPSPrepaidRegisterHide(controls);if(CustomerType=="Personal Use"){}else{if(CustomerType=="Business Use"){InputList=InputListBT}}}if(CustomerType=="Personal Use"){VFSPSBusinessTypeHide(controls)}else{if(CustomerType=="Business Use"){if(sPlanType!="Prepaid"){VFSPSBusinessTypeShow(controls)}else{VFSPSBusinessTypeHide(controls)}}else{}}var InputListLength=InputList.length;for(var i=0;i<InputListLength;i++){if(InputList[i]!="CA Pin"&&InputList[i]!="Activation Key"&&InputList[i]!="Service PIN"&&InputList[i]!="VF No Of Employees"){var input=$("input[name='"+controls[InputList[i]].GetInputName()+"']")}if(sPlanType=="Prepaid"){var sValid=VFTabletIntegrationConstants.GetConstants("VFSPSValidActivationKey");if(input.is(":checked")==false||nCAPIN.length!=4||sValid!="Y"){$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled");break}else{$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}}else{if(CustomerType=="Business Use"){if(input.is(":checked")==false||nCAPIN.length!=4||nNoofEmp.length==0){$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}else{$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}}else{if(input.is(":checked")==false||nCAPIN.length!=4){$("#"+NextBtn+"_Ctrl").addClass("VFSPSChooseServiceNextBtnDisabled").removeClass("VFSPSChooseServiceNextBtnEnabled")}else{$("#"+NextBtn+"_Ctrl").removeClass("VFSPSChooseServiceNextBtnDisabled").addClass("VFSPSChooseServiceNextBtnEnabled")}}}}}function VFSPSValidateActivationKey(e){var ctx=e.data.ctx;var pm=ctx.GetPM();var controls=pm.Get("GetControls");if($(this).hasClass("VFSPSChooseNewServiceClearSearch")){$(".VFSPSChooseFlowActivationInput").val("");$(".VFSPSServicePIN").val("");$("#VFSPSValidateActivationKey").attr("src","images/VFSPSSearchICON.png");$("#VFSPSValidateActivationKey").removeClass("VFSPSChooseNewServiceClearSearch").addClass("VFSPSChooseNewServiceSearchImg");$("#VFSPSValidateActivationKey").removeClass("VFSPSNewActivationCross").addClass("VFSPSNewActivationSearchImg");VFTabletIntegrationConstants.SetConstants("VFSPSValidActivationKey","N");VFSPSNextButtonEnable(e)}else{var sActivationKey=$(".VFSPSChooseFlowActivationInput").val();var sServicePIN=$(".VFSPSServicePIN").val();if(sActivationKey!=""&&sServicePIN!=""){var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("MSISDN",sActivationKey);Input.SetProperty("PIN",sServicePIN);Output=VFCustomSiebelInterface.CallBS("VF SPS Prepaid Utilities","Authenticate",Input,{});Output=Output.GetProperty("Success");if(Output=="true"){VFTabletIntegrationConstants.SetConstants("VFSPSValidActivationKey","Y");var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("Profile Attribute Name","VFSPSActivationKey");Input.SetProperty("Profile Attribute Value",sActivationKey);Output=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",Input,{});Input.SetProperty("Profile Attribute Name","VFSPSEnableWR");Input.SetProperty("Profile Attribute Value","Y");Output=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",Input,{});VFSPSNextButtonEnable(e);$("#VFSPSValidateActivationKey").attr("src","images/VFSPScross.png");$("#VFSPSValidateActivationKey").addClass("VFSPSChooseNewServiceClearSearch").removeClass("VFSPSChooseNewServiceSearchImg");$("#VFSPSValidateActivationKey").addClass("VFSPSNewActivationCross").removeClass("VFSPSNewActivationSearchImg")}else{alert("Please enter a valid Activation Key")}}else{alert("Please enter activation key and service pin before search")}}}return VFSPSChooseServicePR}());return"SiebelAppFacade.VFSPSChooseServicePR"})};