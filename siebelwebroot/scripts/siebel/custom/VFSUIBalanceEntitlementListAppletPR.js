if(typeof(SiebelAppFacade.VFSUIBalanceEntitlementListAppletPR)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.VFSUIBalanceEntitlementListAppletPR");define("siebel/custom/VFSUIBalanceEntitlementListAppletPR",["order!siebel/phyrenderer","order!siebel/jqgridrenderer"],function(){SiebelAppFacade.VFSUIBalanceEntitlementListAppletPR=(function(){function VFSUIBalanceEntitlementListAppletPR(pm){SiebelAppFacade.VFSUIBalanceEntitlementListAppletPR.superclass.constructor.call(this,pm)}SiebelJS.Extend(VFSUIBalanceEntitlementListAppletPR,SiebelAppFacade.PhysicalRenderer);VFSUIBalanceEntitlementListAppletPR.prototype.ShowUI=function(){SiebelAppFacade.VFSUIBalanceEntitlementListAppletPR.superclass.ShowUI.call(this);var sView=SiebelApp.S_App.GetActiveView().GetName();if(sView=="VF SUI Billing Postpay Usage History Detail View 1"||sView=="VF SUI Sales Postpay Usage History Detail View 1"||sView=="VF SUI Sales Prepay Usage History Detail View 1"){var series=new Array();var Month=new Array();var valuearray=new Array();var currentMonths=new Array();var Montharray=["Jan","Feb","March","April","May","June","July","August","Sept","Oct","Nov","Dec"];var busObj=SiebelApp.S_App.GetActiveBusObj();var billAccBc=busObj.GetBusCompByName("VHA SUI Billing Account");var TodayDate=billAccBc.GetFieldValue("SysDate");var datearray=TodayDate.split("/");var svc=SiebelApp.S_App.GetService("VF SUI Entitlement Usage BS");var input=SiebelApp.S_App.NewPropertySet();var output=svc.InvokeMethod("Entitlement Graph",input);var atypeval=SiebelApp.S_App.GetProfileAttr("EntType");console.log(atypeval);var typearray=atypeval.split(",");var typearraylen=typearray.length;var resultSet=output.GetChild(0);var resultcount=resultSet.GetChildCount();if(resultcount!=0){var reset=false;var count=0;var val=1;var arrvar=new Array();for(var typeArrInner=1;typeArrInner<=typearraylen;typeArrInner++){arrvar[typeArrInner]=new Array()}var curMonth=Number(datearray[0]);var j=curMonth-2;for(var monthIndex=0;curMonth>=j&&count<3;curMonth--,monthIndex++){if(curMonth==0){curMonth=12;reset=true}else{if(curMonth==-1){curMonth=11;reset=true}}var monthresultset=resultSet.GetChild(curMonth-1);console.log(monthresultset);var month=monthresultset.GetProperty("Month");var typeresultset=monthresultset.GetChild(0);for(var prop=0;prop<typearraylen;prop++){valuearray[val]=Number(typeresultset.GetProperty(typearray[prop]));val++}currentMonths[monthIndex]=Montharray[curMonth-1];if(reset){if(curMonth==12){curMonth=0;reset=false}else{if(curMonth==11){curMonth=-1;reset=false}}}count++}var graphval=new Array();var innerArrays=new Array();var toatllen=3*typearraylen;var mod;for(var valueArrIndex=1,innerIndex=0;valueArrIndex<=toatllen;valueArrIndex++){mod=valueArrIndex%typearraylen;if(mod!=0){innerArrays=arrvar[mod];innerArrays[innerIndex]=Number(valuearray[valueArrIndex])}else{innerArrays=arrvar[mod+typearraylen];innerArrays[innerIndex]=Number(valuearray[valueArrIndex]);innerIndex++}}var inarr=new Array();for(var outerVar=1;outerVar<arrvar.length;outerVar++){var temp=0;var temparr=new Array();inarr=arrvar[outerVar];for(var innerVar=inarr.length;innerVar>0;innerVar--,temp++){temparr[temp]=inarr[innerVar-1]}arrvar[outerVar]=temparr}for(var types=1;types<arrvar.length;types++){graphval.push(arrvar[types])}for(var typeIndex=0;typeIndex<typearray.length;typeIndex++){var label=typearray[typeIndex];console.log("label = "+label);series.push({label:label})}}else{var graphval=new Array();var curMonth=Number(datearray[0]);var j=curMonth-2;var count=0;for(var monthIndex=0;curMonth>=j&&count<3;curMonth--,monthIndex++){if(curMonth==0){curMonth=12;reset=true}else{if(curMonth==-1){curMonth=11;reset=true}}currentMonths[monthIndex]=Montharray[curMonth-1];if(reset){if(curMonth==12){curMonth=0;reset=false}else{if(curMonth==11){curMonth=-1;reset=false}}}count++}var s1=new Array();for(i=0;i<3;i++){s1[i]=0}graphval.push(s1)}$('[title="Entitlements List Applet"]').parent().before('<div id="chart1" style="width:700px; height:400px;margin-left:150px;"></div>');$('[title="Entitlements List Applet"]').parent().css("display","none");var ticks=new Array();var tickarr=0;for(var revArrVar=currentMonths.length;revArrVar>0;revArrVar--,tickarr++){ticks[tickarr]=currentMonths[revArrVar-1]}var plot1=$.jqplot("chart1",graphval,{text:"Graph",seriesDefaults:{renderer:$.jqplot.BarRenderer,pointLabels:{show:true,hideZeros:true}},series:series,legend:{show:true,location:"e",showSwatch:true,placement:"outsideGrid",marginLeft:"100px"},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:ticks},yaxis:{pad:1}}})}};return VFSUIBalanceEntitlementListAppletPR}());return"SiebelAppFacade.VFSUIBalanceEntitlementListAppletPR"})};