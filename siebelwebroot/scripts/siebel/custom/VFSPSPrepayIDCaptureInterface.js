if(typeof(VFSPSPrepayIDCaptureInterface)==="undefined"){var VFSPSPrepayIDCaptureInterface={};VFSPSPrepayIDCaptureInterface.VFSPSShowIDList=function(){var PriLength=VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo.length;if(PriLength==0){VFCustomSiebelInterface.GetIdList();PriLength=VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo.length}$("#openModal").remove();$("#openModal_C").remove();if(!$("#openModal").length){$("body").append(GetIDTemplate())}$("#openModal #VFSPSPrimaryIDTypesIDDetails").html("");for(var i=0;i<PriLength;i++){var Template='<div class="VFSPSIDTypeLine VFSPSIDTypeLineSelect" Category="'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Description+'" WeightingFactor="'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].WeightingFactor+'" Type="'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Type+'" Points="'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Points+'" IsPrimary="'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Primary+'" ProofOFAddress="'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].ProofOfAddress+'">																																																																											<div class="VFSPSIDType">'+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Type+'</div>																																																																											<div class="VFSPSIDTypeChevron">List '+VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo[i].Description+'</div>																																																																											<span class="VFSPSIDTypeEndTag">></span>																																																																											<div class="VFSPSLineSpace"></div>																																																																											</div>';$("#VFSPSPrimaryIDTypesIDDetails").append(Template)}if(VFCustomSiebelInterface.PrimaryIDListIDCaptureVodlo.length){$("#VFSPSPrimaryIDTypesIDDetails").append('<div class="VFSPSIDTypeLine">																																																																											<div class="VFSPSIDType" id="VFSPSShowMoreID">More ID Types</div>																																																																											<div class="VFSPSIDPoints"></div>																																																																											</div>')}$("#openModal").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#openModal").undelegate();$("#openModal").delegate(".VFSPSDialogClose","click",{},function(e){$("#openModal").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")});$("#openModal").delegate("#VFSPSShowMoreID","click",{},VFSPSShowMoreIds);$("#openModal").delegate(".VFSPSIDTypeLineSelect","click",{"Popup":"SMALL"},VFSPSScanID)};function VFSPSShowMoreIds(e){$("#openModal").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#VFSPSPrepayIDListPreview").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#openModal").remove();$("#openModal_C").remove();if(!$("#openModal_C").length){$("body").append(GetCompleteIDTemplate())}$("#openModal_C #VFSPSPrimaryIDTypesIDDetails").html("");for(var i=0;i<VFCustomSiebelInterface.PrimaryIDList.length;i++){var Template='<div class="VFSPSIDTypeLine VFSPSIDTypeLineSelect" WeightingFactor="'+VFCustomSiebelInterface.PrimaryIDList[i].WeightingFactor+'" Category="'+VFCustomSiebelInterface.PrimaryIDList[i].Description+'" Points="'+VFCustomSiebelInterface.PrimaryIDList[i].Points+'" Type="'+VFCustomSiebelInterface.PrimaryIDList[i].Type+'">																																																																											<div class="VFSPSIDType">'+VFCustomSiebelInterface.PrimaryIDList[i].Type+'</div>																																																																											<div class="VFSPSIDTypeChevron">List '+VFCustomSiebelInterface.PrimaryIDList[i].Description+'</div>																																																																											<span class="VFSPSIDTypeEndTag">></span>																																																																											<div class="VFSPSLineSpace"></div>																																																																											</div>';$("#openModal_C #VFSPSPrimaryIDTypesIDDetails").append(Template)}$("#openModal_C #VFSPSSecondraryIDTypes").html("");for(var i=0;i<VFCustomSiebelInterface.SecondaryIDList.length;i++){var Template='<div class="VFSPSIDTypeLine VFSPSIDTypeLineSelect" WeightingFactor="'+VFCustomSiebelInterface.SecondaryIDList[i].WeightingFactor+'" Category="'+VFCustomSiebelInterface.SecondaryIDList[i].Description+'" Type="'+VFCustomSiebelInterface.SecondaryIDList[i].Type+'" Points="'+VFCustomSiebelInterface.SecondaryIDList[i].Points+'">																																																																											<div class="VFSPSIDType">'+VFCustomSiebelInterface.SecondaryIDList[i].Type+'</div>																																																																											<div class="VFSPSIDTypeChevron">List '+VFCustomSiebelInterface.SecondaryIDList[i].Description+'</div>																																																																											<span class="VFSPSIDTypeEndTag">></span>																																																																											<div class="VFSPSLineSpace"></div>																																																																											</div>';$("#openModal_C #VFSPSSecondraryIDTypes").append(Template)}$("#openModal_C").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#openModal_C").delegate(".VFSPSDialogClose,span.VFSPSMoreIdCancel","click",{},function(e){$("#openModal_C").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")});$("#openModal_C").delegate(".VFSPSIDTypeLineSelect","click",{"Popup":"MORE"},VFSPSScanID)}function VFSPSScanID(e){var cardType=$(this).attr("type");var points=$(this).attr("Points");var IsPrimary=$(this).attr("IsPrimary");var ProofOAddress=$(this).attr("ProofOfAddress");var category=$(this).attr("category");var WeightingFactor=$(this).attr("WeightingFactor");VFTabletIntegrationConstants.SetConstants("VFSPSCardType",cardType);if(cardType=="Driver's Licence"||cardType=="Learner's Permit"||cardType=="Proof of Age Card"){if(e.data.Popup=="MORE"){$("#openModal_C").remove();$("#VFSPSPrepayIDListPreview").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#openModal").remove();if(!$("#openModal").length){$("body").append(GetIDTemplate())}}var StateArray=["New South Wales","Northern Territory","Queensland","South Australia","Tasmania","Victoria","Western Australia"];var stateShortArray=VFCustomSiebelInterface.GetPickListValues("VF_ID_ISSUER","");$("#openModal #VFSPSPrimaryIDTypesIDDetails").html("");$("#openModal .VFSPSIDPopUpHeader").html("Choose 1 of the following State");for(var i=0;i<stateShortArray.length;i++){var Template='<div class="VFSPSIDTypeLine VFSPSStateLineSelect" Type="'+stateShortArray[i]+'">																																																																																														<div class="VFSPSIDType">'+stateShortArray[i]+'</div>																																																																																														<div class="VFSPSIDTypeChevron"></div>																																																																																														<div class="VFSPSLineSpace"></div>																																																																																														</div>';$("#VFSPSPrimaryIDTypesIDDetails").append(Template)}$("#openModal").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#openModal").delegate(".VFSPSStateLineSelect","click",{cardType:cardType,points:points,IsPrimary:IsPrimary,ProofOAddress:ProofOAddress,category:category,WeightingFactor:WeightingFactor},VFSPSGetState)}else{VFSPSStartScanID(cardType,points,IsPrimary,ProofOAddress,"",category,WeightingFactor)}}function VFSPSGetState(e){var state=$(this).attr("type");VFSPSStartScanID(e.data.cardType,e.data.points,e.data.IsPrimary,e.data.ProofOAddress,state,e.data.category,e.data.WeightingFactor)}function VFSPSMapCardType(CardType,State){var sCardMap="";switch(CardType){case ("Learner's Permit"):case ("Driver's Licence"):sCardMap=State.toUpperCase()+"_"+"LICENCE";break;case ("Passport"):sCardMap="PASSPORT";break;case ("Armed Forces ID"):sCardMap="Armed Forces ID";break;case ("Police ID"):sCardMap="Police ID";break;case ("Medicare Card"):sCardMap="MEDICARE";break;case ("Credit Card"):sCardMap="CREDIT_CARD";break;case ("Proof of Age Card"):sCardMap=State.toUpperCase()+"_PROOFOFAGE";break;case ("Pensioner Card"):sCardMap="PENSION_AUS";break;case ("Utility Bill"):sCardMap="UTILITYBILL";break;default:sCardMap=CardType}return sCardMap}function VFSPSStartScanID(cardType,points,IsPrimary,ProofOAddress,State,category,WeightingFactor){var appletId=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureApplet");var appletName=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureAppletName");var bo1=SiebelApp.S_App.GetActiveBusObj();var OCRCardMap=VFSPSMapCardType(cardType,State);var bc1=bo1.GetBusCompByName("VF SPS New Account Contact PrePay TBC");var sessionId=bc1.GetFieldValue("Session Id");VFTabletIntegrationConstants.SessionArray={"cardType":cardType,"points":points,"state":State};ProofOAddress=typeof(ProofOAddress)=="undefined"?"N":ProofOAddress;IsPrimary=typeof(IsPrimary)=="undefined"?"N":IsPrimary;category=typeof(category)=="undefined"||category==""?"B":category;var requestData={"Key":"OCRPrepayScanID","SettingsData":"","MetaData":"","RequestParam":{"CardType":OCRCardMap,"SessionID":sessionId,"IsImageReq":"True","ReturnData":[{"cardType":cardType,"state":State,"points":points,"ProofOAddress":ProofOAddress,"IsPrimary":IsPrimary,"appletId":appletId,"appletName":appletName,"category":category,"WeightingFactor":WeightingFactor}]}};$("#openModal,#openModal_C").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");var IsIDTypeExist=VFTabletIntegrationConstants.GetConstants("IDTypeExist");if(typeof(VHAWrapper)=="undefined"){var retVal=VHAWrapperSTUB?VHAWrapperSTUB.scanIDUsingOCR(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0;retVal=1}else{var retVal=VHAWrapper?VHAWrapper.scanIDUsingOCR(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0}if(retVal){}else{responseData={"Key":"OCRPrepayScanID","Data":[{"Accuracy":[],"Value":[{"cardType":cardType,"state":State,"points":points,"ProofOAddress":ProofOAddress,"IsPrimary":IsPrimary,"appletId":appletId,"appletName":appletName,"category":category,"WeightingFactor":WeightingFactor}],"Key":"ReturnData"}],"StatusCode":"200","StatusMessage":"Success message"};VFTabletIntegration.Success(JSON.stringify(responseData));alert("Could not initiate Bar code scaning. Please go ahead with manual entry.")}}function GetIDTemplate(){return(' <div id = "openModal" class = "modalDialog VFSPSDisplayNone">  																																																											 <div>  																																																											 <span  title = "Close" class = "VFSPSDialogClose" ><img src="images/vfspsclose.jpg"></span>  																																																											 <h2 class="VFSPSIDPopUpHeader"> Choose ID Type </h2>  																																																											 <div id = "VFSPSPrimaryIDTypesIDDetails">  																																																											 </div>  																																																											 </div>  																																																											 </div> ')}function GetCompleteIDTemplate(){return(' <div id = "openModal_C" class = "modalDialog_C VFSPSDisplayNone">  																																																											 <div>  																																																											 <div>																																																											 <span  title = "Close" class = "VFSPSDialogClose" ><img src="images/vfspsclose.jpg"></span>  																																																											 <h2> Identification List </h2>  																																																											 <h3>Primary Documentation</h3>																																																											 <div id = "VFSPSPrimaryIDTypesIDDetails">  																																																											 </div>  																																																											 <h3>Secondrary Documentation</h3>																																																											  <div id = "VFSPSSecondraryIDTypes">  																																																											 </div>  																																																											 </div>  																																																											 </div>																																																											 <span class="VFSPSMoreIdCancel"><span>Cancel</span></span>																																																											 </div> ')}VFSPSPrepayIDCaptureInterface.VFSPSClearIDDetails=function(){var appletId=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureApplet");var IDCaptureTBC=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureTBC");var appletName=VFTabletIntegrationConstants.GetConstants("VFSPSIDCaptureAppletName");$("#s_"+appletId+"_div #VFSPIDTypeHeader").html("Choose an ID Type");var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("IDCaptureTBC",IDCaptureTBC);VFCustomSiebelInterface.CallBS("VF SPS IDCaputre BS","ClearIDDetails",Input,{});VFSPSPrepayIDCaptureInterface.VFSPSProgressBarStatus();VFSPSPrepayIDCaptureInterface.VFSPSToggleIDFields(appletName,"",appletId);$("#s_"+appletId+"_div input").removeClass("VFSTextFilledBorderColour VFSDefaultBorderColour")};VFSPSPrepayIDCaptureInterface.VFSPSToggleIDFields=function(appletName,cardType,appletId){var sActiveView=SiebelApp.S_App.GetActiveView();var IDCaptureApplet1=sActiveView.GetApplet(appletName);var IDCtrls1=IDCaptureApplet1.GetControls();if($("#s_"+appletId+"_div").has("#VFSPSIDCountryDropDown,#VFSPSIDStateDropDown").length==0){$("input[name='"+IDCtrls1.CountryOfIssue.GetInputName()+"']").attr("placeholder","--Select--").after('<img id="VFSPSIDCountryDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$("input[name='"+IDCtrls1.StateofIssue.GetInputName()+"']").attr("placeholder","--Select--").after('<img id="VFSPSIDStateDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true")}if(cardType=="Driver's Licence"||cardType=="Learner's Permit"||cardType=="Proof of Age Card"){$("input[name='"+IDCtrls1.StateofIssue.GetInputName()+"']").parent().closest("tr").show();$("input[name='"+IDCtrls1.CountryOfIssue.GetInputName()+"']").parent().closest("tr").hide()}else{if(cardType=="Passport"){$("input[name='"+IDCtrls1.CountryOfIssue.GetInputName()+"']").parent().closest("tr").show();$("input[name='"+IDCtrls1.StateofIssue.GetInputName()+"']").parent().closest("tr").hide()}else{$("input[name='"+IDCtrls1.StateofIssue.GetInputName()+"'],input[name='"+IDCtrls1.CountryOfIssue.GetInputName()+"']").parent().closest("tr").hide()}}if(cardType!=""){VFSPSPrepayIDCaptureInterface.VFSPSEnableNextButton("","",appletName)}};VFSPSPrepayIDCaptureInterface.VFSPSCheckIDTypeExist=function(cardtype){var SiebelBusComp,SiebelBusObj;SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();var IDCaptureTBC=false;for(i=1;i<=2;i++){SiebelBusComp=SiebelBusObj.GetBusCompByName("VFSPSIDDetailsTBC"+i);var IDType=SiebelBusComp.GetFieldValue("ID type");if(cardtype==IDType){IDCaptureTBC="VFSPSIDDetailsTBC"+i;break}}return IDCaptureTBC};VFSPSPrepayIDCaptureInterface.GetIDCaptureBC=function(sActiveView,appletName,pm){var appletId=pm.Get("GetFullId");var IDCaptureApplet1=sActiveView.GetApplet(appletName);var IDCaptureTBC=IDCaptureApplet1.GetBusComp().GetName();VFTabletIntegrationConstants.SetConstants("VFSPSIDCaptureApplet",appletId);VFTabletIntegrationConstants.SetConstants("VFSPSIDCaptureAppletName",appletName);VFTabletIntegrationConstants.SetConstants("VFSPSIDCaptureTBC",IDCaptureTBC)};VFSPSPrepayIDCaptureInterface.VFSPSScannedIDType=function(sActiveView,appletName,pm,InputList){var appletId=pm.Get("GetFullId");var IDCaptureApplet1=sActiveView.GetApplet(appletName);var IDCaptureTBC=IDCaptureApplet1.GetBusComp();VFSPSPrepayIDCaptureInterface.VFSPSProgressBarStatus();IDType=IDCaptureTBC.GetFieldValue("ID type");VFSPSPrepayIDCaptureInterface.VFSPSToggleIDFields(appletName,IDType,appletId);if(IDType!=""){$("#s_"+appletId+"_div #VFSPIDTypeHeader").html(IDType);setTimeout(function(){VFSPSPrepayIDCaptureInterface.VFSPSEnableNextButton(pm,InputList,appletName)},50)}};VFSPSPrepayIDCaptureInterface.VFSPSProgressBarStatus=function(IDCaptureTBC){SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();var applet=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Prepay Task Playbar Applet - Top");var PrepayIDCaptureStatus;count=0;for(i=1;i<=2;i++){SiebelBusComp=SiebelBusObj.GetBusCompByName("VFSPSIDDetailsTBC"+i);IDCategory=SiebelBusComp.GetFieldValue("VF SPS List");if(IDCategory=="A"){$("#VFSPSPointsLeft").text("ID scan complete!");$("#VFSPSTotalProgress").removeClass().addClass("VFSPSIDFullPoints");PrepayIDCaptureStatus="true";VFTabletIntegrationConstants.SetConstants("PrepayIDCaptureStatus",PrepayIDCaptureStatus);applet.DoExecuteUIUpdate();return false}else{if(IDCategory=="B"&&i==1){count=1}else{if(IDCategory=="B"&&i==2){count=count+1}}}if(count==2){$("#VFSPSPointsLeft").text("ID scan complete!");$("#VFSPSTotalProgress").removeClass().addClass("VFSPSIDFullPoints");PrepayIDCaptureStatus="true";VFTabletIntegrationConstants.SetConstants("PrepayIDCaptureStatus",PrepayIDCaptureStatus);applet.DoExecuteUIUpdate();return false}else{if(count==1){$("#VFSPSTotalProgress").removeClass().addClass("VFSPSIDPoints50");$("#VFSPSPointsLeft").text("Scan one more ID type from List B");PrepayIDCaptureStatus="false"}else{$("#VFSPSTotalProgress").removeClass().addClass("VFSPSIDZeroPoints");$("#VFSPSPointsLeft").text("Please scan one ID type from List A or two from List B");PrepayIDCaptureStatus="false"}}}VFTabletIntegrationConstants.SetConstants("PrepayIDCaptureStatus",PrepayIDCaptureStatus);applet.DoExecuteUIUpdate()};VFSPSPrepayIDCaptureInterface.VFSPSEnableNextButton=function(pm,InputList,AppletName){var ActiveView=SiebelApp.S_App.GetActiveView();var IdApplet1=ActiveView.GetApplet(AppletName);var pm=IdApplet1.GetPModel();var controls=pm.Get("GetControls");var appletId=pm.Get("GetFullId");var InputList=["VFSPSList","IdReferenceNumber","ExpiryDate"];var SelectedIDType=$("input[name='"+controls.IDtype.GetInputName()+"']").val();if(SelectedIDType=="Driver's Licence"||SelectedIDType=="Learner's Permit"||SelectedIDType=="Proof of Age Card"){InputList.push("StateofIssue")}else{if(SelectedIDType=="Passport"){InputList.push("CountryOfIssue")}}var InputListLength=InputList.length;for(var i=0;i<InputListLength;i++){var input=$("input[name='"+controls[InputList[i]].GetInputName()+"']");if(input.val()==""){input.removeClass("VFSDefaultBorderColour").addClass("VFSTextFilledBorderColour")}else{input.removeClass("VFSTextFilledBorderColour").addClass("VFSDefaultBorderColour")}}var applet=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Prepay Task Playbar Applet - Top");applet.DoExecuteUIUpdate()}};