if(typeof(SiebelAppFacade.VFSPSBillingDetailsPR)==="undefined"){var sSelectBillId;var rowId;var PrimaryBillId;var sAccId;var NextBtn;var AccountNo;var CreditCardNo;SiebelJS.Namespace("SiebelAppFacade.VFSPSBillingDetailsPR");define("siebel/custom/VFSPSBillingDetailsPR",["order!siebel/jqgridrenderer","order!siebel/custom/VFCustomSiebelInterface"],function(){SiebelAppFacade.VFSPSBillingDetailsPR=(function(){function VFSPSBillingDetailsPR(pm){SiebelAppFacade.VFSPSBillingDetailsPR.superclass.constructor.call(this,pm)}SiebelJS.Extend(VFSPSBillingDetailsPR,SiebelAppFacade.JQGridRenderer);VFSPSBillingDetailsPR.prototype.Init=function(){SiebelAppFacade.VFSPSBillingDetailsPR.superclass.Init.apply(this,arguments);var savedCard="";var rowId="";this.Data={"SavedCard":this.savedCard,"rowId":this.rowId};this.SetData=function(Category,data){this.Data[Category]=data};this.GetData=function(Category){return this.Data[Category]};SiebelApp.EventManager.cleanListners("VFSPSToggleBilling");SiebelApp.EventManager.cleanListners("VFSPSBillingSaveEnable");SiebelApp.EventManager.cleanListners("VFSPSUpdateBillAlertTxt");SiebelApp.EventManager.cleanListners("VFSPSBillingSubrub");SiebelApp.EventManager.addListner("VFSPSToggleBilling",VFSPSToggle,this);SiebelApp.EventManager.addListner("VFSPSBillingSaveEnable",VFSPSBillingSaveEnable,this);SiebelApp.EventManager.addListner("VFSPSUpdateBillAlertTxt",VFSPSUpdateBill,this);SiebelApp.EventManager.addListner("VFSPSBillingSubrub",VFSPSBillingSubrub,this)};VFSPSBillingDetailsPR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSBillingDetailsPR.superclass.ShowUI.call(this);var Input_1=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input_1.SetProperty("BCName","Order Entry - Orders");Input_1.SetProperty("FieldName","Id");Output=VFCustomSiebelInterface.CallBS("VF SPS TBUI Utilities","GetActiveBOFieldValue",Input_1,{});var OrderId=Output.GetProperty("FieldValue");var BS="VF SPS Order Summary BS";var Method="GetOrderLineItemDetails";var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("OrderId",OrderId);var out=VFCustomSiebelInterface.CallBS(BS,Method,inps,{});var RecordFound=out.GetProperty("OrderFound");var sOrderNbr=out.GetProperty("OrderNumber");var sActiveView=SiebelApp.S_App.GetActiveView();var PlaybarAppletId=sActiveView.GetApplet("VF SPS Task Playbar Applet - Top").GetFullId();$("#s_"+PlaybarAppletId+"_div").hide();var sBO=SiebelApp.S_App.GetActiveBusObj();var sBC=sBO.GetBusCompByName("VF Capture Customer Details TBC");sAccId=sBC.GetFieldValue("Customer Row Id");var sView=sActiveView.GetName();var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("CustAcctId",sAccId);Input.SetProperty("sOrderNbr",sOrderNbr);Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","VFSPSSetProfileAttrib",Input,{});var PrimaryAccId=SiebelApp.S_App.GetProfileAttr("VFSPSBillingAccntId");Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","BillHeader",Input,{});var PostpayFlag="Y";Output=VFCustomSiebelInterface.SiebelMessageToArray(Output);for(i=0;i<Output.length;i++){var AccountHeaderSection=FormHeaderTemplate(i,Output);var AccountChildSection=FormChildTemplate(i);$(".VFSPSAccountSection").append(AccountHeaderSection);$(".VFSPSAccountHeader"+i).append(AccountChildSection);var BillId=$(".VFSPSAccountHeader"+i).find(".VFSPSBillId>input").val();if(BillId==PrimaryAccId){$(".VFSPSAccountHeader"+i).find(".VFSPSCheck").prop("checked",true);ValidateNextButton(BillId,i)}}$(".VFSPSBillingForm").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");if($(".VFSPSAccountSection").children().length=="1"){$(".VFSPSAccountHeader>.VFSPSBillingCheckbox>input[type=checkbox]").prop("checked",true);var row=$(".VFSPSBillingCheckbox>input[type=checkbox]").parent().parent().attr("id");PrimaryBillId=$(".VFSPSAccountHeader"+row+">.VFSPSBillId>input").val();var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("Profile Attribute Name","VFSPSBillingAccntId");Input.SetProperty("Profile Attribute Value",PrimaryBillId);Output=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",Input,{});$(".VFSPSSaveNewAccount").addClass("VFSPSBillSaveBtnEnabled").removeClass("VFSPSBillSaveBtnDisabled");rowId=0;SetRowId(rowId);ValidateNextButton(PrimaryBillId,rowId)}else{$(".VFSPSSaveNewAccount").addClass("VFSPSBillSaveBtnDisabled").removeClass("VFSPSBillSaveBtnEnabled")}};function ValidateNextButton(PrimaryBillId,rowId){LoadChildDetails(PrimaryBillId,rowId);var Pay=$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue>input").val();var EnableFlag="N";if(Pay=="Credit Card"){if($(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNameValue>input").val()!=""&&$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNumberValue>input").val()!=""&&$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardTypeValue>input").val()!=""&&$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSExpiryValue>input").val()!=""){EnableFlag="Y"}}else{if(Pay=="Direct Debit"){if($(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").val()!=""&&$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>input").val()!=""){EnableFlag="Y"}}}setTimeout(function(){if(EnableFlag=="Y"||Pay=="Other"){$(".VFSPSCustomNextButton").removeClass("VFSPSPlaybarNextBtnDisabled").addClass("VFSPSPlaybarNextBtnEnabled")}else{$(".VFSPSCustomNextButton").removeClass("VFSPSPlaybarNextBtnEnabled").addClass("VFSPSPlaybarNextBtnDisabled")}},50)}function FormHeaderTemplate(i,Output){return"<div id = "+i+' class="VFSPSAccountHeader VFSPSAccountHeader'+i+'">					<div class="VFSPSBillingCheckbox"><input type="checkbox" name="AcntNumber" class = "VFSPSCheck"></div>					<div class="VFSPSAccountName VFSPSFloatLeft"><span>Account number:</span><span class="VFSPSAccountValue VFSPSAccountValue'+i+'">'+Output[i]["AccountNumber"]+'</span></div>					<div class="VFSPSName VFSPSFloatLeft"><span>Name:</span><span class="VFSPSNameValue VFSPSNameValue'+i+'">'+Output[i]["AccountName"]+'</span></div>					<div class="VFSPSPIN VFSPSFloatLeft"><span>PIN:</span><span class="VFSPSPINValue VFSPSPINValue'+i+'">'+Output[i]["PIN"]+'</span></div>					<div class="VFSPSBillId VFSPSDisplayNone"><input type="text" name="VFSPSBillIdValue" class="VFSPSBillId VFSPSBillId'+i+'"value ="'+Output[i]["BillId"]+'"></div>					<div class="VFSPSaccordion VFSPSFloatLeft"><img id = "VFSPSdownarrow'+i+'" class = "VFSPSdownarrow" src="images/VFSPSdownarrow.png"></div>					</div>'}function FormChildTemplate(i){return"<div id = "+i+' class="VFSPSBillingForm VFSPSBillingForm'+i+'">				<div class="VFSPSBillingLabel"><span>Billing Address</span></div>				<div class="VFSPSBillingValue"><input type="text" name="VFSPSAddressValue" class="VFSPSBillingField"></div>				<div class="VFSPSBillingManualAdd" id="VFSPSManAdd">				<div class="VFSPSBillingLabel"><span>Type</span></div>				<div class="VFSPSManualTypeValue"><input type="text" name="VFSPSManualTypeValue" class="VFSPSBillingField" id="VFSPSType"></div>				<div class="VFSPSBillingLabel"><span>Floor Type</span></div>				<div class="VFSPSManualFloorValue"><input type="text" name="VFSPSManualFloorValue" class="VFSPSBillingField" id="VFSPSFloorType"></div>				<div class="VFSPSBillingLabel"><span>Apartment/Floor/Flat Number</span></div>				<div class="VFSPSManualAptValue"><input type="text" name="VFSPSManualAptValue" class="VFSPSBillingField"></div>				<div class="VFSPSBillingLabel"><span>Building Number or Building Name</span></div>				<div class="VFSPSManualBuildingValue"><input type="text" name="VFSPSManualBuildingValue" class="VFSPSBillingField"></div>				<div class="VFSPSBillingLabel"><span>Street Type</span></div>				<div class="VFSPSManualStreetTypeValue"><input type="text" name="VFSPSManualStreetTypeValue" class="VFSPSBillingField" id="VFSPSStreetType"></div>				<div class="VFSPSBillingLabel"><span>Street Number</span></div>				<div class="VFSPSManualStreetNoValue"><input type="text" name="VFSPSManualStreetNoValue" class="VFSPSBillingField"></div>				<div class="VFSPSBillingLabel"><span>Street Address</span></div>				<div class="VFSPSManualStreetAddressValue"><input type="text" name="VFSPSManualStreetAddressValue" class="VFSPSBillingField"></div>				<div class="VFSPSBillingLabel"><span>Suburb/Town</span></div>				<div class="VFSPSManualSuburbValue"><input type="text" name="VFSPSManualSuburbValue" class="VFSPSBillingField"></div>				<div class="VFSPSBillingLabel"><span>State</span></div>				<div class="VFSPSManualStateValue"><input type="text" name="VFSPSManualStateValue" class="VFSPSBillingField" id="VFSPSState"></div>				<div class="VFSPSBillingLabel VFSPSCustomPostCode"><span>Postcode</span></div>				<div class="VFSPSManualPostalValue"><input type="text" name="VFSPSManualPostalValue" class="VFSPSBillingField"></div>				<div class="VFSPSBillingLabel"><span>Country</span></div>				<div class="VFSPSManualCountryValue"><input type="text" name="VFSPSManualCountryValue" class="VFSPSBillingField" id="VFSPSCountry"></div>				</div>				<div class="VFSPSAddressPresentValue VFSPSDisplayNone">				<div class="VFSPSRadioButtonDiv"><input type="radio" name="Address" value=Yes" class="VFSPSBillingRadioButton" id="Yes"><span class="VFSPSRadioDisplay">Yes</span></div><br>				<div class="VFSPSRadioButtonDiv"><input type="radio" name="Address" value="No" class="VFSPSBillingRadioButton" id="No"><span class="VFSPSRadioDisplay">No</span></div>				</div>				<div class="VFSPSProfileId VFSPSDisplayNone"><input type="text" name="VFSPSProfileIdValue" class="VFSPSBillingField"></div>				<div class="VFSPSBillingLabel"><span>Email</span></div>				<div class="VFSPSEmailValue "><input type="text" name="VFSPSEmailValue" class="VFSPSBillingField" id="EmailValue"></div>				<div class="VFSPSBillingLabel VFSPSVodafoneBill VFSPSDisplayNone"><span>How would you like to receive your Vodafone Bill?</span></div>				<div class="VFSPSHowtoBillValue VFSPSDisplayNone">				<div class="VFSPSRadioButtonDiv"><input type="radio" name="Bill" value="Email" class="VFSPSBillingRadioButton" id="Email"><span class="VFSPSRadioDisplay">Email</span></div><br>				<div class="VFSPSRadioButtonDiv"><input type="radio" name="Bill" value="Paper" class="VFSPSBillingRadioButton" id="Paper"><span class="VFSPSRadioDisplay">Paper Bill - $2.00 per bill</span></div>				</div>				<div class="VFSPSBillingLabel VFSPSDisplayNone"><span>How would you like to be alerted of your next bill?</span></div>				<div class="VFSPSBillingAlertValue VFSPSDisplayNone"><input type="text" name="VFSPSBillAlert" class="VFSPSBillingField" id="VFSPSAlertType" placeholder="--Select--"></div>				<div class="VFSPSBillingAlertText" id="Text" style="display:none;">				<div class="VFSPSBillingLabel VFSPSDisplayNone"><span>Bill Alert Txt number</span></div>				<div class="VFSPSAlertTxtValue1 VFSPSDisplayNone"><input type="text" name="VFSPSAlertTxtValue1" class="VFSPSBillingField VFSPSBillingField1"><img class="VFSPSBillingInfo" src="images/VFSPSInfo.png"></div></div>				<div class="VFSPSBillingAlertEmail" id="Email" style="display:none;">				<div class="VFSPSBillingLabel VFSPSDisplayNone"><span>Bill Alert Email Address</span></div>				<div class="VFSPSBillAlertEmailValue VFSPSDisplayNone"><input type="text" name="VFSPSBillAlertEmailValue" class="VFSPSBillingField"></div></div>				<div class="VFSPSBillingAlertTextEmail VFSPSDisplayNone" id="TextEmail" style="display:none;">				<div class="VFSPSBillingLabel VFSPSDisplayNone"><span>Bill Alert Txt number</span></div>				<div class="VFSPSAlertTxtValue2 VFSPSDisplayNone"><input type="text" name="VFSPSAlertTxtValue2" class="VFSPSBillingField VFSPSBillingField1"><img class="VFSPSBillingInfo" src="images/VFSPSInfo.png"></div>				<div class="VFSPSBillingLabel VFSPSDisplayNone"><span>Bill Alert Email Address</span></div>				<div class="VFSPSBillAlertEmailValue VFSPSDisplayNone"><input type="text" name="VFSPSBillAlertEmailValue" class="VFSPSBillingField"></div></div>				<div class="VFSPSBillingCustomerEmail"><span>Please advise customer they will receive their Vodafone Bill via Email</span></div>				<div class="VFSPSBillingCustomerTXT"><span>The customer will be alerted of their new bill via TXT</span></div>				<div class="VFSPSBillingLabel VFSPSAlertTXtLabel"><span>Bill Alert Txt number</span></div>				<div class="VFSPSAlertTxtValue"><input type="text" name="VFSPSAlertTxtValue" class="VFSPSBillingField VFSPSBillingField1"></div>				<div class="VFSPSBillingCustomerMobile"><span>The alert will be defaulted to the first mobile number of the billing account when their order is submitted</span></div>				<div class="VFSPSBillingPay"><span class="VFSPSBillingPaySpan">How would you like to pay?</span></div>				<div class="VFSPSBillingLabel"><span>Payment Type</span></div>				<div class="VFSPSPaymentTypeValue"><input type="text" name="VFSPSPaymentType" class="VFSPSBillingField" id="Payment" placeholder="--Select--"></div>				<div class="VFSPSBillingTypeCredit" id="Credit" style="display:none;">				<div class="VFSPSBillingDetailsPayCorpiFrame"></div>				<div class="VFSPSBillingDetailsPaycorpReadOnly VFSPSDisplayNone">'+GetCreditCardReadonly()+'</div>				</div>				<div class="VFSPSBillingTypeDebit" id="Debit" style="display:none;">				<div class="VFSPSBillingLabel"><span>Account Name</span></div>				<div class="VFSPSAccountNameValue"><input type="text" name="VFSPSAccountNameValue" class="VFSPSBillingField"></div>				<div class="VFSPSBillingLabel"><span>Account Number</span></div>				<div class="VFSPSAccountNumberValue">					<input type="number" name="VFSPSAccountNumberValue" class="VFSPSBillingField">					<div class="VFSPSAccountNumberValueDiv VFSPSDisplayNone"></div>				</div>				<div class="VFSPSBillingLabel"><span>BSB</span></div>				<div class="VFSPSBSBValue"><input type="number" name="VFSPSBSBValue" class="VFSPSBillingField VFSPSBillingField1"><img class="applet-form-combo VFSPSBillingPickIcon" src="images/VFSPSSearchICON.png"></div>				</div>				<div class="VFSPSBillingTypeOther" id="Other" style="display:none;">				</div>				<div class="VFSPSSavebutton VFSPSChooseServiceNextBtnDisabled">Save Billing Details</div>				<div id="VFSPSSuccess" class="VFSPSdivclass VFSPSDisplayNone"><img class="VFSPSStick" src="images/VFSPSGreenroundtick.png">				<div class="VFSPSBillProfileSaved"><span>Billing Details Saved</span></div></div>				</div>'}function GetCreditCardReadonly(){return"<div class='VFSPSBillProfCCReadonly'>					<div class='VFSPSDisplayTable VFSPSBillProfCCReadOnlyBlock1'>						<div class='VFSPSDisplayTableRow VFSPSBillProfCCReadOnlyBlock2'>							<div class='VFSPSDisplayTableCell VFSPSBillProfCCReadOnlyBlock3'>								<div class=' VFSPSBillProfCCReadOnlyBlock4 VFSPSBillProfCCReadOnlyDataBlock'>									<div class=' VFSPSBillProfCCReadOnlyBlock51'>										<div class='VFSPSDisplayTableCell VFSPSBillProfCCReadOnlyBlock6 VFSPSBillProfCCTypeImgDiv'><img src='images/VFSPSAMEX-TOKEN.png' /></div>										<div class='VFSPSDisplayTableCell VFSPSBillProfCCReadOnlyBlock7'>											<div class='VFSPBillProfCCMaskedCCCNum'>												<span class='VFSPSBillProfCCFirst2Digit'>12</span>XX XXXX XXXX <span class='VFSPSBillProfCCLast4Digits'>1234</span>											</div>										</div>									</div>									<div class=' VFSPSBillProfCCReadOnlyBlock52'>										<div class='VFSPSDisplayTableCell VFSPSBillProfCCReadOnlyBlock6'></div>										<div class='VFSPSDisplayTableCell VFSPSBillProfCCReadOnlyBlock7'>Exp:<span class='VFSPSBillProfCCReacOnlyExpiryDate'>10/19</span></div>									</div>									<div class='VFSPSDisplayNone VFSPSBillProfHiddenSectionCC'>										<div class='VFSPSBillProdCCHolderName'></div>										<div class='VFSPSBillProfCCNumber'></div>										<div class='VFSPSBillProfCCType'></div>									</div>								</div>							</div>							<div class='VFSPSDisplayTableCell VFSPSBillProfCCReadOnlyBlock8 VFSPSBillProfCCChangePar'>								<div class='VFSPSBillProfCCChange VFSPSBillProfCCChangeCard'>Change</div>							</div>						</div>					</div>				</div>"}function VFSPSToggle(){var sAlertValue=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue>input").val();sAlertValue=="Email"?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue").siblings("#Email").attr("style","display:block;"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue").siblings("#Email").attr("style","display:none;");sAlertValue=="TXT"?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue").siblings("#Text").attr("style","display:block;"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue").siblings("#Text").attr("style","display:none;");sAlertValue=="Email and TXT"?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue").siblings("#TextEmail").attr("style","display:block;"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue").siblings("#TextEmail").attr("style","display:none;");var sPaymentValue=$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue>input").val();var SavedCard=GetPaymentType("SavedCard");if(SavedCard=="Credit Card"){$(".VFSPSBillingForm"+rowId+" .VFSPSBillingDetailsPayCorpiFrame").addClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+" .VFSPSBillingDetailsPaycorpReadOnly").removeClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").siblings("#Credit").attr("style","display:block;")}else{if(sPaymentValue=="Credit Card"){VFSPSShowCreditCardiFrame()}else{$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").siblings("#Credit").attr("style","display:none;")}}if(sPaymentValue!="Credit Card"){$(".VFSPSBillingForm"+rowId+" .VFSPSBillingDetailsPaycorpReadOnly").addClass("VFSPSDisplayNone")}sPaymentValue=="Direct Debit"?$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").siblings("#Debit").attr("style","display:block;"):$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").siblings("#Debit").attr("style","display:none;");sPaymentValue=="Other"?$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").siblings("#Other").attr("style","display:block;"):$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").siblings("#Other").attr("style","display:none;");VFSPSBillingSaveEnable();if($(".VFPPOUIPayCorpSubmit").is(":visible")){$(".VFSPSBillingForm"+rowId+" #VFSPSSuccess").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+" .VFSPSSavebutton").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock")}}function VFSPSUpdateBill(){var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();var sValue=$(".VFSPSBillingForm"+rowId+" .VFSPSAlertTxtValue > input").val();var sBillId=$(".VFSPSAccountHeader"+rowId+">.VFSPSBillId>input").val();var sBillProfileId=$(".VFSPSBillingForm"+rowId+">.VFSPSProfileId>input").val();Input.SetProperty("BillAccId",sBillId);Input.SetProperty("BillProfileId",sBillProfileId);Input.SetProperty("sMSISDN",sValue);Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","UpdateBillAlertTxt",Input,{})}function VFSPSBorderColour(){var sAlertValue=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue>input").val();var sPaymentValue=$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue>input").val();var sEmailValue=$(".VFSPSBillingForm"+rowId+">.VFSPSEmailValue>input").val();var sEmailAlert=$(".VFSPSBillingForm"+rowId+">.VFSPSEmailValue>input").val();var sAlertTXT=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertText>.VFSPSAlertTxtValue>input").val();var sCExpiry=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSExpiryValue>input").val();var sCNumber=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNumberValue>input").val();var sCName=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNameValue>input").val();var sCType=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSBillingCardTypeValue>input").val();var sDAccName=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNameValue>input").val();if($(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").is(":visible")){var sDAccNumber=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").val();var ssAccountInput=true}else{var sDAccNumber=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue .VFSPSAccountNumberValueDiv").html();var ssAccountInput=false}var sDBSB=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>input").val();var sManCountry=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualCountryValue>input").val();var sManPostal=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualPostalValue>input").val();var sManState=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStateValue>input").val();var sManSuburb=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualSuburbValue>input").val();var sManStreetName=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetAddressValue>input").val();var sManStreetNo=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetNoValue>input").val();var sManStreetType=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetTypeValue>input").val();var sManBuilding=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualBuildingValue>input").val();var sManApt=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualAptValue>input").val();var sManFloor=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualFloorValue>input").val();var sManAddFormat=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualTypeValue>input").val();sAlertValue==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sPaymentValue==""?$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sEmailValue==""?$(".VFSPSBillingForm"+rowId+">.VFSPSEmailValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSEmailValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sAlertTXT==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertText>.VFSPSAlertTxtValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertText>.VFSPSAlertTxtValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sEmailAlert==""?$(".VFSPSBillingForm"+rowId+">.VFSPSEmailValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSEmailValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sCExpiry==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSExpiryValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSExpiryValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sCNumber==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNumberValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNumberValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sCName==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNameValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNameValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sDAccName==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNameValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNameValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");if(ssAccountInput){sDAccNumber==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour")}else{sDAccNumber==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue .VFSPSAccountNumberValueDiv").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue .VFSPSAccountNumberValueDiv").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour")}sDBSB==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManCountry==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualCountryValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualCountryValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManPostal==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualPostalValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualPostalValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManState==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStateValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStateValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManSuburb==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualSuburbValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualSuburbValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManStreetName==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetAddressValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetAddressValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManStreetNo==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetNoValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetNoValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManStreetType==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetTypeValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetTypeValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManBuilding==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualBuildingValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualBuildingValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManApt==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualAptValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualAptValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManFloor==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualFloorValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualFloorValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour");sManAddFormat==""?$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualTypeValue>input").addClass("VFSTextFilledBorderColour").removeClass("VFSDefaultBorderColour"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualTypeValue>input").addClass("VFSDefaultBorderColour").removeClass("VFSTextFilledBorderColour")}function VFSPSShowChangeCreditCardiFrame(e){$(".VFSPSBillingForm"+rowId+" .VFSPSBillingDetailsPayCorpiFrame").removeClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+" .VFSPSBillingDetailsPaycorpReadOnly").addClass("VFSPSDisplayNone");VFSPSShowCreditCardiFrame()}function VFSPSShowCreditCardiFrame(e){var sBillProfileId=$(".VFSPSBillingForm"+rowId+">.VFSPSProfileId>input").val();var ser=SiebelApp.S_App.GetService("Workflow Process Manager");var Inputs=SiebelApp.S_App.NewPropertySet();var WF="VF PCI INIT Workflow";Inputs.SetProperty("CompName","VFBillProfUpdate");Inputs.SetProperty("Identifier",sBillProfileId);console.log("ROw Id :"+sBillProfileId);var out=VFCustomSiebelInterface.CallWorkflow(WF,Inputs,{});var PayCorpURL=out.GetProperty("Paycorp URL");$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").siblings("#Credit").children(".VFSPSBillingDetailsPayCorpiFrame").removeClass("VFSPSDisplayNone").html('<iframe id="VFPPOUIPayCorpIFrameID" src="'+PayCorpURL+'" class="VFPayCorpiFrameheight"/><div class="VFPPOUIPayCorpSubmit VFSPSBillProfAddCard InActive">Add Card</div>');$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").siblings("#Credit").attr("style","display:block;");$(".VFSPSBillingForm"+rowId+" .VFSPSSavebutton").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSBillingForm"+rowId+" #VFSPSSuccess").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock")}function VFSPSAccountNumberValueDiv(e){var par=$(this).parent();$(this).addClass("VFSPSDisplayNone");par.children("input").removeClass("VFSPSDisplayNone");par.children("input").val("").focus();VFSPSToggle()}function VFSPSBillingPostCodeCheckLength(e){if((event.which!=8)&&(event.which!=46)){var val=$(this).val();if(val.length==4){event.preventDefault();event.stopPropagation()}}}function VFSPSBillingPostCodeDropDown(e){var val=$(this).val();if(val.length==4){var row=$(this).parent().parent().parent().attr("id");$(".VFSPSBillingForm"+row+" .VFSPSManualStateValue>input").removeAttr("readonly");$(".VFSPSBillingForm"+row+" .VFSPSManualSuburbValue>input").removeAttr("readonly");var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("Business Component Name","VF Postcode Validated VBC");VFCustomSiebelInterface.SetProfileAttr("PostcodeAttr",$(this).val());VFSPSUdateUIFrameWork.VFSPSBlockUI("");setTimeout(function(){Output=VFCustomSiebelInterface.CallBS("VF Generic VBC Service","Query",Input,{});var PicklistValues=new Array();var ArrayList=VFCustomSiebelInterface.SiebelMessageToArray(Output);var ArrayListLen=ArrayList.length;for(var i=0;i<ArrayListLen;i++){PicklistValues[PicklistValues.length]=ArrayList[i]["VFSPSSuburb"]}var selector=".VFSPSBillingForm"+row+" .VFSPSManualSuburbValue > input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML","VFSPSBillingSubrub");VFSPSUdateUIFrameWork.VFSPSUnblockUI()},100)}}function VFSPSBillingSubrub(e){var subrub=$(".VFSPSBillingForm"+rowId+" .VFSPSManualSuburbValue > input").val();var arrayOfStrings=subrub.split(",");$(".VFSPSBillingForm"+rowId+" .VFSPSManualStateValue>input").val(arrayOfStrings[1]);$(".VFSPSBillingForm"+rowId+" .VFSPSManualSuburbValue > input").val(arrayOfStrings[0]);$(".VFSPSBillingForm"+rowId+" .VFSPSManualStateValue>input").attr("readonly","true");$(".VFSPSBillingForm"+rowId+" .VFSPSManualSuburbValue > input").attr("readonly","true")}VFSPSBillingDetailsPR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSBillingDetailsPR.superclass.BindEvents.call(this);var pm=this.GetPM();$(".VFSPSAccountSection").delegate(".VFPPOUIPayCorpSubmit.Active","click",{ctx:this},VFSPSPaycorpSubmit);$(".VFSPSAccountSection").delegate(".VFSPSBillProfCCChangeCard","click",{ctx:this},VFSPSShowChangeCreditCardiFrame);$(".VFSPSAccountSection").delegate(".VFSPSAccountNumberValueDiv","click",{ctx:this},VFSPSAccountNumberValueDiv);$(".VFSPSAccountSection").delegate(".VFSPSdownarrow","click",{ctx:this},VFSPSShowBillingForm);$(".VFSPSPlaybarButton").delegate(".VFSPSCustomNextButton","click",{ctx:this},VFSPSTaskNext);$(".VFSPSPlaybarButton").delegate(".VFSPSCancelClick","click",{ctx:this},VFSPSTaskCancel);$(".VFSPSPlaybarButton").delegate(".VFSPSSaveClick","click",{ctx:this},VFSPSTaskSaveOrder);$(".VFSPSAccountSection").delegate(".VFSPSManualPostalValue>input","keydown",{ctx:this},VFSPSBillingPostCodeCheckLength);$(".VFSPSAccountSection").delegate(".VFSPSManualPostalValue>input","input",{ctx:this},VFSPSBillingPostCodeDropDown);function VFSPSShowBillingForm(e){rowId=$("#"+this.id).parent().parent().attr("id");SetRowId(rowId);sSelectBillId=$(".VFSPSAccountHeader"+rowId+">.VFSPSBillId>input").val();var imgs=$(".VFSPSaccordion").find("img");if($(".VFSPSBillingForm"+rowId).hasClass("VFSPSDisplayBlock")){$(".VFSPSBillingForm").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$(".VFSPSAccountHeader").removeClass("VFSPSAccountHeaderClick");$(".VFSPSBillingForm"+rowId).removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$(".VFSPSAccountHeader"+rowId).removeClass("VFSPSAccountHeaderClick");$(".VFSPSAccountHeader"+rowId).find(".VFSPSdownarrow").attr("src","images/VFSPSdownarrow.png")}else{$(".VFSPSBillingForm"+rowId+" #VFSPSManAdd").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").parent().show();$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").parent().prev().show();LoadChildDetails(sSelectBillId,rowId);$(".VFSPSBillingForm").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$(".VFSPSAccountHeader").removeClass("VFSPSAccountHeaderClick");$(".VFSPSBillingForm"+rowId).removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$(".VFSPSAccountHeader"+rowId).addClass("VFSPSAccountHeaderClick");$(".VFSPSaccordion").find("img").attr("src","images/VFSPSdownarrow.png");$(".VFSPSAccountHeader"+rowId).find(".VFSPSdownarrow").attr("src","images/VFSPSWhiteChevron.png");if(!$(".VFSPSBillingForm"+rowId).find("img").hasClass("VFSPSDropDownIcon")){$(".VFSPSBillingForm"+rowId+" #Payment").after('<img id="VFSPSBillingDropDownPayment" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$(".VFSPSBillingForm"+rowId+" #VFSPSAlertType").after('<img id="VFSPSBillingDropDownAlertType" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">');$(".VFSPSBillingForm"+rowId+" #CreditCardType").after('<img id="VFSPSBillingDropDownCardType" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$(".VFSPSBillingForm"+rowId+" #VFSPSFloorType").attr("placeholder","--Select--").after('<img id="VFSPSBillingDropDownFloorType" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$(".VFSPSBillingForm"+rowId+" #VFSPSStreetType").attr("placeholder","--Select--").after('<img id="VFSPSBillingDropDownStreetType" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$(".VFSPSBillingForm"+rowId+" #VFSPSState").attr("placeholder","--Select--").after('<img id="VFSPSBillingDropDownState" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$(".VFSPSBillingForm"+rowId+" #VFSPSCountry").attr("placeholder","--Select--").after('<img id="VFSPSBillingCountryDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$(".VFSPSBillingForm"+rowId+" #VFSPSType").attr("placeholder","--Select--").after('<img id="VFSPSBillingTypeDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$(".VFSPSBillingForm"+rowId+" .VFSPSAlertTxtValue > input").after('<img id="VFSPSBillingDropDownAlertText" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">')}}VFSPSToggle();var sBO=SiebelApp.S_App.GetActiveBusObj();var sBC=sBO.GetBusCompByName("VF Capture Customer Details TBC");var sConnectionType=sBC.GetFieldValue("VF SPS Connection Type");if(sConnectionType=="NewCustomer"){$(".VFSPSBillingCustomerMobile").show()}else{if(sConnectionType=="ExistingCustomer"){$(".VFSPSBillingCustomerMobile").hide()}}if(!$("img").hasClass("VFSSPSAddressvalidationicon")){$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPStick.png"></img>')}$(".VFSPSBillingForm"+rowId).delegate(".VFSPSSavebutton","click",{ctx:this},VFSPSUpsertBillingForm);$(".VFSPSBillingForm"+rowId).delegate(".VFSPSBillingPickIcon","click",{ctx:this},VFSPSBSBUpdate);$(".VFSPSBillingForm"+rowId+" .VFSPSAlertTxtValue").delegate("#VFSPSBillingDropDownAlertText","click",{ctx:this},VFSPSBillingAlertTextDropDown);$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue").delegate("#VFSPSBillingDropDownPayment","click",{ctx:this},VFSPSBillingPaymentDropDown);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue").delegate("#VFSPSBillingDropDownAlertType","click",{ctx:this},VFSPSBillingAlertTypeDropDown);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSBillingCardTypeValue").delegate("#VFSPSBillingDropDownCardType","click",{ctx:this},VFSPSBillingDropDownCardType);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualFloorValue").delegate("#VFSPSBillingDropDownFloorType","click",{ctx:this},VFSPSBillingDropDownFloorType);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetTypeValue").delegate("#VFSPSBillingDropDownStreetType","click",{ctx:this},VFSPSBillingDropDownStreetType);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStateValue").delegate("#VFSPSBillingDropDownState","click",{ctx:this},VFSPSBillingDropDownState);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualCountryValue").delegate("#VFSPSBillingCountryDropDown","click",{ctx:this},VFSPSBillingCountryDropDown);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualTypeValue").delegate("#VFSPSBillingTypeDropDown","click",{ctx:this},VFSPSBillingTypeDropDown);$(".VFSPSBillingForm"+rowId).delegate(".VFSPSBillingTypeCredit>.VFSPSExpiryValue>input,.VFSPSBillingValue>input,.VFSPSEmailValue>input,.VFSPSBillingAlertValue>input,.VFSPSAlertTxtValue>input,.VFSPSBillAlertEmailValue>input,.VFSPSBillingTypeCredit>.VFSPSCardNameValue>input,.VFSPSBillingTypeCredit>.VFSPSCardNumberValue>input,.VFSPSBillingTypeCredit>.VFSPSCardTypeValue>input,.VFSPSBillingTypeDebit>.VFSPSAccountNameValue>input,.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input,.VFSPSBillingTypeDebit>.VFSPSBSBValue>input","input",{ctx:this},VFSPSBillingSaveEnable);$("#VFSPSManAdd").addClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").autocomplete({source:function(request,response){$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").parent().find(".VFSSPSAddressvalidationicon").remove();$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPSaddress-loader.gif"></img>');var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();var sValue=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").val();inPS.SetProperty("SearchString",sValue);setTimeout(function(){if(service){var outPS=service.InvokeMethod("DoSearchProxy",inPS);var resultSet=outPS.GetChild(0);var addrCount=resultSet.GetChildCount();var addrArray=[];if(resultSet){for(var i=0;i<=addrCount;i++){if(i==addrCount){addrArray.push("Address Not Found? Click Here"+"~^"+"404")}else{addrArray.push(resultSet.GetChild(i).GetProperty("QAS Wsdl Address")+"~^"+resultSet.GetChild(i).GetProperty("QAS Wsdl Moniker"))}}}$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").parent().find(".VFSSPSAddressvalidationicon").remove()}response($.map(addrArray,function(item,id){var res=item.split("~^");return{value:res[0],id:res[1]}}))},50)},minLength:5,appendTo:$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").parent(),select:function(event,ui){var sPickAddr=ui.item.value;var sMonikerval=ui.item.id;var sAddressId=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").attr("sAddressId");var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("PickMoniker",sMonikerval);Input.SetProperty("PickFullAddr",sPickAddr);Input.SetProperty("sAddressId",sAddressId);Input.SetProperty("sBillAccId",sSelectBillId);if(sMonikerval=="404"){$("#VFSPSManAdd").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").parent().hide();$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").parent().prev().hide()}else{Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","BillAddressInsert",Input,{});var sAddressId=Output.GetProperty("sAddressId");var sAdd=Output.GetProperty("sAdd");$("#VFSPSManAdd").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");if(!$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").parent().find("img").hasClass("VFSSPSAddressvalidationicon")){$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPStick.png"></img>')}}}})}$(".VFSPSAccountSection").delegate('.VFSPSRadioButtonDiv input[type="radio"]',"click",function(){VFSPSBillingSaveEnable()});$(".VFSPSNewBilling").delegate("#VFSPSCreateImage","click",{},VFSPSShowBillingAccountNo);$(".VFSPSAccountSection").delegate(".VFSPSCheck","click",function(){if($(this).is(":checked")){$(".VFSPSAccountSection").find(".VFSPSCheck").each(function(){$(".VFSPSAccountSection").find(".VFSPSCheck").prop("checked",false)});$(this).prop("checked",true);var row=$(this).parent().parent().attr("id");PrimaryBillId=$(".VFSPSAccountHeader"+row+">.VFSPSBillId>input").val();var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("Profile Attribute Name","VFSPSBillingAccntId");Input.SetProperty("Profile Attribute Value",PrimaryBillId);Output=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",Input,{});$(".VFSPSSaveNewAccount").addClass("VFSPSBillSaveBtnEnabled").removeClass("VFSPSBillSaveBtnDisabled");ValidateNextButton(PrimaryBillId,row)}else{$(".VFSPSCustomNextButton").removeClass("VFSPSPlaybarNextBtnEnabled").addClass("VFSPSPlaybarNextBtnDisabled");$(".VFSPSSaveNewAccount").addClass("VFSPSBillSaveBtnDisabled").removeClass("VFSPSBillSaveBtnEnabled")}});$(".VFSPSSaveNewAccount").click(function(){VFSPSUpdatePrimaryAccount()});function VFSPSPaycorpSubmit(e){var paymentFrame=document.getElementById("VFPPOUIPayCorpIFrameID").contentWindow;paymentFrame.postMessage(JSON.stringify({type:"SUBMIT"}),"*")}function VFSPSBillingAlertTextDropDown(e){var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();var BillId=$(".VFSPSAccountHeader"+rowId+">.VFSPSBillId>input").val();var sBillingProfileId=$(".VFSPSBillingForm"+rowId+">.VFSPSProfileId>input").val();Input.SetProperty("BillAccId",BillId);Input.SetProperty("BillProfileId",sBillingProfileId);Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","FetchBillAlertTxt",Input,{});var Picklist=new Array();var ArrayList=VFCustomSiebelInterface.SiebelMessageToArray(Output);var ArrayListLen=ArrayList.length;for(var i=0;i<ArrayListLen;i++){Picklist[Picklist.length]=ArrayList[i]["NotificationMSISDN"]}var selector=".VFSPSBillingForm"+rowId+" .VFSPSAlertTxtValue > input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",Picklist,"","","HTML","VFSPSUpdateBillAlertTxt")}$("#Yes, #No").change(function(){var sAddressOpt=$(".VFSPSBillingForm"+rowId+">.VFSPSAddressPresentValue>div>input[name=Address]:checked").val();if(sAddressOpt=="Yes"){}else{if(sAddressOpt=="No"){$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue").after('<div class ="VFSPSBillingValue'+rowId+'"><input type="text" name="VFSPSAddressValue2" class="VFSPSBillingField"></div>')}}})};function VFSPSTaskCancel(){var view=SiebelApp.S_App.GetActiveView();var applet=view.GetApplet("VF SPS Task Playbar Applet - Top");applet.InvokeMethod("CancelTask")}function VFSPSTaskSaveOrder(){var view=SiebelApp.S_App.GetActiveView();var applet=view.GetApplet("VF SPS Task Playbar Applet - Top");applet.InvokeMethod("PauseTask")}function VFSPSTaskNext(){if($(this).hasClass("VFSPSPlaybarNextBtnEnabled")==true){var view=SiebelApp.S_App.GetActiveView();var applet=view.GetApplet("VF SPS Task Playbar Applet - Top");applet.InvokeMethod("NavigateNext")}}function VFSPSBillingSaveEnable(e){var inputName=$(this).attr("name");switch(inputName){case ("VFSPSAccountNumberValue"):AccountNo=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").val();break;case ("VFSPSCardNumberValue"):CreditCardNo=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNumberValue>input").val();break;case ("VFSPSBSBValue"):$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue").addClass("VFBSBNotValidated").removeClass("VFBSBValidated");$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>.VFSPSBillingPickIcon").attr("src","images/VFSPSSearchICON.png");break;default:}VFSPSBorderColour();if($(".VFSPSBillingForm"+rowId+" .VFSPSSavebutton").hasClass("VFSPSDisplayNone")){$(".VFSPSBillingForm"+rowId+" #VFSPSSuccess").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+" .VFSPSSavebutton").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock")}var Pay=$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue>input").val();var EmailIDVal=$(".VFSPSBillingForm"+rowId+">.VFSPSEmailValue>input").val();var AddressVal=$(".VFSPSBillingForm"+rowId+' input[name="VFSPSAddressValue"]').val();var sEmailMode;var sBO=SiebelApp.S_App.GetActiveBusObj();var sBC=sBO.GetBusCompByName("VF Capture Customer Details TBC");var sConnectionType=sBC.GetFieldValue("VF SPS Connection Type");var salert;if(sConnectionType=="NewCustomer"){salert="Y"}else{salert=$(".VFSPSBillingForm"+rowId+">.VFSPSAlertTxtValue>input").val()}$(".VFSPSBillingForm"+rowId+">.VFSPSHowtoBillValue>.VFSPSRadioButtonDiv>input[name=Bill]").each(function(){if($(this).is(":checked")){sEmailMode=$(this).val();return false}else{sEmailMode=""}});if(Pay=="Credit Card"){var ccHolder=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProdCCHolderName").html();var ccNum=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProfCCNumber").html();var ccExp=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProfCCReacOnlyExpiryDate").html();var ccType=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProfCCType").html();var ReadOnly=$(".VFSPSBillingForm"+rowId+" .VFSPSBillingDetailsPaycorpReadOnly").is(":visible");if(ReadOnly&&ccHolder!=""&&ccNum!=""&&ccExp!=""&&ccType!=""){var sEnableCredit="Y"}}if(Pay=="Direct Debit"){var ssAccountNum="";if($(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").is(":visible")){ssAccountNum=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").val()}else{ssAccountNum=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue .VFSPSAccountNumberValueDiv").html()}var ssAccountName=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNameValue>input").val();if(ssAccountNum!=""&&ssAccountName!=""&&$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>input").val()!=""&&$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue").hasClass("VFBSBValidated")){var sEnableDebit="Y"}}if((sEnableCredit=="Y"||sEnableDebit=="Y"||Pay=="Other")&&salert!=""&&EmailIDVal!=""&&AddressVal!=""){if($(".VFSPSBillingForm"+rowId+">.VFSPSHowtoBillValue").hasClass("VFSPSDisplayBlock")&&sEmailMode==""){$(".VFSPSBillingForm"+rowId+">.VFSPSSavebutton").addClass("VFSPSBillSaveBtnDisabled").removeClass("VFSPSBillSaveBtnEnabled")}else{$(".VFSPSBillingForm"+rowId+">.VFSPSSavebutton").addClass("VFSPSBillSaveBtnEnabled").removeClass("VFSPSBillSaveBtnDisabled")}}else{if($(".VFSPSBillingForm"+rowId).parent().find(".VFSPSCheck").is(":checked")==true){$(".VFSPSCustomNextButton").removeClass("VFSPSPlaybarNextBtnEnabled").addClass("VFSPSPlaybarNextBtnDisabled")}$(".VFSPSBillingForm"+rowId+">.VFSPSSavebutton").addClass("VFSPSBillSaveBtnDisabled").removeClass("VFSPSBillSaveBtnEnabled")}}function VFSPSBillingPaymentDropDown(e){var SearchString="[List Of Values.Type] = 'VF_PAY_TYPE' AND [List Of Values.Active] = 'Y' AND [List Of Values.Parent] = 'Australia'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector=".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue>input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML","VFSPSToggleBilling")}function VFSPSBillingAlertTypeDropDown(e){var SearchString="[List Of Values.Type] = 'VF_NOTFCTN_TYPE' AND [List Of Values.Active] = 'Y' AND [List Of Values.High] = 'Australia'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector=".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue>input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML")}function VFSPSBillingDropDownCardType(e){var SearchString="[List Of Values.Type] = 'VF_CC_TYPE' AND [List Of Values.Active] = 'Y' AND [List Of Values.Parent] = 'Postpay'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector=".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSBillingCardTypeValue>input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML")}function VFSPSBillingDropDownFloorType(e){var SearchString="[List Of Values.Type] = 'VF_ADDRESS_FLOOR_TYPE' AND [List Of Values.Active] = 'Y'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector=".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualFloorValue>input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML")}function VFSPSBillingDropDownStreetType(e){var SearchString="[List Of Values.Type] = 'VF_ADDRESS_STREET_TYPE' AND [List Of Values.Active] = 'Y' AND [List Of Values.High] = 'Australia'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector=".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetTypeValue>input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML")}function VFSPSBillingDropDownState(e){var SearchString="[List Of Values.Type] = 'VF_ADDRESS_STATE' AND [List Of Values.Active] = 'Y'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector=".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStateValue>input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML")}function VFSPSBillingCountryDropDown(e){var SearchString="[List Of Values.Type] = 'COUNTRY' AND [List Of Values.Active] = 'Y'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector=".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualCountryValue>input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML")}function VFSPSBillingTypeDropDown(e){var SearchString="[List Of Values.Type] = 'FIN_CON_ADDRESS_TYPE' AND [List Of Values.Active] = 'Y'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector=".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualTypeValue>input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML")}function VFSPSUpdatePrimaryAccount(){}function VFSPSBSBUpdate(){var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("BSBNumber",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>input").val());Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","GetBSBNumber",Input,{});var sBSBNumber=Output.GetProperty("BSBNumber");if(sBSBNumber!=""){$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue").addClass("VFBSBValidated").removeClass("VFBSBNotValidated");$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>.VFSPSBillingPickIcon").attr("src","images/VFSPStick.png")}VFSPSBillingSaveEnable()}function VFSPSUpsertBillingForm(){if($(this).hasClass("VFSPSBillSaveBtnDisabled")){event.preventDefault();event.stopPropagation()}else{var sEmailOpt=$(".VFSPSBillingForm"+rowId+">.VFSPSHowtoBillValue>.VFSPSRadioButtonDiv>input[name=Bill]:checked").val();var sPaymentValue=$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue>input").val();var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("CustAccId",sAccId);Input.SetProperty("BillAccId",$(".VFSPSAccountHeader"+rowId+">.VFSPSBillId>input").val());Input.SetProperty("sBillAccId",$(".VFSPSAccountHeader"+rowId+">.VFSPSBillId>input").val());Input.SetProperty("sPayType",$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue>input").val());Input.SetProperty("sProfileId",$(".VFSPSBillingForm"+rowId+">.VFSPSProfileId>input").val());Input.SetProperty("sBillAlertTXT",$(".VFSPSBillingForm"+rowId+">.VFSPSAlertTxtValue>input").val());Input.SetProperty("sBillAlertMth","TXT");Input.SetProperty("sEmailBillTo",$(".VFSPSBillingForm"+rowId+">.VFSPSEmailValue>input").val());if(sPaymentValue=="Credit Card"){var ssCardName=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProdCCHolderName").html();var ssCreditCardNo=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProfCCNumber").html();var ssExpiry=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProfCCReacOnlyExpiryDate").html();var ssCardType=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProfCCType").html();CreditCardNo=ssCreditCardNo;Input.SetProperty("sExpiry",ssExpiry);Input.SetProperty("sCardNum",ssCreditCardNo);Input.SetProperty("sCardName",ssCardName);Input.SetProperty("sCardType",ssCardType)}else{if(sPaymentValue=="Direct Debit"){Input.SetProperty("sAccountName",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNameValue>input").val());Input.SetProperty("sAccountNumber",AccountNo);Input.SetProperty("sBSB",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>input").val())}else{}}if(sEmailOpt=="Email"){Input.SetProperty("sEmailOpt","Y")}else{Input.SetProperty("sEmailOpt","N")}if($("#VFSPSManAdd").hasClass("VFSPSDisplayBlock")){Input.SetProperty("PickMoniker","404");var sAddressId=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").attr("sAddressId");Input.SetProperty("sAddressId",sAddressId);Input.SetProperty("Address Format",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualTypeValue>input").val());Input.SetProperty("Floor Type",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualFloorValue>input").val());Input.SetProperty("Floor",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualAptValue>input").val());Input.SetProperty("Address Building",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualBuildingValue>input").val());Input.SetProperty("Street Type",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetTypeValue>input").val());Input.SetProperty("Street Number",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetNoValue>input").val());Input.SetProperty("Street Name",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStreetAddressValue>input").val());Input.SetProperty("Suburb",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualSuburbValue>input").val());Input.SetProperty("State",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualStateValue>input").val());Input.SetProperty("Post Code",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualPostalValue>input").val());Input.SetProperty("Country",$(".VFSPSBillingForm"+rowId+">.VFSPSBillingManualAdd>.VFSPSManualCountryValue>input").val())}Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","ValidateBillingDetails",Input,{});Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","BillDetailsupsert",Input,{});sProfileId=Output.GetProperty("sProfileId");var sAccountNbr=Output.GetProperty("sAccNbr");var sCreditNbr=Output.GetProperty("sCreditNumber");var sAddressId=Output.GetProperty("sAddressId");$(".VFSPSBillingForm"+rowId+" #VFSPSSuccess").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+" .VFSPSSavebutton").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");if($(".VFSPSBillingForm"+rowId).parent().find(".VFSPSCheck").is(":checked")==true){$(".VFSPSCustomNextButton").removeClass("VFSPSPlaybarNextBtnDisabled").addClass("VFSPSPlaybarNextBtnEnabled")}$(".VFSPSBillingForm"+rowId+">.VFSPSProfileId>input").val(sProfileId);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").val(sAccountNbr);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue .VFSPSAccountNumberValueDiv").html(sAccountNbr);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNumberValue>input").val(sCreditNbr);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").addClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue .VFSPSAccountNumberValueDiv").removeClass("VFSPSDisplayNone");var sSelectBillId=$(".VFSPSAccountHeader"+rowId+">.VFSPSBillId>input").val();var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("BillAccId",sSelectBillId);Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","BillDetails",Input,{});var PaymentType=Output[0]["PayType"];SetPaymentType(PaymentType)}}function VFSPSShowBillingAccountNo(){var template=" <div class='VFSPSBillingOverlay VFSPSDisplayBlock'>								<div class='VFSPSBillingPopup'>									<span title='Close' class='VFSPSBillingClose'><img src='images/vfspsclose.jpg'></span>									<h2 class='VFSPSBillingAccountNumber'><span>Billing Account Number:</span><span>"+sAccId+"</span></h2>									<div class='VFSPSBillingAccountDetails'>										<div class='VFSPSBillingPopupLabel'><span>Name on Billing Account</span></div>										<div><input type='text' name='VFSPSBillingNameValue' class='VFSPSBillingPopupValue' id='VFSPSBillingPopupName'></div>										<div class='VFSPSBillingPopupLabel'><span>Choose a PIN for your Billing Account</span></div>										<div><input type='number' name='VFSPSBillingPinValue' class='VFSPSBillingPopupValue' id='VFSPSBillingPopupPIN'></div>										<div class='VFSPSBillingCancelButton'>Cancel</div>										<div class='VFSPSBillingCreatePopup'>Create</div></div>									</div>							</div>";if($(".VFSPSBillingOverlay").length==0){$("body").append(template);$("#VFSPSBillingPopupPIN").attr("placeholder","Must be 4 digits").attr("type","number")}$('input[name="VFSPSBillingNameValue"]').val("");$('input[name="VFSPSBillingPinValue"]').val("");$(".VFSPSBillingOverlay").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$(".VFSPSBillingOverlay").undelegate();$(".VFSPSBillingPopup").delegate(".VFSPSBillingClose","click",{},function(e){$(".VFSPSBillingOverlay").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")});$(".VFSPSBillingOverlay").undelegate();$(".VFSPSBillingAccountDetails").delegate(".VFSPSBillingCancelButton","click",{},function(e){$(".VFSPSBillingOverlay").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")});$(".VFSPSBillingAccountDetails").delegate("input[name=VFSPSBillingPinValue]","keydown",{ctx:this},VFSPSCheckLengthFour);function VFSPSCheckLengthFour(e){if((event.which!=8)&&(event.which!=46)){var val=$(this).val();if(val.length==4){event.preventDefault();event.stopPropagation()}}}$(".VFSPSBillingOverlay").undelegate();$(".VFSPSBillingOverlay").delegate(".VFSPSBillingCreatePopup","click",{},function(e){var sName=$("#VFSPSBillingPopupName").val();var sPIN=$("#VFSPSBillingPopupPIN").val();$(".VFSPSBillingOverlay").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("CustAcctId",sAccId);Input.SetProperty("BillId","");Input.SetProperty("PIN",sPIN);Input.SetProperty("Name",sName);Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","BillHeaderupsert",Input,{});var sAccountNbr=Output.GetProperty("AccountNbr");var sBillId=Output.GetProperty("BillId");sName=Output.GetProperty("Name");sPIN=Output.GetProperty("Password");var i=$(".VFSPSAccountSection").children().length+1;var header="<div id = "+i+' class="VFSPSAccountHeader VFSPSAccountHeader'+i+'">					<div class="VFSPSBillingCheckbox"><input type="checkbox" name="AcntNumber" class = "VFSPSCheck"></div>									<div class="VFSPSAccountName VFSPSFloatLeft"><span>Account number:</span><span class="VFSPSAccountValue VFSPSAccountValue'+i+'">'+sAccountNbr+'</span></div>									<div class="VFSPSName VFSPSFloatLeft"><span>Name:</span><span class="VFSPSNameValue VFSPSNameValue'+i+'">'+sName+'</span></div>									<div class="VFSPSPIN VFSPSFloatLeft"><span>PIN:</span><span class="VFSPSPINValue VFSPSPINValue'+i+'">'+sPIN+'</span></div>									<div class="VFSPSBillId VFSPSDisplayNone"><input type="text" name="VFSPSBillIdValue" class="VFSPSBillId VFSPSBillId'+i+'"value ="'+sBillId+'"></div>									<div class="VFSPSaccordion VFSPSFloatLeft"><img id = "VFSPSdownarrow'+i+'" class = "VFSPSdownarrow" src="images/VFSPSdownarrow.png"></div>';var AccountChildSection=FormChildTemplate(i,Output);if(sAccountNbr!=""&&sBillId!=""){$(".VFSPSAccountSection").append(header);$(".VFSPSAccountHeader"+i).append(AccountChildSection);$(".VFSPSBillingForm").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$(".VFSPSAccountHeader").removeClass("VFSPSAccountHeaderClick");$(".VFSPSBillingForm").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$(".VFSPSAccountHeader").removeClass("VFSPSAccountHeaderClick");$(".VFSPSAccountHeader").find(".VFSPSdownarrow").attr("src","images/VFSPSdownarrow.png")}})}function SetPaymentType(Type){var App=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Billing Account List Applet");var pm=App.GetPModel();var pr=pm.GetRenderer();pr.SetData("SavedCard",Type)}function GetPaymentType(Type){var App=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Billing Account List Applet");var pm=App.GetPModel();var pr=pm.GetRenderer();return pr.GetData("SavedCard")}function SetRowId(Val){var App=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Billing Account List Applet");var pm=App.GetPModel();var pr=pm.GetRenderer();pr.SetData("rowId",Val)}function GetRowId(Val){var App=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Billing Account List Applet");var pm=App.GetPModel();var pr=pm.GetRenderer();return pr.GetData("rowId")}function GetCardType(Type){var sType=Type.toUpperCase();var retVal="";switch(Type){case ("DINERS CLUB"):retVal="VFSPSDINERS-TOKEN.png";break;case ("VISA"):retVal="VFSPSVISA-TOKEN.png";break;case ("AMEX"):case ("AMERICAN EXPRESS"):retVal="VFSPSAMEX-TOKEN.png";break;case ("MASTERCARD"):retVal="VFSPSMC-TOKEN.png";break;default:}return retVal}function LoadChildDetails(sSelectBillId,rowId){var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("BillAccId",sSelectBillId);Output=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","BillDetails",Input,{});Output=VFCustomSiebelInterface.SiebelMessageToArray(Output);if(Output.length){var Addr=Output[0]["Addrline1"]+" "+Output[0]["Addrline2"]+" "+Output[0]["City"]+" "+Output[0]["PostCode"];var Expiry="";if(Output[0]["ExpMonth"]!=""||Output[0]["ExpYear"]!=""){Expiry=Output[0]["ExpMonth"]+"/"+Output[0]["ExpYear"]}$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").val(Addr);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").attr("sAddressId",Output[0]["sAddressId"]);if(!$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").parent().find("img").hasClass("VFSSPSAddressvalidationicon")&&Addr!=""){$(".VFSPSBillingForm"+rowId+">.VFSPSBillingValue>input").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPStick.png"></img>')}CreditCardNo=Output[0]["FormattedCardNum"];AccountNo=Output[0]["FormattedAccntNum"];var PaymentType=Output[0]["PayType"];SetPaymentType(PaymentType);$(".VFSPSBillingForm"+rowId+">.VFSPSProfileId>input").val(Output[0]["sProfileId"]);var $radio=$(".VFSPSBillingForm"+rowId+">.VFSPSHowtoBillValue>.VFSPSRadioButtonDiv>input[name=Bill]");if(Output[0]["sEmailBill"]!="Suppresspaper"){$radio.filter("[value="+Output[0]["sEmailBill"]+"]").prop("checked",true)}else{$(".VFSPSBillingForm"+rowId+">.VFSPSHowtoBillValue>.VFSPSRadioButtonDiv>input[name=Bill]").prop("checked",false)}$(".VFSPSBillingForm"+rowId+">.VFSPSEmailValue>input").val(Output[0]["EmailBillTo"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingAlertValue>input").val(Output[0]["BillAlertMth"]);$(".VFSPSBillingForm"+rowId+">.VFSPSAlertTxtValue>input").val(Output[0]["BillAlertTXT"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillAlertEmailValue>input").val(Output[0]["EmailBillTo"]);$(".VFSPSBillingForm"+rowId+">.VFSPSPaymentTypeValue>input").val(Output[0]["PayType"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNameValue>input").val(Output[0]["CardName"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSCardNumberValue>input").val(Output[0]["CardNum"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSBillingCardTypeValue>input").val(Output[0]["CardType"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit>.VFSPSExpiryValue>input").val(Expiry);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNameValue>input").val(Output[0]["sAccountName"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").val(Output[0]["sAccountNumber"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue .VFSPSAccountNumberValueDiv").html(Output[0]["sAccountNumber"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue>input").addClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSAccountNumberValue .VFSPSAccountNumberValueDiv").removeClass("VFSPSDisplayNone");$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>input").val(Output[0]["sBSB"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProdCCHolderName").html(Output[0]["CardName"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProfCCNumber").html(CreditCardNo);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProfCCReacOnlyExpiryDate").html(Expiry);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPBillProfCCMaskedCCCNum").html(Output[0]["CardNum"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProfCCType").html(Output[0]["CardType"]);$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeCredit .VFSPSBillProfCCTypeImgDiv img").attr("src","images/"+GetCardType(Output[0]["CardType"]));if(Output[0]["sEmailBill"]=="Paper"||Output[0]["sEmailBill"]=="Suppresspaper"){$(".VFSPSHowtoBillValue").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$(".VFSPSVodafoneBill").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone")}else{$(".VFSPSHowtoBillValue").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSVodafoneBill").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock")}var sBO=SiebelApp.S_App.GetActiveBusObj();var sBC=sBO.GetBusCompByName("VF Capture Customer Details TBC");var sConnectionType=sBC.GetFieldValue("VF SPS Connection Type");var sCustomerType=sBC.GetFieldValue("Customer Type");if(sConnectionType=="NewCustomer"&&sCustomerType=="Person"){$(".VFSPSAlertTxtValue").addClass("VFSPSDisplayNone");$(".VFSPSAlertTXtLabel").addClass("VFSPSDisplayNone");$(".VFSPSBillingCustomerMobile").addClass("VFSPSDisplayNone")}var sBSBNumber=$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>input").val();if(sBSBNumber==""){$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>.VFSPSBillingPickIcon").attr("src","images/VFSPSSearchICON.png");$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue").addClass("VFBSBNotValidated").removeClass("VFBSBValidated")}else{$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue>.VFSPSBillingPickIcon").attr("src","images/VFSPStick.png");$(".VFSPSBillingForm"+rowId+">.VFSPSBillingTypeDebit>.VFSPSBSBValue").addClass("VFBSBValidated").removeClass("VFBSBNotValidated")}}}VFSPSBillingDetailsPR.prototype.EndLife=function(){SiebelAppFacade.VFSPSBillingDetailsPR.superclass.EndLife.apply(this,arguments);SiebelApp.EventManager.cleanListners("VFSPSToggleBilling");SiebelApp.EventManager.cleanListners("VFSPSUpdateBillAlertTxt")};return VFSPSBillingDetailsPR}());return"SiebelAppFacade.VFSPSBillingDetailsPR"})};