if(typeof(SiebelAppFacade.VFSPSOrderSummaryOLIPR)==="undefined"){var sOrderId;var Count;var sOrderItemId;var NextBtn;var MetaData;var sOrderNumber;var sessionId;var ShipAddr;var shipMail;SiebelJS.Namespace("SiebelAppFacade.VFSPSOrderSummaryOLIPR");define("siebel/custom/VFSPSOrderSummaryOLIPR",["order!siebel/phyrenderer"],function(){SiebelAppFacade.VFSPSOrderSummaryOLIPR=(function(){function VFSPSOrderSummaryOLIPR(pm){SiebelAppFacade.VFSPSOrderSummaryOLIPR.superclass.constructor.call(this,pm)}SiebelJS.Extend(VFSPSOrderSummaryOLIPR,SiebelAppFacade.PhysicalRenderer);VFSPSOrderSummaryOLIPR.prototype.Init=function(){SiebelAppFacade.VFSPSOrderSummaryOLIPR.superclass.Init.apply(this,arguments);this.ResponseData={};this.Data={"ResponseData":this.ResponseData};this.SetData=function(Category,data){this.Data[Category]=data};this.GetData=function(Category){return this.Data[Category]};SiebelApp.EventManager.cleanListners("VFSPSGenerateContractSuccess");SiebelApp.EventManager.cleanListners("VFSPSGenerateContractFailure");SiebelApp.EventManager.cleanListners("VFSPSByPassReason");SiebelApp.EventManager.addListner("VFSPSByPassReason",VFSPSByPassReasonUpdate,this);SiebelApp.EventManager.addListner("VFSPSGenerateContractSuccess",VFSPSGenerateContractSuccess,this);SiebelApp.EventManager.addListner("VFSPSGenerateContractFailure",VFSPSGenerateContractFailure,this)};VFSPSOrderSummaryOLIPR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSOrderSummaryOLIPR.superclass.ShowUI.call(this);var sBO=SiebelApp.S_App.GetActiveBusObj();var sBC=sBO.GetBusCompByName("VF Capture Customer Details TBC");sessionId=sBC.GetFieldValue("Session Id");sCAId=sBC.GetFieldValue("Customer Row Id");var sActiveView=SiebelApp.S_App.GetActiveView();var sView=sActiveView.GetName();var LineItemApplet=sActiveView.GetApplet("VF SPS Order Line Item List Applet").GetFullId();$("#s_"+LineItemApplet+"_div").addClass("VFSPSOrderLineItemApplet");var PlaybarAppletId=sActiveView.GetApplet("VF SPS Task Playbar Applet - Top").GetFullId();$("#s_"+PlaybarAppletId+"_div").hide();sOrderNumber=sBC.GetFieldValue("Order Number");var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();var shipOutput=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("sOrderNumber",sOrderNumber);Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","QueryOrderId",Inputs,{});sOrderId=Outputs.GetProperty("sOrderId");Inputs.SetProperty("OrderId",sOrderId);Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","CallOrderSummary",Inputs,{});shipOutput=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","QueryShipment",Inputs,{});ShipAddr=shipOutput.GetProperty("ShipAddr");shipMail=shipOutput.GetProperty("ShipMail");setTimeout(function(){Shipping(ShipAddr,shipMail,sActiveView)},50);var IO="VF SPS Order Summary IO";var IC="VF Line Items - Summary - TBUI MSO";var RawData=Outputs.GetChildByType("SiebelMessage").GetChildByType("ListOf"+IO).GetChildByType("Order Entry - Orders").GetChildByType("ListOf"+IC);var Plan=new Array();var OrderItemId=new Array();RawData=VFCustomSiebelInterface.SiebelMessageToArray(RawData);var RawDataLen=RawData.length;for(var i=0;i<RawDataLen;i++){Plan[Plan.length]=RawData[i]["Product"];OrderItemId[OrderItemId.length]=RawData[i]["Id"]}var PlanLen=Plan.length;if(PlanLen){for(var i=0;i<PlanLen;i++){$(".VFSPSSummaryOLIPlanDetailsParDiv").append(GetParentTielContainer(i));PopulateTileData(i,Plan,OrderItemId)}}$(".VFSPSReasonSection>.VFSPSSummaryOLITileByPassValue>input").after('<img id="VFSPSOrderBypassDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">');EnableSubmitOrder();VFSPSPlSumSharingPlanDetailsLoadSystemPreference();var BS="VF SPS TBUI Utilities";var Method="GetOrderDetails";var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("OrderId",VFSPSGetOrderId());var out=VFCustomSiebelInterface.CallBS(BS,Method,inps,{});if(out.GetProperty("RecordFound")=="Yes"&&(out.GetProperty("ParentMSISDN")!=""||out.GetProperty("ParentServiceId")!="")){$(".VFSPSSummaryOLIPlanDetailsParDiv").append(GetParentTielContainer(999));var template=$("#VFSPSPlSumSharingTileTemplate").html();$("#VFSPSSummaryOLITileParId999").append(template);$(".VFSPSPlSumSharingInformationText").html("A maximum of "+VFTabletIntegrationConstants.GetConstants("VFSPSSharingConstant")+" secondary plans can be added to a Primary account.")}};function Shipping(ShipAddr,shipMail,sActiveView){var Orderapplet=sActiveView.GetApplet("VF SPS Order Header Summary Applet");var ctrls=Orderapplet.GetControls();NextBtn=ctrls["Ship To - Address"].GetInputName();var TrackEmail=ctrls["Tracking Email"].GetInputName();this.TrackEmail=TrackEmail;this.NextBtn=NextBtn;$("span[id='"+TrackEmail+"']").html(shipMail);$("span[id='"+NextBtn+"']").html(ShipAddr);if(ShipAddr==""){$("#Ship_To_-_Address_Label").hide()}}function PopulateTileData(i,Plan,OrderItemId){if(Plan[i]==""){var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("RootItemId",OrderItemId[i]);inps.SetProperty("ProdType","Account Proposition");var outs=VFCustomSiebelInterface.CallBS("VF SPS TBUI Utilities","GetPropName",inps,{});if(outs.GetProperty("Found")=="Y"){Plan[i]=outs.GetProperty("PropName")}else{Plan[i]="Plan Not Found"}}var template=$("#VFSPSSummaryOLITileTemplate").html();$("#VFSPSSummaryOLITileParId"+i).append(template);$("#VFSPSSummaryOLITileParId"+i).attr("OrderLineItemId",OrderItemId[i]);$("#VFSPSSummaryOLITileParId"+i).attr("RootOrderItem","");$("#VFSPSSummaryOLITileParId"+i).attr("Count",i);$("#VFSPSSummaryOLITileParId"+i+" #VFSPSSummaryOLITileTitleText").html(Plan[i])}function PopulateLineItemData(Count,RawData,Offer,OfferDataLen,AddOns,AddOnsLen){RawData[0]["VF SPS Device TBUI"]!=""?$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsDevice").html(RawData[0]["VF SPS Device TBUI"]):$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsDevice").html("NA");RawData[0]["VF SPS Plan Term"]!=""?$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsPlanTerm").html(RawData[0]["VF SPS Plan Term"]):$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsPlanTerm").html("NA");RawData[0]["VF SIM TBUI"]!=""?$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsSIMNumber").html(RawData[0]["VF SIM TBUI"]):$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsSIMNumber").html("NA");RawData[0]["VF MSISDN TBUI"]!=""?$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsMobNumber").html(RawData[0]["VF MSISDN TBUI"]):$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsMobNumber").html("NA");RawData[0]["VF IMEI TBUI"]!=""?$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsIMEI").html(RawData[0]["VF IMEI TBUI"]):$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsIMEI").html("NA");RawData[0]["VF BS MPP"]!=""?$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsMPP").html(RawData[0]["VF BS MPP"]):$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsMPP").html("NA");RawData[0]["VF SPS Phone Insurance Calc"]!=""?$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsMIP").html(RawData[0]["VF SPS Phone Insurance Calc"]):$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsMIP").html("NA");$("#VFSPSSummaryOLITileParId"+Count).attr("RootOrderItem","Y");$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSSummaryOLIDetailsDiscounts").html("NA");if(OfferDataLen){for(var i=0;i<OfferDataLen;i++){$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSOffers").append(OfferTemplate(i));$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSdynamicOfffer"+i+" #VFSPSSummaryOLIDetailsOffers").html(Offer[i])}}else{$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSOffers").append(OfferTemplate("0"));$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSOffers #VFSPSSummaryOLIDetailsOffers").html("NA")}if(AddOnsLen){for(var i=0;i<AddOnsLen;i++){$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSAddOns").append(AddOnsTemplate(i));$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSdynamicAddOns"+i+" #VFSPSSummaryOLIDetailsAddOns").html(AddOns[i])}}else{$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSAddOns").append(AddOnsTemplate("0"));$("#VFSPSSummaryOLITileParId"+Count+" #VFSPSAddOns #VFSPSSummaryOLIDetailsAddOns").html("NA")}}function GetParentTielContainer(i){return"<div id='VFSPSSummaryOLITileParId"+i+"' class='VFSPSSummaryOLITileParDynDiv'></div>"}function OfferTemplate(i){return"<div id = 'VFSPSdynamicOfffer"+i+"'><span id='VFSPSSummaryOLIDetailsOffers'></span></div>"}function AddOnsTemplate(i){return"<div id = 'VFSPSdynamicAddOns"+i+"'><span id='VFSPSSummaryOLIDetailsAddOns'></span></div>"}function VFSPSOrderSubmitted(){var template="<div class='VFSPSOrderOverlay VFSPSDisplayBlock'>											<div class='VFSPSOrderPopup'>												<span title='Close' class='VFSPSOrderClose'><img src='images/vfspsclose.jpg'></span>												<h2 class='VFSPSOrderFinalize'><span>This Order has now been finalised</span></h2>												<div class='VFSPSOrderDetails VFSPSFloatLeft'>													<div class='VFSPSOrdernumber'><span>Your Order Number is</span></div>									<div class='VFSPSOrdernumber'><span>"+sOrderNumber+"</span></div>													<div class='VFSPSOrderOkButton'>OK</div>												</div>										</div>";if($(".VFSPSBillingOverlay").length==0){$("body").append(template)}}VFSPSOrderSummaryOLIPR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSOrderSummaryOLIPR.superclass.BindEvents.call(this);$(".VFSPSSummaryOLIPlanDetailsParDiv").delegate(".VFSPSSummaryOLIPlanTileTitleDiv","click",{ctx:this},VFSPSExpandPlanDetails);$(".VFSPSPlaybarButton").delegate(".VFSPSSubmitClick","click",{ctx:this},VFSPSBulkEmail);$(".VFSPSPlaybarButton").delegate(".VFSPSCancelClick","click",{ctx:this},VFSPSCancel);$(".VFSPSPlaybarButton").delegate(".VFSPSSaveClick","click",{ctx:this},VFSPSSaveOrder);$(".VFSPSReasonSection").delegate(".VFSPSSummaryOLITileByPassValue>#VFSPSOrderBypassDropDown","click",{ctx:this},VFSPSOrderBypassDropDown)};function VFSPSCancel(){var view=SiebelApp.S_App.GetActiveView();var applet=view.GetApplet("VF SPS Task Playbar Applet - Top");applet.InvokeMethod("CancelTask")}function VFSPSSaveOrder(){var view=SiebelApp.S_App.GetActiveView();var applet=view.GetApplet("VF SPS Task Playbar Applet - Top");applet.InvokeMethod("PauseTask")}function VFSPSBulkEmail(){SubmitOrderAndSendEmail()}function VFSPSGetOrderId(){var BO=SiebelApp.S_App.GetActiveBusObj();var OrderBC=BO.GetBusCompByName("Order Entry - Orders");return OrderBC.GetIdValue()}function SubmitOrderAndSendEmail(){if($(".VFSPSSubmitClick").hasClass("VFSPSPlaybarNextBtnDisabled")){return}var inp=SiebelApp.S_App.NewPropertySet();inp.SetProperty("Profile Attribute Name","VFSPSSubmittedOrderId");inp.SetProperty("Profile Attribute Value",VFSPSGetOrderId());var outs=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",inp,{});var view=SiebelApp.S_App.GetActiveView();var applet=view.GetApplet("VF SPS Task Playbar Applet - Top");applet.InvokeMethod("SubmitTask")}function VFSPSExpandPlanDetails(e){var parentDiv=$(this).parents("div.VFSPSSummaryOLIPlanTileParDiv");if($(parentDiv).hasClass("VFSPSSummaryOLIPlanTileInActive")){$(parentDiv).removeClass("VFSPSSummaryOLIPlanTileInActive").addClass("VFSPSSummaryOLIPlanTileActive");if($(parentDiv).attr("type")=="SHARE"){VFSPSLoadSharePackage()}else{var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();sOrderItemId=$(parentDiv).parent("div.VFSPSSummaryOLITileParDynDiv").attr("orderlineitemid");Count=$(parentDiv).parent("div.VFSPSSummaryOLITileParDynDiv").attr("Count");var sRootItemId=$(parentDiv).parent("div.VFSPSSummaryOLITileParDynDiv").attr("RootOrderItem");if(sRootItemId==""){Inputs.SetProperty("OrderLineId",sOrderItemId);Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","CallOrderLineSummary",Inputs,{});var IO="VF SPS Line Items - Summary - TBUI MSO IO";var OfferIC="VF All Offer";var Offer=new Array();var AddOns=new Array();var RawData=Outputs.GetChildByType("SiebelMessage").GetChildByType("ListOf"+IO);var OfferData=Outputs.GetChildByType("SiebelMessage").GetChildByType("ListOf"+IO).GetChildByType("VF Line Items - Summary - TBUI MSO").GetChildByType("ListOfVF All Offer");var AddOnsData=Outputs.GetChildByType("SiebelMessage").GetChildByType("ListOf"+IO).GetChildByType("VF Line Items - Summary - TBUI MSO").GetChildByType("ListOfVF Order Line Item - Light");RawData=VFCustomSiebelInterface.SiebelMessageToArray(RawData);OfferData=VFCustomSiebelInterface.SiebelMessageToArray(OfferData);AddOnsData=VFCustomSiebelInterface.SiebelMessageToArray(AddOnsData);var GenConFlag=RawData[0]["VF SPS Generate Contract Flag"];RawData[0]["VF BS MPP"]=Outputs.GetProperty("MPP");var AddOnsDataLen=AddOnsData.length;for(var i=0;i<AddOnsDataLen;i++){AddOns[AddOns.length]=AddOnsData[i]["Product"]}var OfferDataLen=OfferData.length;for(var i=0;i<OfferDataLen;i++){Offer[Offer.length]=OfferData[i]["Offer Name"]}PopulateLineItemData(Count,RawData,Offer,OfferDataLen,AddOns,AddOnsDataLen)}Inputs.SetProperty("sOrderItemId",sOrderItemId);Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","LineItemgenConFlagCheck",Inputs,{});var GenConFlag=Outputs.GetProperty("sGenConFlag");if(GenConFlag=="Y"){$("#VFSPSSummaryOLITileParId"+Count+" .VFSPSGenerateContract").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$("#VFSPSSummaryOLITileParId"+Count+" .VFSPSSummaryOLIPlanDetailsSigned").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$("#VFSPSSummaryOLITileParId"+Count+" .VFSPSSummaryOLIPlanDetailsFailed").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock")}else{$("#VFSPSSummaryOLITileParId"+Count+" .VFSPSGenerateContract").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$("#VFSPSSummaryOLITileParId"+Count+" .VFSPSSummaryOLIPlanDetailsSigned").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock")}Inputs.SetProperty("sCAId",sCAId);Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","VFSPSButtonEnable",Inputs,{});var sEnable="Y";if(sEnable=="Y"){$(".VFSPSSummaryOLIPlanDetailsGenerate").addClass("VFSPSGenerateContract").removeClass("VFSPSBillSaveBtnDisabled")}else{$(".VFSPSSummaryOLIPlanDetailsGenerate").addClass("VFSPSBillSaveBtnDisabled").removeClass("VFSPSGenerateContract")}$("#VFSPSSummaryOLITileParId"+Count).undelegate();$("#VFSPSSummaryOLITileParId"+Count).delegate("#VFSPSSummaryOLITileGenerate","click",{ctx:this},VFSPSGeneratePDF)}}else{$(parentDiv).removeClass("VFSPSSummaryOLIPlanTileActive").addClass("VFSPSSummaryOLIPlanTileInActive")}}function VFSPSLoadSharePackage(){VFSPSUdateUIFrameWork.VFSPSBlockUI("");setTimeout(function(){try{var BS="VF SPS TBUI Utilities";var Method="GetSecondaryChildDetails";var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("OrderId",VFSPSGetOrderId());var out=VFCustomSiebelInterface.CallBS(BS,Method,inps,{});$("#VFSPSPlSumSharingPrimaryRatePlan").html(out.GetProperty("SharingPrimaryRatePlan"));$("#VFSPSPlSumSharingPrimaryMSISDN").html(out.GetProperty("SharingPrimaryMSISDN"));var Data=VFCustomSiebelInterface.SiebelMessageToArray(out);var DatLen=Data.length;$("#VFSPSPlSumSecondaryPlansDiv").html("");for(var i=0;i<DatLen;i++){$("#VFSPSPlSumSecondaryPlansDiv").append(SetDataToSecondaryPlan(Data[i]["VF Root MSISDN"],Data[i]["Product"]))}VFSPSUdateUIFrameWork.VFSPSUnblockUI()}catch(e){console.log(e.message)}finally{VFSPSUdateUIFrameWork.VFSPSUnblockUI()}},1000)}function SetDataToSecondaryPlan(MSISDN,RatePlan){return"<div class='VFSPSPlSumDetailsLineDataDiv'>						<div class='VFSPSFloatLeft VFSPSWidth50Cent VFSPSPlSumLineData'>							<span class='VFSPSPlSumSharingSecondaryRatePlan'>"+RatePlan+"</span>						</div>						<div class='VFSPSFloatLeft VFSPSWidth50Cent VFSPSPlSumLineData'>							<span class='VFSPSPlSumSharingSecondaryMSISDN'>"+MSISDN+"</span>						</div>					</div>"}function VFSPSGeneratePDF(){if($(this).hasClass("VFSPSGenerateContract")){sOrderItemId=$(this).parents("div.VFSPSSummaryOLITileParDynDiv").attr("orderlineitemid");Count=$(this).parents("div.VFSPSSummaryOLITileParDynDiv").attr("Count");var bo1=SiebelApp.S_App.GetActiveBusObj();var bc1=bo1.GetBusCompByName("VF Capture Customer Details TBC");sessionId=bc1.GetFieldValue("Session Id");var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("sOrderItemId",sOrderItemId);Inputs.SetProperty("sOrderId",sOrderId);Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","VFSPSButtonCall",Inputs,{"Type":"JSON"});var SettingsData=VFTabletIntegrationConstants.GetSettingData("JSON");var ch=JSON.stringify(Outputs);var MetaData=JSON.parse(ch);var DealerCode=MetaData["SalesDealerCode"];var CustomerID=MetaData["CustomerAccountId"];var ClientID=MetaData["ClientID"];var ContractID=MetaData["ContractId"];var DealerGroup=MetaData["SalesDealerGroup"];var UniqueID=MetaData["OrderId"];var ContactID=MetaData["ContactId"];var StorePersonName=MetaData["SalesPerson"];var StoreName=MetaData["SalesBranch"];var CustomerFirstName=MetaData["CAContactFirstName"];var CustomerLastName=MetaData["CAContactLastName"];var CustomerDOB=MetaData["CAContactBirthDate"];var Today=MetaData["Today"];var IdDocRef=sOrderItemId;var MetadataVersion=MetaData["MetadataVersion"];var CustomerEmail=MetaData["CustomerEmail"];var RequestType=MetaData["RequestType"];var UserName=MetaData["UserName"];var Password=MetaData["Password"];MetaData={"DealerCode":DealerCode,"CustomerID":CustomerID,"ContractID":ContractID,"IdDocRef":IdDocRef,"DealerGroup":DealerGroup,"UniqueID":UniqueID,"MetadataVersion":MetadataVersion,"CustomerFirstName":CustomerFirstName,"CustomerLastName":CustomerLastName,"CustomerMiddleName":"","CustomerEmail":CustomerEmail,"SessionID":sessionId,"CustomerDOB":CustomerDOB,"ClientID":ClientID,"RequestType":RequestType,"UserName":UserName,"ContactID":ContactID,"Password":Password,"StoreName":StoreName,"SalesPersonName":StorePersonName};console.log(MetaData);var requestData={"Key":"ContractSign","SettingsData":SettingsData,"MetaData":MetaData,"RequestParam":Outputs};console.log(JSON.stringify(requestData));if(typeof(VHAWrapper)=="undefined"){var retVal=VHAWrapperSTUB?VHAWrapperSTUB.signContract(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure"):0;retVal=1}else{var retVal=VHAWrapper.signContract(JSON.stringify(requestData),"VFTabletIntegration.Success","VFTabletIntegration.Failure",false)}if(retVal){}else{console.log("Failed to Generate Contract")}}else{}}function VFSPSGenerateContractFailure(){var sActiveView=SiebelApp.S_App.GetActiveView();var app=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Order Line Item List Applet");var pm=app.GetPModel();var pr=pm.GetRenderer();console.log(pr.GetData("ResponseData"));$(".VFSPSSummaryOLIPlanDetailsFailed").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$(".VFSPSGenerateContract").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$(".VFSPSGenerateContract").html("Print Contract");$(".VFSPSSummaryOLIPlanDetailsSigned").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSReasonSection").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$(".VFSPSSummaryOLILineTitleByPass").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$(".VFSPSSummaryOLIPlanDetailsWrongAlert").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");Shipping(ShipAddr,shipMail,sActiveView)}function VFSPSGenerateContractSuccess(){var sActiveView=SiebelApp.S_App.GetActiveView();var app=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Order Line Item List Applet");var pm=app.GetPModel();var pr=pm.GetRenderer();console.log(pr.GetData("ResponseData"));var oResponse=pr.GetData("ResponseData");if(oResponse["isCancelled"]=="true"){}else{if(oResponse["isUploaded"]=="true"){$("#VFSPSSummaryOLITileParId"+Count+" .VFSPSGenerateContract").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$("#VFSPSSummaryOLITileParId"+Count+" .VFSPSSummaryOLIPlanDetailsSigned").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone");$(".VFSPSSummaryOLIPlanDetailsFailed").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSReasonSection").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSSummaryOLILineTitleByPass").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");$(".VFSPSSummaryOLIPlanDetailsWrongAlert").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock");var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("sOrderItemId",sOrderItemId);Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","LineItemgenConFlagUpdate",Inputs,{});EnableSubmitOrder()}else{VFSPSGenerateContractFailure()}}Shipping(ShipAddr,shipMail,sActiveView)}function EnableSubmitOrder(){var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("sOrderId",sOrderId);Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","VFSPSCheckGenConFlag",Inputs,{});var sGenConFlag=Outputs.GetProperty("sGenConFlag");if(sGenConFlag!="N"){$(".VFSPSSubmitClick").removeClass("VFSPSPlaybarNextBtnDisabled").addClass("VFSPSPlaybarNextBtnEnabled");Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","OrderCommentsUpdate",Inputs,{})}else{if($(".VFSPSSummaryOLILineTitleByPass").hasClass("VFSPSDisplayBlock")){if($(".VFSPSReasonSection>.VFSPSSummaryOLITileByPassValue>input").val()!=""){$(".VFSPSSubmitClick").removeClass("VFSPSPlaybarNextBtnDisabled").addClass("VFSPSPlaybarNextBtnEnabled");Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","OrderCommentsUpdate",Inputs,{})}else{$(".VFSPSSubmitClick").removeClass("VFSPSPlaybarNextBtnEnabled").addClass("VFSPSPlaybarNextBtnDisabled")}}else{$(".VFSPSSubmitClick").removeClass("VFSPSPlaybarNextBtnEnabled").addClass("VFSPSPlaybarNextBtnDisabled")}}}function VFSPSByPassReasonUpdate(){var sByPassvalue=$(".VFSPSReasonSection>.VFSPSSummaryOLITileByPassValue>input").val();var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("sByPass",sByPassvalue);Inputs.SetProperty("sOrderId",sOrderId);Outputs=VFCustomSiebelInterface.CallBS("VF SPS Order Summary BS","VFSPSByPassReason",Inputs,{});EnableSubmitOrder()}function VFSPSOrderBypassDropDown(e){var SearchString="[List Of Values.Type] = 'VF_PP_REASON_CODE' AND [List Of Values.Active] = 'Y'";var PicklistValues=VFCustomSiebelInterface.GetPickListValues("",SearchString);var selector=".VFSPSReasonSection>.VFSPSSummaryOLITileByPassValue>input";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues(selector,"",PicklistValues,"","","HTML","VFSPSByPassReason")}function VFSPSPlSumSharingPlanDetailsLoadSystemPreference(e){if(!VFTabletIntegrationConstants.SetConstants("VFSPSSharingConstant")){var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("System Preference Name","VF Max Shared");Outputs=VFCustomSiebelInterface.CallBS("VF Get System Preference","Get System Preference",Inputs,{});VFTabletIntegrationConstants.SetConstants("VFSPSSharingConstant",Outputs.GetProperty("System Preference Value"))}}VFSPSOrderSummaryOLIPR.prototype.EndLife=function(){SiebelAppFacade.VFSPSOrderSummaryOLIPR.superclass.EndLife.apply(this,arguments);SiebelApp.EventManager.cleanListners("VFSPSGenerateContractSuccess");SiebelApp.EventManager.cleanListners("VFSPSGenerateContractFailure");SiebelApp.EventManager.cleanListners("VFSPSByPassReason");$(".VFSPSSummaryOLIPlanDetailsParDiv").undelegate();$(".VFSPSPlaybarButton").undelegate();$(".VFSPSReasonSection").undelegate()};return VFSPSOrderSummaryOLIPR}());return"SiebelAppFacade.VFSPSOrderSummaryOLIPR"})};