if(typeof(SiebelAppFacade.VFSPSNewCustomerPostPaidPlanSummaryPR)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.VFSPSNewCustomerPostPaidPlanSummaryPR");define("siebel/custom/VFSPSNewCustomerPostPaidPlanSummaryPR",["siebel/jqgridrenderer"],function(){SiebelAppFacade.VFSPSNewCustomerPostPaidPlanSummaryPR=(function(){function VFSPSNewCustomerPostPaidPlanSummaryPR(pm){SiebelAppFacade.VFSPSNewCustomerPostPaidPlanSummaryPR.superclass.constructor.apply(this,arguments)}SiebelJS.Extend(VFSPSNewCustomerPostPaidPlanSummaryPR,SiebelAppFacade.JQGridRenderer);VFSPSNewCustomerPostPaidPlanSummaryPR.prototype.Init=function(){SiebelAppFacade.VFSPSNewCustomerPostPaidPlanSummaryPR.superclass.Init.apply(this,arguments)};VFSPSNewCustomerPostPaidPlanSummaryPR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSNewCustomerPostPaidPlanSummaryPR.superclass.ShowUI.apply(this,arguments);$(".VFSPSTaskViewMain").addClass("VFSPSPlanSummaryViewMain");var pm=this.GetPM();var recordSet=pm.Get("GetRecordSet");var recordLength=recordSet.length;var app=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Task Playbar Applet - Top");var nextBtn=app.GetControl("ButtonNext");var SearchString="[List Of Values.Type] = 'VF_MSO_LIMIT' AND [List Of Values.Active] = 'Y' AND [List Of Values.Name] = 'MSO_LIMIT_TBUI'";var MSO_Limit=VFCustomSiebelInterface.GetPickListValues("",SearchString);MSO_Limit=MSO_Limit[0]|0;if(recordLength>=MSO_Limit){$(".VFSPSPlSumAddPlanButtonDiv").hide()}if(recordLength){$(".VFSPSPlSumParentDiv").addClass("VFSPSPlExistData").removeClass("VFSPSPlSumFreshData");$("#"+nextBtn.GetInputName()+"_Ctrl").removeClass("VFSPSPlaybarNextBtnDisabled").addClass("VFSPSPlaybarNextBtnEnabled");for(var i=0;i<recordLength;i++){$(".VFSPSPlSumPlanDetailsParDiv").append(GetParentTielContainer(i));PopulateTileData(i,recordSet[i])}$(".VFSPSPlTaskNavCreateOrderBtn").removeClass("VFSPSTaskNavInActive").addClass("VFSPSTaskNavActive")}else{$(".VFSPSPlSumParentDiv").removeClass("VFSPSPlExistData").addClass("VFSPSPlSumFreshData");$(".VFSPSPlTaskNavCreateOrderBtn").addClass("VFSPSTaskNavInActive").removeClass("VFSPSTaskNavActive")}var inp=SiebelApp.S_App.NewPropertySet();inp.SetProperty("Profile Attribute Name","VFSPSPlSumTaskPath");inp.SetProperty("Profile Attribute Value","");var outs=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",inp,{});inp.SetProperty("Profile Attribute Name","VFSPSPlSumCurrentOrderItemId");inp.SetProperty("Profile Attribute Value","");outs=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",inp,{});if($(".VFSPSPlSumPlanBusGrowDetailsParDiv .VFSPSPlSumPlanTileParDiv").length==0){$(".VFSPSPlSumBusGrowAddPlanButtonDiv").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock")}else{$(".VFSPSPlSumBusGrowAddPlanButtonDiv").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone")}VFSPSPlSumSharingPlanDetailsLoadSystemPreference();var BS="VF SPS TBUI Utilities";var Method="GetOrderDetails";var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("OrderId",VFSPSGetOrderId());var out=VFCustomSiebelInterface.CallBS(BS,Method,inps,{});if(out.GetProperty("RecordFound")=="Yes"&&(out.GetProperty("ParentMSISDN")!=""||out.GetProperty("ParentServiceId")!="")){$(".VFSPSPlSumAddSharePlanButtonDiv").addClass("VFSPSDisplayNone");$(".VFSPSPlSumPlanDetailsParDiv").append(GetParentTielContainer(999));var template=$("#VFSPSPlSumSharingTileTemplate").html();$("#VFSPSPlSumTileParId999").append(template);$(".VFSPSPlSumSharingInformationText").html("A maximum of "+VFTabletIntegrationConstants.GetConstants("VFSPSSharingConstant")+" secondary plans can be added to a Primary account.")}else{if(out.GetProperty("RecordFound")=="Yes"){var BS="VF SPS TBUI Utilities";var Method="CurrentOrderChildConnectionExists";var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("OrderId",VFSPSGetOrderId());inps.SetProperty("BillingAcctId",out.GetProperty("BillingAcctId"));var out2=VFCustomSiebelInterface.CallBS(BS,Method,inps,{});if(out2.GetProperty("RecordFound")=="Yes"&&out2.GetProperty("ChildShairngFound")=="Yes"){$(".VFSPSPlSumAddSharePlanButtonDiv").removeClass("VFSPSDisplayBlock")}else{$(".VFSPSPlSumAddSharePlanButtonDiv").addClass("VFSPSDisplayNone")}}}};function PopulateTileData(index,recordSet){if(recordSet["Product Type"]=="Account Proposition"){var BillingAcctNum="";var inp=SiebelApp.S_App.NewPropertySet();inp.SetProperty("OrderLineItem",recordSet["Order Item Id"]);var outs=VFCustomSiebelInterface.CallBS("VF SPS Billing Account BS","GetPrimaryBillingAccountDetails",inp,{});if(outs.GetProperty("RecordFound")=="Found"){BillingAcctNum=outs.GetProperty("BillingAcctNum")}else{console.log("Billing Account not found.")}var Name=VFSPSGetAccount();var FullName=Name.FName+(Name.MName==""?"":" "+Name.MName)+(Name.LName==""?"":" "+Name.LName);var template=$("#VFSPSPlSumBusGrowTileTemplate").html();$(".VFSPSPlSumPlanBusGrowDetailsParDiv").append(template).attr("OrderLineItemId",recordSet["Order Item Id"]);$("#VFSPSPlSumBusGrowTileTitleText").html(recordSet["VF SPS Product"]);$("#VFSPSPlSumBusGrowCustName").html(FullName);$("#VFSPSPlSumBusGrowBillAcctNum").html(BillingAcctNum)}else{var template=$("#VFSPSPlSumTileTemplate").html();$("#VFSPSPlSumTileParId"+index).append(template);$("#VFSPSPlSumTileParId"+index).attr("OrderLineItemId",recordSet["Order Item Id"]);$("#VFSPSPlSumTileParId"+index+" #VFSPSPlSumTileTitleText").html(recordSet["VF SPS Plan Name"]);$("#VFSPSPlSumTileParId"+index+" #VFSPSPlSumDetailsVoice").html(recordSet["VF SPS Service Type"]);$("#VFSPSPlSumTileParId"+index+" #VFSPSPlSumDetailsDevice").html(recordSet["VF SPS Device"]);if(recordSet["VF SPS SIMO Device"]=="Yes"){$("#VFSPSPlSumTileParId"+index+" #VFSPSPlSumDetailsPlanType").html("SIM Only")}else{$("#VFSPSPlSumTileParId"+index+" #VFSPSPlSumDetailsPlanType").html(recordSet["VF SPS Plan Type"])}$("#VFSPSPlSumTileParId"+index+" #VFSPSPlSumDetailsMobNumber").html(recordSet["New MSISDN"]);$("#VFSPSPlSumTileParId"+index+" #VFSPSPlSumDetailsPlnDuration").html(recordSet["VF SPS Plan Duration"])}}function VFSPSGetAccount(){var BS="VF SPS IDCaputre BS";var Method="QueryOrderMetadata";var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("OrderId",VFSPSGetOrderId());var outs=VFCustomSiebelInterface.CallBS(BS,Method,inps,{});return{"FName":outs.GetProperty("CustFName"),"MName":outs.GetProperty("CustMName"),"LName":outs.GetProperty("CustLName")}}function GetParentTielContainer(index){return"<div id='VFSPSPlSumTileParId"+index+"' class='VFSPSPlSumTileParDynDiv'></div>"}VFSPSNewCustomerPostPaidPlanSummaryPR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSNewCustomerPostPaidPlanSummaryPR.superclass.BindEvents.apply(this,arguments);$(".VFSPSPlSumParentDiv").delegate(".VFSPSPlSumAddPlanButton,.VFSPSPlSumAddPlanButtonDiv","click",{ctx:this,ProfAttr:"AddNewPlan"},VFSPSAddNewPlanFresh);$(".VFSPSPlSumParentDiv").delegate(".VFSPSPlSumBusGrowButton,.VFSPSPlSumBusGrowAddPlanButtonDiv","click",{ctx:this,ProfAttr:"VFSPSNewBusinessGrow"},VFSPSAddNewPlanFresh);$(".VFSPSPlSumParentDiv").delegate(".VFSPSPlSumAddSharePlanButtonDiv","click",{ctx:this,ProfAttr:"Sharing"},VFSPSAddNewPlanFresh);$(".VFSPSPlSumParentDiv").delegate(".VFSPSPlSumPlanTileTitleDiv","click",{ctx:this},VFSPSExpandPlanDetails);$(".VFSPSPlSumParentDiv").delegate(".VFSPSPlSumPlanDetailsDeletePlan,.VFSPSPlSumBusGrowPlanDetailsDeletePlan,.VFSPSPlSumSharingPlanDetailsDeletePlan","click",{ctx:this},VFSPSToggleDeletePlan);$(".VFSPSPlSumParentDiv").delegate(".VFSPSNoConfirmDelete","click",{ctx:this},VFSPSDeletePlan);$(".VFSPSPlSumParentDiv").delegate(".VFSPSPlSumPlanDetailsEditPlan","click",{ctx:this,ProfAttr:"EditExistingPlan"},VFSPSEditPlan);$(".VFSPSPlSumParentDiv").delegate(".VFSPSPlSumPlanBusGrowDetailsEditPlan","click",{ctx:this,ProfAttr:"VFSPSEditBusinessGrow"},VFSPSEditPlan);$("body").delegate("*","click",{},VFSPSPlanSummaryBodyClick);$(".VFSPSPlSumNavigation").delegate(".VFSPSPlTaskNavCancelOrderBtn","click",{ctx:this},VFSPSPlSumCancelOrder);$(".VFSPSPlSumNavigation").delegate(".VFSPSPlTaskNavCreateOrderBtn","click",{ctx:this},VFSPSPlSumCreateOrder);$(".VFSPSPlSumNavigation").delegate(".VFSPSPlTaskNavPauseOrderBtn","click",{ctx:this},VFSPSPlSumPauseOrder);$(".VFSPSPlSumParentDiv").delegate(".VFSPSPlSumSharingPlanDetailsChangePrimary","click",{ctx:this,ProfAttr:"Sharing"},VFSPSAddNewPlanFresh)};function VFSPSAddNewPlanFresh(e){if($(".VFSPSPlSumParentDiv").hasClass("VFSPSPlSumFreshData")){$(".VFSPSPlSumFreshData").addClass("VFSPSPlExistData").removeClass("VFSPSPlSumFreshData")}else{}var inp=SiebelApp.S_App.NewPropertySet();inp.SetProperty("Profile Attribute Name","VFSPSPlSumTaskPath");inp.SetProperty("Profile Attribute Value",e.data.ProfAttr);var outs=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",inp,{});inp.SetProperty("Profile Attribute Name","VFSPSPlSumCurrentOrderItemId");inp.SetProperty("Profile Attribute Value","");outs=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",inp,{});VFSPSNavigateNext()}function VFSPSExpandPlanDetails(e){if($(this).parent().hasClass("VFSPSPlSumPlanTileInActive")){$(this).parent().removeClass("VFSPSPlSumPlanTileInActive").addClass("VFSPSPlSumPlanTileActive");if($(this).attr("type")=="SHARE"){VFSPSLoadSharePackage()}}else{$(this).parent().removeClass("VFSPSPlSumPlanTileActive").addClass("VFSPSPlSumPlanTileInActive")}}function VFSPSToggleDeletePlan(e){if($(this).hasClass("VFSPSNoConfirmDelete")){$(this).addClass("VFSPSConfirmDelete").removeClass("VFSPSNoConfirmDelete");$(this).html("Confirm Delete");e.preventDefault();e.stopPropagation()}else{if($(this).hasClass("VFSPSPlSumBusGrowPlanDetailsDeletePlan")){var OrderLineItemId=$(".VFSPSPlSumPlanBusGrowDetailsParDiv").attr("OrderLineItemId");var WF="VF SPS Delete Root Line Item Workflow";var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("Object Id",VFSPSGetOrderId());inps.SetProperty("RootLineItemId",OrderLineItemId);VFSPSUdateUIFrameWork.VFSPSBlockUI("");setTimeout(function(){try{var outs=VFCustomSiebelInterface.CallWorkflow(WF,inps,{})}catch(e){}if($(".VFSPSPlSumTileParDynDiv").length==0){$(".VFSPSPlSumParentDiv").removeClass("VFSPSPlExistData").addClass("VFSPSPlSumFreshData");$(".VFSPSPlTaskNavCreateOrderBtn").addClass("VFSPSTaskNavInActive").removeClass("VFSPSTaskNavActive")}else{if($(".VFSPSPlSumPlanBusGrowDetailsParDiv .VFSPSPlSumPlanTileParDiv").length==0){$(".VFSPSPlSumBusGrowAddPlanButtonDiv").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock")}else{$(".VFSPSPlSumParentDiv").addClass("VFSPSPlExistData").removeClass("VFSPSPlSumFreshData");$(".VFSPSPlTaskNavCreateOrderBtn").removeClass("VFSPSTaskNavInActive").addClass("VFSPSTaskNavActive")}}VFSPSUdateUIFrameWork.VFSPSUnblockUI()},1000);$(".VFSPSPlSumPlanBusGrowDetailsParDiv .VFSPSPlSumPlanTileParDiv").remove()}else{if($(this).hasClass("VFSPSPlSumSharingPlanDetailsDeletePlan")){$("#VFSPSPlSumTileParId999").addClass("VFSPSDisplayNone");VFSPSUdateUIFrameWork.VFSPSBlockUI("");setTimeout(function(){try{var BS="VF SPS TBUI Utilities";var Method="DeleteOrderSharingContext";var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("OrderId",VFSPSGetOrderId());var out=VFCustomSiebelInterface.CallBS(BS,Method,inps,{});$(".VFSPSPlSumAddSharePlanButtonDiv").addClass("VFSPSDisplayBlock")}catch(e){console.log(e.mesage);$("#VFSPSPlSumTileParId999").removeClass("VFSPSDisplayNone")}finally{VFSPSUdateUIFrameWork.VFSPSUnblockUI()}},1000)}else{var OrderLineItemId=$(this).parents(".VFSPSPlSumTileParDynDiv").attr("OrderLineItemId");var WF="VF SPS Delete Root Line Item Workflow";var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("Object Id",VFSPSGetOrderId());inps.SetProperty("RootLineItemId",OrderLineItemId);VFSPSUdateUIFrameWork.VFSPSBlockUI("");setTimeout(function(){try{var outs=VFCustomSiebelInterface.CallWorkflow(WF,inps,{})}catch(e){}if($(".VFSPSPlSumTileParDynDiv").length==0){$(".VFSPSPlSumParentDiv").removeClass("VFSPSPlExistData").addClass("VFSPSPlSumFreshData");$(".VFSPSPlTaskNavCreateOrderBtn").addClass("VFSPSTaskNavInActive").removeClass("VFSPSTaskNavActive")}else{if($(".VFSPSPlSumPlanBusGrowDetailsParDiv .VFSPSPlSumPlanTileParDiv").length==0){$(".VFSPSPlSumBusGrowAddPlanButtonDiv").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock")}else{$(".VFSPSPlSumParentDiv").addClass("VFSPSPlExistData").removeClass("VFSPSPlSumFreshData");$(".VFSPSPlTaskNavCreateOrderBtn").removeClass("VFSPSTaskNavInActive").addClass("VFSPSTaskNavActive")}}VFSPSUdateUIFrameWork.VFSPSUnblockUI()},1000);$(this).parents(".VFSPSPlSumTileParDynDiv").remove()}}e.preventDefault();e.stopPropagation()}}function VFSPSGetOrderId(){var BO=SiebelApp.S_App.GetActiveBusObj();var OrderBC=BO.GetBusCompByName("Order Entry - Orders");return OrderBC.GetIdValue()}function VFSPSDeletePlan(e){$(this).removeClass("VFSPSNoConfirmDelete");e.preventDefault();e.stopPropagation()}function VFSPSEditPlan(e){var OrderLineItemId=$(this).parents(".VFSPSPlSumTileParDynDiv").attr("OrderLineItemId");var inp=SiebelApp.S_App.NewPropertySet();inp.SetProperty("Profile Attribute Name","VFSPSPlSumTaskPath");inp.SetProperty("Profile Attribute Value",e.data.ProfAttr);var outs=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",inp,{});inp.SetProperty("Profile Attribute Name","VFSPSPlSumCurrentOrderItemId");inp.SetProperty("Profile Attribute Value",OrderLineItemId);outs=VFCustomSiebelInterface.CallBS("SIS OM PMT Service","Set Profile Attribute",inp,{});VFSPSNavigateNext()}function VFSPSPlanSummaryBodyClick(e){if($(this).hasClass("VFSPSPlSumPlanDetailsDeletePlan")){}else{$(".VFSPSConfirmDelete").html("Delete Plan").addClass("VFSPSNoConfirmDelete").removeClass("VFSPSConfirmDelete")}}VFSPSNewCustomerPostPaidPlanSummaryPR.prototype.EndLife=function(){SiebelAppFacade.VFSPSNewCustomerPostPaidPlanSummaryPR.superclass.EndLife.apply(this,arguments);$(".VFSPSPlSumParentDiv").undelegate()};function VFSPSNavigateNext(){var app=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Task Playbar Applet - Top");app.InvokeMethod("NavigateNext")}function VFSPSPlSumCancelOrder(e){var App=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Task Playbar Applet - Top");if(App.CanInvokeMethod("CancelTask")){App.InvokeMethod("CancelTask")}}function VFSPSPlSumCreateOrder(e){if($(this).hasClass("VFSPSTaskNavActive")){var App=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Task Playbar Applet - Top");if(App.CanInvokeMethod("NavigateNext")){App.InvokeMethod("NavigateNext")}}}function VFSPSPlSumPauseOrder(e){var App=SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Task Playbar Applet - Top");if(App.CanInvokeMethod("PauseTask")){App.InvokeMethod("PauseTask")}}function VFSPSLoadSharePackage(){VFSPSUdateUIFrameWork.VFSPSBlockUI("");setTimeout(function(){try{var BS="VF SPS TBUI Utilities";var Method="GetSecondaryChildDetails";var inps=SiebelApp.S_App.NewPropertySet();inps.SetProperty("OrderId",VFSPSGetOrderId());var out=VFCustomSiebelInterface.CallBS(BS,Method,inps,{});$("#VFSPSPlSumSharingPrimaryRatePlan").html(out.GetProperty("SharingPrimaryRatePlan"));$("#VFSPSPlSumSharingPrimaryMSISDN").html(out.GetProperty("SharingPrimaryMSISDN"));var Data=VFCustomSiebelInterface.SiebelMessageToArray(out);var DatLen=Data.length;$("#VFSPSPlSumSecondaryPlansDiv").html("");for(var i=0;i<DatLen;i++){$("#VFSPSPlSumSecondaryPlansDiv").append(SetDataToSecondaryPlan(Data[i]["VF Root MSISDN"],Data[i]["Product"]))}VFSPSUdateUIFrameWork.VFSPSUnblockUI()}catch(e){console.log(e.message)}finally{VFSPSUdateUIFrameWork.VFSPSUnblockUI()}},1000)}function SetDataToSecondaryPlan(MSISDN,RatePlan){return"<div class='VFSPSPlSumDetailsLineDataDiv'>						<div class='VFSPSFloatLeft VFSPSWidth50Cent VFSPSPlSumLineData'>							<span class='VFSPSPlSumSharingSecondaryRatePlan'>"+RatePlan+"</span>						</div>						<div class='VFSPSFloatLeft VFSPSWidth50Cent VFSPSPlSumLineData'>							<span class='VFSPSPlSumSharingSecondaryMSISDN'>"+MSISDN+"</span>						</div>					</div>"}function VFSPSPlSumSharingPlanDetailsLoadSystemPreference(e){if(!VFTabletIntegrationConstants.GetConstants("VFSPSSharingConstant")){var Inputs=SiebelApp.S_App.NewPropertySet();var Outputs=SiebelApp.S_App.NewPropertySet();Inputs.SetProperty("System Preference Name","VF Max Shared");Outputs=VFCustomSiebelInterface.CallBS("VF Get System Preference","Get System Preference",Inputs,{});VFTabletIntegrationConstants.SetConstants("VFSPSSharingConstant",Number(Outputs.GetProperty("System Preference Value"))-1)}}return VFSPSNewCustomerPostPaidPlanSummaryPR}());return"SiebelAppFacade.VFSPSNewCustomerPostPaidPlanSummaryPR"})};