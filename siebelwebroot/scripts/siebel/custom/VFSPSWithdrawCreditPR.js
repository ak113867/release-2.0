if(typeof(SiebelAppFacade.VFSPSWithdrawCreditPR)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.VFSPSWithdrawCreditPR");define("siebel/custom/VFSPSWithdrawCreditPR",["order!siebel/phyrenderer"],function(){SiebelAppFacade.VFSPSWithdrawCreditPR=(function(){function VFSPSWithdrawCreditPR(pm){SiebelAppFacade.VFSPSWithdrawCreditPR.superclass.constructor.call(this,pm)}SiebelJS.Extend(VFSPSWithdrawCreditPR,SiebelAppFacade.PhysicalRenderer);VFSPSWithdrawCreditPR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSWithdrawCreditPR.superclass.ShowUI.call(this);var pm=this.GetPM();var sBO=SiebelApp.S_App.GetActiveBusObj();var sBC=sBO.GetBusCompByName("VF Com Financial Profile");var sCreditid=sBC.GetFieldValue("Id");var sExpirtDate=sBC.GetFieldValue("Id");var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("sCreditId",sCreditid);Output=VFCustomSiebelInterface.CallBS("VF SPS Credit Check Handset Service","WithDrawCredit",Input,{});var sExpiry=Output.GetProperty("sExpiry");sExpiry=VFCustomSiebelInterface.VFSPSConvertDateFormat(sExpiry);var sApprovedCon=Output.GetProperty("sApprovedCon");var sStatus=Output.GetProperty("sStatus");var sStatusMessage=Output.GetProperty("sStatusMessage");sStatus=VFSPSStatusValue(sStatus);var FailMessage="";if(sStatus.toUpperCase()=="FAILED"){FailMessage="Please review the following before resubmitting: <div class='VFSPSCreditCheckConnections'>"+sStatusMessage+"</div>";var template="<div class='VFSPSCreditCheckDateDetails'>Your credit check will expire on'"+sExpiry+"'</div>																					<div class=' VFSPSCreditCheckStatusDetails'>Your Credit Check has been 																					<span class='VFSPSCCStatus'>"+sStatus+".</span>"+FailMessage+"</div>"}else{if(sStatusMessage!=""){FailMessage="<div class='VFSPSCreditCheckConnections VFSPSCreditCheckStatusMessage'><div class='VFSPSCreditCheckStatusText'>Please review the following before resubmitting:</div><div>"+sStatusMessage+"</div></div>"}else{FailMessage=""}var template="<div class='VFSPSCreditCheckDateDetails'>Your credit check will expire on'"+sExpiry+"'</div>																					<div class=' VFSPSCreditCheckStatusDetails'>Your Credit Check has been 																					<span class='VFSPSCCStatus'>"+sStatus+".</span> You can claim up to:</div>																					<div class='VFSPSCreditCheckConnections'>																					<ul><li>"+sApprovedCon+" Connections</li></ul></div>																					"+FailMessage+"<div class='VFSPSWithdrawCreditCheck' id='VFSPSWithdrawCreditCheckButton'>Withdraw this Credit Check</div>"}$(".VFSPSCreditCheckConnections").append(template);var Status=sBC.GetFieldValue("VF Credit Check Status");if(Status=="CONDAPPRVE"){$(".VFSPSRejectButtons").addClass("VFSPSDisplayBlock").removeClass("VFSPSDisplayNone")}else{$(".VFSPSRejectButtons").addClass("VFSPSDisplayNone").removeClass("VFSPSDisplayBlock")}if(Status=="APPROVE"||Status=="CONDAPPRVE"||Status=="ACCEPT"){$(".VFSPSWithdrawCreditCheck").addClass("VFSPSWithdrawCreditCheckDone VFSPSDisplayBlock").removeClass("VFSPSWithdrawCreditCheckUndone VFSPSDisplayNone")}else{$(".VFSPSWithdrawCreditCheck").addClass("VFSPSWithdrawCreditCheckUndone VFSPSDisplayNone").removeClass("VFSPSWithdrawCreditCheckDone VFSPSDisplayBlock")}};VFSPSWithdrawCreditPR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSWithdrawCreditPR.superclass.BindEvents.call(this);$(".VFSPSCreditCheckConnections").delegate(".VFSPSWithdrawCreditCheck","click",{},VFSPSWithdraw);function VFSPSWithdraw(){var sBO=SiebelApp.S_App.GetActiveBusObj();var sBC=sBO.GetBusCompByName("VF Com Financial Profile");var Status=sBC.GetFieldValue("VF Credit Check Status");var view=SiebelApp.S_App.GetActiveView();var applet=sActiveView.GetApplet("VF SPS Credit Legal Disclaimer Applet RO");if(applet==null||applet==""||typeof(applet)=="undefined"){applet=sActiveView.GetApplet("VF SPS Credit Legal Disclaimer Applet")}if(Status=="APPROVE"||Status=="CONDAPPRVE"||Status=="ACCEPT"){applet.InvokeMethod("EventMethodTriggerWithdrawCreditCheck")}else{alert("Cannot Invoke Withdraw CreditCheck")}}};function VFSPSStatusValue(sStatus){var StatusVal=sStatus;switch(sStatus){case ("APPROVE"):case ("APPROVED"):StatusVal="approved";break;case ("Pending"):StatusVal="pending";break;case ("WITHDRAW"):StatusVal="withdrawn";break;case ("DECLINE"):case ("DECLINED"):StatusVal="declined";break;case ("REFER"):case ("REFERRED"):StatusVal="referred";break;case ("Failed"):StatusVal="failed";break;case ("CONDAPPRVE"):StatusVal="conditionally approved";break;default:}return StatusVal}return VFSPSWithdrawCreditPR}());return"SiebelAppFacade.VFSPSWithdrawCreditPR"})};