if(typeof(SiebelAppFacade.VFSPSSearchCustomerPR)==="undefined"){var controls;SiebelJS.Namespace("SiebelAppFacade.VFSPSSearchCustomerPR");define("siebel/custom/VFSPSSearchCustomerPR",["order!siebel/phyrenderer"],function(){SiebelAppFacade.VFSPSSearchCustomerPR=(function(){function VFSPSSearchCustomerPR(pm){SiebelAppFacade.VFSPSSearchCustomerPR.superclass.constructor.call(this,pm);var sActiveView;var pm;SiebelApp.EventManager.addListner("VFSPSValidateNext",VFSPSValidateNext,this);SiebelApp.EventManager.addListner("VFSPSToggleSearchCustomer",VFSPSToggle,this)}SiebelJS.Extend(VFSPSSearchCustomerPR,SiebelAppFacade.PhysicalRenderer);VFSPSSearchCustomerPR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSSearchCustomerPR.superclass.ShowUI.call(this);sActiveView=SiebelApp.S_App.GetActiveView();pm=this.GetPM();controls=this.GetPM().Get("GetControls");var appletId=pm.Get("GetFullId");$("#"+controls.Cancel.GetInputName()+"_Ctrl").addClass("VFSPSCancelbutton");$("#"+controls.Next.GetInputName()+"_Ctrl").addClass("VFSPSNextButton VFSPSPlaybarNextBtnDisabled");$("input[name="+controls.MSISDN.GetInputName()+"]").parent().next().find("span").html("I don't know my mobile number");$("input[name='"+controls["SIM/IMEI"].GetInputName()+"']").after('<img id="VFSPSSearchGlass" class="VFSPSSearchIMEIImage" src="images/VFSPSSearchGlass.png">');$("input[name="+controls.MSISDN.GetInputName()+"]").attr("type","number");$("input[name="+controls.PIN.GetInputName()+"]").attr("type","number");if($("#s_"+appletId+"_div").has("#VFSPSQueryMode").length==0){$("input[name='"+controls["Query Mode"].GetInputName()+"']").attr("placeholder","--Select--").after('<img id="VFSPSQueryMode" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true")}$("input[name='"+controls["Date of Birth"].GetInputName()+"']").attr("placeholder","--DD/MM/YYYY--").after('<img id="VFSPSSearchCustomerCalender" class="VFSPSSearchCustomerDetailsCalIcon" src="images/VFSPScalendar-icon.png">');setTimeout(function(){VFSPSToggle()},50)};function VFSPSToggle(){var sQueryCustomer=$("input[name='"+controls["Query Mode"].GetInputName()+"']").val();if(sQueryCustomer=="Customer"){VFSPSToggleLabelCaption("What is your Customer PIN?","I don't know my customer PIN")}else{if(sQueryCustomer=="Asset"){VFSPSToggleLabelCaption("What is your service PIN?","I don't know my service PIN")}else{if(sQueryCustomer=="Account"){VFSPSToggleLabelCaption("What is your Billing Account PIN?","I don't know my account PIN")}}}$("input[name="+controls.MSISDN.GetInputName()+"],input[name="+controls.PIN.GetInputName()+"],input[name="+controls["SIM/IMEI"].GetInputName()+"],input[name="+controls["Date of Birth"].GetInputName()+"],input[name="+controls["Primary Authentication"].GetInputName()+"]").val("");$(".VFSPSCustomerSearchIMEI,.VFSPSCustomerSearchIDType").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$("#VFSPSSearchGlass").attr("src","images/VFSPSSearchGlass.png").removeClass("VFSPSClearMSISDN");$(".VFSPSCustomerSearchPIN").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("#VFSPSSearchMobile").removeClass("VFSSPSDisableClick")}function VFSPSToggleLabelCaption(PIN_Caption,SubPIN_Caption){$(".VFSPSCustomerSearchPIN>.VFSPSCustomerDetailsLabel>span").html(PIN_Caption);$(".VFSPSCustomerSearchPIN>.VFSPSSubField>span").html(SubPIN_Caption)}VFSPSSearchCustomerPR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSSearchCustomerPR.superclass.BindEvents.call(this);var pm=this.GetPM();var appletId=pm.Get("GetFullId");var Ctrls=pm.Get("GetControls");var PinCtrl=Ctrls["PIN"].GetInputName();var MSISDNCtrl=Ctrls["MSISDN"].GetInputName();var RefNumCtrl=Ctrls["Primary Authentication"].GetInputName();var DOBCtrl=Ctrls["Date of Birth"].GetInputName();$("#s_"+pm.Get("GetFullId")+"_div").delegate("input[name='"+PinCtrl+"'],input[name='"+MSISDNCtrl+"'],input[name='"+RefNumCtrl+"'],input[name='"+DOBCtrl+"']","keyup",{ctx:this},VFSPSValidateNext);$("#s_"+pm.Get("GetFullId")+"_div").delegate("input[name='"+PinCtrl+"']","keydown",{ctx:this},VFSPSCheckLengthFour);$("#s_"+appletId+"_div").delegate("#VFSPSQueryMode","click",function(){var SearchString="[List Of Values.Type] = 'VF_DEALER_SEARCH'";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues("VF Dealer Search VBC","QueryType","LOV","",SearchString,"Siebel","VFSPSToggleSearchCustomer")});$(".VFSPSCustomerSearchMobile").delegate("#VFSPSSearchMobile","click",{ctx:this},VFSPSForgotMobile);$(".VFSPSCustomerSearchPIN").delegate("#VFSPSSearchPIN","click",{ctx:this},VFSPSForgotPIN);$(".VFSPSCustomerSearchIMEI").delegate("#VFSPSSearchGlass","click",{ctx:this},VFSPSValidateIMEINumber);$(".VFSPSPlaybarButton").delegate(".VFSPSCustomCancelButton","click",function(){SiebelApp.S_App.GotoView("VF SPS Home Page View")});$(".VFSPSPlaybarButton").delegate(".VFSPSCustomNextButton","click",function(){if($(this).hasClass("VFSPSPlaybarNextBtnEnabled")==true){applet=sActiveView.GetApplet("VF SPS Customer Search Applet");applet.InvokeMethod("NavigateNext")}});$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSSearchCustomerCalender","click",{ctx:this},VFSPSSearchCustomerCalender)};function VFSPSSearchCustomerCalender(e){var currentVal=$("input[name='"+controls["Date of Birth"].GetInputName()+"']").val();VFSPSUdateUIFrameWork.ShowDatePicker("VF Dealer Search VBC","DOB","Siebel",currentVal,"100:0","VFSPSValidateNext")}function VFSPSCheckLengthFour(e){if((event.which!=8)&&(event.which!=46)){var val=$(this).val();if(val.length==4){event.preventDefault();event.stopPropagation()}}}function VFSPSForgotMobile(e){if($(this).hasClass("VFSSPSDisableClick")==false){$(this).addClass("VFSSPSDisableClick");$(".VFSPSCustomerSearchIMEI").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("input[name="+controls.MSISDN.GetInputName()+"]").val("")}}function VFSPSForgotPIN(e){var MSISDNValue=$("input[name="+controls.MSISDN.GetInputName()+"]").val();if(MSISDNValue!=""){$(".VFSPSCustomNextButton").removeClass("VFSPSPlaybarNextBtnEnabled").addClass("VFSPSPlaybarNextBtnDisabled");var SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();var SiebelBusComp=SiebelBusObj.GetBusCompByName("VF Dealer Search VBC");var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();Input.SetProperty("MSISDN",MSISDNValue);Output=VFCustomSiebelInterface.CallBS("VF Asset Toolkit Service","mFindPrimaryId",Input,{});var StrIdType=Output.GetProperty("IdType");var StrIdNum=Output.GetProperty("IdNum");if(StrIdType!=""){$(".VFSPSCustomerSearchPIN").removeClass("VFSPSDisplayBlock").addClass("VFSPSDisplayNone");$(".VFSPSCustomerSearchIDType").removeClass("VFSPSDisplayNone").addClass("VFSPSDisplayBlock");$("input[name="+controls.PIN.GetInputName()+"]").val("").attr("readonly","readonly");SiebelBusComp.SetFieldValue("Primary ID type",StrIdType);SiebelBusComp.SetFieldValue("Original Id Referene Number",StrIdNum);$("input[name="+controls["ID Type"].GetInputName()+"]").attr("readonly","readonly")}else{}}}function VFSPSValidateIMEINumber(e){if($(this).hasClass("VFSPSClearMSISDN")==true){$("input[name="+controls["SIM/IMEI"].GetInputName()+"]").val("");$("input[name="+controls.MSISDN.GetInputName()+"]").val("").removeAttr("readonly");$(this).attr("src","images/VFSPSSearchGlass.png").removeClass("VFSPSClearMSISDN")}else{var Input=SiebelApp.S_App.NewPropertySet();var Output=SiebelApp.S_App.NewPropertySet();var SiebelBusObj=SiebelApp.S_App.GetActiveBusObj();var SiebelBusComp=SiebelBusObj.GetBusCompByName("VF Dealer Search VBC");var PIN=$("input[name="+controls.PIN.GetInputName()+"]").val();var IMEINo=$("input[name='"+controls["SIM/IMEI"].GetInputName()+"']").val();var MSISDN=$("input[name="+controls.MSISDN.GetInputName()+"]").val();Input.SetProperty("IMEI/SIM",IMEINo);Output=VFCustomSiebelInterface.CallBS("VF Asset Toolkit Service","Authenticate",Input,{});SiebelBusComp.SetFieldValue("MSISDN",Output.GetProperty("StrMSISDN"));$("input[name="+controls.MSISDN.GetInputName()+"]").attr("readonly","readonly");$(this).attr("src","images/VFSPSCrossMark.png").addClass("VFSPSClearMSISDN");VFSPSValidateNext()}}function VFSPSValidateNext(e){var InputList;if($(".VFSPSCustomerSearchPIN").hasClass("VFSPSDisplayNone")){InputList=["MSISDN","Primary Authentication","Date of Birth"]}else{InputList=["PIN","MSISDN"]}var InputListLength=InputList.length;var PIN=$("input[name='"+controls["PIN"].GetInputName()+"']").val();var CustomerFormFieldsEmpty=false;for(var i=0;i<InputListLength;i++){var input=$("input[name='"+controls[InputList[i]].GetInputName()+"']");if(input.val()==""){CustomerFormFieldsEmpty=true;break}}if(!$(".VFSPSCustomerSearchPIN").hasClass("VFSPSDisplayNone")&&(CustomerFormFieldsEmpty==true||PIN.length<4)){$(".VFSPSCustomNextButton").removeClass("VFSPSPlaybarNextBtnEnabled").addClass("VFSPSPlaybarNextBtnDisabled")}else{if($(".VFSPSCustomerSearchPIN").hasClass("VFSPSDisplayNone")&&CustomerFormFieldsEmpty==true){$(".VFSPSCustomNextButton").removeClass("VFSPSPlaybarNextBtnEnabled").addClass("VFSPSPlaybarNextBtnDisabled")}else{$(".VFSPSCustomNextButton").removeClass("VFSPSPlaybarNextBtnDisabled").addClass("VFSPSPlaybarNextBtnEnabled")}}}return VFSPSSearchCustomerPR}());return"SiebelAppFacade.VFSPSSearchCustomerPR"})};