if(typeof(SiebelAppFacade.VFSPSShipmentPR)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.VFSPSShipmentPR");define("siebel/custom/VFSPSShipmentPR",["order!siebel/phyrenderer"],function(){SiebelAppFacade.VFSPSShipmentPR=(function(){var siebConsts=SiebelJS.Dependency("SiebelApp.Constants");function VFSPSShipmentPR(pm){SiebelAppFacade.VFSPSShipmentPR.superclass.constructor.call(this,pm);this.GetPM().AttachPMBinding("FieldChanged",VFSPSEnableNextButton,{scope:this});this.InputList=["VFShipToContactTitle","VFShipToContactFirstName","VFShipToContactLastName","VF Intelligence Search Address","VF Email Address"];this.NextBtn=""}SiebelJS.Extend(VFSPSShipmentPR,SiebelAppFacade.PhysicalRenderer);VFSPSShipmentPR.prototype.ShowUI=function(){SiebelAppFacade.VFSPSShipmentPR.superclass.ShowUI.call(this);var InputList;var controls=this.GetPM().Get("GetControls");var pm=this.GetPM();var sActiveView=SiebelApp.S_App.GetActiveView();var sView=sActiveView.GetName();var playbarapplet=sActiveView.GetApplet("VF SPS Task Playbar Applet - Top");var ctrls=playbarapplet.GetControls();var NextBtn=ctrls.ButtonNext.GetInputName();this.NextBtn=NextBtn;var ExplictCall;if(sActiveView.GetApplet("VF SPS Out of Stock Summary Form Applet - TBUI")){InputList=this.InputList;ExplictCall=true;setTimeout(function(){VFSPSEnableNextButton(pm,InputList,NextBtn,ExplictCall)},50)}$("input[name='"+controls["VFShipToContactTitle"].GetInputName()+"']").after('<img id="VFSPSShippingTitleDropDown" class="VFSPSDropDownIcon" src="images/VFSPSdropdown-arrow.png">').attr("disabled","true");$("input[name='"+controls["VF Intelligence Search Address"].GetInputName()+"']").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPStick.png"></img>');$("input[name='"+controls["Business Name"].GetInputName()+"']").closest("tr").append('<td><div class="VFSPSOptionaldiv">Optional</div></td>');$("input[name='"+controls["Attention To"].GetInputName()+"']").closest("tr").append('<td><div class="VFSPSOptionaldiv">Optional</div></td>');$("input[name='"+controls["VF Intelligence Search Address"].GetInputName()+"']").autocomplete({source:function(request,response){var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();var sValue=$("input[name='"+controls["VF Intelligence Search Address"].GetInputName()+"']").val();inPS.SetProperty("SearchString",sValue);if(service){var outPS=service.InvokeMethod("DoSearchProxy",inPS);var resultSet=outPS.GetChild(0);var addrCount=resultSet.GetChildCount();var addrArray=[];if(resultSet){for(var i=0;i<addrCount;i++){addrArray.push(resultSet.GetChild(i).GetProperty("QAS Wsdl Address")+"~^"+resultSet.GetChild(i).GetProperty("QAS Wsdl Moniker"))}}VFCustomSiebelInterface.SetProfileAttr("VFPostCodeAttr","Y")}$(".VFSSPSAddressvalidationicon").remove();response($.map(addrArray,function(item,id){var res=item.split("~^");return{value:res[0],id:res[1]}}))},minLength:10,appendTo:$("input[name='"+controls["VF Intelligence Search Address"].GetInputName()+"']").parent(),select:function(event,ui){var sPickAddr=ui.item.value;var sMonikerval=ui.item.id;var service=SiebelApp.S_App.GetService("QAS WSDL");var inPS=SiebelApp.S_App.NewPropertySet();inPS.SetProperty("PickMoniker",sMonikerval);inPS.SetProperty("PickFullAddr",sPickAddr);if(service){if(!$("img").hasClass("VFSSPSAddressvalidationicon")){$("input[name='"+controls["VF Intelligence Search Address"].GetInputName()+"']").after('<img class="VFSSPSAddressvalidationicon" src="images/VFSPStick.png"></img>')}var outPS=service.InvokeMethod("GetShippingAddressOUI",inPS)}}})};VFSPSShipmentPR.prototype.BindEvents=function(){SiebelAppFacade.VFSPSShipmentPR.superclass.BindEvents.call(this);var pm=this.GetPM();$("#s_"+pm.Get("GetFullId")+"_div").delegate("#VFSPSShippingTitleDropDown","click",{ctx:this},VFSPSShippingTitleDropDown)};function VFSPSShippingTitleDropDown(e){var SearchString="[List Of Values.Type] = 'MR_MS' AND [List Of Values.Active] = 'Y'";VFSPSUdateUIFrameWork.VFSPSShowPicklistValues("FS Shipment","VF Ship To Contact Title","LOV","",SearchString,"Siebel")}function VFSPSEnableNextButton(pm,InputList,NextBtn,ExplictCall){if(!ExplictCall){pm=this.GetPM();if(SiebelApp.S_App.GetActiveView().GetApplet("VF SPS Out of Stock Summary Form Applet - TBUI")){InputList=this.InputList}NextBtn=this.NextBtn}var controls=pm.Get("GetControls");var InputListLength=InputList.length;var ShipmentFormFieldsEmpty=false;for(var i=0;i<InputListLength;i++){var input=$("input[name='"+controls[InputList[i]].GetInputName()+"']");if(input.val()==""){ShipmentFormFieldsEmpty=true;VFTabletIntegrationConstants.SetConstants("VFSPSShipmentFieldempty","True");break}else{VFTabletIntegrationConstants.SetConstants("VFSPSShipmentFieldempty","False")}}if(ShipmentFormFieldsEmpty==false){$("#"+NextBtn+"_Ctrl").removeClass("VFSPSPlaybarNextBtnDisabled").addClass("VFSPSPlaybarNextBtnEnabled")}else{$("#"+NextBtn+"_Ctrl").addClass("VFSPSPlaybarNextBtnDisabled").removeClass("VFSPSPlaybarNextBtnEnabled")}}return VFSPSShipmentPR}());return"SiebelAppFacade.VFSPSShipmentPR"})};