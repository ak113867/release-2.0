if(typeof(SiebelAppFacade.VFSUIBASpendChartAppletPR)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.VFSUIBASpendChartAppletPR");define("siebel/custom/VFSUIBASpendChartAppletPR",["order!siebel/phyrenderer","order!siebel/jqgridrenderer","order!3rdParty/jqplot108/dist/jquery.jqplot.min","order!3rdParty/jqplot108/dist/plugins/jqplot.barRenderer.min","order!3rdParty/jqplot108/dist/plugins/jqplot.categoryAxisRenderer.min","order!3rdParty/jqplot108/dist/plugins/jqplot.pointLabels.min"],function(){SiebelAppFacade.VFSUIBASpendChartAppletPR=(function(){function VFSUIBASpendChartAppletPR(pm){SiebelAppFacade.VFSUIBASpendChartAppletPR.superclass.constructor.call(this,pm)}SiebelJS.Extend(VFSUIBASpendChartAppletPR,SiebelAppFacade.PhysicalRenderer);VFSUIBASpendChartAppletPR.prototype.ShowUI=function(){SiebelAppFacade.VFSUIBASpendChartAppletPR.superclass.ShowUI.call(this);var sView=SiebelApp.S_App.GetActiveView().GetName();setTimeout(function(){$('button[title="Billing Account:Billing Profile"]').css("width","143px");$('button[title="Billing Account:Pay Arrangement"]').css("width","143px");$('button[title="Billing Account:Credit Card"]').css("width","143px");$('button[title="Billing Account:Pay Arrangement"]').css("margin-top","-40px")},10);var pm=this.GetPM();var busObj=SiebelApp.S_App.GetActiveBusObj();var billAccBC=busObj.GetBusCompByName("VF Billing Account");var assetMgmtBC=busObj.GetBusCompByName("Asset Mgmt - Asset - Header");var paymentType=billAccBC.GetFieldValue("Payment Type");var ExpiredYr=billAccBC.GetFieldValue("VF SUI Expiry Year");var ExpiredMonth=billAccBC.GetFieldValue("VF SUI Expiry Month");var TodayDate=billAccBC.GetFieldValue("SysDate");var IApinvalue=assetMgmtBC.GetFieldValue("Service PIN");var Bapinvalue=billAccBC.GetFieldValue("Password");var billtoemail=billAccBC.GetFieldValue("VF SUI Email Bill To");var CallerAuthenticated=assetMgmtBC.GetFieldValue("VF SUI Caller Authenticated");var emailstatus=billAccBC.GetFieldValue("VF SUI Validity Status");var AccStatus=billAccBC.GetFieldValue("Account Status");var controls=pm.Get("GetControls");var paymenttypectrl=controls["PaymentType"].GetInputName();var billingToEmailCtrl=controls["VFSUIEmailBillTo"].GetInputName();var VFSUIExpiryMonth=controls["VF SUI Expiry Month"].GetInputName();var VFSUIExpiryYear=controls["VF SUI Expiry Year"].GetInputName();var VFSUIValidityStatus=controls["VF SUI Validity Status"].GetInputName();var bapinctrl=controls["Password"].GetInputName();var SysDate=controls["SysDate"].GetInputName();var appTitleCtrl=controls["VF SUI Billing Account title"].GetInputName();var Accstatusctrl=controls["Status"].GetInputName();var datearray=TodayDate.split("/");setTimeout(function(){$("input[name='"+VFSUIExpiryMonth+"']").css("visibility","hidden");$("input[name='"+VFSUIExpiryYear+"']").css("visibility","hidden");$("input[name='"+VFSUIValidityStatus+"']").css("visibility","hidden");$("input[name='"+SysDate+"']").css("visibility","hidden");var getBrowser=navigator.appName;if(getBrowser=="Netscape"){$("#"+appTitleCtrl+"_IPEField").attr("style","position: absolute !important;top: 10px !important");$("#"+appTitleCtrl).attr("style","display: none !important;position: absolute !important;top: 10px !important")}},130);if(paymentType=="Credit Card"){if(datearray[2]<ExpiredYr){}else{if(datearray[2]==ExpiredYr){if(datearray[0]<=ExpiredMonth){}else{$("input[name='"+paymenttypectrl+"']").parent().addClass("redBgcolor")}}else{$("input[name='"+paymenttypectrl+"']").parent().addClass("redBgcolor")}}}if(billtoemail!=""){if(emailstatus=="Not Validated"){$("input[name='"+billingToEmailCtrl+"']").parent().addClass("redBgcolor")}}if(AccStatus=="Overdue"){$("input[name='"+Accstatusctrl+"']").attr("style","border: 1px solid #DD0000 !important; border-radius : 3px !important; width:120px !important")}if(sView=="VF SUI Billing Postpay BA Spend Detail View"||sView=="VF SUI Sales Postpay BA Spend Detail View"||sView=="VF SUI Sales Prepay BA Spend Detail View"){var pm=this.GetPM();var recordSet=pm.Get("GetRecordSet");var sBillId=recordSet[0].Id;var s1=new Array();var Month=new Array();var currentMonths=new Array();Month=["Jan","Feb","March","April","May","June","July","August","Sept","Oct","Nov","Dec"];console.log(sBillId);var svc=SiebelApp.S_App.GetService("VF SUI BA Spend BS");var input=SiebelApp.S_App.NewPropertySet();input.SetProperty("sBillingId",sBillId);var output=svc.InvokeMethod("BA Spend",input);var resultSet=output.GetChild(0);var resultCount=resultSet.GetChildCount();if(resultCount!=0){var childset=resultSet.GetChild(0);console.log(childset);var propertycount=childset.GetChildCount();console.log(propertycount);var curmonth=Number(datearray[0]);var j=curmonth-2;var reset=false;var count=0;for(var k=0;curmonth>=j&&count<3;curmonth--,k++){if(curmonth==0){curmonth=12;reset=true}else{if(curmonth==-1){curmonth=11;reset=true}}s1[k]=childset.GetProperty(curmonth);s1[k]=Number(s1[k]);currentMonths[k]=Month[curmonth-1];console.log(s1[k]);if(reset){if(curmonth==12){curmonth=0;reset=false}else{if(curmonth==11){curmonth=-1;reset=false}}}count++}}else{var curmonth=Number(datearray[0]);var j=curmonth-2;count=0;for(var k=0;curmonth>=j&&count<3;curmonth--,k++){if(curmonth==0){curmonth=12;reset=true}else{if(curmonth==-1){curmonth=11;reset=true}}currentMonths[k]=Month[curmonth-1];if(reset){if(curmonth==12){curmonth=0;reset=false}else{if(curmonth==11){curmonth=-1;reset=false}}}count++}for(i=0;i<12;i++){s1[i]=0}}var graphVal=new Array();var graphIndex=0;for(var sArrReverse=s1.length;sArrReverse>0;sArrReverse--,graphIndex++){graphVal[graphIndex]=s1[sArrReverse-1]}$('[title="Invoices List Applet"]').parent().after('<div id="chart1" style="width:500px; height:400px;margin-left:150px;"></div>');$('[title="Invoices List Applet"]').parent().css("display","none");var A1=graphVal;var ticks=new Array();var tickarr=0;for(var revArrVar=currentMonths.length;revArrVar>0;revArrVar--,tickarr++){ticks[tickarr]=currentMonths[revArrVar-1]}var plot1=$.jqplot("chart1",[A1],{seriesDefaults:{renderer:$.jqplot.BarRenderer,pointLabels:{show:true,hideZeros:true}},series:[],axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:ticks},yaxis:{min:1}}});$("#chart1").find(".jqplot-yaxis").css("left","-8px")}};return VFSUIBASpendChartAppletPR}());return"SiebelAppFacade.VFSUIBASpendChartAppletPR"})};