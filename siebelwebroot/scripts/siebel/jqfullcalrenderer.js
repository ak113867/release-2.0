/*<ORACLECOPYRIGHT>
* Copyright (C) 2008-2024
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 24.2.0.0SIA[2024_02] */
typeof SiebelAppFacade.JQFullCalRenderer=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.JQFullCalRenderer"),define("siebel/jqfullcalrenderer",["3rdParty/fullcalendar/main.js","3rdParty/jquery.ui.touch-punch.min.js","siebel/caldetailpr"],function(){return SiebelAppFacade.JQFullCalRenderer=function(){function e(){SiebelAppFacade.JQFullCalRenderer.superclass.constructor.apply(this,arguments);var e=$(),t,n=0,r=this.GetPM(),i={},s={},o={},u={};this.GetCal=function(){return e},this.SetCal=function(t){e=t},this.GetFullCal=function(){return t},this.SetFullCal=function(e){t=e},this.SetCalContHeight=function(e){n=e},this.GetCalContHeight=function(){return n},this.GetLocaleConverter=function(){return i},this.SetLocaleConverter=function(e){i=e},this.GetUtilityMap=function(){return s},this.SetUtilityMap=function(e){s=e},this.GetCalCtrlBuilder=function(){return o},this.SetCalCtrlBuilder=function(e){o=e},this.GetEventHandlerMap=function(){return u},this.SetEventHandlerMap=function(e){u=e},this.SetDefaultView=function(){if(!r.Get("ViewMode")){var e=r.Get("Default Calendar Mode"),t;switch(e){case"Monthly":t="2";break;case"Weekly":t="1";break;case"Daily":t="0";break;default:t="0"}r.AddProperty("ViewMode",t)}}}function t(){var e=this.GetPM(),t=e.Get("GetFullId"),n=e.Get("GetPlaceholder");$("#"+t).css("overflow-x","auto"),this.SetDefaultView();if(SiebelApp.S_App.IsRwd()&&utils.IsTrue(e.Get("IsObjResponsive"))){var r=$("#"+t).find("#calendar_DIV");if(r.length>0){var i="calendar_"+n;$(r).attr("id",i),this.SetCal($("#"+i))}}else this.SetCal($("#calendar_"+n));this.SetLocaleConverter(new SiebelAppFacade.CalLocaleConverter),this.SetUtilityMap(new SiebelAppFacade.CalUtility),this.SetCalCtrlBuilder(new SiebelAppFacade.CalCtrlBuilder(e,this.GetCal(),this.GetUtilityMap())),this.SetEventHandlerMap(new SiebelAppFacade.CalEventHandlers(e,this.GetCal(),this.GetCalCtrlBuilder(),this.GetUtilityMap()))}function n(){var e=this.GetPM();e.AddProperty("SelectedDate",new Date(e.Get("ReturnStartDate"))),e.AddProperty("ReturnStartDate","")}function r(){var e=this.GetPM(),t=this.GetCal(),n=this.GetFullCal(),r=this.GetUtilityMap(),i=e.Get("ViewMode"),s=e.Get("SelectedDate");s&&(s>n.getDate()||s<n.getDate())&&n.gotoDate(s);if(i&&i!==r.ViewNameToMode(n.view.type)){var o=r.SplitViewName(n.view.type);t.find(".siebui-cal-btn-"+o).removeClass("disabled"),t.find(".siebui-cal-btn-"+o+"-txt").removeClass("disabled");if(window.matchMedia("(max-width: 1199px)").matches&&$("#_FormParentRelatedItemsOuterCont").length>0){var u=n.getOption("initialView");e.AddProperty("ViewMode",r.ViewNameToMode(u)),n.changeView(u)}else n.changeView(r.ViewModeToName(i))}}function i(){this.GetCal().closest(".siebui-applet-parent").is(":visible")&&this.GetCal().fullCalendar("getCalendar").reinitView()}function s(){var e=this.GetPM(),t=e.Get("Start Day of the Week"),n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=$.inArray(t,n),i=[e.Get("Sunday Workday Flag"),e.Get("Monday Workday Flag"),e.Get("Tuesday Workday Flag"),e.Get("Wednesday Workday Flag"),e.Get("Thursday Workday Flag"),e.Get("Friday Workday Flag"),e.Get("Saturday Workday Flag")],s=[],o=[];if(typeof t=="undefined"||r===-1)r=parseInt(e.Get("First Day of Week"),10);e.AddProperty("Week Day Number",r);var u=i.length;for(var a=0;a<u;a++){if(typeof i[a]=="undefined"){s=[r+5,r+6];break}i[a]!=="Y"&&i[a]!=="1"?s.push(a):o.push(a)}e.AddProperty("Hidden Days",s),e.Get("Preferred Weekly Mode")!=="5 Day Weekly"&&(o=[0,1,2,3,4,5,6]);var f=o.indexOf(r),l=[];for(var a=f;a<o.length;a++)l.push(o[a]);for(var a=0;a<f;a++)l.push(o[a]);e.AddProperty("Available Days",l)}function o(){var e=this.GetPM(),t=this.GetCal(),n=this.GetFullCal(),r=n.view.type,i=this.GetUtilityMap().SplitViewName(r),s=SiebelApp.S_App.GetActiveView(),o=s.GetAppletMap();for(var u in o)if(o.hasOwnProperty(u)){var a=o[u];if(a.GetPModel().Get("enableDragAndDropInList")){var f="s_"+a.GetFullId()+"_div",l=document.getElementById(f);if(l!==null)var c=new FullCalendar.Draggable(l,{itemSelector:".ui-draggable"})}}this.GetCalCtrlBuilder().AddControls(),t.find(".siebui-cal-btn-"+i).addClass("disabled"),t.find(".siebui-cal-btn-"+i+"-txt").addClass("disabled"),r!=="dayGridMonth"&&this.GetCalCtrlBuilder().AddMouseControls(),e.AddProperty("MultViewFrames",$("#_swecontent").find("[id^='_svf']").filter(function(){return this.clientHeight!==0}).length),this.resize(),e.SetProperty("FirstLoad",!1)}function u(e,t){var n=this.GetPM(),r=n.Get("Hidden Days"),i=t.type==="timeGridDay"?1:n.Get("Preferred Weekly Mode")==="7 Day Weekly"?7:7-r.length,s=7;for(var o=0;o<i;o++){if(n.Get("Preferred Weekly Mode")!=="7 Day Weekly"&&$.inArray((t.start.day()+o)%7,r)!==-1)continue;var u=new Date(t.activeStart);u.setDate(u.getDate()+o),u.setHours(0),u.setMinutes(0),u.setSeconds(0);var a=new Date(u);a.setSeconds(1);var f=[];e.push({id:"dummy_"+o,start:u,end:a,multiDisplay:f,displayFieldOne:"dummy",allDay:!1,className:"siebui-calendar-dummy"})}}function a(){var e=this.GetPM();if(e.Get("UseCalendarPane")!=="Y")return;var t=$(".siebui-calpane");if($(t).not(":visible")||$(t).is(":hidden"))$("#s_calendarContainer").addClass("siebui-cal-full-width"),$(t).addClass("siebui-calpane-hide");$("#calPaneContent").accordion({header:".siebui-accordion",heightStyle:"content",active:0,collapsible:!0,animate:!1}),$("#calPaneSubContent").accordion({header:".siebui-accordion",heightStyle:"content",active:!1,collapsible:!0,animate:!1});var n=this.GetUtilityMap();n.AttachAutoAttributes($(".siebui-calpane .siebui-icon-drilldown"),"Button","calPaneDrilldown"),$("#s_calendarPane .siebui-accordion").each(function(){var e=$(this).attr("id");n.AttachAutoAttributes($(this),"AccordionTab",e)})}function f(e){var t=this.GetPM();if(t.Get("UseCalendarPane")!=="Y")return;var n=this.GetCal(),r=this.GetFullCal(),i="siebui-cal-event-active",s=n.find("."+i),o=r.view.type==="listDay"||r.view.type==="listWeek";s.length!==0&&s.removeClass(i);if(e&&!$(".siebui-calpane").is(":hidden")){var u=t.Get("GetBusComp"
),a=u.GetIdValue();o?s=n.find(".fc-list-event[data-drilldown*='"+a+"']"):s=n.find(".fc-event[data-drilldown*='"+a+"']"),s.length>0&&s.addClass(i)}}function l(){if(!g.call(this))return;var e=this.GetPM(),t=this.GetCal(),n=this.GetFullCal(),r=e.Get("RTL Mode")!=="Y"?"left":"right",i=t.width(),s=$(".siebui-calpane").width(),o=e.Get("SelectedEvent"),u=o.left,a=u+o.width;if(n.view.type==="timeGridDay"){var f=100;o.width>f&&(r==="left"?a=u+f:u=a-f)}var l=i-s,c=r==="left"?i-u:a;if(l>0)if(r==="left"&&a>l||r==="right"&&i-u>l){var h=0,p=l-c;p>0?h=r==="left"?u-p:i-a-p:h=r==="left"?u-10:i-a-5,h!==0&&$(".fc-view-harness").css(r,-h+"px").css("position","relative")}}function c(){var e=this.GetPM();if(e.Get("UseCalendarPane")!=="Y"||$(".siebui-calpane").is(":hidden"))return;var t=this.GetCal(),n=this.GetFullCal(),r=t.height(),i=n.getOption("contentHeight"),s=this.GetCalContHeight(),o=$("#calPaneHeader").outerHeight(!0)+$("#calPaneContent").outerHeight(!0)+$("#calPaneSubContent").outerHeight(!0);o>r?i+=o-r:o<r&&(i-=r-o,i<s&&(i=s)),n.setOption("contentHeight",i),this.GetCalCtrlBuilder().BldSlotIndicators(n.view),this.GetCalCtrlBuilder().BldWeekColHdr(n.view)}function h(){var e=this.GetPM(),t=this.GetCal(),n=this.GetFullCal();if(e.Get("OpenCalPane")&&$(".siebui-calpane").is(":hidden")){$(".siebui-calpane").removeClass("siebui-calpane-hide").addClass("siebui-calpane-show"),$("#s_calendarContainer").removeClass("siebui-cal-full-width"),g.call(this)&&l.call(this);if(this.GetCalContHeight()===0){var r=n.getOption("contentHeight");this.SetCalContHeight(r)}c.call(this)}}function p(){var e=this.GetPM(),t=this.GetCal(),n=this.GetFullCal();if(e.Get("CloseCalPane")){$(".siebui-calpane").removeClass("siebui-calpane-show").addClass("siebui-calpane-hide"),$("#s_calendarContainer").addClass("siebui-cal-full-width"),e.SetProperty("OpenCalPane",!1),e.SetProperty("CloseCalPane",!1),f.call(this,!1);if(g.call(this)){var r=e.Get("RTL Mode")!=="Y"?"left":"right";$(".fc-view-harness").css(r,"").css("position","")}n.setOption("contentHeight",this.GetCalContHeight());if(typeof e.Get("CalActiveBtnId")!==undefined&&e.Get("CalActiveBtnId")!==""){var i=$("#"+e.Get("CalActiveBtnId"));i.focus(),e.SetProperty("CalActiveBtnId","")}}}function d(e){var t=e.data.ctx.GetPM(),n="",r="",i="",s="",o="",u="#",a="",f="",l=4;i=t.Get("Display Fields");if(i!==""){var c=i.split(",");s=c[0].replace(/^\s+|\s+$/g,""),a=1}typeof (t.Get("Special Date Buscomp Name")==="undefined")?o="N":o="Y";var h=t.Get("GetBusComp");typeof h.GetIdValue!="undefined"&&(n=h.GetIdValue(),r=h.GetName(),f=l+u+n.length+u+n+r.length+u+r,f+=s.length+u+s+a+u+o),SiebelApp.Utils.IsEmpty(n)||t.OnControlEvent(SiebelApp.Constants.get("PHYEVENT_DRILLDOWN_LIST"),f)}function v(){var e=this.GetPM();if(e.Get("UseCalendarPane")!=="Y"||$(".siebui-calpane").is(":hidden"))return;var t=e.Get("GetBusComp"),n=t.GetFieldValue("Repeating Type LIC");n=n.toLowerCase(),n==="repappt_nonrepeating"?$(".siebui-calpane-rept-toggle").hide():$(".siebui-calpane-rept-toggle").each(function(){var e=$(this).attr("id");e==="calPane_repappt_common_top"||e==="calPane_repappt_common_bottom"||e==="calPane_"+n?$(this).show():$(this).hide()}),c.call(this)}function m(){var e=this.GetPM();if(e.Get("UseCalendarPane")!=="Y")return;var t=e.ExecuteMethod("GetControl","AllDay");t&&e.SetProperty("IsAllDay",e.ExecuteMethod("GetFormattedFieldValue",t)==="Y"),v.call(this),f.call(this,!0)}function g(){var e=this.GetPM();if(e.Get("UseCalendarPane")!=="Y")return;var t=$(".siebui-calpane"),n=this.GetCal(),r=parseInt(n.css("z-index"),10),i=isNaN(r)?0:r;r=parseInt(t.css("z-index"),10);var s=isNaN(r)?0:r,o=n.width(),u=t.width();return s>i&&u<o?!0:!1}return SiebelJS.Extend(e,SiebelAppFacade.CalDetailPR),e.prototype.Init=function(){SiebelAppFacade.JQFullCalRenderer.superclass.Init.call(this);var e=this.GetPM();this.AttachPMBinding("ParseEventInfoOUI",function(){e.AddProperty("SelectedDate",new Date(e.Get("Default Selected Day")))},{scope:this,when:function(){return e.Get("FirstLoad")&&e.Get("Default Selected Day")}}),this.AttachPMBinding("ParseEventInfoOUI",n,{scope:this,when:function(){return e.Get("ReturnStartDate")&&e.Get("ReturnStartDate")!==""}}),this.AttachPMBinding("ParseEventInfoOUI",this.BindData),this.AttachPMBinding("ForceWindowResize",function(){e.Get("ForceWindowResize")===!0&&($(window).trigger("resize"),e.SetProperty("ForceWindowResize",!1))}),this.AttachPMBinding("NeedRefetchEvents",function(){if(e.Get("NeedRefetchEvents")){var t=this.GetFullCal();t.refetchEvents(),this.GetCalCtrlBuilder().BldSlotIndicators(t.view),e.Get("ViewMode")==="1"&&this.GetCalCtrlBuilder().BldWeekColHdr(t.view),e.SetProperty("NeedRefetchEvents",!1)}}),this.AttachPMBinding("OpenCalPane",h,{scope:this,when:function(){return e.Get("UseCalendarPane")==="Y"}}),this.AttachPMBinding("CloseCalPane",p,{scope:this,when:function(){return e.Get("UseCalendarPane")==="Y"}}),this.AttachPMBinding("RefreshRepeatLayout",function(){e.Get("RefreshRepeatLayout")&&(v.call(this),e.SetProperty("RefreshRepeatLayout",!1))}),this.AttachPMBinding("ShowSelection",m,{scope:this,when:function(){return e.Get("UseCalendarPane")==="Y"&&!e.Get("FirstLoad")}}),SiebelApp.EventManager.addListner("refreshview",this.resize,this),SiebelApp.EventManager.addListner("forceResize",this.resize,this)},e.prototype.BindEvents=function(e){SiebelAppFacade.JQFullCalRenderer.superclass.BindEvents.call(this);var t=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper"),n=this.GetFullCal();t&&(t.Manage($(window),"resize.JQFullCalRenderer",{ctx:this},function(e){var t=e.data.ctx,r=t.GetPM();e.target===window&&r.Get("ForceWindowResize")===!1&&(t.resize(),r.Get("UseCalendarPane")==="Y"&&(t.SetCalContHeight(n.getOption("contentHeight")),c.call(t)))}),t.Manage($("#openSidebarButton"),"click.JQFullCalRenderer",{ctx:this},function(e){e.data.ctx.resize()}),t.Manage($("#sidebarCloseButton"),"click.JQFullCalRenderer",{ctx:this},function(e){e.data.ctx.resize()}),t.Manage($(".siebui-calpane .siebui-icon-drilldown")
,"click",{ctx:this},d),t.Manage($(".siebui-calpane .siebui-accordion"),"click",{ctx:this},function(e){c.call(e.data.ctx)}),t.Manage($("#"+this.GetPM().Get("GetFullId")),"focus",{ctx:this},function(e){var t=e.data.ctx.GetPM();typeof t!="undefined"&&!t.Get("IsActive")&&t.OnControlEvent(SiebelApp.Constants.get("PHYEVENT_APPLET_FOCUS"))})),this.GetPM().Get("Enable External Drag And Drop")==="Y"&&t&&(t.Manage(this.GetCal(),"dragover",function(e){e.preventDefault()}),t.Manage(this.GetCal(),"drop",{ctx:this},this.GetEventHandlerMap().OnExtHTMLDropHandler)),SiebelApp.EventManager.addListner("ShowAppletContent",i,this)},e.prototype.GetOptions=function(){var e=this,t=this.GetPM(),n=this.GetEventHandlerMap(),r={allDaySlot:t.Get("AllowAllDay"),allDayText:t.Get("UISTR All Day Event")||"All Day",slotLabelFormat:{hour12:t.Get("24 Hour Flag")==="Y"?!1:!0,hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:t.Get("24 Hour Flag")==="Y"?!1:"short"},buttonText:{today:t.Get("UISTR Today Button"),month:t.Get("UISTR Monthly Tab"),week:t.Get("UISTR Weekly Tab"),day:t.Get("UISTR Daily Tab"),prev:"",next:"",prevYear:"",nextYear:""},contentHeight:500,initialView:this.GetUtilityMap().ViewModeToName(t.Get("ViewMode")),dragScroll:!1,droppable:t.Get("Enable External Drag And Drop")==="Y",drop:function(){if(utils.IsTrue(SiebelApp.S_App.IsAutoOn())){var e=t.ExecuteMethod("ConvertDateToString",arguments[0].date,!1),r=("0"+arguments[0].date.getHours()).slice(-2)+":"+("0"+arguments[0].date.getMinutes()).slice(-2)+":"+("0"+arguments[0].date.getSeconds()).slice(-2);arguments.formattedDateTime=e,arguments.formattedTime=r,SiebelApp.EventManager.fireEvent("calendarDrop",arguments)}n.OnExtJQueryDropHandler.apply(n,arguments)},editable:t.Get("CanUpdate"),eventDisplay:"block",eventsSet:function(){n.OnEventAfterAllRender.apply(n,arguments)},eventClick:function(){n.OnEventClick.apply(n,arguments)},eventWillUnmount:function(){n.OnEventDestroy.apply(n,arguments)},eventDragStop:function(){n.OnEventDragStop.apply(n,arguments)},eventDrop:function(){n.OnEventDrop.apply(n,arguments)},eventDurationEditable:t.Get("CanUpdate"),eventDidMount:function(){n.OnEventRender.apply(n,arguments)},eventContent:function(){return n.OnEventContent.apply(n,arguments)},longPressDelay:400,eventLongPressDelay:400,eventResizableFromStart:!0,eventResizeStart:function(){n.OnEventResizeStart.apply(n,arguments)},eventResizeStop:function(){n.OnEventResizeStop.apply(n,arguments)},eventResize:function(){n.OnEventResize.apply(n,arguments)},firstDay:t.Get("Week Day Number"),scrollTime:t.Get("Preferred Business Day Start Time"),scrollTimeReset:!1,headerToolbar:{start:"left",center:"today prev title next",end:"right"},hiddenDays:[],direction:t.Get("RTL Mode")==="Y"?"rtl":"ltr",lazyFetching:!1,longDateFormat:t.Get("Long Date Format"),select:function(){n.OnCalSelect.apply(n,arguments)},selectable:!0,selectMirror:t.Get("CanInsert")&&(typeof t.Get("Enable Quick Add")=="undefined"||t.Get("Enable Quick Add").toLowerCase()!=="n"&&t.Get("Enable Quick Add").toLowerCase()!=="false"),slotEventOverlap:!1,slotDuration:{minutes:parseInt(t.Get("Preferred Timeslot Interval"),10)},eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},datesSet:function(){n.OnViewDisplayChange.apply(n,arguments)},weekends:!0,fixedWeekCount:!1,dayMaxEventRows:!1,moreLinkClick:function(){return n.OnEventLimitClick.apply(n,arguments)},moreLinkContent:function(e){return"+"+e.num+"..."},views:{agenda:{timeFormat:" "},timeGridDay:{dayHeaders:!1,titleFormat:t.Get("Long Date Format")},timeGridWeek:{dayHeaderFormat:"dddd%MMM%DD",hiddenDays:t.Get("Preferred Weekly Mode")!=="7 Day Weekly"?t.Get("Hidden Days"):[],titleFormat:" ",dayHeaderContent:function(t){return e.GetCalCtrlBuilder().BldWeekHdrContent(t)}},dayGridMonth:{dayHeaderFormat:"dddd",dayMaxEventRows:4,titleFormat:"MMMM YYYY"}}},i=this.GetLocaleConverter().ConvertLocale(r);return t.SetProperty("SiebelShorDateFmt",r.SiebelShorDateFmt),r=$.extend(!0,{},r,i),delete r.SiebelShorDateFmt,delete r.longDateFormat,r},e.prototype.ShowUI=function(){SiebelAppFacade.JQFullCalRenderer.superclass.ShowUI.call(this);var e=this.GetPM(),n=e.Get("GetPlaceholder"),i="calendar_"+n;if(SiebelApp.S_App.IsRwd()&&utils.IsTrue(e.Get("IsObjResponsive"))){var u=e.Get("GetFullId");if($("#"+u).length>0){var f=$("#"+u).find("#calendar_DIV");if(f.length===0)return}}else if($("#calendar_"+e.Get("GetPlaceholder")).length===0)return;t.call(this),s.call(this);var l=this.GetOptions(),c=this.GetEventHandlerMap();e.AddProperty("ShortMonthNames",l.monthNamesShort),e.AddProperty("ShortDayNames",l.dayNamesShort);var h=document.getElementById(i),p=new FullCalendar.Calendar(h,l);this.SetFullCal(p),this.GetEventHandlerMap().SetFullCal(p),this.GetCalCtrlBuilder().SetFullCal(p),p.setOption("events",function(){c.OnEventRefresh.apply(c,arguments)});var d=this.GetUtilityMap().ViewModeToName(e.Get("ViewMode"));(d==="timeGridDay"||d==="timeGridWeek")&&this.GetCalCtrlBuilder().PrepareSlotLaneContent(d),r.call(this),p.render(),o.call(this),a.call(this)},e.prototype.resize=function(){if(SiebelApp.Utils.IsEmpty(this.GetPM()))return;var e=this.GetPM();if($("#calendar_"+e.Get("GetPlaceholder")).length===0)return;var t=this.GetCal(),n=this.GetFullCal(),r,i=SiebelApp.S_App.IsRwd()?$("#"+SiebelApp.S_App.ViewTarget()):$("#_sweview");$(i).find(".siebui-applet").each(function(){$(this).find(".fc-view-harness").length===0&&$(this).removeClass("hide")}),$("#_FormParentRelatedItemsOuterCont").removeClass("hide"),$("#"+e.Get("GetFullId")).width(0).width("auto"),$("#s_"+e.Get("GetFullId")+"_div").width(0).width("auto"),r=Math.max(t.find(".fc-toolbar").width(),$("#s_"+e.Get("GetFullId")+"_div").width(),t.find(".fc-view").width(),t.find(".siebui-short-hdr").is(":hidden")?0:t.find(".siebui-short-hdr").width()),r!==$("#s_"+e.Get("GetFullId")+"_div").width()&&(r===t.find(".fc-view").width()&&e.Get("FirstLoad")?($("#s_"+e.Get("GetFullId")+"_div").width(r+200),n.updateSize()):$("#s_"+e.Get("GetFullId")+"_div").width(r
)),(e.Get("ViewMode")==="1"||e.Get("ViewMode")==="2")&&window.matchMedia("(max-width: 1199px)").matches&&!e.Get("FirstLoad")&&!$("#"+e.Get("GetFullId")).parent().hasClass("siebui-sub-applets")&&!utils.IsSmallScreen()&&($(i).find(".siebui-applet").each(function(){$(this).find(".fc-view-harness").length===0&&$(this).addClass("hide")}),$("#_FormParentRelatedItemsOuterCont").addClass("hide"),$("#"+e.Get("GetFullId")).width(0),r=Math.max($(i).width(),t.find(".fc-toolbar").width()),$("#"+e.Get("GetFullId")).width(r),$("#s_"+e.Get("GetFullId")+"_div").width("auto"),r===t.find(".fc-toolbar").width()&&$("#s_"+e.Get("GetFullId")+"_div").width(r),e.Get("ViewMode")==="1"&&this.GetCalCtrlBuilder().BldWeekColHdr(n.view),n.setOption("contentHeight",n.getOption("contentHeight"))),e.Get("FirstLoad")&&$(i).find(".siebui-view-multi-column").length>0&&(e.SetProperty("Enable 5Day Time Display","Never"),e.SetProperty("Enable Monthly Time Display","Never"));if(e.Get("MultViewFrames")===1&&!e.Get("FirstLoad"))if($(window).height()!==e.Get("WindowHeight")||$(window).width()!==e.Get("WindowWidth")){e.AddProperty("WindowHeight",$(window).height()),e.AddProperty("WindowWidth",$(window).width());var s=$("#_swescrnbar").width()>=$("#_sweclient").width()*.9?$("#_swescrnbar").outerHeight(!0):0,o=$(".siebui-button-toolbar").length==1?$(".siebui-button-toolbar").outerHeight(!0):0,u=$("#_swethreadbar").length?$("#_swethreadbar").outerHeight(!0):0,a=($("#_sweclient").outerHeight(!0)-$("#_sweappmenu").outerHeight(!0)-u-o-s)*.95;a-=t.outerHeight(!0),a+=$(".fc-view-harness").height(),n.setOption("contentHeight",Math.max(100,Math.min(a,500)))}e.Get("FirstLoad")||(this.GetCalCtrlBuilder().BldSlotIndicators(n.view),e.Get("ViewMode")==="1"&&this.GetCalCtrlBuilder().BldWeekColHdr(n.view)),$(".siebui-cal-popup").length>0&&$(".siebui-cal-popup").position({my:"center",at:"center",of:$(window)});var f=this.GetUtilityMap();f.AddResponsiveTitle(t,n,e),f.AddResponsiveHdrClass(t)},e.prototype.EndLife=function(){$(window).unbind("resize.JQFullCalRenderer"),$("#openSidebarButton").unbind("click.JQFullCalRenderer"),$("#sidebarCloseButton").unbind("click.JQFullCalRenderer"),$(".siebui-tooltip-calendar").remove(),SiebelApp.EventManager.removeListner("refreshview",this.resize,this),SiebelApp.EventManager.removeListner("forceResize",this.resize,this),this.GetFullCal().destroy(),this.SetFullCal(null),this.SetCal(null),this.SetLocaleConverter(null),this.SetUtilityMap(null),this.SetCalCtrlBuilder(null),this.SetEventHandlerMap(null),$(document).unbind("mouseup.JQFullCalRenderer"),SiebelAppFacade.JQFullCalRenderer.superclass.EndLife.call(this),SiebelApp.EventManager.removeListner("ShowAppletContent",i,this)},e.prototype.BindData=function(){var e=[],t=this.GetPM(),n=[],r=[],i=this.GetCal(),s=this.GetFullCal(),o=this.GetUtilityMap(),a,f,l;if(this.inProgress)return[];if(SiebelApp.S_App.IsRwd()!==null&&utils.IsTrue(t.Get("IsObjResponsive"))!==!0&&$("#calendar_"+this.GetPM().Get("GetPlaceholder")).length===0)return;var c=t.Get("GetRecordSet"),h=t.Get("EventInfo"),p=s.view.type==="listDay"||s.view.type==="listWeek";if(this.GetFullCal()&&h){var d=h.length;for(a=0;a<d;a++){var v=h[a],m=[],g=[],y=[],b,w,E=!1;v.Planned=new Date(v.Planned),v.PlannedCompletion=new Date(v.PlannedCompletion);var S=new Date(v.PlannedCompletion),x=v.DisplayField.length;for(f=0;f<x;f++){w=v.DisplayField[f],(w.Name!=="Readonly"||!t.Get("CanUpdate"))&&w.FieldValue===""&&w.IconFile!==""&&(m.push(w.IconFile),g.push(w.ToolTip));if(w.FieldValue==="")continue;b=parseInt(w.Sequence,10),y[b]=f}var T=[],N,C=y.length;for(l=1;l<C;l++)N=[],w=v.DisplayField[y[l]],N.FieldValue=w.FieldValue,N.ToolTip=w.ToolTip,N.DrillDown=w.DrillDown,N.FieldColor=w.FieldColor,N.CSSName=this.GetUtilityMap().IsAllDayEvent(v)?"calendar-DisplayField-AllDayEventFont":"calendar-DisplayField-Font"+l.toString(),T.push(N);var k=v.EventStyle.replace(/\s/g,"");typeof v.EventStyle!="undefined"&&($.inArray(v.EventLegend,n)<0&&n.push(v.EventLegend),typeof r[v.EventLegend]=="undefined"&&(r[v.EventLegend]=k));var L;L=v.AllDayFlag==="Y",L&&S.setSeconds(S.getSeconds()+1);if(!p&&v.Planned===v.PlannedCompletion){E=!0;var A=parseInt(t.Get("Preferred Timeslot Interval"),10);S.setMinutes(S.getMinutes()+A);if(v.AllowAllDay!=="Y"&&v.AllowAllDay!=="T"&&v.AllowAllDay!=="1"||v.AllowAllDay==="string")L=!1}if(y.length===0||!y[1]){if(v.DisplayField.length===0)continue;y[1]=0}var O="";p&&(O=v.DisplayField[y[1]].FieldValue),e.push({id:v.Id,title:O,start:v.Planned,end:S,multiDisplay:T,displayFieldOne:v.DisplayField[y[1]].FieldValue,dataDrilldown:v.DisplayField[y[1]].DrillDown,url:"javascript:void(0)",repeating:v.Repeating,calendarId:v.CalendarId,readOnly:v.ReadOnly,icons:m,iconText:g,className:"fc-event-skin calendar-EventStyle-"+k,allDay:L,origAllDay:L,editable:t.Get("CanUpdate"),isZeroDuration:E})}}s.view.type==="listWeek"&&u.call(this,e,s.view),t.SetProperty("CachedEvents",e),t.Get("CalSuccessCallBack")===null?(t.SetProperty("CallBackEvents",e),s.refetchEvents()):(t.Get("CalSuccessCallBack").cb(e),t.SetProperty("CalSuccessCallBack",null)),t.Get("DelayRenderUpdate")&&(t.AddProperty("DelayRenderUpdate",!1),s.refetchEvents());if(t.Get("Enable BusyFreeTime")==="Y"){var M=t.ExecuteMethod("CalcBusyHrsAndAllDay",e);t.AddProperty("BusyHours",M[0]),t.AddProperty("AllDays",M[1]),this.GetCalCtrlBuilder().RenderBusyFreeTime()}t.AddProperty("CSSLegendsLDC",n),t.AddProperty("CSSLegendsLIC",r),this.GetCalCtrlBuilder().AddColorCodedLegends(i.find(".siebui-cal-hdr-wrapper"));var _=i.find(".siebui-cal-btn-today").children("span");o.AttachAutoAttributes($(_).children(".fc-button-content"),"Button","today"),_=i.find(".siebui-cal-btn-prev").children("span"),o.AttachAutoAttributes($(_).children(".fc-button-content"),"Button","prev"),o.AttachAutoAttributes($(_),"Button","prev"),_=i.find(".siebui-cal-btn-next").children("span"),o.AttachAutoAttributes($(_).children(".fc-button-content"),"Button","next"),o.AttachAutoAttributes($(_),"Button","next");if(t.Get("EventClickInProgress"
)){t.SetProperty("EventClickInProgress",!1);var D=t.Get("EventClickInProgressDrilldown");SiebelApp.Utils.IsEmpty(D)||(t.SetProperty("EventClickInProgressDrilldown",""),t.Get("UseCalendarPane")==="Y"?t.OnControlEvent("eventSelection",D):t.OnControlEvent(SiebelApp.Constants.get("PHYEVENT_DRILLDOWN_LIST"),D))}},e}(),SiebelAppFacade.CalCtrlEventHandlers=function(){function e(e,t,n,r){var i=e,s=t,o=t,u=n,a=r,f;this.GetPM=function(){return i},this.GetCal=function(){return s},this.GetCalCtrlBuilder=function(){return u},this.GetUtilityMap=function(){return a},this.GetFullCal=function(){return f},this.SetFullCal=function(e){f=e}}return e.prototype={OnCancelClick:function(e){$("#"+e).dialog("close")},OnDatepickerSelect:function(e){var t=this.GetCal(),n=this.GetFullCal(),r=this.GetPM(),i=$("#"+e).datepicker("getDate");r.AddProperty("SelectedDate",i),n.gotoDate(i);if(utils.IsTrue(SiebelApp.S_App.IsAutoOn())){var s={target:$("#"+e)};SiebelApp.EventManager.fireEvent("CustomControlEvent:Change",s)}t.find(".fc-toolbar").width()>$("#s_"+r.Get("GetFullId")+"_div").width()&&$("#s_"+r.Get("GetFullId")+"_div").width(t.find(".fc-toolbar").width()),n.view.type!=="dayGridMonth"&&this.GetCalCtrlBuilder().AddMouseControls()},OnHomePageViewBtnClick:function(e){var t=this.GetPM(),n=CCFMiscUtil_CreatePropSet(),r=this.GetFullCal();SiebelApp.S_App.uiStatus.Busy({target:SiebelApp.S_App.GetTargetViewContainer(),mask:!0});var i={async:!0,cb:function(){SiebelApp.S_App.uiStatus.Free()}},s=r.getDate();n.SetProperty("SelectedDay",t.ExecuteMethod("ConvertDateToString",s,!0));switch(e){case"dayGridMonth":t.ExecuteMethod("InvokeMethod","GoToMonthly",n,i);break;case"timeGridWeek":t.ExecuteMethod("InvokeMethod","GotoWeekly",n,i);break;case"timeGridDay":t.ExecuteMethod("InvokeMethod","GotoToday",n,i);break;default:}},OnQuickAddDialogOkClick:function(e,t,n){var r=this.GetPM(),i=$("input:text[name=eventDescription]").val();$.trim(i)===""?i="":r.SetProperty("QuickAdd",!0),r.OnControlEvent("newEvent",i,t,n,null),$("#"+e).dialog("close")},OnRepeatDialogOkClick:function(e,t,n,r,i){var s=this.GetPM(),o=CCFMiscUtil_CreatePropSet(),u=$("input:radio[name=userchoice]:checked").val();u!=="SaveThisOne"&&u!=="SaveAll"?(r(),$("#"+e).dialog("close")):(o.SetProperty("Repeating","Y"),u==="SaveThisOne"?o.SetProperty("Modify","ThisOne"):o.SetProperty("Modify","AllFuture"),s.OnControlEvent(n,t.start,t.end,t.id,o),i(),$("#"+e).dialog("close"))},OnSettingsDialogOkClick:function(e){var t=this.GetPM(),n=!1,r={async:!0,cb:function(){SiebelApp.S_App.uiStatus.Free()}};t.Get("Enable Timezone Picker")==="Y"&&t.Get("Timezone")!==$("#tzCombo").val()&&(t.AddProperty("Timezone",$("#tzCombo").val()),n=!0);var i=$("#ownerCombo").val();t.Get("Enable Owner Picker")==="Y"&&t.Get("Owner")!==i&&(i==="ALLEMPLOYEES"?(SiebelApp.S_App.uiStatus.Busy({target:SiebelApp.S_App.GetTargetViewContainer(),mask:!0}),t.ExecuteMethod("InvokeMethod","GoToEmployeeCalView",CCFMiscUtil_CreatePropSet(),r)):(t.AddProperty("Owner",i),t.ExecuteMethod("UpdateUserPermission"),i===t.Get("User Login Name")&&t.Get("FromExternalCalendar")==="Y"&&(SiebelApp.S_App.uiStatus.Busy({target:SiebelApp.S_App.GetTargetViewContainer(),mask:!0}),t.ExecuteMethod("InvokeMethod","GoToExternalCalView",t.ExecuteMethod("PopulatePropSet"),r))),n=!0),n&&i!=="ALLEMPLOYEES"&&(t.AddProperty("DelayRenderUpdate",!0),t.ExecuteMethod("GetCalendarData")),$("#"+e).dialog("close")},OnViewBtnClick:function(e){var t=this.GetCal(),n=this.GetFullCal(),r=this.GetPM(),i=this.GetUtilityMap(),s=n.view.type;if(e==="timeGridDay"&&s==="timeGridWeek"||e==="timeGridWeek"&&s==="timeGridDay")r.SetProperty("UseClientCalendarData",!0),n.changeView("dayGridMonth"),t.find(".siebui-cal-btn-day-grid-month").removeClass("disabled"),t.find(".siebui-cal-btn-day-grid-month-txt").removeClass("disabled"),r.SetProperty("UseClientCalendarData",!1);s==="listDay"?s="timeGridDay":s==="listWeek"&&(s="timeGridWeek"),s=i.SplitViewName(s);var o,u=SiebelApp.S_App.IsRwd()?$("#"+SiebelApp.S_App.ViewTarget()):$("#_sweview"),a=r.Get("ToggleClicked")||!1;a?r.AddProperty("ToggleClicked",!1):(t.find(".siebui-cal-btn-"+s).removeClass("disabled"),t.find(".siebui-cal-btn-"+s+"-txt").removeClass("disabled"));var f=r.Get("Enable List Toggle")==="Y"||!1,l=r.Get("CurrentViewMode")==="List"||!1;f&&l?e==="timeGridDay"?e="listDay":e==="timeGridWeek"&&(e="listWeek"):f&&!l&&(e==="listDay"?e="timeGridDay":e==="listWeek"&&(e="timeGridWeek")),r.AddProperty("ViewMode",i.ViewNameToMode(e)),e==="timeGridDay"?($(u).find(".siebui-applet").each(function(){$(this).find(".fc-view-harness").length===0&&$(this).removeClass("hide")}),$("#_FormParentRelatedItemsOuterCont").removeClass("hide"),$("#"+r.Get("GetFullId")).width(0),$("#"+r.Get("GetFullId")).width("auto"),$("#s_"+r.Get("GetFullId")+"_div").width(0),$("#s_"+r.Get("GetFullId")+"_div").width("auto"),o=Math.max(t.find(".fc-toolbar").width(),$("#s_"+r.Get("GetFullId")+"_div").width(),t.find(".siebui-short-hdr").is(":hidden")?0:t.find(".siebui-short-hdr").width()),o!==$("#s_"+r.Get("GetFullId")+"_div").width()&&$("#s_"+r.Get("GetFullId")+"_div").width(o),r.SetProperty("ForceWindowResize",!0)):e!=="timeGridDay"&&window.matchMedia("(max-width: 1199px)").matches&&!$("#"+r.Get("GetFullId")).parent().hasClass("siebui-sub-applets")&&!utils.IsSmallScreen()&&($(u).find(".siebui-applet").each(function(){$(this).find(".fc-view-harness").length===0&&$(this).addClass("hide")}),$("#_FormParentRelatedItemsOuterCont").addClass("hide"),$("#"+r.Get("GetFullId")).width(0),o=Math.max($(u).width(),t.find(".fc-toolbar").width()),$("#"+r.Get("GetFullId")).width(o),$("#s_"+r.Get("GetFullId")+"_div").width(0),$("#s_"+r.Get("GetFullId")+"_div").width("auto"),o===t.find(".fc-toolbar").width()&&$("#s_"+r.Get("GetFullId")+"_div").width(o)),(e==="timeGridDay"||e==="timeGridWeek")&&this.GetCalCtrlBuilder().PrepareSlotLaneContent(e);var c=n.getEvents();n.batchRendering(function(){for(var e=0;e<c.length;e++)c[e].remove()}),n.changeView(e),i.AddResponsiveHdrClass(t),$(document)
.unbind("mouseup.JQFullCalRenderer"),e!=="dayGridMonth"&&this.GetCalCtrlBuilder().AddMouseControls()},OnNavBtnClick:function(e){var t=this.GetPM(),n=this.GetCal(),r=this.GetFullCal(),i=r.view,s=i.type,o={};e==="next"?s==="timeGridWeek"||s==="listWeek"?o={days:7}:s==="timeGridDay"||s==="listDay"?o={days:1}:o={months:1}:e==="prev"&&(s==="timeGridWeek"||s==="listWeek"?o={days:-7}:s==="timeGridDay"||s==="listDay"?o={days:-1}:o={months:-1});var u=new Date;u.getTime()<i.activeStart.getTime()||u.getTime()>i.activeEnd.getTime()||e!=="today",(e==="prev"||e==="next")&&r.incrementDate(o);var a=r.getDate(),f=a;e==="today"&&(f=new Date,r.gotoDate(f)),$("#"+t.Get("GetFullId")).find("#caldate_picker").datepicker("setDate",f),n.find(".fc-toolbar").width()>$("#s_"+t.Get("GetFullId")+"_div").width()&&$("#s_"+t.Get("GetFullId")+"_div").width(n.find(".fc-toolbar").width()),s!=="dayGridMonth"&&this.GetCalCtrlBuilder().AddMouseControls()},OnRefreshCalendar:function(){var e=this.GetFullCal();e.refetchEvents(),this.GetCalCtrlBuilder().BldSlotIndicators(e.view)},OnToggleClick:function(e){var t=this.GetCal(),n=this.GetFullCal(),r=this.GetPM(),i="siebui-icon-grid",s="siebui-icon-toggle",o=r.Get("CurrentViewMode"),u=n.view.type;r.AddProperty("ToggleClicked",!0),o==="List"?($(e.target).removeClass(s).addClass(i),t.find(".siebui-cal-btn-day-grid-month").removeClass("disabled"),t.find(".siebui-cal-btn-day-grid-month-txt").removeClass("disabled"),r.SetProperty("CurrentViewMode","Agenda")):($(e.target).removeClass(i).addClass(s),t.find(".siebui-cal-btn-day-grid-month").addClass("disabled"),t.find(".siebui-cal-btn-day-grid-month-txt").addClass("disabled"),r.SetProperty("CurrentViewMode","List"),u==="dayGridMonth"&&(u="listWeek")),this.OnViewBtnClick(u)},OnPrintCalendar:function(){var e=this.GetPM(),t=this.GetCal(),n=this.GetFullCal(),r=e.Get("GetFullId"),i=!1,s=$("#"+r),o=$("#s_"+r+"_div"),u=$("#_sweview"),a=$(".siebui-applet"),f=$("div[class^=siebui-span-]"),l=$(".siebui-view-multi-column");a.each(function(){$(this).find(".fc-view-harness").length===0&&$(this).addClass("hide")}),$("#_FormParentRelatedItemsOuterCont").addClass("hide"),f.each(function(){$(this).addClass("siebui-print-static")});var c=t.find(".fc-scroller").scrollTop(),h=n.view.type,p="";h==="timeGridWeek"?(p="listWeek",i=!0):h==="timeGridDay"?(p="listDay",i=!0):p=h;var d=e.Get("ViewMode"),v=n.getOption("contentHeight");i&&n.changeView(p),l.addClass("siebui-print-dbl-width"),o.addClass("siebui-cal-print");var m=d==="2"?$(".fc-daygrid-body").height()+$(".fc-col-header").height():$(".fc-list-table").height();n.setOption("contentHeight",m),s.addClass("siebui-noscroll"),o.addClass("siebui-noscroll"),l.addClass("siebui-noscroll"),u.addClass("siebui-noscroll"),t.find(".fc-scroller").addClass("siebui-noscroll");var g="span";if(d==="2"){o.find(g+".fc-event-title").each(function(){$(this).data("originalText",$(this).text());var e=$(this).text();$(this).text(e),$(this).find("a").addClass("siebui-no-display")});var y=o.find(".fc-col-header, .fc-daygrid-body, .fc-scrollgrid-sync-table");y.addClass("siebui-cal-full-width")}window.print(),d==="2"&&(o.find(g+".fc-event-title").each(function(){var e=$(this).data("originalText");$(this).text(e),$(this).find("a").removeClass("siebui-no-display")}),y.removeClass("siebui-cal-full-width")),i&&n.changeView(h),a.each(function(){$(this).find(".fc-view-harness").length===0&&$(this).removeClass("hide")}),$("#_FormParentRelatedItemsOuterCont").removeClass("hide"),f.each(function(){$(this).removeClass("siebui-print-static")}),s.removeClass("siebui-noscroll"),o.removeClass("siebui-cal-print siebui-noscroll"),l.removeClass("siebui-print-dbl-width siebui-noscroll"),u.removeClass("siebui-noscroll"),t.find(".fc-scroller").removeClass("siebui-noscroll"),d==="2"&&n.render(),n.setOption("contentHeight",v),(d==="0"||d==="1")&&t.find(".fc-scroller").scrollTop(c),e.Get("UseClientCalendarData")&&e.SetProperty("UseClientCalendarData",!1)},OnWeekHdrAddClick:function(e){var t=this.GetPM();t.Get("UseCalendarPane")==="Y"&&t.AddProperty("CalActiveBtnId",$(e.target).attr("id"));var n=$(e.target).attr("data-date").split("-"),r=new Date(n[0],n[1]-1,n[2]),i,s=new Date,o=s.getMinutes(),u=parseInt(t.Get("Preferred Timeslot Interval"),10),a=parseInt(t.Get("Preferred Duration"),10);t.SetProperty("SelectedDate",r),t.SetProperty("UseClientCalendarData",!0),t.SetProperty("CallBackEvents",t.Get("CachedEvents")),this.GetFullCal().gotoDate(r),r.setHours(s.getHours()+Math.floor((o+u)/60)),r.setMinutes((Math.floor(o/u)+1)*u%60),r.setSeconds(0),i=new Date(r),i.setMinutes(i.getMinutes()+a),t.OnControlEvent("newEvent","",r,i,null)},OnWeekHdrClick:function(e){var t=this.GetPM(),n;$(e.target).attr("data-date")?n=$(e.target).attr("data-date").split("-"):n=$(e.target.parentElement).attr("data-date").split("-");var r=new Date(n[0],n[1]-1,n[2]);t.AddProperty("SelectedDate",r),this.GetFullCal().gotoDate(r)},OnWeekHdrCollapseClick:function(e){var t=this.GetPM(),n,r=$(e.target);r.hasClass("siebui-icon-arrowsm-up")?(r.removeClass("siebui-icon-arrowsm-up").addClass("siebui-icon-arrowsm-down"),n=t.Get("UISTR Expand")||"Expand"):(r.removeClass("siebui-icon-arrowsm-down").addClass("siebui-icon-arrowsm-up"),n=t.Get("UISTR Collapse")||"Collapse"),n=n.replace(/\s/g,""),r.attr("title",n),r.attr("alt",n);var i=$(e.target).attr("data-date");$("tr.fc-list-event[data-date = '"+i+"']").toggle()}},e}(),SiebelAppFacade.CalCtrlBuilder=function(){function e(e,t,n){var r=t,i=e,s=n,o=new SiebelAppFacade.CalCtrlEventHandlers(e,t,this,n),u;this.GetCal=function(){return r},this.GetPM=function(){return i},this.GetCalCtrlEventHandlers=function(){return o},this.GetUtilityMap=function(){return s},this.GetFullCal=function(){return u},this.SetFullCal=function(e){u=e,this.GetCalCtrlEventHandlers().SetFullCal(e)}}function t(e,t,n,r,i,s,o,u){SiebelApp.Utils.IsEmpty(o)&&(o=t);var a=$(SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({attrs:"ot='"+i+"' un='"+o.replace(/\s/g,"")+"' rn='"+o.replace(/\s/g,"")+"' alt= '"+
t.replace(/\d/g,"")+"' title='"+t.replace(/\d/g,"")+"'",className:n,id:r,type:i,value:e})),f=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper");return f&&f.Manage(a,["click","tap"],function(){a.hasClass("fc-state-disabled")||s.apply(this,Array.prototype.slice.call(arguments,0))}).Manage(a,"mousedown",function(){a.not(".fc-state-active").not(".fc-state-disabled").addClass("fc-state-down"),a.data("mouseDown",!0)}).Manage(a,"mouseup",function(){a.removeClass("fc-state-down"),a.data("mouseDown")&&a.removeData("mouseDown")}).Manage(a,"mouseenter",function(){a.not(".fc-state-active").not(".fc-state-disabled").addClass("fc-state-hover")}).Manage(a,"mouseleave",function(){a.removeClass("fc-state-hover").removeClass("fc-state-down")}).Manage(a,"focus",function(){typeof u!="undefined"&&!u.Get("IsActive")&&!a.data("mouseDown")&&u.OnControlEvent(SiebelApp.Constants.get("PHYEVENT_APPLET_FOCUS"))}),a}function n(e,t,n){var r=this.GetPM(),i=this.GetUtilityMap(),s=this.GetCal(),o=s.find("#"+e);o.hide();var u=r.Get("ShortMonthNames"),a=r.Get("ShortDayNames"),f=r.Get("UISTR Choose a date")||"Choose a date";o.datepicker({buttonImage:t,buttonText:f,buttonImageOnly:!1,changeMonth:!0,changeYear:!0,dayNamesMin:a,isRTL:r.Get("RTL Mode")==="Y",monthNames:r.Get("MonthStringArray"),monthNamesShort:u,onSelect:n,firstDay:r.Get("Week Day Number"),showOn:"button"});var l=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper");return l.Manage(o,"keydown",function(){o.focus()}),$(".ui-datepicker-trigger").addClass("fc-button-inner"),$(".ui-datepicker-trigger").attr("alt",f),$(".ui-datepicker-trigger").attr("title",f),$(".ui-datepicker-trigger").attr("tabindex",0),$(".ui-datepicker-trigger").children().addClass("fc-button-content"),$(".ui-datepicker-trigger").children().addClass("cal-ui-datepicker"),$(".ui-datepicker-trigger").addClass("btn-icon"),$(".ui-datepicker-trigger").addClass("siebui-icon-calendar"),$(".hasDatepicker").attr("tabindex",-1),i.AttachAutoAttributes(s.find("#"+e).siblings().filter("button.ui-datepicker-trigger"),"JDatePick","datePicker"),utils.IsTrue(SiebelApp.S_App.IsAutoOn())&&s.find("#"+e).attr("data-autom","next"),r.Get("Default Selected Day")?o.datepicker("setDate",r.Get("Default Selected Day")):r.Get("SelectedDate")&&o.datepicker("setDate",r.Get("SelectedDate")),o}function r(e,t,n,r){var i=$("#"+e),s=[];for(var o in r){var u={"class":"siebui-ctrl-btn appletButton",click:r[o],text:o};s.push(u)}return $("#"+e).length===0&&(i=$('<div id="'+e+'"></div>').html(t).dialog({autoOpen:!1,buttons:s,close:function(){$("#"+e).remove()},height:"auto",modal:!0,resizable:!1,title:n,width:"auto",draggable:!1})),i.parent().addClass("siebui-cal-popup"),i}function i(e){var t=this.GetPM(),n="",r;switch(e){case"QuickAddDialog":var i=t.Get("UISTR Tooltip Field Label:Description")||"Description",s=t.Get("DescriptionFieldLength");r="aria-labelledby='s_DescriptionId' rn='QANewDescription' ot='JText' un='QANewDescription' name='eventDescription' maxlength='"+s+"'",n='<p><span id="s_DescriptionId">'+i+"</span><br />",n+=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_TEXT"),id:"DescriptionId",attrs:r}),n+="<br/></p>";break;case"RepeatDialog":var o=t.Get("UISTR Repeating Dialog Label 1"),u=t.Get("UISTR Repeating Dialog Label 2"),a=t.Get("UISTR Repeating Dialog This Instance")||"This instance",f=t.Get("UISTR Repeating Dialog All Future Instances")||"This and all future instances";r="aria-labelledby='s_SaveThisOneId' rn='saveThisOne' ot='JRadioButton' un='saveThisOne' name='userchoice' checked='checked'",n="<p>"+o+"<br/><br/>",n+=u+"<br/>",n+=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_RADIO"),id:"SaveThisOneId",attrs:r,value:"SaveThisOne"}),r="aria-labelledby='s_SaveAllId' rn='saveAll' ot='JRadioButton' un='saveAll' name='userchoice'",n+='<span id="s_SaveThisOneId">'+a+"</span><br/>",n+=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_RADIO"),id:"SaveAllId",attrs:r,value:"SaveAll"}),n+='<span id="s_SaveAllId">'+f+"</span><br/></p>";break;case"SettingsDialog":var l=CCFMiscUtil_CreatePropSet();n="<table><td></td>";if(t.Get("Enable Timezone Picker")==="Y"){l.DecodeFromString(t.Get("Timezone List"));var c=[],h=l.GetChildCount();for(var p=0;p<h;p++)c.push(l.GetChild(p).GetProperty("Value"));var d=t.Get("UISTR Timezone Label");r="aria-labelledby='Timezone_Label' aria-label='"+d+"'rn='settingTimeZone' ot='JComboBox' un='settingTimeZone'";var v=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_COMBOBOX"),id:"tzCombo",attrs:r,value:c});n+='<tr><td><span id="Timezone_Label">'+d+"</span></td>",n+="<td>"+v+"</td></tr>"}if(t.Get("Enable Owner Picker")==="Y"){l.DecodeFromString(t.Get("Access List"));var m=l.EnumProperties(!0),g=[],y=[],b=[];while(m)g.push([m,l.GetProperty(m)]),m=l.EnumProperties(!1);g.sort(this.GetUtilityMap().SortOrder);for(var w=0;w<g.length;w++)b.push(g[w][0]),y.push(g[w][1]);var E=t.Get("UISTR Owner Label");r="aria-labelledby='Owner_Label' aria-label='"+E+"'rn='settingOwner' ot='JComboBox' un='settingOwner'";var S=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({attrs:r,displayValue:y,id:"ownerCombo",type:consts.get("SWE_CTRL_COMBOBOX"),value:b});n+='<tr><td><span id="Owner_Label">'+E+"</span></td>",n+="<td>"+S+"</td></tr>"}n+="</table>"}return n}return e.prototype.AddColorCodedLegends=function(e){var t=this.GetPM(),n=this.GetCal(),r=t.Get("CSSLegendsLDC")||[],i=t.Get("CSSLegendsLIC")||[];n.find("#siebui-cal-legend-row")&&n.find("#siebui-cal-legend-row").remove();var s=$("<div id='siebui-cal-legend-row' class='siebui-cal-legend-row'></div>");s.appendTo(e),r.sort();for(var o=0;o<r.length;o++){var u=r[o]!==""?i[r[o]]:"undefined",a=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_PLAINTEXT"),className:"siebui-legend-square",id:"color_square_"+u,attrs:"title=''",value:"&#9632"}),f=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_PLAINTEXT"
),className:"siebui-legend-text",id:"legend_"+u,value:r[o]!==""?r[o]:"undefined"}),l=$(a+f);n.find("#siebui-cal-legend-row").append(l);var c=$(".calendar-EventStyle-"+u).css("background-color");c||(n.find("#color_square_"+u).remove(),n.find("#legend_"+u).remove())}},e.prototype.AddControls=function(){var e=this.GetPM(),t=this.GetCal(),r=this.GetFullCal(),i=this,s=this.GetCalCtrlEventHandlers(),o=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper"),u=e.Get("Home Page Mode"),a=this.GetUtilityMap(),f="";t.find(".fc-prev-button").parent().addClass("fc-center"),t.find(".fc-right-button").parent().addClass("fc-right"),t.find(".fc-left-button").parent().addClass("fc-left");var l=$(".fc-center").width(),c=[],h=[],p=[],d=[],v,m,g,y="";if(e.Get("CanInsert")){if(e.Get("Enable New Contact Call Button")==="Y"){var b=e.Get("UISTR Contact Call")||"Contact Call";c.push(this.BldCustomHdrBtn(e.Get("UISTR Contact Call Button"),b,"newContactCall","",function(){e.OnControlEvent("newLSCall","Contact")},"ContactCall"))}if(e.Get("Enable New Account Call Button")==="Y"){var w=e.Get("UISTR Account Call")||"Account Call";c.push(this.BldCustomHdrBtn(e.Get("UISTR Account Call Button"),w,"newAccountCall","",function(){e.OnControlEvent("newLSCall","Account")},"AccountCall"))}if(e.Get("Enable New Meeting Button")==="Y"){var E=e.Get("UISTR Meeting")||"Meeting";c.push(this.BldCustomHdrBtn(e.Get("UISTR New Meeting Button"),E,"newMeetingCall","",function(){e.OnControlEvent("newLSCall","Meeting")},"Meeting"))}if(e.Get("Enable New Button")==="Y"){var S=e.Get("UISTR New Record")||"New Record",x=function(){var t,n,i=r.view,s=i.type;e.Get("UseCalendarPane")==="Y"&&e.AddProperty("CalActiveBtnId",$(this).attr("id")),t=r.getDate(),s==="timeGridWeek"&&e.Get("Preferred Weekly Mode")!=="7 Day Weekly"&&$.inArray(t.getDay()%7,e.Get("Hidden Days"))!==-1&&(t=i.activeStart);if(e.Get("timeGridPicked")!=="Y"){var o=new Date,u=o.getMinutes(),a=parseInt(e.Get("Preferred Timeslot Interval"),10);t.setHours(o.getHours()+Math.floor((u+a)/60)),t.setMinutes((Math.floor(u/a)+1)*a%60),t.setSeconds(0)}var f=parseInt(e.Get("Preferred Duration"),10);n=new Date(t),n.setMinutes(n.getMinutes()+f),e.OnControlEvent("newEvent","",t,n,null)};f="cal_leftHdr_newEvent_button",h.push(this.BldStdHdrBtn("",S,"newEvent","siebui-icon-add",f,x,"NewRecord")),f="cal_shortHdr_newEvent_button",d.push(this.BldStdHdrBtn("",S,"newEvent","siebui-icon-add",f,x,"NewRecord"))}}if(e.Get("Enable Refresh Button")==="Y"){var T=e.Get("UISTR Refresh")||"Refresh";y="Refresh",h.push(this.BldStdHdrBtn("",T,"refreshCalendar","siebui-icon-in-progress","",function(){s.OnRefreshCalendar()},y))}if(e.Get("Enable Print Button")==="Y"){var N=e.Get("UISTR Print")||"Print";y="Print",h.push(this.BldStdHdrBtn("",N,"printCalendar","siebui-icon-print","",function(){s.OnPrintCalendar()},y))}var C=e.Get("Enable List Toggle")==="Y"||!1,k="Agenda";e.SetProperty("CurrentViewMode",k);if(!u&&C){var L=e.Get("UISTR Toggle View Mode")||"Toggle view mode";y="Toggleviewmode";var A=function(e){s.OnToggleClick(e)};f="cal_rightHdr_listToggle_button";var O="siebui-icon-grid",M="siebui-icon-toggle",_=k==="List"?M:O;p.push(this.BldStdHdrBtn("",L,"listToggle",_,f,A,y))}if(e.Get("Enable Daily")==="Y"){var D=e.Get("UISTR Switch to daily view")||"Switch to daily view";y="Switchtodailyview";var P;u?P=function(){s.OnHomePageViewBtnClick("timeGridDay")}:P=function(){s.OnViewBtnClick("timeGridDay")},f="cal_rightHdr_agendaDay_button",p.push(this.BldStdHdrBtn("",D,a.SplitViewName("timeGridDay"),"siebui-icon-cal-daily",f,P,y)),f="cal_rightHdr_agendaDay_txt_button",p.push(this.BldStdHdrBtn(e.Get("UISTR Daily Tab"),D,a.SplitViewName("timeGridDay")+"-txt","",f,P,y)),f="cal_shortHdr_agendaDay_txt_button",d.push(this.BldStdHdrBtn(e.Get("UISTR Daily Tab"),D,a.SplitViewName("timeGridDay")+"-txt","",f,P,y))}if(e.Get("Enable Weekly")==="Y"){var H=e.Get("UISTR Switch to week view")||"Switch to week view";y="Switchtoweekview";var B;u?B=function(){s.OnHomePageViewBtnClick("timeGridWeek")}:B=function(){s.OnViewBtnClick("timeGridWeek")},f="cal_rightHdr_agendaWeek_button",p.push(this.BldStdHdrBtn("",H,a.SplitViewName("timeGridWeek"),"siebui-icon-cal-weekly",f,B,y)),f="cal_rightHdr_agendaWeek_txt_button",p.push(this.BldStdHdrBtn(e.Get("UISTR Weekly Tab"),H,a.SplitViewName("timeGridWeek")+"-txt","",f,B,y)),f="cal_shortHdr_agendaWeek_txt_button",d.push(this.BldStdHdrBtn(e.Get("UISTR Weekly Tab"),H,a.SplitViewName("timeGridWeek")+"-txt","",f,B,y))}if(e.Get("Enable Monthly")==="Y"){var j=e.Get("UISTR Switch to month view")||"Switch to month view";y="Switchtomonthview";var F;u?F=function(){s.OnHomePageViewBtnClick("dayGridMonth")}:F=function(){s.OnViewBtnClick("dayGridMonth")},f="cal_rightHdr_month_button",p.push(this.BldStdHdrBtn("",j,a.SplitViewName("dayGridMonth"),"siebui-icon-cal-monthly",f,F,y)),f="cal_rightHdr_month_txt_button",p.push(this.BldStdHdrBtn(e.Get("UISTR Monthly Tab"),j,a.SplitViewName("dayGridMonth")+"-txt","",f,F,y)),f="cal_shortHdr_month_txt_button",d.push(this.BldStdHdrBtn(e.Get("UISTR Monthly Tab"),j,a.SplitViewName("dayGridMonth")+"-txt","",f,F,y))}if((e.Get("Enable Timezone Picker")==="Y"||e.Get("Enable Owner Picker")==="Y")&&(!u||u!=="Y")){var I=e.Get("UISTR Advanced Calendar Settings")||"Advanced Calendar Settings";y="AdvancedCalendarSettings",p.push(this.BldStdHdrBtn("",I,"settings","siebui-icon-settings","",function(){i.BuildSettingsDialog()},y))}var q=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_PLAINTEXT"),className:"fc-header-space"}),R=$(SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({className:"siebui-cal-hdr-wrapper siebui-cal-"+a.SplitViewName(r.view.type)+"-hdr",id:"siebui-cal-hdr-wrapper-"+this.GetPM().Get("GetPlaceholder"),type:consts.get("SWE_CTRL_PLAINTEXT"),tagType:"div"})),U=$("<div class='siebui-short-hdr siebui-btn-group-justified' id='siebui-short-hdr-"+this.GetPM().Get("GetPlaceholder")+"'></div>");t.prepend(U),t.find(".fc-header-toolbar").find("h2").removeClass("fc-toolbar-title"
),t.find(".fc-header-toolbar").find("h2").addClass("fc-header-title");var z=$("<div class='siebui-hdr-right'></div>"),W=$("<div class='siebui-hdr-left'></div>");t.find(".fc-right").append(z),t.find(".fc-left").append(W);var X=$("<div id='siebui-cal-button-row-2'><div id='cal-custom-buttons'></div></div>");c.length===0?X.addClass("siebui-cal-custombutton-row-empty"):X.addClass("siebui-cal-custombutton-row"),R.append(X);var V=X.find("#cal-custom-buttons"),J=t.find(".siebui-hdr-left"),K=t.find(".siebui-hdr-right"),Q="caldate_picker",G=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_TEXT"),id:Q}),Y=t.find(".fc-today-button"),Z=e.Get("RTL Mode")!=="Y"?t.find(".fc-prev-button"):t.find(".fc-next-button"),et=e.Get("RTL Mode")!=="Y"?t.find(".fc-next-button"):t.find(".fc-prev-button"),tt={},nt={};if(Y.length>0){tt=Y.parent(),nt=Y.prev();if(e.Get("Enable Today Button")==="Y"){var rt=e.Get("UISTR Go to Today")||"Go to Today";y="today",f="cal_today_button",Y=this.BldStdHdrBtn(e.Get("UISTR Today Button"),rt,"today","",f,function(){s.OnNavBtnClick("today")},y),nt[0]?nt.after(Y):tt.prepend(Y);var it=r.view,st=new Date;st.getTime()>=it.activeStart.getTime()&&st.getTime()<=it.activeEnd.getTime()?Y.addClass("disabled"):Y.removeClass("disabled");var ot=Y.clone(!0,!0).attr("id","cal_shortHdr_today_button");d.push(ot)}}if(Z.length>0){var ut=e.Get("RTL Mode")!=="Y"?e.Get("UISTR Previous Day")||"Previous Day":e.Get("UISTR Next Day")||"Next Day";y=e.Get("RTL Mode")!=="Y"?"prev":"next",tt=Z.parent(),nt=Z.prev(),Z=this.BldStdHdrBtn("",ut,y,"siebui-icon-arrowsm-left","",function(){s.OnNavBtnClick(e.Get("RTL Mode")!=="Y"?"prev":"next")},y),nt[0]?nt.after(Z):tt.prepend(Z)}var at="",ft=e.Get("UISTR Choose a date")||"Choose a date",lt="tabindex='0' aria-label='"+ft+"'";e.Get("Enable Date Picker")==="Y"&&(at=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_PLAINTEXT"),className:"btn-icon siebui-cal-btn-datepicker",id:"cal-datepicker-button",value:G,attrs:lt}));for(v=0;v<h.length;v++)J.append(q),J.append(h[v]);for(m=0;m<p.length;m++)K.append(q),K.append(p[m]);for(g=0;g<c.length;g++)V.append(q),V.append(c[g]);e.Get("RTL Mode")!=="Y"?t.find(".fc-center").append(at):nt.after(at);for(m=0;m<d.length;m++){var ct=$(SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({className:"siebui-short-hdr-elm",type:consts.get("SWE_CTRL_PLAINTEXT")}));ct.append(d[m]),U.append(ct)}var ht=e.Get("UISTR Date Picker Icon")||"images/calPicker_icon.gif";if(e.Get("Enable Date Picker")==="Y"){n.call(this,Q,ht,function(){s.OnDatepickerSelect.call(s,Q)});var pt=t.find("#"+Q),dt=pt.datepicker("widget"),vt=t.find(".ui-datepicker-trigger.siebui-icon-calendar");t.find("#cal-datepicker-button").find("img").remove(),o&&(o.Manage(pt,["change"],function(n){var i=$(this).val();if(i===""&&$(this).val()!==""||$(this).val()==="")SiebelApp.Utils.Alert(SiebelApp.S_App.LocaleObject.GetLocalString("IDS_SWE_JQGRID_MSG_DATE")),vt.focus();else{var s=i.split("/"),o=new Date(s[2],s[0]-1,s[1]);e.AddProperty("SelectedDate",o),r.gotoDate(o),$(this).hide(),t.find(".fc-header-title").show(),vt.focus()}}),o.Manage(pt,"keydown",function(e){e.keyCode===$.ui.keyCode.ENTER&&(t.find("#caldate_picker").hide(),t.find(".fc-header-title").show())}),o.Manage(t.find(".fc-header-title"),["click","tap"],function(){var t=e.ExecuteMethod("ConvertDateToString",r.getDate(),!0);$(this).hide(),pt.val(t).width($(this).width()).show().focus(),pt.addClass("siebui-cal-input")}),o.Manage(pt,["blur"],function(){t.find("#caldate_picker").hide(),t.find(".fc-header-title").show()}),o.Manage(vt,["click","tap"],function(){pt.datepicker("show"),dt.find(".ui-datepicker-calendar").attr("tabindex","0").focus()}),o.Manage(vt,"keydown",function(e){e.keyCode===$.ui.keyCode.ENTER&&(pt.datepicker("show"),dt.find(".ui-datepicker-calendar").attr("tabindex","0").focus())}),o.Manage(dt,"keydown",function(e){e.keyCode===$.ui.keyCode.TAB&&(pt.datepicker("hide"),vt.focus())}))}if(et.length>0){var mt=e.Get("RTL Mode")!=="Y"?e.Get("UISTR Next Day")||"Next Day":e.Get("UISTR Previous Day")||"Previous Day";y=e.Get("RTL Mode")!=="Y"?"next":"prev",tt=et.parent(),nt=et.prev(),et=this.BldStdHdrBtn("",mt,y,"siebui-icon-arrowsm-right","",function(){s.OnNavBtnClick(e.Get("RTL Mode")!=="Y"?"next":"prev")},y),nt[0]&&e.Get("RTL Mode")!=="Y"?tt.append(et):nt[0]?nt.after(et):tt.prepend(et)}tt.parent().after(R),a.AddResponsiveHdrClass(t)},e.prototype.AddMouseControls=function(){var e=this.GetPM(),t=!1,n=!1,r=$("#"+e.Get("GetFullId")+" .fc-timegrid-slot"),i,s,o=SiebelApp.Utils.IsTrue(SiebelApp.S_App.IsAutoOn()),u=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper");u&&(u.Manage(r,"mousedown",function(e){t=!0,n=!1,i=e.pageX,s=e.pageY}),u.Manage(r,"mousemove",function(e){t===!0&&(Math.abs(e.pageX-i)>5||Math.abs(e.pageY-s)>5)&&(n=!0)}),u.Manage($(document),"mouseup.JQFullCalRenderer",function(){t===!0&&(t=!1,e.AddProperty("MouseDrag",n))}))},e.prototype.BuildQuickAddDialog=function(e,t){var n=this.GetPM(),s=this.GetCalCtrlEventHandlers(),o=this.GetCal(),u=this.GetUtilityMap(),a=CCFMiscUtil_CreatePropSet();if(typeof n.Get("Enable Quick Add")=="undefined"||n.Get("Enable Quick Add").toLowerCase()!=="n"&&n.Get("Enable Quick Add").toLowerCase()!=="false"){var f=n.Get("UISTR Tooltip Field Label:Description")||"Description",l=n.Get("UISTR Repeating Dialog OK Button")||"OK",c=n.Get("UISTR Repeating Dialog Cancel Button")||"Cancel",h=n.Get("UISTR New Event")||"New Event",p=i.call(this,"QuickAddDialog"),d={};d[l]=function(){s.OnQuickAddDialogOkClick("quickAddDialog",e,t)},d[c]=function(){s.OnCancelClick("quickAddDialog")};var v=r.call(this,"quickAddDialog",p,h,d);$("#quickAddDialog").addClass("siebui-cal-quick-add-dialog"),v.dialog("option","open",function(e){var t=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper");t&&t.Manage($("#quickAddDialog"),"keypress",function(e){e.keyCode===$.ui.keyCode.ENTER&&$(this).parent().find(".ui-dialog-buttonset button").eq(0).trigger("click")})});var m=$
("#quickAddDialog ~ .ui-dialog-buttonpane");u.AttachAutoAttributes(m.find("button").filter(function(){return $(this).text()===l}),"Button","QuickAddOK"),u.AttachAutoAttributes(m.find("button").filter(function(){return $(this).text()===c}),"Button","QuickAddCancel"),v.dialog("open")}},e.prototype.BuildRepeatDialog=function(e,t,n,s){var o=this.GetPM(),u=this.GetCalCtrlEventHandlers(),a=CCFMiscUtil_CreatePropSet(),f=this.GetUtilityMap(),l=i.call(this,"RepeatDialog"),c=o.Get("UISTR Repeating Dialog OK Button")||"OK",h=o.Get("UISTR Repeating Dialog Cancel Button")||"Cancel",p=o.Get("UISTR Repeating Event Dialog")||"IDS_SWE_REPEAT_EVENT_DIALOG",d={};d[c]=function(){u.OnRepeatDialogOkClick("repeatDialog",e,t,n,s)},d[h]=function(){n(),u.OnCancelClick("repeatDialog")};var v=r.call(this,"repeatDialog",l,p,d);$("#repeatDialog").addClass("siebui-cal-repeat-dialog"),v.dialog("option","close",function(e,t){e.originalEvent&&$(e.originalEvent.target).closest(".ui-dialog-titlebar-close").length!==0&&n(),$("#repeatDialog").remove()});var m=$("#repeatDialog ~ .ui-dialog-buttonpane");f.AttachAutoAttributes(m.find("button").filter(function(){return $(this).text()===c}),"Button","RepeatOK"),f.AttachAutoAttributes(m.find("button").filter(function(){return $(this).text()===h}),"Button","RepeatCancel"),v.dialog("open")},e.prototype.BuildSettingsDialog=function(){var e=this.GetPM(),t=this.GetCalCtrlEventHandlers(),n=this.GetUtilityMap(),s=e.Get("UISTR Repeating Dialog OK Button")||"OK",o=e.Get("UISTR Repeating Dialog Cancel Button")||"Cancel",u=e.Get("UISTR Settings")||"Settings",a=i.call(this,"SettingsDialog"),f={};f[s]=function(){t.OnSettingsDialogOkClick("calSettingsDialog")},f[o]=function(){t.OnCancelClick("calSettingsDialog")};var l=r.call(this,"calSettingsDialog",a,u,f);$("#calSettingsDialog").addClass("siebui-cal-settings-dialog");var c=$("#calSettingsDialog ~ .ui-dialog-buttonpane");n.AttachAutoAttributes(c.find("button").filter(function(){return $(this).text()===s}),"Button","SettingsOK"),n.AttachAutoAttributes(c.find("button").filter(function(){return $(this).text()===o}),"Button","SettingsCancel"),l.dialog("open");var h=e.Get("Timezone");if(e.Get("Enable Timezone Picker")==="Y"){if(typeof h=="undefined"){var p=e.Get("Default Timezone")||"(GMT-08:00) Pacific Time (US & Canada)";e.AddProperty("Timezone",p),h=p}$("#tzCombo").val(h)}var d=e.Get("Owner");e.Get("Enable Owner Picker")==="Y"&&$("#ownerCombo").val(d)},e.prototype.BldStdHdrBtn=function(e,n,r,i,s,o,u){var a=SiebelApp.Utils.IsEmpty(s)?"cal_"+r+"_button":s,f="btn-icon siebui-cal-btn-"+r+" "+i;return t(e,n,f,a,consts.get("SWE_PST_BUTTON_CTRL"),o,u,this.GetPM())},e.prototype.BldCustomHdrBtn=function(e,n,r,i,s,o){var u="siebui-ctrl-btn siebui-cal-btn-"+r+" "+i;return t(e,n,u,"cal-"+r+"-button",consts.get("SWE_CTRL_PLAINTEXT"),s,o,this.GetPM())},e.prototype.BldSlotIndicators=function(e){var t=e.type;if(t==="dayGridMonth"||t==="listDay"||t==="listWeek")return;var n=this.GetPM(),r=this.GetCal(),i=n.Get("Hidden Days"),s=t==="timeGridDay"?1:7,o=e==="timeGridDay"?1:n.Get("Preferred Weekly Mode")==="7 Day Weekly"?7:7-i.length,u,a=this.GetUtilityMap(),f=new Date,l,c,h,p,d=n.ExecuteMethod("GetSlotInfo"),v,m,g,y,b,w="calendar-WorkingHr-"+t,E="calendar-NonWorkingHr-"+t,S=0;r.find(".siebui-cal-start-row").removeClass("siebui-cal-start-row"),r.find(".siebui-cal-end-row").removeClass("siebui-cal-end-row"),r.find("."+w).removeClass(w),r.find("."+E).removeClass(E);for(var x=0;x<s;x++){var T=new Date(f.getFullYear(),f.getMonth(),f.getDate()),N=(new Date(e.activeStart)).setDate(e.activeStart.getDate()+x);l=N<T,c=N>T,h=!l&&!c,p=$.inArray((e.activeStart.getDay()+x)%7,i)===-1;if(t==="timeGridWeek"&&n.Get("Preferred Weekly Mode")!=="7 Day Weekly"&&!p)continue;v=h?Math.floor((f.getHours()+f.getMinutes()/60)*d.slotsPerHr):d.startWorkHrSlot;for(var C=0;C<d.totalSlots;C++){var k=C*parseInt(n.Get("Preferred Timeslot Interval"),10),L=Math.floor(k/60),A=k%60,O=L===0?"00":L<10?"0"+L:L,M=A===0?"00":A<10?"0"+A:A;dayTime=O+":"+M;if(t==="timeGridDay")y=r.find(".fc-timegrid-slots tr").eq(C),m=y.find(".fc-timegrid-slot-lane"),g=y.find(".fc-timegrid-slot-label"),b=g.parent(),a.AttachAutoAttributes(m,"drilldown","slotCol-0-"+dayTime);else if(t==="timeGridWeek"){y=r.find(".fc-timeGridWeek-view").find(".fc-timegrid-slot-label").eq(C).closest("tr");var _=y.find("td.fc-timegrid-slot-lane").eq(0),D=_.find("td");if(S===0&&y.find("td.fc-timegrid-slot-lane").length===1)for(var P=0;P<o;P++){var H=D.eq(P);H.addClass(_.attr("class")),H.attr("data-time",_.attr("data-time"));var B=P%o;a.AttachAutoAttributes(H,"drilldown","slotCol-"+B+"-"+dayTime)}b=D.eq(S),b.children().length===0&&b.append($("<div style='position:relative'>&nbsp;</div>")),m=b.find("div")}C===v&&!l&&p&&m.addClass("siebui-cal-start-row");if(C>=v&&C<d.endWorkHrSlot&&!l&&p)t!=="dayGridMonth"&&m.addClass(w);else if(C<v||C>=d.endWorkHrSlot||l||!p)!l&&p&&C===d.endWorkHrSlot&&m.addClass("siebui-cal-end-row"),t==="timeGridDay"&&g.addClass(E),t!=="dayGridMonth"&&t!=="listDay"&&t!=="listWeek"&&m.addClass(E)}S++}if(SiebelApp.Utils.IsTrue(SiebelApp.S_App.IsAutoOn())){var j=r.find("div.fc-day-grid td.fc-day"),F=j.length,I;for(I=0;I<F;I++)a.AttachAutoAttributes(j.eq(I),"drilldown","slotAD-"+I)}},e.prototype.PrepareSlotLaneContent=function(e){var t=this.GetPM(),n=this.GetCal(),r=this.GetFullCal();if(e==="timeGridDay")r.setOption("slotLaneContent",{html:""});else if(e==="timeGridWeek"){var i=t.Get("Hidden Days"),s=t.Get("Preferred Weekly Mode")==="7 Day Weekly"?7:7-i.length,o="<table style='height:100%' class='siebui-cal-slot-lane'><tr>";for(var u=0;u<s;u++)o+="<td style='height:100%'><div style='position:relative; height:100%'></div></td>";o+="</tr></table>",r.setOption("slotLaneContent",{html:o})}},e.prototype.BldWeekColHdr=function(e){var t=this.GetPM(),n=this.GetCal(),r=this.GetCalCtrlEventHandlers(),i=SiebelApp.S_App.PluginBuilder.GetHoByName("EventHelper"),s=t.Get("Hidden Days"),o=t.Get("Preferred Weekly Mode")==="7 Day Weekly"?7:7-s.length,u,a,f=0
,l;if(e.type!=="timeGridWeek")return;var c=function(e){r.OnWeekHdrAddClick(e)},h=function(e){r.OnWeekHdrClick(e)};for(var p=0;p<o;p++){u=n.find("th.fc-col-header-cell").not(".fc-timegrid-axis").eq(p);if(!u.hasClass("siebui-cal-col-hdr")||u.find(".siebui-cal-btn-newEvent").length===0){$(u).addClass("siebui-cal-col-hdr");while(t.Get("Preferred Weekly Mode")!=="7 Day Weekly"&&$.inArray((e.activeStart.getDay()+f)%7,s)!==-1)f++;var d=u.find(".siebui-col-hdr-date");i&&i.Manage(d,["click","tap"],h),a=new Date(e.activeStart.getTime()+f*24*60*60*1e3),l=a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2);var v=t.Get("UISTR New Record")||"New Record",m="cal_wkcolumn"+p+"newEvent_button",g="NewRecord"+p,y=this.BldStdHdrBtn("",v,"newEvent","siebui-icon-add",m,c,g);y.attr("data-date",l);var b=u.find(".siebui-hdr-add-container");b.append(y)}f++}},e.prototype.BldWeekHdrContent=function(e){var t=this.GetPM(),n=this.GetFullCal(),r=e.date,i=r.getFullYear()+"-"+("0"+(r.getMonth()+1)).slice(-2)+"-"+("0"+r.getDate()).slice(-2),s=n.getOption("views").timeGridWeek.dayHeaderFormat,o=n.formatDate(r,{weekday:s.weekday}),u=n.formatDate(r,{month:s.month,day:s.day}),a=$(SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({attrs:"data-date= '"+i+"'",className:"siebui-col-hdr-date",type:consts.get("SWE_CTRL_PLAINTEXT")})),f=$(SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({className:"siebui-col-hdr-row",type:consts.get("SWE_CTRL_PLAINTEXT"),value:o})),l=$(SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({className:"siebui-col-hdr-row",type:consts.get("SWE_CTRL_PLAINTEXT"),value:u}));a.append(f),a.append(l);var c=$(SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({className:e.isToday?"siebui-date-hdr fc-day-today fc-state-highlight":"siebui-date-hdr",type:consts.get("SWE_CTRL_PLAINTEXT")}));c.append(a);var h=$(SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({className:"siebui-hdr-add-container",type:consts.get("SWE_CTRL_PLAINTEXT")}));t.Get("CanInsert")&&t.Get("Enable New Button")==="Y"&&c.append(h);var p=$(SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_PLAINTEXT")}));return p.append(c),{html:p.html()}},e.prototype.RenderBusyFreeTime=function(){var e=this.GetPM(),t=this.GetCal(),n=this.GetFullCal(),r=n.view;if(r.type!=="dayGridMonth")return;var i=e.ExecuteMethod("HourDecimal",e.Get("Preferred Business Day Start Time")),s=e.ExecuteMethod("HourDecimal",e.Get("Preferred Business Day End Time")),o=e.Get("Hidden Days");for(var u=0;u<7;u++)if($.inArray(u,o)!==-1){var a;u===0?a="sun":u===1?a="mon":u===2?a="tue":u===3?a="wed":u===4?a="thu":u===5?a="fri":u===6&&(a="sat"),typeof a!="undefined"&&t.find(".fc-day.fc-day-"+a).addClass("siebui-off-day")}t.find(".siebui-free-time").remove();var f=new Date(r.activeStart),l;while(f<r.activeEnd){if(f<r.currentStart||f>=r.currentEnd||f<new Date((new Date).toDateString())){f<new Date((new Date).toDateString())&&(l=f.getFullYear()+"-"+("0"+(f.getMonth()+1)).slice(-2)+"-"+("0"+f.getDate()).slice(-2),t.find(".fc-day[data-date='"+l+"']").addClass("siebui-past-day")),f.setDate(f.getDate()+1);continue}if(n.getDate().getMonth()===f.getMonth()){var c=e.Get("BusyHours"),h=$.inArray(f.getDay(),o)!==-1||typeof e.Get("AllDays")[f.toDateString()]!="undefined"?0:s-i,p=typeof c[f.toDateString()]=="undefined"?s-i:Math.round(h-c[f.toDateString()]/36e5),d=p===1?"HOUR AVAILABLE":"HOURS AVAILABLE";l=f.getFullYear()+"-"+("0"+(f.getMonth()+1)).slice(-2)+"-"+("0"+f.getDate()).slice(-2);var v=t.find(".fc-day[data-date='"+l+"']").not(".siebui-off-month, .siebui-off-day");v.find("div").removeAttr("style"),v.removeClass("fc-state-highlight");var m;if(p>0&&v.length>0&&h>0){var g=$("<div id='free-time-"+l+"' class='siebui-free-time'></div>");g.append("<h4>"+p+"</h4>"),g.append("<p>"+d+"</p>"),m=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({className:"siebui-cal-monthly-cell",type:consts.get("SWE_CTRL_PLAINTEXT"),value:v.html()+$("<div>").append(g).html()}),v.html(m)}else{var y=e.Get("AllDays");v.find("p").remove();if(typeof y[f.toDateString()]!="undefined"){var b=$("<p id='all-day-"+l+"'>"+y[f.toDateString()].displayFieldOne+"</p>");v.addClass("siebui-cal-all-day"),m=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({className:"siebui-cal-monthly-cell",type:consts.get("SWE_CTRL_PLAINTEXT"),value:v.html()+$("<div>").append(b).html()}),v.html(m)}}f.setDate(f.getDate()+1)}}},e}(),SiebelAppFacade.CalEventHandlers=function(){function e(e,t,n,r){var i=t,s=e,o=n,u=r,a;this.GetCal=function(){return i},this.GetPM=function(){return s},this.GetCalCtrlBuilder=function(){return o},this.GetUtilityMap=function(){return u},this.GetFullCal=function(){return a},this.SetFullCal=function(e){a=e}}return e.prototype={OnCalSelect:function(e){var t=this.GetPM(),n=e.view.calendar,r;n.gotoDate(e.start),t.AddProperty("SelectedDate",e.start),(e.view.type==="timeGridDay"||e.view.type==="timeGridWeek")&&t.AddProperty("timeGridPicked","Y"),$("#s_"+t.Get("GetFullId")+"_div").focus();if(t.Get("CanInsert")&&n.view.type!=="dayGridMonth"){if(SiebelApp.Utils.IsTrue(SiebelApp.S_App.IsAutoOn()))if(e.jsEvent.type==="touchend")SiebelApp.EventManager.fireEvent("CustomControlEvent:Change",e.jsEvent);else{var i=e.start,s=("0"+i.getHours()).slice(-2)+":"+("0"+i.getMinutes()).slice(-2);if(n.view.type==="timeGridWeek"){var o=i.getDay();if(t.Get("Preferred Weekly Mode")==="5 Day Weekly"){var u=t.Get("Hidden Days"),a=0;for(var f=0;f<u.length;f++){if(!(u[f]<o))break;a++}o-=a}r=$("[rn='slotCol-"+o+"-"+s+"']")}else r=$("[rn='slotCol-0-"+s+"']");SiebelApp.EventManager.fireEvent("CustomControlEvent:Change",{target:r})}var l={Planned:e.start,PlannedCompletion:e.end,AllDayFlag:"N"},c=this.GetUtilityMap().IsAllDayEvent(l),h=t.Get("MouseDrag"),p;if(h===!1&&!c){var d=parseInt(t.Get("Preferred Duration"),10)*60*1e3;p=new Date(e.start.getTime()+d)}else p=e.end;this.GetCalCtrlBuilder().BuildQuickAddDialog(e.start,p)}},OnEventRender:function(e){var t=e.event,n=$(e.el),r=e.view,i=t.extendedProps,s=this.
GetPM();if(r.type==="dayGridMonth"&&s.Get("Enable BusyFreeTime")==="Y"){t.setProp("display","none");return}if(SiebelApp.Utils.IsEmpty(i.calendarId)){typeof n.addClass!="undefined"&&n.addClass("siebui-cal-quick-add-helper");return}var o=this.GetCal(),u=this.GetFullCal(),a=s.Get("CSSFontColors")||[],f="",l="",c,h=r.type==="listDay"||r.type==="listWeek",p=h?$(n.find(".fc-list-event-title")[0]):$(n.find(".fc-event-title")[0]),d=s.Get("Available Days")||[],v=new Date(t.start),m=v.getDay(),g=d.indexOf(m);r.type==="timeGridDay"&&(g=0);var y=i.displayFieldOne.replace(/\s/g,""),b=(t.start.getHours()<10?"0":"")+t.start.getHours()+(t.start.getMinutes()<10?"0":"")+t.start.getMinutes()+(t.start.getSeconds()<10?"0":"")+t.start.getSeconds(),w="slot-"+g+"-"+b+y,E=t.id,S="drilldown";n.attr("rn",w),n.attr("un",E),n.attr("ot",S),n.attr("data-drilldown",i.dataDrilldown);if(i.icons)for(c=0;c<i.icons.length;c++){var x=i.icons[c],T=i.iconText[c];x!==""&&(f+=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_IMAGECONTROL"),src:"images/"+x,attrs:"title = '"+T+"' alt= '"+T+"'"}))}var N=i.multiDisplay;for(var C=0;C<N.length;C++){var k=N[C],L=a[k.CSSName];L||(p.addClass(k.CSSName),L=$("."+k.CSSName).css("color"),L?L=this.GetUtilityMap().Rgb2hex(L):L="NOCSSFONTCOLOR",p.removeClass(k.CSSName),a[k.CSSName]=L),L!=="NOCSSFONTCOLOR"&&L!=="#29303f"&&(k.FieldColor=L),k.FieldColor=k.FieldColor||"#29303f",w="slot-"+g+"-"+y;var A="link-"+C+"-"+w,O="link-"+C+"-"+E,M="drilldown";k.AutoAttr=' rn="'+A+'" un="'+O+'" ot="'+M+'" ';var _=this.GetUtilityMap().MakeDisplayField(k);_!==""&&(l+=_)}s.AddProperty("CSSFontColors",a),h?(n.find(".fc-list-event-title").addClass("siebui-col-hdr-date"),n.find("span.fc-list-event-dot").replaceWith(f),l=l.replace("fc-event-title","fc-list-event-title"),n.find("a").replaceWith(l)):p.prepend(f+"&nbsp;"+l),n.find(".fc-event-time").text("");if(!t.allDay&&!h&&s.ExecuteMethod("IsTimeStampRequired",t.start,t.end)){var D=t.start,P=t.end;i.isZeroDuration&&(P=t.start);var H=s.ExecuteMethod("GetTimeStampFormat",D,P),B=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({className:"siebui-cal-timestamp",type:consts.get("SWE_CTRL_PLAINTEXT"),value:u.formatRange(D,P,H)+" "});p.parent().parent().prepend(B)}p.find("a").tooltip({content:p.find("a").attr("title"),position:s.Get("RTL Mode")!=="Y"?{}:{my:"right top",at:"right bottom",of:s.Get("ViewMode")==="2"?$(n.find(".fc-event-main")[0]):p,collision:"fit flip"},tooltipClass:"siebui-tooltip-calendar"})},OnEventAfterRender:function(e){var t=e.event,n=$(e.el),r=e.view,i=t.extendedProps,s=this.GetPM(),o=this.GetCal(),u=this.GetFullCal(),a,f=0,l=!0;if(e.view.type!=="dayGridMonth"){var c=t.source||{},h=function(e){return u.getOption(e)},p=[t.durationEditable,c.durationEditable,h("eventDurationEditable"),t.editable,c.editable,h("editable")],d,v=this;for(a=0;a<p.length;a++)if(p[a]!==undefined){d=p[a];break}var m=SiebelJS.Dependency("SiebelApp.Utils");if(d&&!t.allDay&&!m.IsEmpty(t.start)&&!m.IsEmpty(t.end)){n.find(".fc-event-resizer").remove();var g=Math.max(o.find(".fc-timegrid-slots tr").height(),21),y=parseInt(s.Get("Preferred Timeslot Interval"),10),b=(t.end.getTime()-t.start.getTime())/6e4,w=g;b%y!=0&&(w=b%y*g/y);var E=bMutateEnd=!1,S="";n.hasClass("fc-event-start")&&n.hasClass("fc-event-end")?S="n,s":n.hasClass("fc-event-start")?S="n":n.hasClass("fc-event-end")&&(S="s"),S.length!==0&&(SiebelAppFacade.DecisionManager.IsTouch()||n.resizable({handles:S,grid:g,minHeight:w,start:function(e,t){f!==0&&(clearTimeout(f),f=0),n.css("min-height",w+"px"),$(e.originalEvent.target).hasClass("ui-resizable-n")?E=!0:$(e.originalEvent.target).hasClass("ui-resizable-s")&&(bMutateEnd=!0)},stop:function(e,r){var i,s;n.height()<=r.originalSize.height&&b<=y?i=0:i=Math.round((Math.max(w,n.height())-r.originalSize.height)/g);if(E){s=new Date(t.start);var o=new Date(t.start);o.setMinutes(o.getMinutes()-i*y),t.setStart(o);var a={event:t,startDelta:i,revert:function(){t.setStart(s),u.refetchEvents()},jsEvent:e,el:r};v.OnEventResize(a)}else if(bMutateEnd){s=new Date(t.end);var f=new Date(t.end);f.setMinutes(f.getMinutes()+i*y),t.setEnd(f);var a={event:t,endDelta:i,revert:function(){t.setEnd(s),u.refetchEvents()},jsEvent:e,el:r};v.OnEventResize(a)}n.css("min-height","22px")}}),SiebelAppFacade.DecisionManager.IsTouch()&&(n.on("touchstart",function(e){if(l){l=!1;var t=800;return f=setTimeout(function(){f=0;var t=$.Event("touchstart");t.touches=e.touches,t.targetTouches=e.targetTouches,t.changedTouches=e.changedTouches,t.delegateTarget=e.delegateTarget,t.currentTarget=e.currentTarget,t.target=e.target,t.originalEvent=e.originalEvent,n.trigger(t)},t),!1}}),n.on("touchend",function(e){f!==0&&(clearTimeout(f),n.trigger("click"))}))),n.on("mousedown",function(e){if($(e.target).hasClass("ui-resizable-n")||$(e.target).hasClass("ui-resizable-s"))e.preventDefault(),e.stopPropagation()})}}n.removeClass("fc-event-resizable")},OnEventAfterAllRender:function(e){$(".fc-event.fc-selected").removeClass("fc-selected");var t=this.GetUtilityMap(),n=this.GetCal(),r=this.GetFullCal(),i=r.view,s=i.type==="listWeek",o=i.type==="listDay";if(!s&&!o)return;o&&($("tr.fc-list-day").find(".siebui-cal-btn-newEvent").remove(),$("tr.fc-list-day").find(".siebui-cal-btn-collapsebtn").remove());var u=s?"tr.fc-list-day, tr.fc-list-event":"tr.fc-list-event",a=$(u),f=a.length;if(f<1)return;var l=this.GetPM(),c=this.GetCalCtrlBuilder(),h=c.GetCalCtrlEventHandlers(),p=function(e){h.OnWeekHdrAddClick(e)},d=function(e){h.OnWeekHdrCollapseClick(e)},v=function(e){h.OnWeekHdrClick(e)},m="",g=0,y=0,b;for(var w=0;w<f;w++){var E=a.eq(w),S=E.attr("data-date");if(!SiebelApp.Utils.IsEmpty(S)){m=S,g>0&&(b&&b.hasClass("disabled")&&b.removeClass("disabled"),g=0);var b=E.find(".siebui-cal-btn-collapsebtn");if(b.length===0){var x=l.Get("UISTR New Record")||"New Record",T="NewRecord",N="cal_wklist"+y+"newEvent_button",C=c.BldStdHdrBtn("",x,"newEvent","siebui-icon-add",N,p,T),k=l.Get("UISTR Collapse")||"Collapse";N="collapse_"+y+"_button"
,b=c.BldStdHdrBtn("",k,"collapsebtn","siebui-icon-arrowsm-up",N,d,"Collapse"),C.attr("data-date",S),b.attr("data-date",S),b.addClass("disabled"),SiebelApp.Utils.IsTrue(SiebelApp.S_App.IsAutoOn())&&(this.GetUtilityMap().AttachAutoAttributes(C,"Button","newbtn-"+y),this.GetUtilityMap().AttachAutoAttributes(b,"Button","collapsebtn-"+y));var L=E.find(".fc-list-day-text");L.prepend(C),L=E.find(".fc-list-day-side-text"),L.append(b)}y++}else E.hasClass("siebui-calendar-dummy")||(s&&E.attr("data-date",m),g++)}g>0&&b&&b.removeClass("disabled")},OnEventContent:function(e){var t=e.view.type,n=t==="listWeek",r=t==="listDay";if(r||n&&e.event.extendedProps.displayFieldOne!=="dummy")return{html:'<a class="fc-list-placeholder" />'}},OnEventClick:function(e){var t=this.GetPM(),n=this.GetCal(),r=e.view.calendar,i={id:e.event.id},s=e.jsEvent.target||e.jsEvent.srcElement,o=$(s);if(SiebelAppFacade.DecisionManager.IsTouch()&&(o.hasClass("ui-resizable-s")||o.hasClass("ui-resizable-n")))return;var u=e.event.extendedProps.dataDrilldown,a;SiebelApp.Utils.IsEmpty(o.parent()[0].dataset.drilldown)||(a=o.parent()[0].dataset.drilldown,a!==u&&t.Get("UseCalendarPane")!=="Y"&&(u=a));if(u===undefined||u===null)return;t.Get("UseCalendarPane")==="Y"&&(i.left=$(e.el).offset().left,i.width=$(e.el).width()),t.SetProperty("SelectedEvent",i);var f=e.event.start,l=e.view.activeStart;f<l?(t.SetProperty("EventClickInProgress",!0),t.SetProperty("EventClickInProgressDrilldown",u),t.SetProperty("UseClientCalendarData",!1)):(t.SetProperty("UseClientCalendarData",!0),t.SetProperty("CallBackEvents",t.Get("CachedEvents"))),r.gotoDate(e.event.start),t.SetProperty("SelectedDate",r.getDate());if(f>=l){t.Get("UseCalendarPane")==="Y"?t.OnControlEvent("eventSelection",u):t.OnControlEvent(SiebelApp.Constants.get("PHYEVENT_DRILLDOWN_LIST"),u);return}},OnEventLimitClick:function(e){var t=this.GetPM(),n=this.GetCal(),r=this.GetFullCal(),i=t.Get("Monthly More Click");if(!i)i="timeGridDay";else{i=i.toLowerCase();if(i==="daily")i="timeGridDay";else if(i==="weekly")i="timeGridWeek";else if(i==="drilldown"){var s=e.hiddenSegs[0].footprint.eventDef,o={id:s.id,start:s.dateProfile.start,drilldownData:s.miscProps.dataDrilldown};this.OnEventClick(o);return}}if(i==="timeGridDay"||i==="timeGridWeek"){var u=this.GetUtilityMap().SplitViewName(r.view.type);n.find(".siebui-cal-btn-"+u).removeClass("disabled"),n.find(".siebui-cal-btn-"+u+"-txt").removeClass("disabled")}return i},OnEventDestroy:function(e){var t=$(e.el),n=e.view.type==="listDay"||e.view.type==="listWeek",r=n?$(t.find(".fc-list-event-title")[0]).find("a"):$(t.find(".fc-event-title")[0]).find("a");r.data("ui-tooltip")&&r.tooltip("destroy"),t.data("ui-draggable")&&t.draggable("destroy"),t.data("ui-resizable")&&t.resizable("destroy"),r.off()},OnEventDrop:function(e){var t=this.GetPM(),n=this.GetCal(),r=e.view.calendar;if(utils.IsTrue(SiebelApp.S_App.IsAutoOn())){var i=t.ExecuteMethod("ConvertDateToString",e.event.start,!1),s=("0"+e.event.start.getHours()).slice(-2)+":"+("0"+e.event.start.getMinutes()).slice(-2)+":"+("0"+e.event.start.getMinutes()).slice(-2);arguments.formattedDateTime=i,arguments.event=e.event,arguments.type="EventDnD",SiebelApp.EventManager.fireEvent("calendarDrop",arguments)}if(e.event.extendedProps.readOnly!=="N"||e.event.allDay!==e.event.extendedProps.origAllDay||e.event.end===null)e.revert();else{if(e.event.extendedProps.repeating==="N"){t.OnControlEvent("eventDrop",e.event.start,e.event.end,e.event.id,null),r.refetchEvents();return}var o=e.event;this.GetCalCtrlBuilder().BuildRepeatDialog(o,"eventDrop",e.revert,function(){r.refetchEvents()})}},OnEventDragStop:function(e){var t=this.GetCal(),n=e.view.calendar,r=t.find(".fc-view-harness").width(),i=t.find(".fc-view-harness").height(),s=t.find(".fc-view-harness").offset(),o=s.left+r,u=s.top+i,a=e.jsEvent.pageX||e.jsEvent.changedTouches[0].pageX,f=e.jsEvent.pageY||e.jsEvent.changedTouches[0].pageY;!SiebelApp.Utils.IsEmpty(a)&&!SiebelApp.Utils.IsEmpty(f)&&(a<s.left||a>o||f<s.top||f>u)&&n.refetchEvents()},OnEventResizeStart:function(e){var t=this.GetPM(),n=this.GetCal(),r=$(e.el),i=Math.max(n.find(".fc-timegrid-slots tr").height(),21),s=parseInt(t.Get("Preferred Timeslot Interval"),10),o=(e.event.end.getTime()-e.event.start.getTime())/6e4,u=i;o%s!=0&&(u=o%s*i/s),r.css("min-height",u+"px"),r.on("mousedown",function(e){e.preventDefault(),e.stopPropagation()})},OnEventResizeStop:function(e){var t=$(e.el);t.css("min-height","22px")},OnEventResize:function(e){var t=e.event,n=$(e.el),r=e.view,i=t.extendedProps,s=this.GetPM(),o=this.GetCal(),u=this.GetFullCal(),a;if(e.view.type!=="dayGridMonth"){var f=t.source||{},l=function(e){return u.getOption(e)},c=[t.durationEditable,f.durationEditable,l("eventDurationEditable"),t.editable,f.editable,l("editable")],h;for(a=0;a<c.length;a++)if(c[a]!==undefined){h=c[a];break}}if(h&&!t.allDay&&!utils.IsEmpty(t.start)&&!utils.IsEmpty(t.end))if(e.event.extendedProps.readOnly!=="N")e.revert(),s.SetProperty("UseClientCalendarData",!0),s.SetProperty("CallBackEvents",s.Get("CachedEvents")),u.refetchEvents();else{if(e.event.extendedProps.repeating==="N"){this.GetPM().OnControlEvent("eventResize",e.event.start,e.event.end,e.event.id,null),u.refetchEvents();return}var t=e.event;this.GetCalCtrlBuilder().BuildRepeatDialog(t,"eventResize",function(){e.revert(),s.SetProperty("UseClientCalendarData",!0),s.SetProperty("CallBackEvents",s.Get("CachedEvents")),u.refetchEvents()},function(){u.refetchEvents()})}},OnEventRefresh:function(e,t,n){var r=this.GetPM(),i=e.start,s=e.end,o=r.Get("CallBackEvents");if(!r.Get("UseClientCalendarData")){r.AddProperty("CurViewShowDate",i),r.AddProperty("CurViewStartDate",i),r.AddProperty("CurViewEndDate",s),r.AddProperty("SelectedDate",this.GetFullCal().getDate());if(typeof o!="undefined"&&o!==null)t(o),r.SetProperty("CallBackEvents",null);else{var u=[];u.cb=t,r.AddProperty("CalSuccessCallBack",u),r.ExecuteMethod("GetCalendarData")}}else typeof o!="undefined"&&o!==null&&(t(o),r.SetProperty("CallBackEvents"
,null),r.SetProperty("UseClientCalendarData",!1))},OnExtJQueryDropHandler:function(e){var t=this.GetPM(),n=e.date;if(t.Get("CanInsert")&&$.data(e.draggedEl).appletRowId){var r=t.ExecuteMethod("ConvertDateToString",n,!1);t.OnControlEvent("externalDrop",r,$.data(e.draggedEl).appletRowId.appletName,$.data(e.draggedEl).appletRowId.rowId,null),t.SetProperty("QuickAdd",!0)}},OnExtHTMLDropHandler:function(e){e.preventDefault();var t,n=e.data.ctx.GetFullCal();e.originalEvent.dataTransfer&&(t=e.originalEvent.dataTransfer.getData("Text"));if(t){var r;t.indexOf("\r")!==-1?r=t.replace(/\n/g,"").split("\r"):r=t.split("\n");var i=[],s=[],o,u;if(r.length-1<=1){SiebelJS.Log("ERROR: Expected data but only received header row");return}for(o=0;o<r.length-1;o++){var a=r[o].split("	"),f=[];for(u=0;u<a.length;u++)if(o===0){var l=a[u].replace("\n","");if(l===""){SiebelJS.Log("ERROR: Empty field name received in header row.");return}i.push(l)}else f.push(a[u].replace("\n",""));o!==0&&s.push(f)}var c=s.length;for(o=0;o<c;o++){var h=CCFMiscUtil_CreatePropSet(),p=i.length;for(u=0;u<p;u++)h.SetProperty(i[u],s[o][u]);e.data.ctx.GetPM().OnControlEvent("externalDrop",null,null,null,h)}n.refetchEvents()}},OnViewDisplayChange:function(e){var t=this.GetPM(),n=this.GetCal(),r=this.GetCalCtrlBuilder(),i=this.GetUtilityMap(),s=e.view,o=s.type;t.AddProperty("timeGridPicked","N"),o==="listDay"?o="timeGridDay":o==="listWeek"&&(o="timeGridWeek"),o=this.GetUtilityMap().SplitViewName(o),n.find(".siebui-cal-btn-"+o).addClass("disabled"),n.find(".siebui-cal-btn-"+o+"-txt").addClass("disabled");var u=new Date;u.getTime()>=s.activeStart.getTime()&&u.getTime()<=s.activeEnd.getTime()?n.find(".siebui-cal-btn-today").addClass("disabled"):n.find(".siebui-cal-btn-today").removeClass("disabled"),n.find(".siebui-cal-hdr-wrapper").removeClass().addClass("siebui-cal-hdr-wrapper"),n.find(".siebui-cal-hdr-wrapper").addClass("siebui-cal-"+o+"-hdr"),s.type==="timeGridWeek"&&r.BldWeekColHdr(s),(s.type==="timeGridDay"||s.type==="timeGridWeek")&&r.BldSlotIndicators(s),s.type==="dayGridMonth"&&t.Get("Enable BusyFreeTime")==="Y"&&n.find(".fc-grid .fc-day-content").addClass("siebui-no-height"),i.AddResponsiveTitle(n,this.GetFullCal(),t),i.AddResponsiveHdrClass(n)}},e}(),SiebelAppFacade.CalUtility=function(){function e(){}return e.prototype={EventSortOrder:function(e,t){return e.start-t.start},GetObjectSize:function(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&(t+=1);return t},Hex:function(e){return("0"+parseInt(e,10).toString(16)).slice(-2)},IsAllDayEvent:function(e){if(e.AllDayFlag==="Y")return!0;if(e.Planned<=e.PlannedCompletion){var t=e.Planned,n=e.PlannedCompletion;if(t.getHours()===0&&t.getMinutes()===0&&t.getSeconds()===0&&n.getHours()===0&&n.getMinutes()===0&&n.getSeconds()===0)return!0}return!1},MakeDisplayField:function(e){var t=e.FieldValue,n=$("<div></div>").text(e.ToolTip).html(),r=e.DrillDown,i=e.FieldColor,s="";if(t==="")return s;var o=n.split("&lt;br /&gt;"),u=45;for(var a=0;a<o.length;a++)o[a].length>u&&(o[a]=o[a].substring(0,u).split(" ").slice(0,-1).join(" ")+"...");n=o.join("&lt;br /&gt;");var f="";return SiebelApp.Utils.IsTrue(SiebelApp.S_App.IsAutoOn())&&!SiebelApp.Utils.IsEmpty(e.AutoAttr)&&(f=e.AutoAttr),s+=SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_LINK"),attrs:f+'title="'+n+'" data-drilldown="'+r+'"',value:SiebelAppFacade.HTMLTemplateManager.GenerateMarkup({type:consts.get("SWE_CTRL_PLAINTEXT"),className:e.CSSName+" fc-event-title siebui-cal-drilldown",value:t,attrs:i!==""?"style='color:"+i+"'":""})}),s},Rgb2hex:function(e){return e.search("rgb")===-1?e:(e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/),"#"+this.Hex(e[1])+this.Hex(e[2])+this.Hex(e[3]))},SortOrder:function(e,t){return e[1]>t[1]?1:-1},SplitViewName:function(e){var t="",n=e.match(/[A-Z]*[^A-Z]+/g);for(var r=0;r<n.length;r++)t+=n[r].toLowerCase(),r!==n.length-1&&(t+="-");return t},ViewModeToName:function(e){var t="timeGridDay";return e==="0"?t="timeGridDay":e==="1"?t="timeGridWeek":e==="2"&&(t="dayGridMonth"),t},ViewNameToMode:function(e){var t="0";return e==="timeGridDay"||e==="listDay"?t="0":e==="timeGridWeek"||e==="listWeek"?t="1":e==="dayGridMonth"&&(t="2"),t},AddResponsiveHdrClass:function(e){var t="siebui-calendar-res-hdr";e.find(".fc-right").removeClass(t);var n=4,r=e.find(".fc-toolbar").height(),i=e.find(".fc-center").height()+n;if(SiebelApp.Utils.IsEmpty(r)||SiebelApp.Utils.IsEmpty(i))return;r>i&&e.find(".fc-right").addClass(t)},AddResponsiveTitle:function(e,t,n){if(SiebelApp.Utils.IsEmpty(e)||SiebelApp.Utils.IsEmpty(n))return;var r=n.Get("SiebelShorDateFmt");if(SiebelApp.Utils.IsEmpty(r))return;var i=$("h2.fc-header-title"),s=i.text();if(SiebelApp.Utils.IsEmpty(s))return;i.get(0).childNodes.length>1&&($(i.get(0).childNodes[1]).remove(),s=i.text());var o=t.view.type;if(o!=="timeGridDay")return;var u=t.formatDate(t.getDate(),r),a=t.view.title,f=e.width()||0,l=e.find(".fc-center").width()*1.05||0;if(f===0||l===0)return;f<l&&(SiebelApp.Utils.IsEmpty(u)||s!==u&&i.text(u))},AttachAutoAttributes:function(e,t,n){typeof e!="undefined"&&e.attr({rn:n,ot:t,un:n})}},e}(),SiebelAppFacade.CalLocaleConverter=function(){function e(){var e={"hh:mm:ss":function(e){return o(e)},"mm:hh:ss":function(e){return o(e)},"ss:mm:hh":function(e){return o(e)},"mm:ss:hh":function(e){return o(e)},"hh:ss:mm":function(e){return o(e)},"ss:hh:mm":function(e){return o(e)},"h:mm:ss":function(e){return o(e)},"mm:h:ss":function(e){return o(e)},"ss:mm:h":function(e){return o(e)},"mm:ss:h":function(e){return o(e)},"ss:h:mm":function(e){return o(e)},"h:ss:mm":function(e){return o(e)},"m:hh:ss":function(e){return o(e)},"ss:m:hh":function(e){return o(e)},"hh:m:ss":function(e){return o(e)},"m:ss:hh":function(e){return o(e)},"hh:ss:m":function(e){return o(e)},"ss:hh:m":function(e){return o(e)},"hh:mm:s":function(e){return o(e)},"mm:hh:s":function(e){return o(e)},"s:mm:hh":function(e){return o(e)},"s:hh:mm":function(e){return o(e)},"mm:s:hh":function(e){return o
(e)},"hh:s:mm":function(e){return o(e)},"h:m:ss":function(e){return o(e)},"m:h:ss":function(e){return o(e)},"ss:m:h":function(e){return o(e)},"ss:h:m":function(e){return o(e)},"m:ss:h":function(e){return o(e)},"h:ss:m":function(e){return o(e)},"hh:m:s":function(e){return o(e)},"hh:s:m":function(e){return o(e)},"m:hh:s":function(e){return o(e)},"s:hh:m":function(e){return o(e)},"s:m:hh":function(e){return o(e)},"m:s:hh":function(e){return o(e)},"h:mm:s":function(e){return o(e)},"mm:h:s":function(e){return o(e)},"mm:s:h":function(e){return o(e)},"s:mm:h":function(e){return o(e)},"h:s:mm":function(e){return o(e)},"s:h:mm":function(e){return o(e)},"h:m:s":function(e){return o(e)},"m:h:s":function(e){return o(e)},"s:m:h":function(e){return o(e)},"hh:mm":function(e){return o(e,"hm")},"mm:hh":function(e){return o(e,"hm")},"h:mm":function(e){return o(e,"hm")},"mm:h":function(e){return o(e,"hm")},"hh:m":function(e){return o(e,"hm")},"m:hh":function(e){return o(e,"hm")},"h:m":function(e){return o(e,"hm")},"m:h":function(e){return o(e,"hm")},"ss:mm":function(e){return o(e,"ms")},"ss:m":function(e){return o(e,"ms")},"m:ss":function(e){return o(e,"ms")},"mm:s":function(e){return o(e,"ms")},"s:mm":function(e){return o(e,"ms")},"s:m":function(e){return o(e,"ms")},"m:s":function(e){return o(e,"ms")},"dd/mm/yyyy":function(e){return u(e)},"mm/dd/yyyy":function(e){return u(e)},"dd/yyyy/mm":function(e){return u(e)},"yyyy/dd/mm":function(e){return u(e)},"mm/yyyy/dd":function(e){return u(e)},"yyyy/mm/dd":function(e){return u(e)},"d/mm/yyyy":function(e){return u(e)},"mm/d/yyyy":function(e){return u(e)},"d/yyyy/mm":function(e){return u(e)},"yyyy/d/mm":function(e){return u(e)},"mm/yyyy/d":function(e){return u(e)},"yyyy/mm/d":function(e){return u(e)},"dd/m/yyyy":function(e){return u(e)},"m/dd/yyyy":function(e){return u(e)},"dd/yyyy/m":function(e){return u(e)},"yyyy/dd/m":function(e){return u(e)},"m/yyyy/dd":function(e){return u(e)},"yyyy/m/dd":function(e){return u(e)},"dd/mm/yy":function(e){return u(e)},"mm/dd/yy":function(e){return u(e)},"dd/yy/mm":function(e){return u(e)},"yy/dd/mm":function(e){return u(e)},"mm/yy/dd":function(e){return u(e)},"yy/mm/dd":function(e){return u(e)},"d/m/yyyy":function(e){return u(e)},"m/d/yyyy":function(e){return u(e)},"d/yyyy/m":function(e){return u(e)},"yyyy/d/m":function(e){return u(e)},"m/yyyy/d":function(e){return u(e)},"yyyy/m/d":function(e){return u(e)},"d/mm/yy":function(e){return u(e)},"mm/d/yy":function(e){return u(e)},"d/yy/mm":function(e){return u(e)},"yy/d/mm":function(e){return u(e)},"mm/yy/d":function(e){return u(e)},"yy/mm/d":function(e){return u(e)},"dd/m/yy":function(e){return u(e)},"m/dd/yy":function(e){return u(e)},"dd/yy/m":function(e){return u(e)},"yy/dd/m":function(e){return u(e)},"m/yy/dd":function(e){return u(e)},"yy/m/dd":function(e){return u(e)},"d/m/yy":function(e){return u(e)},"m/d/yy":function(e){return u(e)},"d/yy/m":function(e){return u(e)},"yy/d/m":function(e){return u(e)},"m/yy/d":function(e){return u(e)},"yy/m/d":function(e){return u(e)},"mm/yyyy":function(e){return u(e,"my")},"yyyy/mm":function(e){return u(e,"my")},"yyyy/m":function(e){return u(e,"my")},"m/yyyy":function(e){return u(e,"my")},"mm/yy":function(e){return u(e,"my")},"yy/mm":function(e){return u(e,"my")},"yy/m":function(e){return u(e,"my")},"m/yy":function(e){return u(e,"my")},"dd/mm":function(e){return u(e,"md")},"mm/dd":function(e){return u(e,"md")},"dd/m":function(e){return u(e,"md")},"m/dd":function(e){return u(e,"md")},"d/mm":function(e){return u(e,"md")},"mm/d":function(e){return u(e,"md")},"d/m":function(e){return u(e,"md")},"m/d":function(e){return u(e,"md")},s:function(e){return{second:e.s==="s"?"numeric":"2-digit"}},ss:function(e){return{second:e.s==="s"?"numeric":"2-digit"}},m:function(e){return{minute:e.n==="m"?"numeric":"2-digit"}},mm:function(e){return{minute:e.n==="m"?"numeric":"2-digit"}},h:function(e){return{hour:e.h=="h"?"numeric":"2-digit"}},hh:function(e){return{hour:e.h=="h"?"numeric":"2-digit"}},H:function(e){return{hour:e.h=="h"?"numeric":"2-digit"}},HH:function(e){return{hour:e.h=="h"?"numeric":"2-digit"}},d:function(e){return{day:e.ld==="DD"?"2-digit":"numeric"}},dd:function(e){return{day:e.ld==="DD"?"2-digit":"numeric"}},M:function(e){return{month:e.lm==="MMMM"?"long":e.lm==="MMM"?"short":e.lm==="MM"?"2-digit":"numeric"}},MM:function(e){return{month:e.lm==="MMMM"?"long":e.lm==="MMM"?"short":e.lm==="MM"?"2-digit":"numeric"}},yy:function(e){return{year:e.ly==="YYYY"?"numeric":"2-digit"}},yyyy:function(e){return{year:e.ly==="YYYY"?"numeric":"2-digit"}},ddd:function(e){return{weekday:"short"}},dddd:function(e){return{weekday:"long"}},MMM:function(e){return{month:"short"}},MMMM:function(e){return{month:"long"}},t:function(e){return{meridiem:e.h24?!1:"short"}},a:function(e){return{meridiem:e.h24?!1:"short"}},T:function(e){return e.h24?{meridiem:!1}:{}},A:function(e){return e.h24?{meridiem:!1}:{}},"//":function(e){return{}},"/":function(e){return{}},"::":function(e){return{}},":":function(e){return{}}};this.getFormatConverter=function(){return e}}function t(e){var t,n,r,s,o="",u=SiebelApp.S_App.LocaleObject.GetDateFormat(),a=u.length;for(t=0;t<a;t++)for(n=a;n>t;n--)r=i(u.substring(t,n),e,!1),r&&r!==e.ds&&(t=n-1,e=r);return e}function n(e){var t,n,r,s,o="",u="",a=e.longDateFmt,f=a.length,l=a.toUpperCase(),c=[],h;for(t=0;t<f;t++){o=l.charAt(t);if(o==="'")for(n=t+1;n<f;n++)if(l.charAt(n)==="'"){if(n-t===2&&c.length>0){h="["+l.charAt(t+1)+"]";var p=c.pop();switch(p){case"ld":e=$.extend(!0,{},e,{symbLd:h});break;case"lm":e=$.extend(!0,{},e,{symbLm:h});break;case"ly":e=$.extend(!0,{},e,{symbLy:h})}}t=n;break}for(r=f;r>t;r--)s=i(l.substring(t,r),e,!0,c),s&&s!==e.ds&&(t=r-1,e=s)}return e}function r(e){var t,n,r,s,o="",u=SiebelApp.S_App.LocaleObject.GetTimeFormat(),a=u.length;for(t=0;t<a;t++)for(n=a;n>t;n--)r=i(u.substring(t,n),e,!1),r&&r!==e.ts&&(t=n-1,e=r);return e}function i(e,t,n,r){var i;switch(e){case t.ds:i=t.ds;break;case t.ts:i=t.ts;break;case"DDDD":n&&(i=t);break;case"DDD"
:n&&(i=t);break;case"DD":n?(i=$.extend(!0,{},t,{ld:"DD",ldf:t.ldf.concat("d")}),r.push("ld")):i=$.extend(!0,{},t,{d:"DD",df:t.df.concat("d")});break;case"D":n?(i=$.extend(!0,{},t,{ld:"D",ldf:t.ldf.concat("d")}),r.push("ld")):i=$.extend(!0,{},t,{d:"D",df:t.df.concat("d")});break;case"MMMM":n?(i=$.extend(!0,{},t,{lm:"MMMM",ldf:t.ldf.concat("m")}),r.push("lm")):i=$.extend(!0,{},t,{m:"MMMM",df:t.df.concat("m")});break;case"MMM":n?(i=$.extend(!0,{},t,{lm:"MMM",ldf:t.ldf.concat("m")}),r.push("lm")):i=$.extend(!0,{},t,{m:"MMM",df:t.df.concat("m")});break;case"MM":n?(i=$.extend(!0,{},t,{lm:"MM",ldf:t.ldf.concat("m")}),r.push("lm")):i=$.extend(!0,{},t,{m:"MM",df:t.df.concat("m")});break;case"M":n?(i=$.extend(!0,{},t,{lm:"M",ldf:t.ldf.concat("m")}),r.push("lm")):i=$.extend(!0,{},t,{m:"M",df:t.df.concat("m")});break;case"YYYY":n?(i=$.extend(!0,{},t,{ly:"YYYY",ldf:t.ldf.concat("y")}),r.push("ly")):i=$.extend(!0,{},t,{y:"YYYY",df:t.df.concat("y")});break;case"YY":n?(i=$.extend(!0,{},t,{ly:"YY",ldf:t.ldf.concat("y")}),r.push("ly")):i=$.extend(!0,{},t,{y:"YY",df:t.df.concat("y")});break;case"HH":i=$.extend(!0,{},t,{h:"HH",h24:!0,tf:t.tf.concat("h")});break;case"H":i=$.extend(!0,{},t,{h:"H",h24:!0,tf:t.tf.concat("h")});break;case"hh":i=$.extend(!0,{},t,{h:"hh",tf:t.tf.concat("h")});break;case"h":i=$.extend(!0,{},t,{h:"h",tf:t.tf.concat("h")});break;case"mm":i=$.extend(!0,{},t,{n:"mm",tf:t.tf.concat("m")});break;case"m":i=$.extend(!0,{},t,{n:"m",tf:t.tf.concat("m")});break;case"ss":i=$.extend(!0,{},t,{s:"ss",tf:t.tf.concat("s")});break;case"s":i=$.extend(!0,{},t,{s:"s",tf:t.tf.concat("s")});break;case"p":i=$.extend(!0,{},t,{h24:!1,p:" a"});break;default:return}return i}function s(e,t){var n=t.longDateFmt;if(e===n)if(t.symbLy||t.symbLm||t.symbLd)return{year:t.ly==="YY"?"2-digit":"numeric",day:t.ld==="DD"?"2-digit":"numeric",month:"long"};var r,i=e.length,s,o,u,a={},f={};for(r=0;r<i;r++){s=e.charAt(r);if(s==="'"){for(o=r+1;o<i;o++)if(e.charAt(o)==="'"){r=o;break}}else for(o=i;o>r;o--){u=this.getFormatConverter()[e.substring(r,o)]||this.getFormatConverter()[e.substring(r,o).toLowerCase()];if(u){a=$.extend(!0,{},a,u(t)),r=o-1;break}}}return a}function o(e,t){var n={hour12:!e.h24,meridiem:e.h24?!1:"short"},r=e.h==="HH"||e.h==="hh"?"2-digit":"numeric",i=e.n==="mm"?"2-digit":"numeric",s=e.s==="ss"?"2-digit":"numeric";switch(t){case"hm":n.hour=r,n.minute=i;break;case"ms":n.minute=i,n.second=s;break;default:n.hour=r,n.minute=i,n.second=s}return timeformat}function u(e,t){var n={},r=e.y==="YY"?"2-digit":"numeric",i,s=e.d==="DD"?"2-digit":"numeric";switch(e.m){case"MMMM":i="long";break;case"MMM":i="short";break;case"MM":i="2-digit";break;case"M":i="numeric";break;default:}switch(t){case"my":n.year=r,n.month=i;break;case"md":n.month=i,n.day=s;break;default:n.year=r,n.month=i,n.day=s}return n}function a(e){var t={year:e.ly==="YY"?"2-digit":"numeric",day:e.ld==="DD"?"2-digit":"numeric",omitCommas:!0};if(e.symbLm)return t.month="long",t;switch(e.lm){case"MMMM":t.month="long";break;case"MMM":t.month="short";break;case"MM":t.month="2-digit";break;case"M":t.month="numeric";break;default:}return t}function f(){var e=SiebelApp.S_App.GetULC()||window.language,t={ARA:"ar",CHS:"zh-cn",CHT:"zh-tw",CSY:"cs",DAN:"da",NLD:"nl",ENU:"en",FIN:"fi",FRA:"fr",DEU:"de",HEB:"he",ITA:"it",JPN:"ja",KOR:"ko",PLK:"pl",PTB:"pt-br",PTG:"pt",RUS:"ru",ESN:"es",SVE:"sv",THA:"th",TRK:"tr"};return t[e.toUpperCase()]}return e.prototype.ConvertLocale=function(e){var i=this,o={ds:SiebelApp.S_App.LocaleObject.GetDispDateSeparator(),ts:SiebelApp.S_App.LocaleObject.GetDispTimeSeparator(),h24:!0,df:"",tf:"",ldf:"",p:"",longDateFmt:e.longDateFormat};return o=t(o),o=r(o),o=n(o),e.SiebelShorDateFmt=s.call(this,SiebelApp.S_App.LocaleObject.GetDateFormat(),o),{locale:f(),views:{timeGridDay:{titleFormat:s.call(i,e.views.timeGridDay.titleFormat,o)},timeGridWeek:{dayHeaderFormat:s.call(i,e.views.timeGridWeek.dayHeaderFormat,o),titleFormat:a.call(i,o)},dayGridMonth:{dayHeaderFormat:s.call(i,e.views.dayGridMonth.dayHeaderFormat,o),titleFormat:s.call(i,e.views.dayGridMonth.titleFormat,o)},listDay:{eventTimeFormat:e.eventTimeFormat,listDaySideFormat:s.call(i,SiebelApp.S_App.LocaleObject.GetDateFormat(),o),noEventsContent:"",titleFormat:s.call(i,e.views.timeGridDay.titleFormat,o)},listWeek:{eventTimeFormat:e.eventTimeFormat,listDaySideFormat:s.call(i,SiebelApp.S_App.LocaleObject.GetDateFormat(),o),noEventsContent:"",titleFormat:a.call(i,o)}}}},e}(),"SiebelAppFacade.JQFullCalRenderer"}));
