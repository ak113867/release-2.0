/*<ORACLECOPYRIGHT>
* Copyright (C) 2008-2024
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 24.2.0.0SIA[2024_02] */
typeof SiebelAppFacade.JSTreeRenderer=="undefined"&&(SiebelJS.Namespace("SiebelAppFacade.JSTreeRenderer"),define("siebel/jsTreeCtrl",["siebel/basephyrenderer","3rdParty/fancytree/dist/jquery.fancytree.min.js"],function(){return SiebelAppFacade.JSTreeRenderer=function(){function s(){SiebelAppFacade.JSTreeRenderer.superclass.constructor.apply(this,arguments);var t={};this.GetDataSet=function(){return t},this.EmptyDataSet=function(){t={}},this.GetKey=function(){var t=e.get("SWE_PROP_NC_ID_SCREEN_CONTROL"),n=this.GetPM().Get("IsScreen")?"screenName":"viewName";return this.GetKey=function(){return n},n}}function o(e,t){var n="siebui-nav-tree",r=$("div#"+e+"."+n);if(t&&r.length===0){r=$('div[id="'+e+'"]');if(r.length){r=r.not(function(){return $(this).hasClass("siebui-nav-hb")}),r=r.eq(0);var i=(r.attr("class")||"").split(" ");for(var s=0,o=i.length;s<o;s++)i[s].indexOf("siebui-nav-")===0&&i[s]!==n&&r.removeClass(i[s]);r.addClass(n)}}else r.length&&(r=r.eq(0));return r}function u(s,o){var u,a=this.GetPM(),f=o.node,l=!0;s.type=="fancytreeclick"&&(l=$.ui.fancytree.getEventTargetType(s.originalEvent)==="title"?!0:!1);if(f&&l&&f.key){var c;if(f.folder===!0)this.GetDataSet()!==null&&(u=this.GetDataSet()[f.key],c=u[a.Get("IsScreen")?"defaultViewName":this.GetKey()],u.viewName=c,a.Get("GetType")===e.get("SWE_PROP_NC_ID_SCREEN_CONTROL")?u.level=t:u.level=r);else{var h=a.Get("GetSelectedTabKey"),p=null;h!==null&&h!==undefined&&(u=a.Get("GetTabInfo")[h]),c=u.links==undefined?f.key:u.links[f.key].viewName,u.viewName=c,a.Get("GetType")===e.get("SWE_PROP_NC_ID_SCREEN_CONTROL")?u.level=n:u.level=i}return a.OnControlEvent("OnClick",u)?!0:!1}return!1}function a(t){var n=this;if(t.length===1){t.fancytree({source:[],titlesTabbable:!0,autoCollapse:!0,imagePath:" ",_classNames:{nodeIcon:null},clickFolderMode:3,minExpandLevel:1,persist:!1,renderNode:function(e,t){var n=t.node;n.data.addClass&&$(n.span).addClass(n.data.addClass)},keydown:function(e,t){e.which==13&&u.call(n,e,t)},click:function(e,t){u.call(n,e,t)}});var r=n.GetPM(),i=r.Get("GetType")===e.get("SWE_PROP_NC_ID_SCREEN_CONTROL")?"siebui-view-navs":"siebui-subview-navs";t.hasClass(i)||t.addClass(i),this.TreeLoaded=!0}}function f(){this.TreeLoaded&&this.Refresh(!0)}function l(t,n){var r=this.GetPM(),i=r.Get("GetTabContainerAutomationInfo"),s=r.Get("GetTabItemsAutomationInfo"),o=r.Get("IsScreen")?r.Get("GetTabInfo")[r.Get("GetSelectedTabKey")]&&r.Get("GetTabInfo")[r.Get("GetSelectedTabKey")].screenName:r.Get("GetTabInfo")[r.Get("GetSelectedTabKey")]&&r.Get("GetTabInfo")[r.Get("GetSelectedTabKey")].viewName,u=r.Get("GetTabViewLinkContainerAutomationInfo"),a=r.Get("GetTabViewLinkItemsAutomationInfo"),f=e.get("SWE_PROP_AUTOM_OT"),l=e.get("SWE_PROP_AUTOM_RN"),c=e.get("SWE_PROP_AUTOM_UN");t&&t.ul&&i&&typeof i.GetProperty=="function"&&(t.ul.setAttribute("ot",i.GetProperty(f)),t.ul.setAttribute("rn",i.GetProperty(l)),t.ul.setAttribute("un",i.GetProperty(c)));var h=t.getChildren()?t.getChildren().length:0;for(var p=0;p<h;p++){var d=t.getChildren()[p];d&&d.li&&s[p]&&typeof s[p].GetProperty=="function"&&(d.li.setAttribute("ot",s[p].GetProperty(f)),d.li.setAttribute("rn",s[p].GetProperty(l)),d.li.setAttribute("un",s[p].GetProperty(c)));if(d.getChildren()!==null&&o===d.key){d.ul&&u&&typeof u.GetProperty=="function"&&(d.ul.setAttribute("ot",u.GetProperty(f)),d.ul.setAttribute("rn",u.GetProperty(l)),d.ul.setAttribute("un",u.GetProperty(c)));for(var v=0;v<d.getChildren().length;v++){var m=d.getChildren()[v];m&&m.li&&a[v]&&typeof a[v].GetProperty=="function"&&(m.li.setAttribute("ot",a[v].GetProperty(f)),m.li.setAttribute("rn",a[v].GetProperty(l)),m.li.setAttribute("un",a[v].GetProperty(c)))}}}if(!n.overflow)return;var t=$("#"+n.comboContainer),g=r.Get("GetJumpTabAutomationInfo"),f=e.get("SWE_PROP_AUTOM_OT"),l=e.get("SWE_PROP_AUTOM_RN"),c=e.get("SWE_PROP_AUTOM_UN"),y=n.chtotal-n.count;g&&typeof g.GetProperty=="function"&&(t.attr("ot",g.GetProperty(f)),t.attr("rn",g.GetProperty(l)),t.attr("un",g.GetProperty(c))),d=t.children("option");var v=1;for(p=y;p<n.chtotal&&d.length>0;p++)s[p]&&typeof s[p].GetProperty=="function"&&(d.eq(v).attr("ot",s[p].GetProperty(f)),d.eq(v).attr("rn",s[p].GetProperty(l)),d.eq(v).attr("un",s[p].GetProperty(c)),v++)}function c(n){var s=null,u=this.GetPM(),a,f,l;SiebelApp.S_App.IsRwd()?(a=u.Get("placeholder"),f=u.Get("placeholder"),l=u.Get("SubPlaceholder")):(a=e.get("SWE_PROP_NC_ID_SCREEN_CONTROL"),f=e.get("SWE_PROP_NC_ID_VIEW_CONTROL"));switch(n){case t:s=o.call(this,a),s.find("ul li").eq(0).find(".fancytree-title").eq(0).focus();break;case r:s=o.call(this,f),s.find(" ul  li a").eq(0).focus();break;case i:SiebelApp.S_App.IsRwd()&&(s=o.call(this,l),s.find(" ul  li a").eq(0).focus())}}var e=SiebelJS.Dependency("SiebelApp.Constants"),t=e.get("SWE_SCREEN_NAV_CONTROL_STR"),n=e.get("SWE_AGGR_VIEW_NAV_CONTROL_STR"),r=e.get("SWE_DET_VIEW_NAV_CONTROL_STR"),i=e.get("SWE_DET_SUB_VIEW_NAV_CONTROL_STR");return SiebelJS.Extend(s,SiebelAppFacade.BasePR),s.prototype.Init=function(){SiebelAppFacade.JSTreeRenderer.superclass.Init.apply(this,arguments),this.GetPM().Get("IsScreen")&&this.AttachPMBinding("Refresh",this.BindData),this.GetPM().AttachPMBinding("FocusNavLink",c,{scope:this})},s.prototype.ShowUI=function(){var t=this.GetPM(),n=SiebelApp.S_App.IsRwd()?t.Get("placeholder"):t.Get("GetType"),r=o.call(this,n,!0);SiebelJS.Debug("[JSTreeRenderer] -> jqcontainer = "+r.length),n===e.get("SWE_PROP_NC_ID_VIEW_CONTROL")&&o.call(this,e.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL"),!0).length!==0&&(n=e.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")),r.attr("role","navigation"),t.SetProperty("LevelPlaceholder",n),a.call(this,r)},s.prototype.BindEvents=function(){var e=this;$(window).resize(function(){e.TreeLoaded&&e.Refresh(!0)}),SiebelApp.EventManager.removeListner("forceResize",f,this),SiebelApp.EventManager.addListner("forceResize",f,this)},s.prototype.BindData=function(){var e=this.GetPM(),t=e.Get("GetDataReload"),n=e.Get("GetTabInfo"),r=e.Get("GetSelectedTabLinkInfo"),i,s;t&&this.EmptyDataSet
();var o=this.GetDataSet(),u={};if(n!==null&&t)for(s in n)if(n.hasOwnProperty(s)){if(s.search("tabScreen")===-1)continue;i=n[s],o[i[this.GetKey()]]=i}var a=e.Get("GetSelectedTabKey"),f=null;a!==null&&a!==undefined&&n[a]!==undefined&&(f=n[a][this.GetKey()]);var l=!1;if(r!==null&&o[f]!==undefined&&o[f].links===undefined){var c=!1;for(s in r)if(r.hasOwnProperty(s)){if(s.search("tabView")===-1)continue;i=r[s],u[i.viewName]=i,c=!0}c&&(o[f].links=u,l=!0)}t&&(l=!0),this.Refresh(l)},s.prototype.Refresh=function(t){if(!t)return;var n=this.GetPM(),i=o.call(this,SiebelApp.S_App.IsRwd()?n.Get("placeholder"):n.Get("GetType")),s=$.ui.fancytree.getTree(i);if(s===null||s.getRootNode().length===0)return;s.getRootNode().removeChildren();var u=n.Get("GetTabInfo")||{};if(!u.tabScreen0)return;var f=n.Get("GetSelectedTabLinkInfo")||{},c=s.getRootNode(),h,p,d,v=!0;h=c;var m=n.Get("GetSelectedTabKey"),g=null;g=(u[m]||u.tabScreen0)[this.GetKey()],g=String(g);var y=n.Get("GetSelectedLinkKey"),b=null;y!==null&&y!==undefined&&(b=f[y]?f[y].viewName:""),b=String(b);var w=i.width()>i.height()?1:0,E=w?i.width():i.height(),S=45,x=!1,T=SiebelApp.S_App.IsRwd()?"j_"+n.Get("placeholder"):"j_"+n.Get("GetType"),N=n.Get("IsScreen")?"siebui-nav-screenlist":"siebui-nav-viewlist",C='<select id="'+T+'" class="'+N+'"><option></option>',k=!1,L=n.Get("GetTabInfo")[n.Get("GetSelectedTabKey")]||n.Get("GetTabInfo").tabScreen0,A=null;A=h.addChildren({title:L.captionName,folder:!0,url:L.captionName,icon:L.tabIcon,active:L.captionName===g,addClass:L.captionName===g?"screen-tab-selected":"screen-tab-deselected",expanded:L.captionName===g,key:L});var O=$($(A)[0].li).outerWidth(!0);S+=O,h.removeChildren(),$("#"+T).remove();var M=0,_=0,D=this.GetDataSet(),P;for(var H in D)if(D.hasOwnProperty(H)){if(!x){P="";if(D[H].tabBmpHTMLAttrib){var B=D[H].tabBmpHTMLAttrib.indexOf("=");P=D[H].tabBmpHTMLAttrib.substring(B+1).replace(/\"/g,"")}var j=D[H].tabIcon?D[H].tabIcon.replace(/-/g,"_"):"",F=j?utils.GetSpanTag(j,"screentab_icon"):utils.GetSpanTag("screentab_icon");p=h.addChildren({title:D[H].captionName,folder:!0,url:D[H].captionName,icon:D[H].tabIcon,addClass:(H===g?"screen-tab-selected":"screen-tab-deselected")+" "+P,expanded:H===g,key:H});if(F){if($(p.span).length===0){var I={noAnimation:!0};h.setExpanded(!0,I).done(function(){})}$(p.span).find(".fancytree-title").prepend(F)}H===g&&(k=!0,S-=O);var q=this.GetDataSet()[H].links,R=p,U=!1;for(d in q)if(q.hasOwnProperty(d)){if(v&&n.Get("LevelPlaceholder")===e.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")){var z=o.call(this,n.Get("LevelPlaceholder"));a.call(this,z);var W=$.ui.fancytree.getTree(z);if(W===null||W.getRootNode().length===0)return;W.getRootNode().removeChildren(),R=W.getRootNode(),v=!1}var X=R.addChildren({title:q[d].captionName,folder:!1,url:q[d].captionName,active:d===b,addClass:n.Get("LevelPlaceholder")===e.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")?d===b?"screen-tab-selected":"screen-tab-deselected":d===b?"view-tab-selected":"view-tab-deselected",key:d});d===b&&(U=!0)}H===g&&!U&&p.setActive(!0);var V=w?$($(p)[0].li).outerWidth(!0):$($(p)[0].li).outerHeight(!0);S+V<=E?S+=V:w&&(x=!0,p.remove(),this.GetDataSet()[H].captionName!==L.captionName||this.GetDataSet()[H].viewName!==L.viewName?(C+='<option value = "'+this.GetDataSet()[H].viewName+'">'+this.GetDataSet()[H].captionName+"</option>",_++):k=!1)}else{var J=this.GetDataSet()[H],K=J.captionName,Q=J.viewName;if(K!==L.captionName||Q!==L.viewName)C+='<option value = "'+Q+'">'+K+"</option>",_++}M++}x&&(C+="</select>",i.append(C));if(!k){var G=n.Get("IsScreen")?String(L.screenName):String(L.viewName);p=h.addChildren({title:L.captionName,folder:!0,url:L.captionName,icon:L.tabIcon,active:!1,addClass:G===g?"screen-tab-selected":"screen-tab-deselected",expanded:G===g,key:G});var Y=!1;for(d in L.links)if(L.links.hasOwnProperty(d)){var Z=p.addChildren({title:L.links[d].captionName,folder:!1,url:L.links[d].captionName,active:d===b,key:d});d===b&&(Y=!0)}!Y&&G===g&&p.setActive(!0)}var et=this;$("#"+T).change(function(){var e=$("#"+T).find("option:selected").text(),t=$("#"+T).find("option:selected").val(),i=et.GetDataSet(),s="";for(var o in i)i.hasOwnProperty(o)&&e===String(i[o].captionName)&&t===String(i[o].viewName)&&(s=i[o].viewName,i[o].level=r,s||(i[o].viewName=i[o].defaultViewName),n.OnControlEvent("OnClick",i[o]))});var tt={};tt.comboContainer=T,tt.chtotal=M,tt.count=_,tt.overflow=x,l.call(this,h,tt),h.isExpanded()||h.setExpanded(!0).done(function(){}),$(h.ul).find(".fancytree-title").attr("role","link")},s}(),"SiebelAppFacade.JSTreeRenderer"}));
